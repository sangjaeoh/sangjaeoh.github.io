<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.2.2">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2023-02-08T23:36:00+09:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Stack O Flow</title><subtitle>ì¡°ê¸ˆì”© ì•Œì•„ê°€ëŠ” ê²ƒì„ ì ëŠ” ê°œë°œ ë…¸íŠ¸ì…ë‹ˆë‹¤.</subtitle><author><name>Sangjae Oh</name></author><entry><title type="html">JUnit 5, AssertJ Cheat Sheet</title><link href="http://localhost:4000/java/TDD(Test-Driven-Development)-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%A3%BC%EB%8F%84-%EA%B0%9C%EB%B0%9C/" rel="alternate" type="text/html" title="JUnit 5, AssertJ Cheat Sheet" /><published>2023-02-07T00:00:00+09:00</published><updated>2023-02-07T00:00:00+09:00</updated><id>http://localhost:4000/java/TDD(Test%20Driven%20Development)-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%A3%BC%EB%8F%84-%EA%B0%9C%EB%B0%9C</id><content type="html" xml:base="http://localhost:4000/java/TDD(Test-Driven-Development)-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%A3%BC%EB%8F%84-%EA%B0%9C%EB%B0%9C/"><![CDATA[<p>JUnit 5, AssertJì˜ ì‚¬ìš©ë²•ì„ ê°„ë‹¨í•˜ê²Œ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤. ğŸ˜</p>
<ul>
  <li><a href="https://junit.org/junit5/docs/current/user-guide/#overview-what-is-junit-5" target="_blank">jUnit 5 ê°€ì´ë“œ ë§í¬</a></li>
  <li><a href="https://assertj.github.io/doc/" target="_blank">AssertJ ê°€ì´ë“œ ë§í¬</a>
<br />
<br />
<br /></li>
</ul>

<h1 id="-junit-ì´ë€">ğŸ¤” JUnit ì´ë€?</h1>
<ul>
  <li>Java ì§„ì˜ì˜ ëŒ€í‘œì ì¸ Test Framework</li>
  <li>ë‹¨ìœ„ í…ŒìŠ¤íŠ¸(Unit Test)ë¥¼ ìœ„í•œ ë„êµ¬ë¥¼ ì œê³µ
    <ul>
      <li>ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë€?
        <ul>
          <li>ì½”ë“œì˜ íŠ¹ì • ëª¨ë“ˆì´ ì˜ë„ëœ ëŒ€ë¡œ ë™ì‘í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•˜ëŠ” ì ˆì°¨ë¥¼ ì˜ë¯¸</li>
          <li>ëª¨ë“  í•¨ìˆ˜ì™€ ë©”ì†Œë“œì— ëŒ€í•´ ê°ê°ì˜ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì‘ì„±í•˜ëŠ” ê²ƒ</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ì–´ë…¸í…Œì´ì…˜(Annotation)ì„ ê¸°ë°˜ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì§€ì›</li>
  <li>ë‹¨ì •ë¬¸(Assert)ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì˜ ê¸°ëŒ€ê°’ì— ëŒ€í•´ ìˆ˜í–‰ ê²°ê³¼ë¥¼ í™•ì¸ í•  ìˆ˜ ìˆë‹¤</li>
  <li>Spring Boot 2.2 ë²„ì „ ë¶€í„° JUnit 5 ë²„ì „ì„ ì‚¬ìš©</li>
  <li>JUnitì€ í¬ê²Œ Jupiter, Platform, Vintage ëª¨ë“ˆë¡œ êµ¬ì„±<br />
<br />
<br />
<br />
<br /></li>
</ul>

<h1 id="-junit-5-ëª¨ë“ˆ-ì„¤ëª…">ğŸ“– JUnit 5 ëª¨ë“ˆ ì„¤ëª…</h1>
<p><strong>JUnit Jupiter</strong></p>
<ul>
  <li>TestEngine API êµ¬í˜„ì²´ë¡œ JUnit 5ë¥¼ êµ¬í˜„í•˜ê³  ìˆë‹¤.</li>
  <li>í…ŒìŠ¤íŠ¸ì˜ ì‹¤ì œ êµ¬í˜„ì²´ëŠ” ë³„ë„ ëª¨ë“ˆ ì—­í• ì„ ìˆ˜í–‰í•˜ëŠ”ë°, ê·¸ ëª¨ë“ˆ ì¤‘ í•˜ë‚˜ê°€ Jupiter-Engineì´ë‹¤.</li>
  <li>ì´ ëª¨ë“ˆì€ Jupiter-APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ì„±í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ë°œê²¬í•˜ê³  ì‹¤í–‰í•˜ëŠ” ì—­í• ì„ ìˆ˜í–‰í•œë‹¤.</li>
  <li>ê°œë°œìê°€ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•  ë•Œ ì‚¬ìš©ëœë‹¤.</li>
</ul>

<p><strong>JUnit Platform</strong></p>
<ul>
  <li>Testë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•œ ë¼ˆëŒ€</li>
  <li>Testë¥¼ ë°œê²¬í•˜ê³  í…ŒìŠ¤íŠ¸ ê³„íšì„ ìƒì„±í•˜ëŠ” TestEngine ì¸í„°í˜ì´ìŠ¤ë¥¼ ê°€ì§€ê³  ìˆë‹¤.</li>
  <li>TestEngineì„ í†µí•´ Testë¥¼ ë°œê²¬í•˜ê³ , ìˆ˜í–‰ ë° ê²°ê³¼ë¥¼ ë³´ê³ í•œë‹¤. ê·¸ë¦¬ê³  ê°ì¢… IDE ì—°ë™ì„ ë³´ì¡°í•˜ëŠ” ì—­í• ì„ ìˆ˜í–‰í•œë‹¤.(ì½˜ì†” ì¶œë ¥ ë“±)</li>
  <li>Platform = TestEngine API + Console Launcher + JUnit 4 Based Runner ë“±</li>
</ul>

<p><strong>JUnit Vintage</strong></p>
<ul>
  <li>TestEngine API êµ¬í˜„ì²´ë¡œ JUnit 3, 4ë¥¼ êµ¬í˜„í•˜ê³  ìˆë‹¤.</li>
  <li>ê¸°ì¡´ JUnit 3, 4ë²„ì „ìœ¼ë¡œ ì‘ì„±ëœ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•  ë•Œ ì‚¬ìš©ëœë‹¤.</li>
  <li>Vintage-Engine ëª¨ë“ˆì„ í¬í•¨í•˜ê³  ìˆë‹¤.</li>
</ul>

<p><img src="/assets/images/posts/java/junit5/3b581de9-e2a5-4f19-afe8-098b61a9e370.png" alt="jUnit Module" />
<br />
<br />
<br />
<br /></p>

<h1 id="-junit-5-ì–´ë…¸í…Œì´ì…˜">ğŸ“– JUnit 5 ì–´ë…¸í…Œì´ì…˜</h1>
<p><a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-annotations" target="_blank">ì–´ë…¸í…Œì´ì…˜ ê°€ì´ë“œ ë§í¬</a></p>

<h2 id="ë¼ì´í”„ì‚¬ì´í´-ì–´ë…¸í…Œì´ì…˜">ë¼ì´í”„ì‚¬ì´í´ ì–´ë…¸í…Œì´ì…˜</h2>
<p>JUnit 5ëŠ” ì•„ë˜ì™€ ê°™ì€ í…ŒìŠ¤íŠ¸ ë¼ì´í”„ ì‚¬ì´í´ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.</p>

<table>
  <thead>
    <tr>
      <th>Annotation</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>@Test</td>
      <td>í…ŒìŠ¤íŠ¸ìš© ë©”ì†Œë“œë¥¼ í‘œí˜„í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜</td>
    </tr>
    <tr>
      <td>@BeforeEach</td>
      <td>ê° í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œê°€ ì‹œì‘ë˜ê¸° ì „ì— ì‹¤í–‰ë˜ì–´ì•¼ í•˜ëŠ” ë©”ì†Œë“œë¥¼ í‘œí˜„</td>
    </tr>
    <tr>
      <td>@AfterEach</td>
      <td>ê° í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œê°€ ì‹œì‘ëœ í›„ ì‹¤í–‰ë˜ì–´ì•¼ í•˜ëŠ” ë©”ì†Œë“œë¥¼ í‘œí˜„</td>
    </tr>
    <tr>
      <td>@BeforeAll</td>
      <td>í…ŒìŠ¤íŠ¸ ì‹œì  ì „ì— ì‹¤í–‰ë˜ì–´ì•¼ í•˜ëŠ” ë©”ì†Œë“œë¥¼ í‘œí˜„ (static ì²˜ë¦¬ í•„ìš”)</td>
    </tr>
    <tr>
      <td>@AfterAll</td>
      <td>í…ŒìŠ¤íŠ¸ ì¢…ë£Œ í›„ì— ì‹¤í–‰ë˜ì–´ì•¼ í•˜ëŠ” ë©”ì†Œë“œë¥¼ í‘œí˜„ (static ì²˜ë¦¬ í•„ìš”)</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<h2 id="parameterizedtest">@ParameterizedTest</h2>
<p>íŒŒë¼ë¯¸í„° í…ŒìŠ¤íŠ¸ë¥¼ í•  ìˆ˜ ìˆê²Œ ë„ì™€ì£¼ëŠ” ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ,Â <code class="language-plaintext highlighter-rouge">@ValueSource</code>, <code class="language-plaintext highlighter-rouge">@CsvSource</code>,<code class="language-plaintext highlighter-rouge">@MethodSource</code> ë“±ì„ í†µí•´ ë§¤ê°œë³€ìˆ˜ë¥¼ ì§€ì •í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ParameterizedTest</span>
<span class="nd">@ValueSource</span><span class="o">(</span><span class="n">ints</span> <span class="o">=</span> <span class="o">{</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">5</span> <span class="o">})</span>
<span class="kt">void</span> <span class="nf">isPositive</span><span class="o">(</span><span class="kt">int</span> <span class="n">number</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">assertTrue</span><span class="o">(</span><span class="n">number</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ParameterizedTest</span>
<span class="nd">@CsvSource</span><span class="o">({</span>
    <span class="s">"apple,         1"</span><span class="o">,</span>
    <span class="s">"banana,        2"</span><span class="o">,</span>
    <span class="s">"'lemon, lime', 0xF1"</span><span class="o">,</span>
    <span class="s">"strawberry,    700_000"</span>
<span class="o">})</span>
<span class="kt">void</span> <span class="nf">testWithCsvSource</span><span class="o">(</span><span class="nc">String</span> <span class="n">fruit</span><span class="o">,</span> <span class="kt">int</span> <span class="n">rank</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertNotNull</span><span class="o">(</span><span class="n">fruit</span><span class="o">);</span>
    <span class="n">assertNotEquals</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">rank</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ParameterizedTest</span>
<span class="nd">@MethodSource</span><span class="o">(</span><span class="s">"stringProvider"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">testWithExplicitLocalMethodSource</span><span class="o">(</span><span class="nc">String</span> <span class="n">argument</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">assertNotNull</span><span class="o">(</span><span class="n">argument</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">static</span> <span class="nc">Stream</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">stringProvider</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"apple"</span><span class="o">,</span> <span class="s">"banana"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="repeatedtest">@RepeatedTest</h2>
<p>ë°˜ë³µ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ì–´ë…¸í…Œì´ì…˜</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RepeatedTest</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">repeatedTest</span><span class="o">()</span> <span class="o">{</span>
  <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"í…ŒìŠ¤íŠ¸ ë°˜ë³µ!"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="testmethodorder">@TestMethodOrder</h2>
<p>ìš°ì„  ìˆœìœ„ì— ë”°ë¼ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ì–´ë…¸í…Œì´ì…˜. <code class="language-plaintext highlighter-rouge">@Order</code> ë¥¼ í†µí•´ ìš°ì„ ìˆœìœ„ë¥¼ ì§€ì •í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@TestMethodOrder</span><span class="o">(</span><span class="nc">OrderAnnotation</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">OrderedTestsDemo</span> <span class="o">{</span>
  <span class="nd">@Test</span>
  <span class="nd">@Order</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
  <span class="kt">void</span> <span class="nf">secondTest</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"2"</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@Test</span>
  <span class="nd">@Order</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
  <span class="kt">void</span> <span class="nf">firstTest</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"1"</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="testinstance">@TestInstance</h2>
<p>ìƒëª…ì£¼ê¸°ë¥¼ ì§€ì •í•  ìˆ˜ ìˆëŠ” ì–´ë…¸í…Œì´ì…˜</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@TestInstance</span><span class="o">(</span><span class="nc">Lifecycle</span><span class="o">.</span><span class="na">PER_CLASS</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">OrderedTestsDemo</span> <span class="o">{...}</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="displayname">@DisplayName</h2>
<p>í…ŒìŠ¤íŠ¸ ì´ë¦„ì„ ì§€ì •í•  ìˆ˜ ìˆëŠ” ì–´ë…¸í…Œì´ì…˜</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"ê¸°ë³¸ ì‚°ìˆ˜ë¥¼ ê²€ì¦í•˜ëŠ” í…ŒìŠ¤íŠ¸"</span><span class="o">)</span>
<span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">basic</span><span class="o">()</span> <span class="o">{</span>
  <span class="n">assertEquals</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="nested">@Nested</h2>
<p>ì¤‘ì²© í´ë˜ìŠ¤ í…ŒìŠ¤íŠ¸ë¼ëŠ” ê²ƒì„ ëª…ì‹œí•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ <code class="language-plaintext highlighter-rouge">@BeforeAll</code>Â ë˜ëŠ”Â <code class="language-plaintext highlighter-rouge">@AfterAll</code> ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ìƒëª… ì£¼ê¸°ë¥¼ ëª…ì‹œí•´ì•¼í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">NestedTests</span> <span class="o">{</span>

  <span class="nd">@TestInstance</span><span class="o">(</span><span class="nc">Lifecycle</span><span class="o">.</span><span class="na">PER_CLASS</span><span class="o">)</span>
  <span class="nd">@Nested</span>
  <span class="kd">class</span> <span class="nc">Positive</span> <span class="o">{</span>

    <span class="nd">@BeforeAll</span>
    <span class="kt">void</span> <span class="nf">startTest</span><span class="o">()</span> <span class="o">{</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"í…ŒìŠ¤íŠ¸ ì‹œì‘"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">isPositive</span><span class="o">()</span> <span class="o">{</span>
      <span class="n">assertTrue</span><span class="o">(</span><span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="nd">@Nested</span>
  <span class="kd">class</span> <span class="nc">Negative</span> <span class="o">{</span>
    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">isNegative</span><span class="o">()</span> <span class="o">{</span>
      <span class="n">assertTrue</span><span class="o">(-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="tag">@Tag</h2>
<p>íƒœê·¸ë¥¼ ì„ ì–¸í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜. ì¶”í›„ì— êµ¬ì„± ì„¤ì • íŒŒì¼ì„ í†µí•´ í…ŒìŠ¤íŠ¸ì— í¬í•¨ ì‹œí‚¬ íƒœê·¸ë¥¼ ì„ íƒí•˜ê±°ë‚˜, ì œì™¸ì‹œí‚¬ íƒœê·¸ë¥¼ ì„ íƒí•  ìˆ˜ ìˆë‹¤. JUnit4ì˜Â <code class="language-plaintext highlighter-rouge">@Category</code>ê°€ ì´ ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ëŒ€ì²´ë¨</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Tag</span><span class="o">(</span><span class="s">"number"</span><span class="o">)</span>
<span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">basic</span><span class="o">()</span> <span class="o">{</span>
  <span class="n">assertEquals</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-groovy highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">junitPlatform</span> <span class="o">{</span>
  <span class="n">filters</span> <span class="o">{</span>
      <span class="n">tags</span> <span class="o">{</span>
          <span class="n">include</span> <span class="s1">'number'</span><span class="o">,</span> <span class="s1">'korean'</span>
          <span class="n">exclude</span> <span class="s1">'english'</span>
      <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="disabled">@Disabled</h2>
<p>í…ŒìŠ¤íŠ¸ì—ì„œ ì œì™¸ì‹œí‚¤ëŠ” ì–´ë…¸í…Œì´ì…˜. JUnit4ì˜Â <code class="language-plaintext highlighter-rouge">@Ingore</code>ì™€ ê°™ì€ ê¸°ëŠ¥ì´ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Disabled</span>
<span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">ignoredTest</span><span class="o">()</span> <span class="o">{</span>
  <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"í…ŒìŠ¤íŠ¸ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="timeout">@Timeout</h2>
<p>ì‹¤í–‰ ì‹œê°„ ì œí•œì„ ê±¸ì–´ë‘ëŠ” ì–´ë…¸í…Œì´ì…˜. ì‹œê°„ì´ ì´ˆê³¼ë˜ë©´Â <code class="language-plaintext highlighter-rouge">TimeoutException</code>ì´ ë°œìƒí•˜ë©° í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Timeout</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
<span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">mustRunIn1SecondTest</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span>
	<span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1500</span><span class="o">);</span> <span class="c1">// ì‹¤íŒ¨</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="nd">@Timeout</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">500</span><span class="o">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="nc">TimeUnit</span><span class="o">.</span><span class="na">MILLISECONDS</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">failsIfExecutionTimeExceeds500Milliseconds</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// fails if execution time exceeds 500 milliseconds</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br />
<br />
<br /></p>

<h1 id="-junit-assertions">ğŸ“– JUnit Assertions</h1>
<p><a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-annotations" target="_blank">Assertions ê°€ì´ë“œ ë§í¬</a></p>

<h2 id="asserttrue--assertfalse">assertTrue &amp;&amp; assertFalse</h2>
<p>ì°¸ ê±°ì§“ ì—¬ë¶€ íŒë‹¨. 2ë²ˆì§¸ ì¸ìê°€ ì¡´ì¬í•˜ë©´ ì‹¤íŒ¨ ì‹œ 2ë²ˆì§¸ ì¸ìë¥¼ ë©”ì‹œì§€ë¡œ ì¶œë ¥í•´ì¤€ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertTrue</span><span class="o">(</span><span class="sc">'a'</span> <span class="o">&lt;</span> <span class="sc">'b'</span><span class="o">);</span>
<span class="n">assertTrue</span><span class="o">(</span><span class="sc">'a'</span> <span class="o">&lt;</span> <span class="sc">'b'</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="s">"message"</span><span class="o">);</span>

<span class="n">assertFalse</span><span class="o">(</span><span class="sc">'a'</span> <span class="o">&lt;</span> <span class="sc">'b'</span><span class="o">);</span>
<span class="n">assertFalse</span><span class="o">(</span><span class="sc">'a'</span> <span class="o">&lt;</span> <span class="sc">'b'</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="s">"message"</span><span class="o">);</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="assertnull--assertnotnull">assertNull &amp;&amp; assertNotNull</h2>
<p>ê°ì²´ì˜ null ì—¬ë¶€ íŒë‹¨</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertNull</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"my.prop"</span><span class="o">));</span>
<span class="n">assertNotNull</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"my.prop"</span><span class="o">));</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="assertequals--assertnotequals">assertEquals &amp;&amp; assertNotEquals</h2>
<p>ë‘ ê°’ì„ ë¹„êµí•˜ì—¬ ì¼ì¹˜ ì—¬ë¶€ íŒë‹¨. 3ë²ˆì§¸ ì¸ìê°€ ì¡´ì¬í•˜ë©´ ì‹¤íŒ¨ ì‹œ 3ë²ˆì§¸ ì¸ìë¥¼ ë©”ì‹œì§€ë¡œ ì¶œë ¥í•´ì¤€ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertEquals</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">));</span>
<span class="n">assertEquals</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">multiply</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">2</span><span class="o">),</span> <span class="s">"message"</span><span class="o">);</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="assertarrayequals">assertArrayEquals</h2>
<p>ë‘ ë°°ì—´ì„ ë¹„êµí•˜ì—¬ ì¼ì¹˜ ì—¬ë¶€ íŒë‹¨. ë‘ ë°°ì—´ì´ ëª¨ë‘ nullì´ì–´ë„ ë™ì¼í•œ ê²ƒìœ¼ë¡œ ê°„ì£¼í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">char</span><span class="o">[]</span> <span class="n">expected</span> <span class="o">=</span> <span class="o">{</span><span class="sc">'J'</span><span class="o">,</span><span class="sc">'u'</span><span class="o">,</span><span class="sc">'n'</span><span class="o">,</span><span class="sc">'i'</span><span class="o">,</span><span class="sc">'t'</span><span class="o">};</span>
<span class="kt">char</span><span class="o">[]</span> <span class="n">actual</span> <span class="o">=</span> <span class="s">"Junit"</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">();</span>
<span class="n">assertArrayEquals</span><span class="o">(</span><span class="n">expected</span><span class="o">,</span> <span class="n">actual</span><span class="o">);</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="assertall">assertAll</h2>
<p>ì—¬ëŸ¬ ê°œì˜ <code class="language-plaintext highlighter-rouge">assertions</code>ê°€ ë§Œì¡±í•  ê²½ìš°ì—ë§Œ í…ŒìŠ¤ë¥¼ í†µê³¼í•˜ì˜€ë‹¤ê³  íŒë‹¨í•˜ê³  ì‹¶ì„ ê²½ìš°ì—ëŠ” <code class="language-plaintext highlighter-rouge">assertAll()</code>ì„ ì‚¬ìš©í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">assertAll</span><span class="o">(</span>
      <span class="s">"heading"</span><span class="o">,</span>
      <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertEquals</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span><span class="o">,</span> <span class="s">"4 is 2 times 2"</span><span class="o">),</span>
      <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertEquals</span><span class="o">(</span><span class="s">"java"</span><span class="o">,</span> <span class="s">"JAVA"</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">()),</span>
      <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertEquals</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="s">"null is equal to null"</span><span class="o">)</span>
    <span class="o">);</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">dependentAssertions</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">assertAll</span><span class="o">(</span><span class="s">"properties"</span><span class="o">,</span>
        <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">firstName</span> <span class="o">=</span> <span class="n">person</span><span class="o">.</span><span class="na">getFirstName</span><span class="o">();</span>
            <span class="n">assertNotNull</span><span class="o">(</span><span class="n">firstName</span><span class="o">);</span>
            <span class="n">assertAll</span><span class="o">(</span><span class="s">"first name"</span><span class="o">,</span>
                <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">firstName</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="s">"J"</span><span class="o">)),</span>
                <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">firstName</span><span class="o">.</span><span class="na">endsWith</span><span class="o">(</span><span class="s">"e"</span><span class="o">))</span>
            <span class="o">);</span>
        <span class="o">},</span>
        <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">lastName</span> <span class="o">=</span> <span class="n">person</span><span class="o">.</span><span class="na">getLastName</span><span class="o">();</span>
            <span class="n">assertNotNull</span><span class="o">(</span><span class="n">lastName</span><span class="o">);</span>
            <span class="n">assertAll</span><span class="o">(</span><span class="s">"last name"</span><span class="o">,</span>
                <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">lastName</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="s">"D"</span><span class="o">)),</span>
                <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="o">(</span><span class="n">lastName</span><span class="o">.</span><span class="na">endsWith</span><span class="o">(</span><span class="s">"e"</span><span class="o">))</span>
            <span class="o">);</span>
        <span class="o">}</span>
    <span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="assertsame--assertnotsame">assertSame &amp;&amp; assertNotSame</h2>
<p>ì˜ˆìƒë˜ëŠ” ê°’ê³¼ ì‹¤ì œ ê°’ì´ ë™ì¼í•œ ê°ì²´ë¥¼ ì°¸ì¡°í•˜ëŠ”ì§€ í™•ì¸</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">language</span> <span class="o">=</span> <span class="s">"Java"</span><span class="o">;</span>
<span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">optional</span> <span class="o">=</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">language</span><span class="o">);</span>

<span class="n">assertSame</span><span class="o">(</span><span class="n">language</span><span class="o">,</span> <span class="n">optional</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
<span class="n">assertNotSame</span><span class="o">(</span><span class="n">language</span><span class="o">,</span> <span class="n">optional</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="assertthrows">assertThrows</h2>
<p>íŠ¹ì • ì˜ˆì™¸ê°€ ë°œìƒí•˜ì˜€ëŠ”ì§€ í™•ì¸. ì²« ë²ˆì§¸ ì¸ìëŠ” í™•ì¸í•  ì˜ˆì™¸ í´ë˜ìŠ¤, ë‘ ë²ˆì§¸ ì¸ìëŠ” í…ŒìŠ¤íŠ¸í•˜ë ¤ëŠ” ì½”ë“œ</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">exceptionTesting</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">Exception</span> <span class="n">exception</span> <span class="o">=</span> <span class="n">assertThrows</span><span class="o">(</span><span class="nc">ArithmeticException</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span>
        <span class="n">calculator</span><span class="o">.</span><span class="na">divide</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">));</span>
    <span class="n">assertEquals</span><span class="o">(</span><span class="s">"/ by zero"</span><span class="o">,</span> <span class="n">exception</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="asserttimeout--asserttimeoutpreemptively">assertTimeout &amp; assertTimeoutPreemptively</h2>
<p>íŠ¹ì • ì‹œê°„ ì•ˆì— ì‹¤í–‰ì´ ëë‚˜ëŠ”ì§€ í™•ì¸</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">assertTimeout</code>: ì‹œê°„ ë‚´ ì‹¤í–‰ì´ ëë‚˜ëŠ”ì§€ ì—¬ë¶€ í™•ì¸ ì‹œ</li>
  <li><code class="language-plaintext highlighter-rouge">assertTimeoutPreemptively</code>: ì§€ì •í•œ ì‹œê°„ ë‚´ ëë‚˜ì§€ ì•Šìœ¼ë©´ ë°”ë¡œ ì¢…ë£Œ</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">timeoutNotExceeded</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ì‹œê°„ì•ˆì— ì„±ê³µ</span>
    <span class="n">assertTimeout</span><span class="o">(</span><span class="n">ofMinutes</span><span class="o">(</span><span class="mi">2</span><span class="o">),</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="c1">// 2ë¶„ ì•ˆì— ëë‚˜ëŠ” í…ŒìŠ¤íŠ¸ ì‘ì„±...</span>
    <span class="o">});</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">timeoutNotExceededWithResult</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ì‹œê°„ ì•ˆì— ì„±ê³µ, ê·¸ë¦¬ê³  supplied object ë¦¬í„´</span>
    <span class="nc">String</span> <span class="n">actualResult</span> <span class="o">=</span> <span class="n">assertTimeout</span><span class="o">(</span><span class="n">ofMinutes</span><span class="o">(</span><span class="mi">2</span><span class="o">),</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"a result"</span><span class="o">;</span>
    <span class="o">});</span>
    <span class="n">assertEquals</span><span class="o">(</span><span class="s">"a result"</span><span class="o">,</span> <span class="n">actualResult</span><span class="o">);</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">timeoutExceeded</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ì‹œê°„ì•ˆì— í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µí•˜ì§€ ëª»í•œë‹¤ë©´ ë‹¤ìŒê³¼ ë¹„ìŠ·í•œ ì˜¤ë¥˜ ë©”ì‹œì§€ ì¶œë ¥</span>
    <span class="c1">// execution exceeded timeout of 10 ms by 91 ms</span>
    <span class="n">assertTimeout</span><span class="o">(</span><span class="n">ofMillis</span><span class="o">(</span><span class="mi">10</span><span class="o">),</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
    <span class="o">});</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">timeoutExceededWithPreemptiveTermination</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ì‹œê°„ì•ˆì— í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µí•˜ì§€ ëª»í•œë‹¤ë©´ ë‹¤ìŒê³¼ ë¹„ìŠ·í•œ ì˜¤ë¥˜ ë©”ì‹œì§€ ì¶œë ¥</span>
    <span class="c1">// execution timed out after 10 ms</span>
    <span class="n">assertTimeoutPreemptively</span><span class="o">(</span><span class="n">ofMillis</span><span class="o">(</span><span class="mi">10</span><span class="o">),</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="c1">// 10ms ì´ìƒ ì†Œìš”ë˜ëŠ” ì‘ì—…...</span>
        <span class="k">new</span> <span class="nf">CountDownLatch</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">await</span><span class="o">();</span>
    <span class="o">});</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br />
<br />
<br /></p>

<h1 id="-assertj-assertions">ğŸ“– AssertJ Assertions</h1>
<ul>
  <li><a href="https://assertj.github.io/doc/" target="_blank">AssertJ ê°€ì´ë“œ ë§í¬</a></li>
  <li><a href="https://www.baeldung.com/introduction-to-assertj" target="_blank">Spring AssertJ ê°€ì´ë“œ ë§í¬</a></li>
</ul>

<div class="notice--info">
<p><strong>ì°¸ê³ </strong></p>

<p><code class="language-plaintext highlighter-rouge">AssertJ</code>ì—ì„œ ëª¨ë“  í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” <code class="language-plaintext highlighter-rouge">assertThat()</code>ìœ¼ë¡œ ì‹œì‘í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="n">íƒ€ê²Ÿ</span><span class="o">).</span><span class="na">ë©”ì†Œë“œ1</span><span class="o">().</span><span class="na">ë©”ì†Œë“œ2</span><span class="o">();</span>
</code></pre></div></div>
</div>
<p><br /></p>

<h2 id="object-assertions">Object Assertions</h2>
<p>ObjectsëŠ” ë‘ ê°ì²´ì˜ ë™ë“±ì„±ì´ë‚˜ ê°ì²´ì˜ í•„ë“œë¥¼ ê²€ì‚¬í•˜ê¸° ìœ„í•´ ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ ë¹„êµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Dog</span> <span class="o">{</span> 
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span> 
    <span class="kd">private</span> <span class="nc">Float</span> <span class="n">weight</span><span class="o">;</span>
    
    <span class="c1">// Getters, Setters...</span>
<span class="o">}</span>

<span class="nc">Dog</span> <span class="n">fido</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Dog</span><span class="o">(</span><span class="s">"Fido"</span><span class="o">,</span> <span class="mf">5.25</span><span class="o">);</span>
<span class="nc">Dog</span> <span class="n">fidosClone</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Dog</span><span class="o">(</span><span class="s">"Fido"</span><span class="o">,</span> <span class="mf">5.25</span><span class="o">)</span>
</code></pre></div></div>

<h3 id="isequalto">isEqualTo()</h3>
<p>ì°¸ì¡° ë¹„êµ</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="n">fido</span><span class="o">).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="n">fidosClone</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="isequaltocomparingfieldbyfieldrecursively">isEqualToComparingFieldByFieldRecursively()</h3>
<p>ë‚´ìš© ë¹„êµ</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="n">fido</span><span class="o">).</span><span class="na">isEqualToComparingFieldByFieldRecursively</span><span class="o">(</span><span class="n">fidosClone</span><span class="o">);</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="boolean-assertions">Boolean Assertions</h2>
<p>ì°¸, ê±°ì§“ í™•ì¸</p>

<h3 id="istrue--isfalse">isTrue() &amp;&amp; isFalse()</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="s">""</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()).</span><span class="na">isTrue</span><span class="o">();</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="iterablearray-assertions">Iterable/Array Assertions</h2>
<p><a href="https://joel-costigliola.github.io/assertj/core-8/api/org/assertj/core/api/AbstractIterableAssert.html" target="_blank">Iterable/Array ê°€ì´ë“œ ë§í¬</a><br />
<code class="language-plaintext highlighter-rouge">Iterable/Array</code>ì— íŠ¹ì • ìš”ì†Œê°€ ì¡´ì¬í•˜ëŠ”ì§€ ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ ì•Œ ìˆ˜ ìˆë‹¤.</p>

<h3 id="contains">contains()</h3>
<p>ìš”ì†Œ í¬í•¨ í™•ì¸</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"1"</span><span class="o">,</span> <span class="s">"2"</span><span class="o">,</span> <span class="s">"3"</span><span class="o">);</span>
<span class="n">assertThat</span><span class="o">(</span><span class="n">list</span><span class="o">).</span><span class="na">contains</span><span class="o">(</span><span class="s">"1"</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="doesnotcontain">doesNotContain()</h3>
<p>ìš”ì†Œê°€ í¬í•¨ë˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="n">list</span><span class="o">).</span><span class="na">doesNotContain</span><span class="o">(</span><span class="s">"4"</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="containsexactly">containsExactly()</h3>
<p>ì‹¤ì œ ê·¸ë£¹ì— ì§€ì •ëœ ê°’ì´ ìˆœì„œëŒ€ë¡œ ì •í™•íˆ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤. ì¼ê´€ëœ ë°˜ë³µ ìˆœì„œê°€ ìˆëŠ” ê·¸ë£¹ì—ë§Œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">Ring</span><span class="o">&gt;</span> <span class="n">elvesRings</span> <span class="o">=</span> <span class="n">newArrayList</span><span class="o">(</span><span class="n">vilya</span><span class="o">,</span> <span class="n">nenya</span><span class="o">,</span> <span class="n">narya</span><span class="o">);</span>

 <span class="c1">// ì„±ê³µ</span>
 <span class="n">assertThat</span><span class="o">(</span><span class="n">elvesRings</span><span class="o">).</span><span class="na">containsExactly</span><span class="o">(</span><span class="n">vilya</span><span class="o">,</span> <span class="n">nenya</span><span class="o">,</span> <span class="n">narya</span><span class="o">);</span>

 <span class="c1">// ì‹¤íŒ¨</span>
 <span class="n">assertThat</span><span class="o">(</span><span class="n">elvesRings</span><span class="o">).</span><span class="na">containsExactly</span><span class="o">(</span><span class="n">nenya</span><span class="o">,</span> <span class="n">vilya</span><span class="o">,</span> <span class="n">narya</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="containsall">containsAll()</h3>
<p>ì‹¤ì œ ê·¸ë£¹ì— ì§€ì •ëœ <code class="language-plaintext highlighter-rouge">Iterable</code>ì˜ ëª¨ë“  ìš”ì†Œê°€ ì„ì˜ì˜ ìˆœì„œë¡œ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">abc</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">,</span> <span class="s">"c"</span><span class="o">);</span>

 <span class="c1">// ì„±ê³µ</span>
 <span class="n">assertThat</span><span class="o">(</span><span class="n">abc</span><span class="o">).</span><span class="na">containsAll</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"b"</span><span class="o">,</span> <span class="s">"c"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">containsAll</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">,</span> <span class="s">"c"</span><span class="o">));</span>

 <span class="c1">// ì‹¤íŒ¨</span>
 <span class="n">assertThat</span><span class="o">(</span><span class="n">abc</span><span class="o">).</span><span class="na">containsAll</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"d"</span><span class="o">));</span>
 <span class="n">assertThat</span><span class="o">(</span><span class="n">abc</span><span class="o">).</span><span class="na">containsAll</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">,</span> <span class="s">"c"</span><span class="o">,</span> <span class="s">"d"</span><span class="o">));</span>
</code></pre></div></div>

<h3 id="isnotempty">isNotEmpty()</h3>
<p>ë¹„ì–´ìˆì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="n">list</span><span class="o">).</span><span class="na">isNotEmpty</span><span class="o">();</span>
</code></pre></div></div>

<h3 id="startswith">startsWith()</h3>
<p>ì£¼ì–´ì§„ ê°’ìœ¼ë¡œ ì‹œì‘í•˜ëŠ”ì§€ í™•ì¸</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="n">list</span><span class="o">).</span><span class="na">startsWith</span><span class="o">(</span><span class="s">"1"</span><span class="o">);</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="character-assertions">Character Assertions</h2>
<p><a href="https://joel-costigliola.github.io/assertj/core-8/api/org/assertj/core/api/AbstractCharacterAssert.html" target="_blank">Character ê°€ì´ë“œ ë§í¬</a><br />
Characterì— ëŒ€í•œ ë¹„êµ</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="n">someCharacter</span><span class="o">)</span>
  <span class="o">.</span><span class="na">isNotEqualTo</span><span class="o">(</span><span class="sc">'a'</span><span class="o">)</span>             <span class="c1">// a ê°€ ì•„ë‹ˆê³ </span>
  <span class="o">.</span><span class="na">inUnicode</span><span class="o">()</span>                   <span class="c1">// ìœ ë‹ˆì½”ë“œ í…Œì´ë¸”ì— ìˆê³ </span>
  <span class="o">.</span><span class="na">isGreaterThanOrEqualTo</span><span class="o">(</span><span class="sc">'b'</span><span class="o">)</span>   <span class="c1">// bë³´ë‹¤ í¬ê³ </span>
  <span class="o">.</span><span class="na">isLowerCase</span><span class="o">();</span>                <span class="c1">// ì†Œë¬¸ì ì¸ì§€ í™•ì¸</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="class-assertions">Class Assertions</h2>
<p><a href="https://joel-costigliola.github.io/assertj/core-8/api/org/assertj/core/api/AbstractClassAssert.html" target="_blank">Class ê°€ì´ë“œ ë§í¬</a><br />
í´ë˜ìŠ¤ì— ê´€í•œ ë¹„êµ</p>

<h3 id="isinterface">isInterface()</h3>
<p>ì¸í„°í˜ì´ìŠ¤ì¸ì§€ í™•ì¸</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="nc">Runnable</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">isInterface</span><span class="o">();</span>
</code></pre></div></div>

<h3 id="isassignablefrom">isAssignableFrom()</h3>
<p>í• ë‹¹ ê°€ëŠ¥í•œì§€ í™•ì¸</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="nc">Exception</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="nc">NoSuchElementException</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="file-assertions">File Assertions</h2>
<p><a href="https://joel-costigliola.github.io/assertj/core-8/api/org/assertj/core/api/AbstractFileAssert.html" target="_blank">File ê°€ì´ë“œ ë§í¬</a><br />
íŒŒì¼ì— ê´€ë ¨ëœ ë¹„êµ</p>

<h3 id="exists">exists()</h3>
<p>ì¡´ì¬ ì—¬ë¶€</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="n">someFile</span><span class="o">).</span><span class="na">exists</span><span class="o">();</span>
</code></pre></div></div>

<h3 id="isfile">isFile()</h3>
<p>íŒŒì¼ìœ í˜•ì¸ì§€ í™•ì¸</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="n">someFile</span><span class="o">).</span><span class="na">isFile</span><span class="o">();</span>
</code></pre></div></div>

<h3 id="canread">canRead()</h3>
<p>ì½ì„ ìˆ˜ ìˆëŠ”ì§€ í™•ì¸</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="n">someFile</span><span class="o">).</span><span class="na">canRead</span><span class="o">();</span>
</code></pre></div></div>

<h3 id="canwrite">canWrite()</h3>
<p>ì“¸ ìˆ˜ ìˆëŠ”ì§€ í™•ì¸</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="n">someFile</span><span class="o">).</span><span class="na">canWrite</span><span class="o">();</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="doublefloatintegerassertions">Double/Float/IntegerÂ Assertions</h2>
<p><a href="https://joel-costigliola.github.io/assertj/core-8/api/org/assertj/core/api/AbstractDoubleAssert.html" target="_blank">Double/Float/Integer ê°€ì´ë“œ ë§í¬</a><br />
ìˆ«ìì— ëŒ€í•œ ë¹„êµ</p>

<h3 id="isbetween">isBetween()</h3>
<p>ê°’ì´ ë‘ ê°’ ì‚¬ì´ì— ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ (start, end í¬í•¨)</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="mi">3</span><span class="o">).</span><span class="na">isBetween</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">4</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="isstrictlybetween">isStrictlyBetween()</h3>
<p>ê°’ì´ ë‘ ê°’ ì‚¬ì´ì— ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ (start, end ë¯¸í¬í•¨)</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="mi">3</span><span class="o">).</span><span class="na">isStrictlyBetween</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">4</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="ispositive">isPositive()</h3>
<p>ì–‘ìˆ˜ì¸ì§€ í™•ì¸</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="mi">3</span><span class="o">).</span><span class="na">isPositive</span><span class="o">();</span>
</code></pre></div></div>

<h3 id="isnegative">isNegative()</h3>
<p>ìŒìˆ˜ì¸ì§€ í™•ì¸</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(-</span><span class="mi">1</span><span class="o">).</span><span class="na">isNegative</span><span class="o">();</span>
</code></pre></div></div>

<h3 id="iszero">isZero()</h3>
<p>ê°’ì´ 0ì¸ì§€ í™•ì¸</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">isZero</span><span class="o">();</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="mapassertions">MapÂ Assertions</h2>
<p><a href="https://joel-costigliola.github.io/assertj/core-8/api/org/assertj/core/api/AbstractMapAssert.html" target="_blank">Map ê°€ì´ë“œ ë§í¬</a><br />
ë§µì— íŠ¹ì • í•­ëª©, entry, key/value ê°’ì´ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤.</p>

<h3 id="containskey">containsKey()</h3>
<p>í‚¤ê°€ ì¡´ì¬í•˜ì§€ëŠ” í™•ì¸</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="n">map</span><span class="o">).</span><span class="na">containsKey</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="doesnotcontainkeys">doesNotContainKeys()</h3>
<p>í‚¤ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ì§€ í™•ì¸</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="n">map</span><span class="o">).</span><span class="na">doesNotContainKeys</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="entry">entry()</h3>
<p>mapì˜ í‚¤, ê°’ì„ í™•ì¸</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="n">map</span><span class="o">).</span><span class="na">contains</span><span class="o">(</span><span class="n">entry</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="s">"a"</span><span class="o">));</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="throwable-assertions">Throwable Assertions</h2>
<p><a href="https://joel-costigliola.github.io/assertj/core-8/api/org/assertj/core/api/AbstractThrowableAssert.html" target="_blank">Throwable ê°€ì´ë“œ ë§í¬</a><br />
ì˜ˆì™¸ ë©”ì‹œì§€, ìŠ¤íƒ ì¶”ì  ê²€ì‚¬, ì˜ˆì™¸ ë°œìƒí–ˆëŠ”ì§€ í™•ì¸</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Throwable</span> <span class="n">thrown</span> <span class="o">=</span> <span class="n">catchThrowable</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="o">(</span><span class="s">"boom!"</span><span class="o">);</span>
<span class="o">});</span>

<span class="n">assertThat</span><span class="o">(</span><span class="n">thrown</span><span class="o">).</span><span class="na">isInstanceOf</span><span class="o">(</span><span class="nc">Exception</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">hasMessageContaining</span><span class="o">(</span><span class="s">"boom"</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="assertthatthrownby">assertThatThrownBy()</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThatThrownBy</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span><span class="k">throw</span> <span class="k">new</span> <span class="nc">Exception</span><span class="o">(</span><span class="s">"boom!"</span><span class="o">);})</span>
<span class="o">.</span><span class="na">isInstanceOf</span><span class="o">(</span><span class="nc">Exception</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="o">.</span><span class="na">hasMessageContaining</span><span class="o">(</span><span class="s">"boom"</span><span class="o">);</span>
</code></pre></div></div>

<h3 id="assertthatexceptionoftype">assertThatExceptionOfType()</h3>
<p>íŠ¹ì • íƒ€ì…ìœ¼ë¡œ ê²€ì‚¬</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThatExceptionOfType</span><span class="o">(</span><span class="nc">IOException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="o">.</span><span class="na">isThrownBy</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="k">throw</span> <span class="k">new</span> <span class="nc">IOException</span><span class="o">(</span><span class="s">"boom!"</span><span class="o">);</span> <span class="o">})</span>
<span class="o">.</span><span class="na">withMessage</span><span class="o">(</span><span class="s">"%s!"</span><span class="o">,</span> <span class="s">"boom"</span><span class="o">)</span>
<span class="o">.</span><span class="na">withMessageContaining</span><span class="o">(</span><span class="s">"boom"</span><span class="o">)</span>
<span class="o">.</span><span class="na">withNoCause</span><span class="o">();</span>
</code></pre></div></div>
<p>ê·¸ ë°–ì— íŠ¹ì • íƒ€ì…ì„ ê²€ì‚¬í•˜ëŠ” <code class="language-plaintext highlighter-rouge">exceptions</code>ë¥¼ ì´ìš©í•  ìˆ˜ ìˆë‹¤.</p>
<ul>
  <li>assertThatNullPointerException</li>
  <li>assertThatIllegalArgumentException</li>
  <li>assertThatIllegalStateException</li>
  <li>assertThatIOException<br />
<br /></li>
</ul>

<h2 id="describing-assertions">Describing Assertions</h2>

<h3 id="as">as()</h3>
<p>í…ŒìŠ¤íŠ¸ì˜ ì„¤ëª… ì‘ì„±</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assertThat</span><span class="o">(</span><span class="n">person</span><span class="o">.</span><span class="na">getAge</span><span class="o">())</span>
    <span class="o">.</span><span class="na">as</span><span class="o">(</span><span class="s">"%s's age should be equal to 100"</span><span class="o">,</span> <span class="n">person</span><span class="o">.</span><span class="na">getName</span><span class="o">())</span>
    <span class="o">.</span><span class="na">isEqualTo</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>

<span class="c1">// ì¶œë ¥</span>
<span class="c1">// [Alex's age should be equal to 100] expected:&lt;100&gt; but was:&lt;34&gt;</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="junit-assumptions">JUnit Assumptions</h2>
<p>íŠ¹ì • í™˜ê²½ì¼ ë•Œë§Œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ë„ë¡ í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©</p>

<h3 id="assumetrue--assumefalse">assumeTrue() &amp;&amp; assumeFalse()</h3>
<p>í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µ, ì‹¤íŒ¨ì¼ ë•Œ ê³„ì† ì§„í–‰</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">trueAssumption</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">assumeTrue</span><span class="o">(</span><span class="s">"PRD"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">getenv</span><span class="o">(</span><span class="s">"ENV"</span><span class="o">)));</span>
    <span class="c1">// ê³„ì† ì§„í–‰...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">falseAssumption</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">assumeFalse</span><span class="o">(</span><span class="mi">5</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="o">);</span>
    <span class="c1">// ê³„ì† ì§„í–‰...</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="assumingthat">assumingThat()</h3>
<p>ì²«ë²ˆì§¸ ì¸ì ì„±ê³µì‹œ, ë‘ë²ˆì§¸ ì¸ì ì‹¤í–‰</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">assumptionThat</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">assumingThat</span><span class="o">(</span><span class="s">"CI"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">getenv</span><span class="o">(</span><span class="s">"ENV"</span><span class="o">)),</span>
        <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="c1">// CIì„œë²„ì—ì„œë§Œ ì´ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•œë‹¤.</span>
            <span class="n">assertEquals</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">divide</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="mi">2</span><span class="o">));</span>
        <span class="o">});</span>
    <span class="n">assertEquals</span><span class="o">(</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">7</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br />
<br />
<br /></p>

<h1 id="-junit-import-static">ğŸ“– JUnit import static</h1>
<p>ê¸°ë³¸ import static í•´ë†“ìœ¼ë©´ ì¢‹ì€ ê²ƒë“¤ì„ ì •ë¦¬</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">hamcrest</span><span class="o">.</span><span class="na">Matchers</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.*;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">assertj</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.*;</span>
</code></pre></div></div>
<p><br />
<br /></p>]]></content><author><name>Sangjae Oh</name></author><category term="Java" /><category term="Java" /><category term="JUnit 5" /><category term="AssertJ" /><category term="CheatSheet" /><summary type="html"><![CDATA[JUnit 5, AssertJì˜ ì‚¬ìš©ë²•ì„ ê°„ë‹¨í•˜ê²Œ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤. ğŸ˜ jUnit 5 ê°€ì´ë“œ ë§í¬ AssertJ ê°€ì´ë“œ ë§í¬]]></summary></entry><entry><title type="html">TDD(Test Driven Development) - í…ŒìŠ¤íŠ¸ ì£¼ë„ ê°œë°œ</title><link href="http://localhost:4000/insight/TDD(Test-Driven-Development)-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%A3%BC%EB%8F%84-%EA%B0%9C%EB%B0%9C/" rel="alternate" type="text/html" title="TDD(Test Driven Development) - í…ŒìŠ¤íŠ¸ ì£¼ë„ ê°œë°œ" /><published>2023-02-07T00:00:00+09:00</published><updated>2023-02-07T00:00:00+09:00</updated><id>http://localhost:4000/insight/TDD(Test%20Driven%20Development)-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%A3%BC%EB%8F%84-%EA%B0%9C%EB%B0%9C</id><content type="html" xml:base="http://localhost:4000/insight/TDD(Test-Driven-Development)-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%A3%BC%EB%8F%84-%EA%B0%9C%EB%B0%9C/"><![CDATA[<p><br /></p>

<h1 id="-tddtest-driven-developmentë€">ğŸ¤” TDD(Test Driven Development)ë€?</h1>
<ul>
  <li>TDDë€ Test Driven Developmentì˜ ì•½ìë¡œ í…ŒìŠ¤íŠ¸ ì£¼ë„ ê°œë°œì´ë¼ í•©ë‹ˆë‹¤.</li>
  <li>TDDëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ ë°©ë²•ë¡  ì¤‘ì˜ í•˜ë‚˜ë¡œ <strong>ìë™í™”ëœ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•œ í›„, í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ê¸° ìœ„í•œ ì½”ë“œë¥¼ ê°œì„ í•˜ëŠ” ë°©ì‹ì˜ ê°œë°œ ë°©ì‹</strong>ì„ ë§í•©ë‹ˆë‹¤. <br />
<br />
<br /></li>
</ul>

<h1 id="ï¸ï¸-tdd-ê°œë°œ-ë°©ë²•">â›¹ï¸â€â™€ï¸ TDD ê°œë°œ ë°©ë²•</h1>
<p><img src="/assets/images/posts/insight/tdd/9d2d7f30-25c2-4ef7-ae08-e67eb8cf2bb5.png" alt="TDD lifecycle" /></p>

<ol>
  <li>í…ŒìŠ¤íŠ¸ ì‘ì„±, ê¸°ëŠ¥ì´ ì•„ì§ êµ¬í˜„ë˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨í•œë‹¤.</li>
  <li>í…ŒìŠ¤íŠ¸ë¥¼ ì„±ê³µí•˜ë„ë¡ í”„ë¡œë•ì…˜ ì½”ë“œ ì‘ì„±</li>
  <li>í”„ë¡œë•ì…˜ ì½”ë“œì™€ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ë¦¬íŒ©í† ë§</li>
</ol>

<p>ìœ„ 3ë‹¨ê³„ë¥¼ ë°˜ë³µí•˜ë©°, ë” ê°„ë‹¨í•˜ê³  ê°œì„ ëœ ë””ìì¸ íŒ¨í„´ê³¼ ë†’ì€ í’ˆì§ˆì˜ ì½”ë“œë¥¼ ì‘ì„±í•˜ê²Œ ë©ë‹ˆë‹¤.
<br />
<br /></p>

<h1 id="-tdd-ì›ì¹™">ğŸ¯ TDD ì›ì¹™</h1>
<ol>
  <li>ì‹¤íŒ¨í•˜ëŠ” ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•  ë•Œê¹Œì§€ í”„ë¡œë•ì…˜ ì½”ë“œ(production code)ë¥¼ ì‘ì„±í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
  <li>ì»´íŒŒì¼ì€ ì‹¤íŒ¨í•˜ì§€ ì•Šìœ¼ë©´ì„œ ì‹¤í–‰ì´ ì‹¤íŒ¨í•˜ëŠ” ì •ë„ë¡œë§Œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•œë‹¤.</li>
  <li>í˜„ì¬ ì‹¤íŒ¨í•˜ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•  ì •ë„ë¡œë§Œ ì‹¤ì œ ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤.
<br />
<br /></li>
</ol>

<h1 id="-tddì˜-íš¨ê³¼">ğŸ¯ TDDì˜ íš¨ê³¼</h1>

<ol>
  <li>
    <p><strong>ë¹ ë¥´ê²Œ í”¼ë“œë°± ë°›ì„ ìˆ˜ ìˆë‹¤.</strong><br />
TDDë¥¼ í†µí•´ ì‹œìŠ¤í…œ êµ¬í˜„(<em>â€œì‹œìŠ¤í…œì´ ë™ì‘í•˜ëŠ”ê°€?â€</em>)ê³¼ ì„¤ê³„ì˜ í’ˆì§ˆ(<em>â€œì‹œìŠ¤í…œì´ ì˜ êµ¬ì¡°í™” ë˜ìˆëŠ”ê°€?â€</em>)ì— ê´€í•œ í”¼ë“œë°±ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
  </li>
  <li>
    <p><strong>ë””ë²„ê¹… ì‹œê°„ì„ ë‹¨ì¶• í•  ìˆ˜ ìˆë‹¤.</strong><br />
TDDì˜ ê²½ìš° ìë™í™” ëœ ìœ ë‹›í…ŒìŠ¤íŒ…ì„ ì „ì¬í•˜ë¯€ë¡œ íŠ¹ì • ë²„ê·¸ë¥¼ ì† ì‰½ê²Œ ì°¾ì•„ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
  </li>
  <li>
    <p><strong>ê°ì²´ ì§€í–¥ì ì¸ ì½”ë“œê°€ ëœë‹¤.</strong><br />
TDDë¥¼ ì‚¬ìš©í•˜ë©´ ìì—°ìŠ¤ëŸ½ê²Œ ë‹¨ìˆœí•œ ë‹¨ìœ„ë¡œ ì‘ì—…ì„ ì§„í–‰í•˜ê²Œ ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë‹¤ ë³´ë©´ ê¸°ëŠ¥ë³„ë¡œ ëª¨ë“ˆí™”ê°€ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ì¦‰ ê°•ë ¬í•œ ë””ìì¸ ì‚¬ê³  ë•Œë¬¸ì´ ì•„ë‹ˆë¼ ìƒí˜¸ ì—°ê²°ëœ ë§ì€ ì‘ì€ ëª¨ë“ˆì˜ ìƒí˜¸ ì‘ìš©ìœ¼ë¡œ ë³µì¡í•œ ê¸°ëŠ¥ì„ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ë” ë‚˜ì€ ì½”ë“œë¥¼ ê°–ê²Œ ë©ë‹ˆë‹¤.</p>
  </li>
  <li>
    <p><strong>í”„ë¡œê·¸ë˜ë¨¸ì˜ ì˜¤ë²„ ì—”ì§€ë‹ˆì–´ë§ì„ ë°©ì§€í•œë‹¤.</strong><br />
í”„ë¡œê·¸ë˜ë¨¸ë“¤ì€ ê°„í˜¹ ê³„íší•˜ì§€ ì•Šì•˜ë˜ ì½”ë“œë¥¼ ì¶”ê°€í•˜ì—¬ ì˜¤ë²„ ì—”ì§€ë‹ˆì–´ë§í•˜ëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ TDDì˜ ì›ì¹™ ì¤‘ í•˜ë‚˜ëŠ”, í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ê¸° ìœ„í•œ ìµœì†Œí•œì˜ ì½”ë“œë§Œ ì‘ì„± ë° ê°œì„ í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ê¸°ëŠ¥ ë‹¨ìœ„ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ê¸° ë•Œë¬¸ì—, ë¬¸ì œê°€ ë°œê²¬ë˜ì§€ ì•Šì€ ì½”ë“œì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆëŠ” ì˜¤ë²„ ì½”ë”©ì€ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
  </li>
  <li>
    <p><strong>ë¬¸ì„œì˜ ì—­í• ì„ í•œë‹¤.</strong><br />
TDDë¥¼ ì‚¬ìš©í•˜ë©´, í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê³¼ì •ì—ì„œ íˆìŠ¤í† ë¦¬ê°€ ë‚¨ìŠµë‹ˆë‹¤. TDDë¥¼ í†µí•´ ì‘ì„±í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ íŠ¸ë˜í‚¹í•˜ë©´ì„œ ê³¼ê±°ì— ì–´ë–¤ ì¸ê³¼ê´€ê³„ë¡œ ì˜ì‚¬ê²°ì •ì„ í–ˆëŠ”ì§€ í™•ì¸í•˜ê¸° ì‰½ìŠµë‹ˆë‹¤.</p>
  </li>
  <li>
    <p><strong>ìœ ì§€ë³´ìˆ˜(ë¦¬íŒ©í† ë§)ì´ ìš©ì´í•˜ë‹¤.</strong><br />
TDDì˜ ê²½ìš° ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ê¸°ë°˜ì˜ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ê¸° ë•Œë¬¸ì— ì¶”í›„ ë¬¸ì œê°€ ë°œìƒí•˜ì˜€ì„ ë•Œ ê°ê°ì˜ ëª¨ë“ˆë³„ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ë³´ë©´ ë¬¸ì œì˜ ì§€ì ì„ ì‰½ê²Œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
  </li>
  <li>
    <p><strong>ë³€í™”, ì¶”ê°€ êµ¬í˜„ì´ ìš©ì´í•˜ë‹¤.</strong><br />
ê°œë°œì´ ì™„ë£Œëœ ì†Œí”„íŠ¸ì›¨ì–´ì— ì–´ë–¤ ê¸°ëŠ¥ì„ ì¶”ê°€í•  ë•Œ ê°€ì¥ ìš°ë ¤ë˜ëŠ” ì ì€ í•´ë‹¹ ê¸°ëŠ¥ì´ ê¸°ì¡´ ì½”ë“œì— ì–´ë–¤ ì˜í–¥ì„ ë¯¸ì¹ ì§€ ì•Œì§€ ëª»í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. í•˜ì§€ë§Œ TDDì˜ ê²½ìš° ìë™í™”ëœ ìœ ë‹› í…ŒìŠ¤íŒ…ì„ ì „ì œí•˜ë¯€ë¡œ í…ŒìŠ¤íŠ¸ ê¸°ê°„ì„ íšê¸°ì ìœ¼ë¡œ ë‹¨ì¶•ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
<br />
<br /></p>
  </li>
</ol>

<h1 id="-tddì˜-í•œê³„">ğŸ˜“ TDDì˜ í•œê³„</h1>
<p>ì´ë¡ ì ìœ¼ë¡œ, ê·¸ë¦¬ê³  ì‹¤ì œë¡œ ë§ì€ ê²½ìš°ì— TDDëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œì— ë§ì€ ì¥ì ì´ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ëŒ€ë¶€ë¶„ì€ ì´ìƒì ì¸ TDD í™˜ê²½ì´ ì•„ë‹ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<ol>
  <li>
    <p><strong>ë ˆê±°ì‹œ ì½”ë“œ</strong><br />
ì½”ë“œê°€ ì´ë¯¸ ì‘ì„±ë˜ì—ˆê¸° ë•Œë¬¸ì— TDDëŠ” ë ˆê±°ì‹œ ì½”ë“œì— ì ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
  </li>
  <li>
    <p><strong>ìƒì‚°ì„±ì˜ ì €í•˜</strong><br />
ì¥ê¸°ì ìœ¼ë¡œ ë³´ë©´ ìƒì‚°ì„±ì´ ì¦ê°€í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ëŠ” <strong>â€œê¸‰í•˜ì§€ ì•Šì€ í™˜ê²½â€</strong>ì—ì„œì˜ ê²½ìš°ì…ë‹ˆë‹¤. ë‚©ê¸°ì¸ ì¤€ìˆ˜ê°€ ì¤‘ìš”í•œ SIí”„ë¡œì íŠ¸ ê°™ì€ ê²½ìš° ì´ëŸ¬í•œ ì¡°ê±´ê³¼ ëª¨ìˆœë©ë‹ˆë‹¤.</p>
  </li>
  <li>
    <p><strong>ë¶ˆì™„ì „í•œ í…ŒìŠ¤íŠ¸ ì‚¬ë¡€</strong><br />
í”„ë¡œê·¸ë˜ë¨¸ê°€ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ëˆ„ë½í•œë‹¤ë©´, TDDëŠ” ì‚¬ìš©ìë¥¼ ë³´í˜¸í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br />
<br />
<br /></p>
  </li>
</ol>

<h1 id="-tdd-í•„ìš”í•œê°€">ğŸ¤” TDD í•„ìš”í•œê°€?</h1>
<p>ì ì  ë” ë§ì€ ê°œë°œìë“¤ì´ TDDë¡œ ì „í™˜í•˜ê³  ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì¼ë¶€ëŠ” TDDê°€ ì‹¤ì œ ì½”ë”© ëŒ€ì‹  í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•˜ëŠ” ë° ì‹œê°„ì„ ì†Œë¹„í•˜ëŠ” ë¹„ìš©ì´ ìˆë‹¤ê³  ì£¼ì¥í•©ë‹ˆë‹¤.</p>

<p>í”„ë¡œí† íƒ€ì…ì„ ë¹ ë¥´ê²Œ ì½”ë”©í•˜ê³  ë¹ ë¥´ê²Œ ì œí’ˆì„ ë§Œë“¤ì–´ì•¼ í•˜ëŠ” ìŠ¤íƒ€íŠ¸ì—… ê°œë°œìì™€ ê°™ì´ ì‹œê°„ì´ ì œí•œëœ ê°œë°œìì—ê²ŒëŠ” ì´ëŸ¬í•œ ì‹œê°„ ì†Œë¹„ê°€ ì¹˜ëª…ì ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ê´€ë¦¬ìì™€ ê³ ê°ì˜ TDDì˜ ì¥ì ì— ëŒ€í•œ ì´í•´ ë¶€ì¡±, ê°œë°œì êµìœ¡ì˜ íˆ¬ì ë¹„ìš©ì€ TDDë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê²Œ í•©ë‹ˆë‹¤.</p>

<p>í•˜ì§€ë§Œ ë¦¬ì†ŒìŠ¤ë¥¼ ë³´ìœ í•˜ê³  ìˆìœ¼ë©° ì½”ë“œ í’ˆì§ˆì´ ê°€ì¥ ì¤‘ìš”í•œ ê¸°ì—…ì€ TDDë¡œ ì „í™˜ì„ í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.
<br />
<br /></p>]]></content><author><name>Sangjae Oh</name></author><category term="Insight" /><category term="Insight" /><category term="TDD" /><summary type="html"><![CDATA[]]></summary></entry><entry><title type="html">ğŸ“– ìë°” ORM í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë°</title><link href="http://localhost:4000/books/%EC%9E%90%EB%B0%94-ORM-%ED%91%9C%EC%A4%80-JPA-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/" rel="alternate" type="text/html" title="ğŸ“– ìë°” ORM í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë°" /><published>2023-01-16T00:00:00+09:00</published><updated>2023-01-16T00:00:00+09:00</updated><id>http://localhost:4000/books/%EC%9E%90%EB%B0%94-ORM-%ED%91%9C%EC%A4%80-JPA-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D</id><content type="html" xml:base="http://localhost:4000/books/%EC%9E%90%EB%B0%94-ORM-%ED%91%9C%EC%A4%80-JPA-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/"><![CDATA[<p><a href="https://product.kyobobook.co.kr/detail/S000000935744" target="_blank">ìë°” ORM í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë°</a> ì±…ì„ ì½ê³  ë‚´ìš©ì„ ì•„ì£¼ ê°„ë‹¨í•˜ê²Œ ì •ë¦¬í•œ ê¸€ì…ë‹ˆë‹¤. ì±…ì—ëŠ” ìì„¸í•œ ì„¤ëª…ê³¼ ì˜ˆì œê°€ ë§ìœ¼ë‹ˆ <strong>ê¼­ êµ¬ì…í•´ì„œ ì½ëŠ”ê²ƒì„ ì¶”ì²œ</strong>í•©ë‹ˆë‹¤~ğŸ‘</p>

<hr />

<h1 id="1-jpa-ì†Œê°œ">1. JPA ì†Œê°œ</h1>
<h2 id="11-sqlì„-ì§ì ‘-ë‹¤ë£°-ë•Œ-ë°œìƒí•˜ëŠ”-ë¬¸ì œì ">1.1 SQLì„ ì§ì ‘ ë‹¤ë£° ë•Œ ë°œìƒí•˜ëŠ” ë¬¸ì œì </h2>
<ul>
  <li>ìë°”ë¡œ ê°œë°œí•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ëŒ€ë¶€ë¶„ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë°ì´í„° ì €ì¥ì†Œë¡œ ì‚¬ìš©í•œë‹¤.</li>
  <li>JDBC APIë¥¼ ì‚¬ìš©í•´ SQLì„ ì „ë‹¬í•œë‹¤.</li>
</ul>

<h3 id="111-ë°˜ë³µ-ë°˜ë³µ-ê·¸ë¦¬ê³ -ë°˜ë³µ">1.1.1 ë°˜ë³µ, ë°˜ë³µ ê·¸ë¦¬ê³  ë°˜ë³µ</h3>
<p>ê°ì²´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— CURD í•˜ë ¤ë©´ ë„ˆë¬´ë§ì€ SQLê³¼ JDBC APIë¥¼ ì½”ë“œë¡œ ì‘ì„±í•´ì•¼ í•œë‹¤. í…Œì´ë¸”ì´ ì—¬ëŸ¬ê°œë¼ë©´ ë¬´ìˆ˜íˆ ë§ì€ SQLì„ ì‘ì„±í•´ì•¼ í•œë‹¤.</p>

<h3 id="112-sqlì—-ì˜ì¡´ì ì¸-ê°œë°œ">1.1.2 SQLì— ì˜ì¡´ì ì¸ ê°œë°œ</h3>
<p>ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ SQLì„ ì§ì ‘ ë‹¤ë£° ë•Œ ë°œìƒí•˜ëŠ” ë¬¸ì œì </p>
<ul>
  <li>ì§„ì •í•œ ì˜ë¯¸ì˜ ê³„ì¸µ ë¶„í• ì´ ì–´ë µë‹¤.</li>
  <li>ì—”í‹°í‹°ë¥¼ ì‹ ë¢°í•  ìˆ˜ ì—†ë‹¤.</li>
  <li>SQLì— ì˜ì¡´ì ì¸ ê°œë°œì„ í”¼í•˜ê¸° ì–´ë µë‹¤.</li>
</ul>

<h3 id="113-jpaì™€-ë¬¸ì œ-í•´ê²°">1.1.3 JPAì™€ ë¬¸ì œ í•´ê²°</h3>
<p>JPAë¥¼ ì‚¬ìš©í•˜ë©´ ê°ì²´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ê³  ê´€ë¦¬í•  ë•Œ, ê°œë°œìê°€ ì§ì ‘ SQLì„ ì‘ì„±í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ JPAê°€ ì œê³µí•˜ëŠ” APIë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì €ì¥</span>
<span class="n">jpa</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>

<span class="c1">// ì¡°íšŒ</span>
<span class="nc">String</span> <span class="n">memberId</span> <span class="o">=</span> <span class="s">"helloId"</span>
<span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">jpa</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">memberId</span><span class="o">);</span>

<span class="c1">// ìˆ˜ì •</span>
<span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">jpa</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">memberId</span><span class="o">);</span>
<span class="n">member</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">"ì´ë¦„ë³€ê²½"</span><span class="o">);</span> <span class="c1">// jpaëŠ” update ë©”ì†Œë“œê°€ ë”°ë¡œ ì—†ë‹¤.</span>

<span class="c1">// ì—°ê´€ëœ ê°ì²´ ì¡°íšŒ</span>
<span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">jpa</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">memberId</span><span class="o">);</span>
<span class="nc">Team</span> <span class="n">team</span> <span class="o">=</span> <span class="n">member</span><span class="o">.</span><span class="na">getTeam</span><span class="o">();</span>
</code></pre></div></div>

<h2 id="12-íŒ¨ëŸ¬ë‹¤ì„-ë¶ˆì¼ì¹˜">1.2 íŒ¨ëŸ¬ë‹¤ì„ ë¶ˆì¼ì¹˜</h2>
<ul>
  <li>ê°ì²´ì™€ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ëŠ” ì§€í–¥í•˜ëŠ” ëª©ì ì´ ì„œë¡œ ë‹¤ë¥´ë‹¤.</li>
  <li>ê¸°ëŠ¥ê³¼ í‘œí˜„ ë°©ë²•ë„ ë‹¤ë¥´ë‹¤.</li>
  <li>ê°ì²´ êµ¬ì¡°ë¥¼ í…Œì´ë¸” êµ¬ì¡°ì— ì €ì¥í•˜ëŠ” ë°ëŠ” í•œê³„ê°€ ìˆë‹¤.</li>
</ul>

<h3 id="121-ìƒì†">1.2.1 ìƒì†</h3>
<p>ê°ì²´ëŠ” ìƒì†ì´ë¼ëŠ” ê¸°ëŠ¥ì„ ê°€ì§€ê³  ìˆì§€ë§Œ í…Œì´ë¸”ì€ ìƒì†ì´ë¼ëŠ” ê¸°ëŠ¥ì´ ì—†ë‹¤.(ì¼ë¶€ ë°ì´í„°ë² ì´ìŠ¤ëŠ” ìƒì† ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ë§Œ ê°ì²´ì˜ ìƒì†ê³¼ëŠ” ì•½ê°„ ë‹¤ë¥´ë‹¤.)</p>

<center><img src="/assets/images/posts/books/2/1_2_ê°ì²´ìƒì†ëª¨ë¸.png" alt="ê°ì²´ìƒì†ëª¨ë¸" width="90%" height="90%" /></center>

<p><br /></p>

<p>ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ë§ì—ì„œëŠ” ìŠˆí¼íƒ€ì… ì„œë¸Œíƒ€ì… ê´€ê³„ë¥¼ ì‚¬ìš©í•˜ë©´ ìœ ì‚¬í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.</p>

<center><img src="/assets/images/posts/books/2/1_2_í…Œì´ë¸”ëª¨ë¸.png" alt="í…Œì´ë¸”ëª¨ë¸" width="90%" height="90%" /></center>

<p><br /></p>

<p>ìœ„ì˜ êµ¬ì¡°ë¥¼ JDBC APIë¥¼ ì‚¬ìš©í•´ì„œ êµ¬í˜„í•˜ë ¤ë©´ ì‘ì„±í•´ì•¼ í•  ì½”ë“œëŸ‰ì´ ë§Œë§Œì¹˜ ì•Šë‹¤.</p>
<ul>
  <li>INSERT INTO ITEMâ€¦</li>
  <li>INSERT INTO ALBUMâ€¦</li>
</ul>

<p><br /></p>

<p><strong>JPAì™€ ìƒì†</strong><br />
JPAëŠ” ìƒì†ê³¼ ê´€ë ¨ëœ íŒ¨ëŸ¬ë‹¤ì„ ë¶ˆì¼ì¹˜ ë¬¸ì œë¥¼ ê°œë°œì ëŒ€ì‹  í•´ê²°í•´ ì¤€ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì €ì¥</span>
<span class="n">jpa</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">album</span><span class="o">);</span>

<span class="c1">// JPAì—ì„œ ì‹¤í–‰ í•´ì£¼ëŠ” SQL</span>
<span class="no">INSERT</span> <span class="no">INTO</span> <span class="no">ITEM</span><span class="o">...</span>
<span class="no">INSERT</span> <span class="no">INTO</span> <span class="no">ALBUM</span><span class="o">...</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="122-ì—°ê´€ê´€ê³„">1.2.2 ì—°ê´€ê´€ê³„</h3>
<ul>
  <li><strong>ê°ì²´ëŠ” ì°¸ì¡°ë¥¼ ì‚¬ìš©í•´ ë‹¤ë¥¸ ê°ì²´ì™€ ì—°ê´€ê´€ê³„</strong>ë¥¼ ê°€ì§„ë‹¤. ì°¸ì¡°ì— ì ‘ê·¼í•´ì„œ ì—°ê´€ëœ ê°ì²´ë¥¼ ì¡°íšŒí•œë‹¤.</li>
  <li><strong>í…Œì´ë¸”ì€ ì™¸ë˜ í‚¤ë¥¼ ì‚¬ìš©í•´ ë‹¤ë¥¸ í…Œì´ë¸”ê³¼ ì—°ê´€ê´€ê³„</strong>ë¥¼ ê°€ì§„ë‹¤. ì¡°ì¸ì„ ì‚¬ìš©í•´ì„œ ì—°ê´€ëœ í…Œì´ë¸”ì„ ì¡°íšŒí•œë‹¤.</li>
  <li><strong>ê°ì²´ëŠ” ì°¸ì¡°ê°€ ìˆëŠ” ë°©í–¥ìœ¼ë¡œë§Œ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.</strong></li>
</ul>
<center><img src="/assets/images/posts/books/2/1_2_ì—°ê´€ê´€ê³„.png" alt="ì—°ê´€ê´€ê³„" width="90%" height="90%" /></center>

<p><br /></p>

<p><strong>ê°ì²´ë¥¼ í…Œì´ë¸”ì— ë§ì¶”ì–´ ëª¨ë¸ë§</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ê°€ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì— ë§ì¶”ë©´ ê°ì²´ ì°¸ì¡°ë¥¼ í†µí•´ ì¡°íšŒí•  ìˆ˜ ì—†ë‹¤.</span>
<span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>   <span class="c1">// MEMBER_ID ì»¬ëŸ¼ ì‚¬ìš©</span>
    <span class="nc">Long</span> <span class="n">teamId</span><span class="o">;</span> <span class="c1">// TEAM_ID FK ì»¬ëŸ¼ ì‚¬ìš©</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<p><strong>ê°ì²´ì§€í–¥ ëª¨ë¸ë§</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// íŒ¨ëŸ¬ë‹¤ì„ ë¶ˆì¼ì¹˜ë¥¼ í•´ê²°í•˜ë ¤ê³  ì†Œëª¨í•˜ëŠ” ì½”ë“œê°€ ë§ë‹¤.</span>
<span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>   <span class="c1">// MEMBER_ID ì»¬ëŸ¼ ì‚¬ìš©</span>
    <span class="nc">Team</span> <span class="n">team</span><span class="o">;</span> <span class="c1">// ì°¸ì¡°ë¡œ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.</span>
<span class="o">}</span>

<span class="c1">// ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥</span>
<span class="n">member</span><span class="o">.</span><span class="na">getId</span><span class="o">();</span>
<span class="n">member</span><span class="o">.</span><span class="na">getTeam</span><span class="o">.</span><span class="na">getId</span><span class="o">();</span> <span class="c1">// TEAM_ID FKë¥¼ ì§ì ‘ êµ¬í•´ì•¼ í•¨</span>
<span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>

<span class="c1">// ì¡°íšŒ</span>
<span class="no">SQL</span> <span class="n">ì‹¤í–‰</span>
<span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span> <span class="o">();</span>
<span class="nc">Team</span> <span class="n">team</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Team</span><span class="o">();</span>
<span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="n">member</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="n">team</span><span class="o">);</span> <span class="c1">// ì§ì ‘ íšŒì›ê³¼ íŒ€ ê´€ê³„ ì„¤ì •</span>
</code></pre></div></div>

<p><br /></p>

<p><strong>JPAì™€ ì—°ê´€ê´€ê³„</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// JPAëŠ” ì—°ê´€ê´€ê³„ì™€ ê´€ë ¨ëœ íŒ¨ëŸ¬ë‹¤ì„ ë¶ˆì¼ì¹˜ ë¬¸ì œë¥¼ í•´ê²°í•´ì¤€ë‹¤.</span>

<span class="c1">// ì €ì¥</span>
<span class="n">member</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="n">team</span><span class="o">);</span>
<span class="n">jpa</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member</span><span class="o">);</span> <span class="c1">// TEAM_ID FKë¥¼ ì§ì ‘ ì§€ì •í•  í•„ìš” ì—†ìŒ</span>

<span class="c1">// ì¡°íšŒ</span>
<span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">jpa</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">memberId</span><span class="o">);</span>
<span class="nc">Team</span> <span class="n">team</span> <span class="o">=</span> <span class="n">member</span><span class="o">.</span><span class="na">getTeam</span><span class="o">();</span> <span class="c1">// ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="123-ê°ì²´-ê·¸ë˜í”„-íƒìƒ‰">1.2.3 ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰</h3>
<p>ê°ì²´ì—ì„œ íšŒì›ì— ì†Œì†ëœ íŒ€ì„ ì¡°íšŒí•  ë•ŒëŠ” ë‹¤ìŒì²˜ëŸ¼ ì°¸ì¡°ë¥¼ ì‚¬ìš©í•´ì„œ ì—°ê´€ëœ íŒ€ì„ ì°¾ìœ¼ë©´ ë˜ëŠ”ë°, ì´ê²ƒì„ ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰ì´ë¼ í•œë‹¤.</p>

<center><img src="/assets/images/posts/books/2/1_2_ê°ì²´ê·¸ë˜í”„íƒìƒ‰.png" alt="ê°ì²´ê·¸ë˜í”„íƒìƒ‰" width="90%" height="90%" /></center>

<p><br /></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰</span>
<span class="n">member</span><span class="o">.</span><span class="na">getOrder</span><span class="o">().</span><span class="na">getOrderItem</span><span class="o">()...</span>

<span class="c1">// ë¬¸ì œ ë°œìƒ</span>
<span class="n">member</span><span class="o">.</span><span class="na">getOrder</span><span class="o">();</span> <span class="c1">// ë§Œì•½ nullì´ë¼ë©´?</span>
</code></pre></div></div>

<p><strong>SQLì„ ì§ì ‘ ë‹¤ë£¨ë©´ ì²˜ìŒ ì‹¤í–‰í•˜ëŠ” SQLì— ë”°ë¼ ê°ì²´ ê·¸ë˜í”„ë¥¼ ì–´ë””ê¹Œì§€ íƒìƒ‰í•  ìˆ˜ ìˆëŠ”ì§€ ì •í•´ì§„ë‹¤.</strong> ì´ëŠ” ê°ì²´ ê·¸ë˜í”„ê°€ ì–¸ì œ ëŠì–´ì§ˆì§€ ëª¨ë¥´ê¸° ë•Œë¬¸ì— í•¨ë¶€ë¡œ íƒìƒ‰í•  ìˆ˜ ì—†ë‹¤.</p>

<p><strong>JPAì™€ ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰</strong><br />
JPAëŠ” ì—°ê´€ëœ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ëŠ” ì‹œì ì— ì ì ˆí•œ SELECT SQLì„ ì‹¤í–‰í•œë‹¤(<strong>ì§€ì—°ë¡œë”©</strong>). ë”°ë¼ì„œ JPAë¥¼ ì‚¬ìš©í•˜ë©´ ì—°ê´€ëœ ê°ì²´ë¥¼ ì‹ ë¢°í•˜ê³  ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.</p>

<h3 id="124-ë¹„êµ">1.2.4 ë¹„êµ</h3>
<ul>
  <li>ë°ì´í„°ë² ì´ìŠ¤ëŠ” ê¸°ë³¸ í‚¤ì˜ ê°’ìœ¼ë¡œ ê° rowë¥¼ êµ¬ë¶„</li>
  <li>ê°ì²´ëŠ” ë™ì¼ì„±, ë™ë“±ì„± ë¹„êµ.
    <ul>
      <li>ë™ì¼ì„±ì€ == ë¹„êµ. ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ì˜ ì£¼ì†Œ ê°’ì„ ë¹„êµí•œë‹¤.</li>
      <li>ë™ë“±ì„±ì€ equals() ë¹„êµ. ê°ì²´ ë‚´ë¶€ì˜ ê°’ì„ ë¹„êµí•œë‹¤.</li>
    </ul>
  </li>
</ul>

<p><strong>JDBC API ë¹„êµ</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">memberId</span> <span class="o">=</span> <span class="s">"100"</span><span class="o">;</span>
<span class="nc">Member</span> <span class="n">member1</span> <span class="o">=</span> <span class="n">memberDAO</span><span class="o">.</span><span class="na">getMember</span><span class="o">(</span><span class="n">memberID</span><span class="o">);</span>
<span class="nc">Member</span> <span class="n">member2</span> <span class="o">=</span> <span class="n">memberDAO</span><span class="o">.</span><span class="na">getMember</span><span class="o">(</span><span class="n">memberID</span><span class="o">);</span>

<span class="c1">// false</span>
<span class="n">member1</span> <span class="o">==</span> <span class="n">member2</span><span class="o">;</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>JPA ë¹„êµ</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">memberId</span> <span class="o">=</span> <span class="s">"100"</span><span class="o">;</span>
<span class="nc">Member</span> <span class="n">member1</span> <span class="o">=</span> <span class="n">jpa</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="n">memberID</span><span class="o">);</span>
<span class="nc">Member</span> <span class="n">member2</span> <span class="o">=</span> <span class="n">jpa</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="n">memberID</span><span class="o">);</span>

<span class="c1">// true</span>
<span class="n">member1</span> <span class="o">==</span> <span class="n">member2</span><span class="o">;</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="125-ì •ë¦¬">1.2.5 ì •ë¦¬</h3>
<ul>
  <li><strong>ê°ì²´ ëª¨ë¸ê³¼ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ì€ ì§€í–¥í•˜ëŠ” íŒ¨ëŸ¬ë‹¤ì„ì´ ì„œë¡œ ë‹¤ë¥´ë‹¤.</strong></li>
  <li>ì´ íŒ¨ëŸ¬ë‹¤ì„ ì°¨ì´ë¥¼ ê·¹ë³µí•˜ë ¤ê³  ê°œë°œìê°€ ë„ˆë¬´ ë§ì€ ì‹œê°„ê³¼ ì½”ë“œë¥¼ ì†Œë¹„í•œë‹¤.</li>
  <li>ê²°êµ­, ê°ì²´ ëª¨ë¸ë§ì€ í˜ì„ ìƒê³  ì ì  ë°ì´í„° ì¤‘ì‹¬ì˜ ëª¨ë¸ë¡œ ë³€í•´ê°„ë‹¤.</li>
  <li><strong>JPAëŠ” íŒ¨ëŸ¬ë‹¤ì„ ë¶ˆì¼ì¹˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³ , ì •êµí•œ ê°ì²´ ëª¨ë¸ë§ì„ ìœ ì§€í•˜ê²Œ ë„ì™€ì¤€ë‹¤.</strong></li>
</ul>

<p><br />
<br /></p>

<h2 id="13-jpaë€-ë¬´ì—‡ì¸ê°€">1.3 JPAë€ ë¬´ì—‡ì¸ê°€?</h2>
<p><strong>JPAë€?</strong></p>
<ul>
  <li>JPA(java persistence API)ëŠ” ìë°”ì§„ì˜ ORM ê¸°ìˆ  í‘œì¤€ì´ë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ JDBC ì‚¬ì´ì—ì„œ ë™ì‘í•œë‹¤.</li>
</ul>
<center><img src="/assets/images/posts/books/2/1_3_JPA.png" alt="JPA" width="90%" height="90%" /></center>
<p><br />
<br /></p>

<p><strong>ORMì´ë€?</strong></p>
<ul>
  <li>ORM(Object-Relational Mapping)ì€ <strong>ê°ì²´ì™€ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë§¤í•‘í•œë‹¤ëŠ” ëœ»</strong>ì´ë‹¤.</li>
  <li>ë‹¤ì–‘í•œ ORM í”„ë ˆì„ì›Œí¬ë“¤ì´ ìˆëŠ”ë° ìë°” ì§„ì˜ì—ì„œëŠ” <strong>í•˜ì´ë²„ë„¤ì´íŠ¸ í”„ë ˆì„ì›Œí¬ê°€ ê°€ì¥ ë§ì´ ì‚¬ìš©</strong>ëœë‹¤.</li>
</ul>

<center><img src="/assets/images/posts/books/2/1_3_JPAì¡°íšŒ.png" alt="JPAì¡°íšŒ" width="80%" height="80%" /></center>
<p><br />
<br />
<br /></p>

<h3 id="131-jpa-ì†Œê°œ">1.3.1 JPA ì†Œê°œ</h3>
<center><img src="/assets/images/posts/books/2/1_3_JPAí‘œì¤€ì¸í„°í˜ì´ìŠ¤ì™€êµ¬í˜„ì²´.png" alt="JPAí‘œì¤€ì¸í„°í˜ì´ìŠ¤ì™€êµ¬í˜„ì²´" width="80%" height="80%" /></center>
<p><br /></p>

<ul>
  <li><strong>JPAëŠ” ìë°” ORM ê¸°ìˆ ì— ëŒ€í•œ API í‘œì¤€ ëª…ì„¸ë‹¤.</strong></li>
  <li>ì‰½ê²Œ ì´ì•¼ê¸°í•´ì„œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ëª¨ì•„ë‘” ê²ƒì´ë‹¤.</li>
  <li>ë”°ë¼ì„œ JPAë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ JPAë¥¼ êµ¬í˜„í•œ ORM í”„ë ˆì„ì›Œí¬ë¥¼ ì„ íƒí•´ì•¼ í•œë‹¤.</li>
  <li>ORM í”„ë ˆì„ì›Œí¬ ì¤‘ <strong>í•˜ì´ë²„ë„¤ì´íŠ¸ê°€ ê°€ì¥ ëŒ€ì¤‘ì </strong>ì´ë‹¤.<br />
<br />
<br /></li>
</ul>

<h3 id="132-ì™œ-jpaë¥¼-ì‚¬ìš©í•´ì•¼-í•˜ëŠ”ê°€">1.3.2 ì™œ JPAë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ê°€?</h3>
<ul>
  <li>ìƒì‚°ì„±</li>
  <li>ìœ ì§€ë³´ìˆ˜</li>
  <li>íŒ¨ëŸ¬ë‹¤ì„ ë¶ˆì¼ì¹˜ í•´ê²°</li>
  <li>ì„±ëŠ¥ (ìºì‹œ)</li>
  <li>ë°ì´í„° ì ‘ê·¼ ì¶”ìƒí™”ì™€ ë²¤ë” ë…ë¦½ì„±
    <ul>
      <li>ë°ì´í„°ë² ì´ìŠ¤ë§ˆë‹¤ ì‚¬ìš©ë²•ì´ ë‹¤ë¥´ë‹¤ (ì˜ˆ: í˜ì´ì§• ì¿¼ë¦¬)</li>
      <li>JPAì—ê²Œ ë°ì´í„°ë² ì´ìŠ¤ë§Œ ì•Œë ¤ì£¼ë©´ ìë™ìœ¼ë¡œ í•´ê²°ëœë‹¤</li>
    </ul>
  </li>
  <li>í‘œì¤€
    <ul>
      <li>ìë°” ì§„ì˜ ORM ê¸°ìˆ  í‘œì¤€</li>
      <li>í‘œì¤€ì„ ì‚¬ìš©í•˜ë©´ ë‹¤ë¥¸ êµ¬í˜„ ê¸°ìˆ ë¡œ ì†ì‰½ê²Œ ë³€ê²½ ê°€ëŠ¥</li>
    </ul>
  </li>
</ul>

<center><img src="/assets/images/posts/books/2/1_3_ë²¤ë”ë…ë¦½ì„±.png" alt="ë²¤ë”ë…ë¦½ì„±" width="80%" height="80%" /></center>
<p><br />
<br /></p>

<h2 id="14-ì •ë¦¬">1.4 ì •ë¦¬</h2>
<ul>
  <li>SQLì„ ì§ì ‘ ë‹¤ë£° ë•Œ ë°œìƒí•˜ëŠ” ë‹¤ì–‘í•œ ë¬¸ì œ</li>
  <li>ê°ì²´ì§€í–¥ ì–¸ì–´ì™€ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ì´ì˜ íŒ¨ëŸ¬ë‹¤ì„ ë¶ˆì¼ì¹˜ ë¬¸ì œ</li>
  <li>JPAê°€ ê° ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í•˜ëŠ”ì§€</li>
  <li>JPAê°€ ë¬´ì—‡ì¸ì§€</li>
  <li>JPA ì¥ì <br />
<br />
<br />
<br /></li>
</ul>

<h1 id="2-jpa-ì‹œì‘">2. JPA ì‹œì‘</h1>
<h2 id="21-ì´í´ë¦½ìŠ¤-ì„¤ì¹˜ì™€-í”„ë¡œì íŠ¸-ë¶ˆëŸ¬ì˜¤ê¸°">2.1 ì´í´ë¦½ìŠ¤ ì„¤ì¹˜ì™€ í”„ë¡œì íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸°</h2>
<h2 id="22-h2-ë°ì´í„°ë² ì´ìŠ¤-ì„¤ì¹˜">2.2 H2 ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì¹˜</h2>
<h2 id="23-ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€-í”„ë¡œì íŠ¸-êµ¬ì¡°">2.3 ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ í”„ë¡œì íŠ¸ êµ¬ì¡°</h2>
<h2 id="24-ê°ì²´-ë§¤í•‘-ì‹œì‘">2.4 ê°ì²´ ë§¤í•‘ ì‹œì‘</h2>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ê°ì²´ ë§¤í•‘ ì˜ˆ</span>
<span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"MEMBER"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"NAME"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">Integer</span> <span class="n">age</span><span class="o">;</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th><strong>ì–´ë…¸í…Œì´ì…˜</strong></th>
      <th><strong>ì„¤ëª…</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>@Entity</td>
      <td>ì´ í´ë˜ìŠ¤ë¥¼ í…Œì´ë¸”ê³¼ ë§¤í•‘í•œë‹¤ê³  JPAì—ê²Œ ì•Œë ¤ì¤€ë‹¤. @Entityê°€ ì‚¬ìš©ëœ í´ë˜ìŠ¤ë¥¼ ì—”í‹°í‹° í´ë˜ìŠ¤ë¼ í•œë‹¤.</td>
    </tr>
    <tr>
      <td>@Table</td>
      <td>ì—”í‹°í‹° í´ë˜ìŠ¤ì— ë§¤í•‘í•  í…Œì´ë¸” ì •ë³´ë¥¼ ì•Œë ¤ì¤€ë‹¤. ì´ ì–´ë…¸í…Œì´ì…˜ì„ ìƒëµí•˜ë©´ í´ë˜ìŠ¤ ì´ë¦„ì„ í…Œì´ë¸” ì´ë¦„ìœ¼ë¡œ ë§¤í•‘í•œë‹¤. (ì •í™•íˆëŠ” ì—”í‹°í‹° ì´ë¦„ì„ ì‚¬ìš©í•¨)</td>
    </tr>
    <tr>
      <td>@Id</td>
      <td>ì—”í‹°í‹° í´ë˜ìŠ¤ì˜ í•„ë“œë¥¼ í…Œì´ë¸” ê¸°ë³¸í‚¤(primary key)ì— ë§¤í•‘í•œë‹¤. @Idê°€ ì‚¬ìš©ëœ í•„ë“œë¥¼ ì‹ë³„ì í•„ë“œë¼ í•œë‹¤.</td>
    </tr>
    <tr>
      <td>@Column</td>
      <td>í•„ë“œë¥¼ ì»¬ëŸ¼ì— ë§¤í•‘í•œë‹¤.</td>
    </tr>
    <tr>
      <td>ë§¤í•‘ ì •ë³´ê°€ ì—†ëŠ” í•„ë“œ</td>
      <td>í•„ë“œëª…ì„ ì‚¬ìš©í•´ì„œ ì»¬ëŸ¼ëª…ìœ¼ë¡œ ë§¤í•‘í•œë‹¤. ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë¶„í•˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ @Column(name=â€AGEâ€)ì²˜ëŸ¼ ëª…ì‹œì ìœ¼ë¡œ ë§¤í•‘í•´ì•¼ í•œë‹¤.</td>
    </tr>
  </tbody>
</table>

<p><br />
<br /></p>

<h2 id="25-ê°ì²´-ë§¤í•‘-ì‹œì‘">2.5 ê°ì²´ ë§¤í•‘ ì‹œì‘</h2>
<h3 id="251-ë°ì´í„°ë² ì´ìŠ¤-ë°©ì–¸">2.5.1 ë°ì´í„°ë² ì´ìŠ¤ ë°©ì–¸</h3>
<p>ë°ì´í„°ë² ì´ìŠ¤ë§ˆë‹¤ SQL ë¬¸ë²•ê³¼ í•¨ìˆ˜ê°€ ì¡°ê¸ˆì”© ë‹¤ë¥´ë‹¤ëŠ” ë¬¸ì œì ì´ ìˆë‹¤.</p>
<ul>
  <li>ë°ì´í„° íƒ€ì…: ê°€ë³€ ë¬¸ì íƒ€ì…ìœ¼ë¡œ MySQLì€ VARCHAR, ì˜¤ë¼í´ì€ VARCHAR2 ì‚¬ìš©</li>
  <li>ë‹¤ë¥¸ í•¨ìˆ˜ëª…: ë¬¸ìì—´ì„ ìë¥´ëŠ” í•¨ìˆ˜ë¡œ SQL í‘œì¤€ì€ SUBSTRING(), ì˜¤ë¼í´ì€ SUBSTR()</li>
  <li>í˜ì´ì§• ì²˜ë¦¬: MySQLì€ LIMIT, ì˜¤ë¼í´ì€ ROWNUM</li>
</ul>

<p><strong>ë°ì´í„°ë² ì´ìŠ¤ë§Œì˜ ê³ ìœ í•œ ê¸°ëŠ¥ì„ JPAì—ì„œëŠ” ë°©ì–¸(Dialect)ì´ë¼ í•œë‹¤.</strong> í•˜ì´ë²„ë„¤ì´íŠ¸ë¥¼ í¬í•¨í•œ ëŒ€ë¶€ë¶„ì˜ JPA êµ¬í˜„ì²´ë“¤ì€ ìœ„ì™€ ê°™ì€ ë¬¸ì œì ì„ í•´ê²°í•˜ë ¤ê³  ë‹¤ì–‘í•œ ë°ì´í„°ë² ì´ìŠ¤ ë°©ì–¸ í´ë˜ìŠ¤ë¥¼ ì œê³µí•œë‹¤. <strong>ë°©ì–¸ë§Œ êµì²´í•˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ì— ë§ëŠ” SQLì´ ì•Œì•„ì„œ ì‹¤í–‰ëœë‹¤.</strong></p>

<center><img src="/assets/images/posts/books/2/2_5_ë°©ì–¸.png" alt="ë°©ì–¸" width="80%" height="80%" /></center>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- í•„ìˆ˜ ì†ì„± --&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"javax.persistence.jdbc.driver"</span> <span class="na">value=</span><span class="s">"org.h2.Driver"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"javax.persistence.jdbc.user"</span> <span class="na">value=</span><span class="s">"sa"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"javax.persistence.jdbc.password"</span> <span class="na">value=</span><span class="s">""</span><span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"javax.persistence.jdbc.url"</span> <span class="na">value=</span><span class="s">"jdbc:h2:tcp://localhost/~/test"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"hibernate.dialect"</span> <span class="na">value=</span><span class="s">"org.hibernate.dialect.H2Dialect"</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- ë°©ì–¸ ì„¤ì • --&gt;</span>

<span class="c">&lt;!-- ì˜µì…˜ --&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"hibernate.show_sql"</span> <span class="na">value=</span><span class="s">"true"</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- í•˜ì´ë²„ë„¤ì´íŠ¸ê°€ ì‹¤í–‰í•œ SQLì„ ì¶œë ¥í•œë‹¤ --&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"hibernate.format_sql"</span> <span class="na">value=</span><span class="s">"true"</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- í•˜ì´ë²„ë„¤ì´íŠ¸ê°€ ì‹¤í–‰í•œ SQLì„ ë³´ê¸° ì‰½ê²Œ ì •ë ¬í•œë‹¤ --&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"hibernate.use_sql_comments"</span> <span class="na">value=</span><span class="s">"true"</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- ì¿¼ë¦¬ë¥¼ ì¶œë ¥í•  ë•Œ ì£¼ì„ë„ í•¨ê»˜ ì¶œë ¥í•œë‹¤ --&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"hibernate.id.new_generator_mappings"</span> <span class="na">value=</span><span class="s">"true"</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- JPA í‘œì¤€ì— ë§ì¶˜ ìƒˆë¡œìš´ í‚¤ ìƒì„± ì „ëµì„ ì‚¬ìš©í•œë‹¤. --&gt;</span>
</code></pre></div></div>
<p><br />
<br />
<br /></p>

<h2 id="26-ì• í”Œë¦¬ì¼€ì´ì…˜-ê°œë°œ">2.6 ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ</h2>
<p>ì‹œì‘ì½”ë“œë¥¼ ì‚´í´ë³´ì</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JpaMain</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="c1">//ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ ìƒì„±</span>
        <span class="nc">EntityManagerFactory</span> <span class="n">emf</span> <span class="o">=</span> <span class="nc">Persistence</span><span class="o">.</span><span class="na">createEntityManagerFactory</span><span class="o">(</span><span class="s">"jpabook"</span><span class="o">);</span>
        <span class="nc">EntityManager</span> <span class="n">em</span> <span class="o">=</span> <span class="n">emf</span><span class="o">.</span><span class="na">createEntityManager</span><span class="o">();</span> <span class="c1">//ì—”í‹°í‹° ë§¤ë‹ˆì € ìƒì„±</span>

        <span class="nc">EntityTransaction</span> <span class="n">tx</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">();</span> <span class="c1">//íŠ¸ëœì­ì…˜ ê¸°ëŠ¥ íšë“</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="n">tx</span><span class="o">.</span><span class="na">begin</span><span class="o">();</span> <span class="c1">//íŠ¸ëœì­ì…˜ ì‹œì‘</span>
            <span class="n">logic</span><span class="o">(</span><span class="n">em</span><span class="o">);</span>  <span class="c1">//ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§</span>
            <span class="n">tx</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span><span class="c1">//íŠ¸ëœì­ì…˜ ì»¤ë°‹</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="n">tx</span><span class="o">.</span><span class="na">rollback</span><span class="o">();</span> <span class="c1">//íŠ¸ëœì­ì…˜ ë¡¤ë°±</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="n">em</span><span class="o">.</span><span class="na">close</span><span class="o">();</span> <span class="c1">//ì—”í‹°í‹° ë§¤ë‹ˆì € ì¢…ë£Œ</span>
        <span class="o">}</span>

        <span class="n">emf</span><span class="o">.</span><span class="na">close</span><span class="o">();</span> <span class="c1">//ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ ì¢…ë£Œ</span>
    <span class="o">}</span>

    <span class="c1">// ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">logic</span><span class="o">(</span><span class="nc">EntityManager</span> <span class="n">em</span><span class="o">)</span> <span class="o">{...}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ì½”ë“œëŠ” í¬ê²Œ 3ë¶€ë¶„ìœ¼ë¡œ ë‚˜ë‰˜ì–´ ìˆë‹¤</p>
<ul>
  <li>ì—”í‹°í‹° ë§¤ë‹ˆì € ìƒì„±</li>
  <li>íŠ¸ëœì­ì…˜ ê´€ë¦¬</li>
  <li>ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§<br />
<br />
<br /></li>
</ul>

<h3 id="261-ì—”í‹°í‹°-ë§¤ë‹ˆì €-ì„¤ì •">2.6.1 ì—”í‹°í‹° ë§¤ë‹ˆì € ì„¤ì •</h3>
<p><strong>ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ ìƒì„±</strong><br />
JPAë¥¼ ì‹œì‘í•˜ë ¤ë©´ ìš°ì„  ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ë¥¼ ìƒì„±í•´ì•¼ í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">EntityManagerFactory</span> <span class="n">emf</span> <span class="o">=</span> <span class="nc">Persistence</span><span class="o">.</span><span class="na">createEntityManagerFactory</span><span class="o">(</span><span class="s">"jpabook"</span><span class="o">);</span>
</code></pre></div></div>
<p><strong>ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬</strong>ëŠ” JPAë¥¼ ë™ì‘ì‹œí‚¤ê¸° ìœ„í•œ ê¸°ë°˜ ê°ì²´ë¥¼ ë§Œë“¤ê³  ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜ í’€ë„ ìƒì„±í•˜ë¯€ë¡œ <strong>ìƒì„± ë¹„ìš©ì€ ì•„ì£¼ í¬ë‹¤.</strong> ë”°ë¼ì„œ <strong>ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ì— ë”± í•œ ë²ˆë§Œ ìƒì„±í•˜ê³  ê³µìœ í•´ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</strong><br />
<br /></p>

<p><strong>ì—”í‹°í‹° ë§¤ë‹ˆì € ìƒì„±</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">EntityManager</span> <span class="n">em</span> <span class="o">=</span> <span class="n">emf</span><span class="o">.</span><span class="na">createEntityManager</span><span class="o">();</span>
</code></pre></div></div>
<p>JPAì˜ ê¸°ëŠ¥ ëŒ€ë¶€ë¶„ì€ ì—”í‹°í‹° ë§¤ë‹ˆì €ê°€ ì œê³µí•œë‹¤. ëŒ€í‘œì ìœ¼ë¡œ ì—”í‹°í‹°ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ë“±ë¡,ìˆ˜ì •,ì‚­ì œ,ì¡°íšŒí•  ìˆ˜ ìˆë‹¤. <strong>ì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜ê³¼ ë°€ì ‘í•œ ê´€ê³„ê°€ ìˆìœ¼ë¯€ë¡œ ìŠ¤ë ˆë“œê°„ì— ê³µìœ í•˜ê±°ë‚˜ ì¬ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤.</strong><br />
<br /></p>

<p><strong>ì¢…ë£Œ</strong><br />
ì‚¬ìš©ì´ ëë‚œ ì—”í‹°í‹° ë§¤ë‹ˆì €, ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ëŠ” ë°˜ë“œì‹œ ì¢…ë£Œí•´ì•¼í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">em</span><span class="o">.</span><span class="na">close</span><span class="o">();</span> <span class="c1">// ì—”í‹°í‹° ë§¤ë‹ˆì € ì¢…ë£Œ</span>
<span class="n">emf</span><span class="o">.</span><span class="na">close</span><span class="o">()</span> <span class="c1">// ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ ì¢…ë£Œ</span>
</code></pre></div></div>
<p><br />
<br />
<br /></p>

<h3 id="262-íŠ¸ëœì­ì…˜-ê´€ë¦¬">2.6.2 íŠ¸ëœì­ì…˜ ê´€ë¦¬</h3>
<p><strong>JPAë¥¼ ì‚¬ìš©í•˜ë©´ í•­ìƒ íŠ¸ëœì­ì…˜ ì•ˆì—ì„œ ë°ì´í„°ë¥¼ ë³€ê²½í•´ì•¼ í•œë‹¤.</strong> íŠ¸ëœì­ì…˜ ì—†ì´ ë°ì´í„°ë¥¼ ë³€ê²½í•˜ë©´ ì˜ˆì™¸ê°€ ë°œìƒí•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">EntityTransaction</span> <span class="n">tx</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">();</span> <span class="c1">//íŠ¸ëœì­ì…˜ ê¸°ëŠ¥ íšë“</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">tx</span><span class="o">.</span><span class="na">begin</span><span class="o">();</span> <span class="c1">//íŠ¸ëœì­ì…˜ ì‹œì‘</span>
    <span class="n">logic</span><span class="o">(</span><span class="n">em</span><span class="o">);</span>  <span class="c1">//ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§</span>
    <span class="n">tx</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span><span class="c1">//íŠ¸ëœì­ì…˜ ì»¤ë°‹</span>

<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="n">tx</span><span class="o">.</span><span class="na">rollback</span><span class="o">();</span> <span class="c1">//íŠ¸ëœì­ì…˜ ë¡¤ë°±</span>
<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
    <span class="n">em</span><span class="o">.</span><span class="na">close</span><span class="o">();</span> <span class="c1">//ì—”í‹°í‹° ë§¤ë‹ˆì € ì¢…ë£Œ</span>
<span class="o">}</span>

<span class="n">emf</span><span class="o">.</span><span class="na">close</span><span class="o">();</span> <span class="c1">//ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ ì¢…ë£Œ</span>
</code></pre></div></div>
<p><br />
<br />
<br /></p>

<h3 id="263-ë¹„ì¦ˆë‹ˆìŠ¤-ë¡œì§">2.6.3 ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§</h3>
<p>JPAë¥¼ ì´ìš©í•œ ë“±ë¡, ìˆ˜ì •, ì¡°íšŒ, ì‚­ì œ ì˜ˆëŠ” ì•„ë˜ì™€ ê°™ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">logic</span><span class="o">(</span><span class="nc">EntityManager</span> <span class="n">em</span><span class="o">)</span> <span class="o">{</span>

        <span class="nc">String</span> <span class="n">id</span> <span class="o">=</span> <span class="s">"id1"</span><span class="o">;</span>
        <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">();</span>
        <span class="n">member</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
        <span class="n">member</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">"ì§€í•œ"</span><span class="o">);</span>
        <span class="n">member</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>

        <span class="c1">//ë“±ë¡</span>
        <span class="c1">// INSERT INTO MEMBER ...</span>
        <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>

        <span class="c1">//ìˆ˜ì •</span>
        <span class="c1">// JPAëŠ” ì—”í‹°í‹° ë³€ê²½ ì¶”ì  ê¸°ëŠ¥ì´ ìˆì–´ ì—”í‹°í‹°ì˜ ê°’ë§Œ ë³€ê²½í•˜ë©´ ìˆ˜ì •ë¨</span>
        <span class="c1">// UPDATE MEMBER SET AGE=20, NAME='ì§€í•œ' WHERE ID = 'id1';</span>
        <span class="n">member</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="mi">20</span><span class="o">);</span>

        <span class="c1">//í•œ ê±´ ì¡°íšŒ</span>
        <span class="c1">// SELECT * FROM MEMBER WHERE ID = 'id1';</span>
        <span class="nc">Member</span> <span class="n">findMember</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"findMember="</span> <span class="o">+</span> <span class="n">findMember</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()</span> <span class="o">+</span> <span class="s">", age="</span> <span class="o">+</span> <span class="n">findMember</span><span class="o">.</span><span class="na">getAge</span><span class="o">());</span>

        <span class="c1">//ëª©ë¡ ì¡°íšŒ</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"select m from Member m"</span><span class="o">,</span> <span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">getResultList</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"members.size="</span> <span class="o">+</span> <span class="n">members</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>

        <span class="c1">//ì‚­ì œ</span>
        <span class="c1">// DELETE FROM MEMBER WHERE ID = 'id1';</span>
        <span class="n">em</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre></div></div>
<p><br />
<br />
<br /></p>

<h3 id="264-jpql">2.6.4 JPQL</h3>
<p>JPAëŠ” SQLì„ ì¶”ìƒí™”í•œ JPQLì´ë¼ëŠ” ê°ì²´ ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´ë¥¼ ì œê³µí•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//ëª©ë¡ ì¡°íšŒ</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"select m from Member m"</span><span class="o">,</span> <span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">getResultList</span><span class="o">();</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"members.size="</span> <span class="o">+</span> <span class="n">members</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
</code></pre></div></div>

<p><strong>JPQLê³¼ SQLì˜ ê°€ì¥ í° ì°¨ì´ì </strong></p>
<ul>
  <li><strong>JPQLì€ ì—”í‹°í‹° ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì¿¼ë¦¬</strong>í•œë‹¤.</li>
  <li>SQLì€ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì„ ëŒ€ìƒìœ¼ë¡œ ì¿¼ë¦¬í•œë‹¤.</li>
</ul>

<div class="notice--warning">
<p><strong>JPQLì€ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì„ ì „í˜€ ì•Œì§€ ëª»í•œë‹¤.</strong></p>
</div>
<p><br />
<br /></p>

<h2 id="27-ì •ë¦¬">2.7 ì •ë¦¬</h2>
<ul>
  <li>JPAë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ê°œë°œ í™˜ê²½ ì„¤ì •</li>
  <li>JPAë¥¼ ì‚¬ìš©</li>
  <li>JPQL ì„¤ëª…<br />
<br />
<br />
<br />
<br /></li>
</ul>

<h1 id="3-ì˜ì†ì„±-ê´€ë¦¬">3. ì˜ì†ì„± ê´€ë¦¬</h1>
<h2 id="31-ì—”í‹°í‹°-ë§¤ë‹ˆì €-íŒ©í† ë¦¬ì™€-ì—”í‹°í‹°-ë§¤ë‹ˆì €">3.1 ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ì™€ ì—”í‹°í‹° ë§¤ë‹ˆì €</h2>
<ul>
  <li>ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ë¥¼ ë§Œë“œëŠ” ë¹„ìš©ì€ ìƒë‹¹íˆ í¬ë‹¤.</li>
  <li>ë”°ë¼ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ì—ì„œ ê³µìœ í•˜ë„ë¡ ì„¤ê³„ë˜ì–´ ìˆë‹¤. (ê·¸ë˜ì„œ ì¼ë°˜ì ìœ¼ë¡œ í•˜ë‚˜ë§Œ ìƒì„± í•œë‹¤)</li>
  <li><strong>ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ëŠ” ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ì ‘ê·¼í•´ë„ ì•ˆì „</strong>í•˜ë‹¤.</li>
  <li><strong>ì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ì ‘ê·¼í•˜ë©´ ë™ì‹œì„± ë¬¸ì œê°€ ë°œìƒ</strong>í•œë‹¤.</li>
</ul>
<center><img src="/assets/images/posts/books/2/3_1_ì¼ë°˜ì ì¸ì›¹ì• í”Œë¦¬ì¼€ì´ì…˜.png" alt="ì¼ë°˜ì ì¸ì›¹ì• í”Œë¦¬ì¼€ì´ì…˜" width="80%" height="80%" /></center>

<p><br />
<br /></p>

<h2 id="32-ì˜ì†ì„±-ì»¨í…ìŠ¤íŠ¸ë€">3.2 ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë€?</h2>
<p>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸(persistence context)ë€ í•´ì„í•˜ìë©´ <strong>ì—”í‹°í‹°ë¥¼ ì˜êµ¬ ì €ì¥í•˜ëŠ” í™˜ê²½</strong>ì´ë€ ëœ»ì´ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì´ ë©”ì†Œë“œëŠ” ì •í™•íˆ í‘œí˜„í•˜ìë©´ 'ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ ì‚¬ìš©í•´ì„œ íšŒì› ì—”í‹°í‹°ë¥¼ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥í•œë‹¤' ì´ë‹¤.</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">memeber</span><span class="o">);</span>
</code></pre></div></div>
<p>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ”</p>
<ul>
  <li>ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ ìƒì„±í•  ë•Œ í•˜ë‚˜ ë§Œë“¤ì–´ì§„ë‹¤.</li>
  <li>ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ í†µí•´ì„œ ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.</li>
  <li>ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ í†µí•´ ê´€ë¦¬ë°›ëŠ”ë‹¤.</li>
  <li>ì—¬ëŸ¬ ì—”í‹°í‹° ë§¤ë‹ˆì €ê°€ ì ‘ê·¼í•  ìˆ˜ë„ ìˆë‹¤.<br />
<br />
<br />
<br /></li>
</ul>

<h2 id="33-ì—”í‹°í‹°ì˜-ìƒëª…ì£¼ê¸°">3.3 ì—”í‹°í‹°ì˜ ìƒëª…ì£¼ê¸°</h2>
<p>ì—”í‹°í‹°ì—ëŠ” 4ê°€ì§€ ìƒíƒœê°€ ì¡´ì¬í•œë‹¤.</p>
<ul>
  <li>ë¹„ì˜ì†(new / transient): ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì™€ ì „í˜€ ê´€ê³„ê°€ ì—†ëŠ” ìƒíƒœ</li>
  <li>ì˜ì†(managed): ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥ëœ ìƒíƒœ</li>
  <li>ì¤€ì˜ì†(detached): ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥ë˜ì—ˆë‹¤ê°€ ë¶„ë¦¬ëœ ìƒíƒœ</li>
  <li>ì‚­ì œ(removed): ì‚­ì œëœ ìƒíƒœ</li>
</ul>
<center><img src="/assets/images/posts/books/2/3_3_ìƒëª…ì£¼ê¸°.png" alt="ìƒëª…ì£¼ê¸°" width="90%" height="90%" /></center>
<p><br />
<br />
<br /></p>

<h2 id="34-ì˜ì†ì„±-ì»¨í…ìŠ¤íŠ¸ì˜-íŠ¹ì§•">3.4 ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ íŠ¹ì§•</h2>
<p>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ íŠ¹ì§•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<ul>
  <li><strong>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” ì—”í‹°í‹°ë¥¼ ì‹ë³„ìê°’(@Id)ìœ¼ë¡œ êµ¬ë¶„í•œë‹¤.</strong> ì˜ì† ìƒíƒœëŠ” ì‹ë³„ì ê°’ì´ ë°˜ë“œì‹œ ìˆì–´ì•¼ í•œë‹¤.</li>
  <li>JPAëŠ” ë³´í†µ <strong>íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•˜ëŠ” ìˆœê°„ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ìƒˆë¡œ ì €ì¥ëœ ì—”í‹°í‹°ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•˜ëŠ”ë° ì´ê²ƒì„ í”ŒëŸ¬ì‹œ(flush)ë¼ í•œë‹¤.</strong></li>
</ul>

<div class="notice--info">
<p><strong>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ì—”í‹°í‹°ë¥¼ ê´€ë¦¬í•  ë•Œ ì¥ì </strong></p>
<ul>
  <li>1ì°¨ ìºì‹œ</li>
  <li>ë™ì¼ì„± ë³´ì¥</li>
  <li>íŠ¸ëœì­ì…˜ì„ ì§€ì›í•˜ëŠ” ì“°ê¸° ì§€ì—°</li>
  <li>ë³€ê²½ ê°ì§€</li>
  <li>ì§€ì—°ë¡œë”©</li>
</ul>
</div>
<p><br />
<br /></p>

<h3 id="341-ì—”í‹°í‹°-ì¡°íšŒ">3.4.1 ì—”í‹°í‹° ì¡°íšŒ</h3>
<p>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” ë‚´ë¶€ì— ìºì‹œë¥¼ ê°€ì§€ê³  ìˆëŠ”ë° ì´ê²ƒì„ 1ì°¨ ìºì‹œë¼ í•œë‹¤. ì˜ì† ìƒíƒœì˜ ì—”í‹°í‹°ëŠ” ëª¨ë‘ ì´ê³³ì— ì €ì¥ëœë‹¤.</p>

<p><strong>1ì°¨ ìºì‹œì—ì„œ ì¡°íšŒ</strong></p>
<center><img src="/assets/images/posts/books/2/3_4_1ì°¨ìºì‹œì—ì„œì¡°íšŒ.png" alt="1ì°¨ìºì‹œì—ì„œì¡°íšŒ" width="90%" height="90%" /></center>

<ul>
  <li>1ì°¨ ìºì‹œì˜ í‚¤ëŠ” ì‹ë³„ì(@Id) ê°’.</li>
  <li>ì‹ë³„ì ê°’ì€ ë°ì´í„°ë² ì´ìŠ¤ ê¸°ë³¸ í‚¤ì™€ ë§¤í•‘.</li>
  <li>1ì°¨ ìºì‹œì—ì„œ ì—”í‹°í‹°ë¥¼ ì°¾ê³  ì—”í‹°í‹°ê°€ ì—†ìœ¼ë©´ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¡°íšŒí•œë‹¤.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ë¹„ì˜ì† ìƒíƒœ</span>
<span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">();</span>
<span class="n">member</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="s">"member1"</span><span class="o">);</span>
<span class="n">member</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">"íšŒì›1"</span><span class="o">);</span>

<span class="c1">// ì˜ì† ìƒíƒœ (1ì°¨ ìºì‹œì— ì €ì¥ë¨)</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>

<span class="c1">// 1ì°¨ ìºì‹œì—ì„œ ì¡°íšŒ</span>
<span class="nc">Member</span> <span class="n">findMember</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"member1"</span><span class="o">);</span>
</code></pre></div></div>
<p><br />
<br /></p>

<p><strong>ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¡°íšŒ</strong></p>
<ul>
  <li>ì¡°íšŒì‹œ ì—”í‹°í‹°ê°€ 1ì°¨ ìºì‹œì— ì—†ìœ¼ë©´ ì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¡°íšŒí•´ì„œ ì—”í‹°í‹°ë¥¼ ìƒì„±.</li>
  <li>1ì°¨ ìºì‹œì— ì €ì¥í•œ í›„ì— ì˜ì† ìƒíƒœì˜ ì—”í‹°í‹°ë¥¼ ë°˜í™˜í•œë‹¤.</li>
</ul>

<center><img src="/assets/images/posts/books/2/3_4_1ì°¨ìºì‹œì—ì—†ìœ¼ë©´ë°ì´í„°ë² ì´ìŠ¤ì„œì¡°íšŒ.png" alt="1ì°¨ìºì‹œì—ì—†ìœ¼ë©´ë°ì´í„°ë² ì´ìŠ¤ì„œì¡°íšŒ" width="90%" height="90%" /></center>
<p><br />
<br /></p>

<p><strong>ì˜ì† ì—”í‹°í‹°ì˜ ë™ì¼ì„± ë³´ì¥</strong><br />
ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” ì„±ëŠ¥ìƒ ì´ì ê³¼ ì—”í‹°í‹°ì˜ ë™ì¼ì„±ì„ ë³´ì¥í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Member</span> <span class="n">a</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"member1"</span><span class="o">);</span>
<span class="nc">Member</span> <span class="n">b</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"member1"</span><span class="o">);</span>

<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="o">);</span>
</code></pre></div></div>

<div class="notice--warning">
<p><strong>ë™ì¼ì„±ê³¼ ë™ë“±ì„±</strong></p>
<ul>
  <li>ë™ì¼ì„±(identity): ì‹¤ì œ ì¸ìŠ¤í„´ìŠ¤ê°€ ê°™ë‹¤. ë”°ë¼ì„œ ì°¸ì¡° ê°’ì„ ë¹„êµí•˜ëŠ” == ë¹„êµì˜ ê°’ì´ ê°™ë‹¤.</li>
  <li>ë™ë“±ì„±(equality): ì‹¤ì œ ì¸ìŠ¤í„´ìŠ¤ëŠ” ë‹¤ë¥¼ ìˆ˜ ìˆì§€ë§Œ ì¸ìŠ¤í„´ìŠ¤ê°€ ê°€ì§€ê³  ìˆëŠ” ê°’ì´ ê°™ë‹¤.</li>
</ul>
</div>
<p><br />
<br /></p>

<h3 id="342-ì—”í‹°í‹°-ë“±ë¡">3.4.2 ì—”í‹°í‹° ë“±ë¡</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">EntityManager</span> <span class="n">em</span> <span class="o">=</span> <span class="n">emf</span><span class="o">.</span><span class="na">createEntityManager</span><span class="o">();</span> 
<span class="nc">EntityTransaction</span> <span class="n">tx</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">();</span>
<span class="c1">// ì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” ë°ì´í„° ë³€ê²½ ì‹œ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•´ì•¼ í•œë‹¤.</span>
<span class="n">tx</span><span class="o">.</span><span class="na">begin</span><span class="o">();</span> <span class="c1">//íŠ¸ëœì­ì…˜ ì‹œì‘</span>

<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">memberA</span><span class="o">);</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">memberB</span><span class="o">);</span>
<span class="c1">// ì—¬ê¸°ê¹Œì§€ INSERT SQLì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë³´ë‚´ì§€ ì•ŠëŠ”ë‹¤.</span>

<span class="c1">// ì»¤ë°‹í•˜ëŠ” ìˆœê°„ ë°ì´í„°ë² ì´ìŠ¤ì— INSERT SQLì„ ë³´ë‚¸ë‹¤.</span>
<span class="n">tx</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</code></pre></div></div>
<ol>
  <li>ì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•˜ê¸° ì§ì „ê¹Œì§€ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ì§€ ì•Šê³  ë‚´ë¶€ ì¿¼ë¦¬ ì €ì¥ì†Œì— INSERT SQLì„ ëª¨ì•„ë‘”ë‹¤.</li>
  <li>íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•  ë•Œ ëª¨ì•„ë‘” ì¿¼ë¦¬ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ë³´ë‚¸ë‹¤. ì´ë¥¼ íŠ¸ëœì­ì…˜ì„ ì§€ì›í•˜ëŠ” ì“°ê¸° ì§€ì—°ì´ë¼ í•œë‹¤.</li>
</ol>

<center><img src="/assets/images/posts/books/2/3_4_ì“°ê¸°ì§€ì—°1.png" alt="ì“°ê¸°ì§€ì—°" width="90%" height="90%" /></center>
<p><br /></p>
<center><img src="/assets/images/posts/books/2/3_4_ì“°ê¸°ì§€ì—°2.png" alt="ì“°ê¸°ì§€ì—°" width="90%" height="90%" /></center>
<p><br /></p>
<center><img src="/assets/images/posts/books/2/3_4_ì“°ê¸°ì§€ì—°3.png" alt="ì“°ê¸°ì§€ì—°" width="90%" height="90%" /></center>

<div class="notice--info">
<p><strong>í”ŒëŸ¬ì‹œ</strong></p>
<ul>
  <li>í”ŒëŸ¬ì‹œëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë³€ê²½ ë‚´ìš©ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë™ê¸°í™” í•˜ëŠ” ì‘ì—…</li>
  <li>êµ¬ì²´ì ìœ¼ë¡œ ì´ì•¼ê¸°í•˜ë©´ ì“°ê¸° ì§€ì—° SQLì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë³´ë‚´ëŠ” ì‘ì—…ì´ë‹¤.</li>
</ul>
</div>

<div class="notice--info">
<p><strong>íŠ¸ëœì­ì…˜ì„ ì§€ì›í•˜ëŠ” ì“°ê¸° ì§€ì—°ì´ ê°€ëŠ¥í•œ ì´ìœ </strong></p>
<ul>
  <li>ë“±ë¡ ì¿¼ë¦¬ë¥¼ ê·¸ë•Œ ê·¸ë•Œ ë°ì´í„°ë² ì´ìŠ¤ì— ì „ë‹¬í•´ë„ íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•˜ì§€ ì•Šìœ¼ë©´ ì•„ë¬´ ì†Œìš© ì—†ë‹¤.</li>
  <li>ê²°êµ­ ë°ì´í„°ë² ì´ìŠ¤ì— SQLì„ ê·¸ë•Œ ê·¸ë•Œ ì „ë‹¬í•˜ë‚˜, ì»¤ë°‹ ì§ì „ì—ë§Œ ì „ë‹¬í•˜ë‚˜ ê²°ê³¼ëŠ” ê°™ë‹¤.</li>
</ul>
</div>
<p><br />
<br /></p>

<h3 id="343-ì—”í‹°í‹°-ìˆ˜ì •">3.4.3 ì—”í‹°í‹° ìˆ˜ì •</h3>
<p><strong>SQL ìˆ˜ì • ì¿¼ë¦¬ì˜ ë¬¸ì œì </strong></p>
<ul>
  <li>ìˆ˜ì • ì¿¼ë¦¬ê°€ ë§ì•„ì§„ë‹¤.</li>
  <li>ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ë¶„ì„í•˜ê¸° ìœ„í•´ SQLì„ ê³„ì† í™•ì¸í•´ì•¼í•œë‹¤.</li>
  <li>ê²°êµ­ ì§ê°„ì ‘ì ìœ¼ë¡œ <strong>ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ SQLì— ì˜ì¡´í•œë‹¤.</strong><br />
<br /></li>
</ul>

<p><strong>JPAì˜ ìˆ˜ì •: ë³€ê²½ê°ì§€</strong></p>
<ul>
  <li><strong>JPAì—ì„œ ì—”í‹°í‹° ìˆ˜ì •ì€ ë‹¨ìˆœíˆ ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•´ì„œ ë°ì´í„°ë§Œ ë³€ê²½</strong>í•˜ë©´ ëœë‹¤.</li>
  <li>ì´ë ‡ê²Œ ì—”í‹°í‹°ì˜ ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ìë™ìœ¼ë¡œ ë°˜ì˜í•˜ëŠ” ê¸°ëŠ¥ì„ <strong>ë³€ê²½ ê°ì§€</strong>ë¼ í•œë‹¤.</li>
  <li><strong>ë³€ê²½ ê°ì§€ëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ê´€ë¦¬í•˜ëŠ” ì˜ì† ìƒíƒœì˜ ì—”í‹°í‹°ì—ë§Œ ì ìš©ëœë‹¤.</strong></li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">EntityManager</span> <span class="n">em</span> <span class="o">=</span> <span class="n">emf</span><span class="o">.</span><span class="na">createEntityManager</span><span class="o">();</span> 
<span class="nc">EntityTransaction</span> <span class="n">tx</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">();</span>

<span class="c1">// íŠ¸ëœì­ì…˜ ì‹œì‘</span>
<span class="n">tx</span><span class="o">.</span><span class="na">begin</span><span class="o">();</span>

<span class="c1">// ì˜ì† ì—”í‹°í‹° ì¡°íšŒ</span>
<span class="nc">Member</span> <span class="n">memberA</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"memberA"</span><span class="o">);</span>

<span class="c1">// ì˜ì† ì—”í‹°í‹° ë°ì´í„° ìˆ˜ì •</span>
<span class="n">memberA</span><span class="o">.</span><span class="na">setUserName</span><span class="o">(</span><span class="s">"hi"</span><span class="o">);</span>
<span class="n">memberA</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>

<span class="c1">// íŠ¸ëœì­ì…˜ ì»¤ë°‹</span>
<span class="n">tx</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</code></pre></div></div>

<center><img src="/assets/images/posts/books/2/3_4_ë³€ê²½ê°ì§€.png" alt="ë³€ê²½ê°ì§€" width="100%" height="100%" /></center>
<p><br /></p>

<ul>
  <li><strong>JPAì˜ ìˆ˜ì • ê¸°ë³¸ì „ëµì€ ì—”í‹°í‹°ì˜ ëª¨ë“  í•„ë“œë¥¼ ì—…ë°ì´íŠ¸</strong> í•œë‹¤.</li>
  <li>í•„ë“œê°€ ë„ˆë¬´ ë§ê±°ë‚˜ ì €ì¥ë˜ëŠ” ë‚´ìš©ì´ ë„ˆë¬´ í¬ë©´ ìˆ˜ì •ëœ ë°ì´í„°ë§Œ ì‚¬ìš©í•´ì„œ <strong>ë™ì ìœ¼ë¡œ UPDATE SQLì„ ìƒì„±í•˜ëŠ” ì „ëµì„ ì„ íƒí•  ìˆ˜ ìˆë‹¤.</strong></li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@org</span><span class="o">.</span><span class="na">hibernate</span><span class="o">.</span><span class="na">annotations</span><span class="o">.</span><span class="na">DynamicUpdate</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span><span class="o">{...}</span>
</code></pre></div></div>

<div class="notice--info">
<p><strong>ì°¸ê³ </strong><br />
ìƒí™©ì— ë”°ë¼ ë‹¤ë¥´ê² ì§€ë§Œ ì»¬ëŸ¼ì´ ëŒ€ëµ 30ê°œ ì •ë„ê°€ ì•„ë‹ˆë¼ë©´ ê¸°ë³¸ ì „ëµì˜ ìˆ˜ì • ì¿¼ë¦¬ê°€ ë¹ ë¥´ë‹¤.<br />
ì¶”ê°€ë¡œ <strong>INSERT SQLì„ ë™ì ìœ¼ë¡œ ìƒì„±í•˜ëŠ” <code class="language-plaintext highlighter-rouge">@DynamicInsert</code>ë„ ìˆë‹¤.</strong></p>
</div>
<p><br />
<br /></p>

<h3 id="344-ì—”í‹°í‹°-ì‚­ì œ">3.4.4 ì—”í‹°í‹° ì‚­ì œ</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì˜ì† ì—”í‹°í‹° ì¡°íšŒ</span>
<span class="nc">Member</span> <span class="n">memberA</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"memberA"</span><span class="o">);</span>
<span class="n">em</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">memberA</span><span class="o">);</span>
</code></pre></div></div>
<ol>
  <li><code class="language-plaintext highlighter-rouge">em.remove();</code> í˜¸ì¶œ</li>
  <li>í˜¸ì¶œ ìˆœê°„ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì—”í‹°í‹° ì œê±°</li>
  <li>ì“°ê¸° ì§€ì—° SQL ì €ì¥ì†Œì— ì‚­ì œ ì¿¼ë¦¬ ë“±ë¡</li>
  <li>íŠ¸ëœì­ì…˜ ì»¤ë°‹ì‹œ í”ŒëŸ¬ì‹œ (ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ì— ì‚­ì œ ì¿¼ë¦¬ ì „ë‹¬)</li>
  <li>ë°ì´í„°ë² ì´ìŠ¤ íŠ¸ëœì­ì…˜ ì»¤ë°‹<br />
<br />
<br /></li>
</ol>

<h2 id="35-í”ŒëŸ¬ì‹œ">3.5 í”ŒëŸ¬ì‹œ</h2>
<p><strong>í”ŒëŸ¬ì‹œëŠ”(<code class="language-plaintext highlighter-rouge">flush()</code>)ëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë³€ê²½ ë‚´ìš©ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•œë‹¤.</strong> ë™ì‘ ìˆœì„œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<ol>
  <li>ë³€ê²½ ê°ì§€ê°€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ìˆëŠ” ëª¨ë“  ì—”í‹°í‹°ë¥¼ ìŠ¤ëƒ…ìƒ·ê³¼ ë¹„êµí•´ì„œ ìˆ˜ì •ëœ ì—”í‹°í‹°ë¥¼ ì°¾ëŠ”ë‹¤.</li>
  <li>ìˆ˜ì •ëœ ì—”í‹°í‹°ëŠ” ìˆ˜ì • ì¿¼ë¦¬ë¥¼ ë§Œë“¤ì–´ ì“°ê¸° ì§€ì—° SQL ì €ì¥ì†Œì— ë“±ë¡í•œë‹¤.</li>
  <li>ì“°ê¸° ì§€ì—° SQL ì €ì¥ì†Œì˜ ì¿¼ë¦¬ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì „ì†¡í•œë‹¤.(ë“±ë¡,ìˆ˜ì •,ì‚­ì œ ì¿¼ë¦¬)<br />
<br /></li>
</ol>

<p><strong>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ í”ŒëŸ¬ì‹œí•˜ëŠ” ë°©ë²• 3ê°€ì§€</strong></p>
<ol>
  <li>ì§ì ‘ í˜¸ì¶œ (<code class="language-plaintext highlighter-rouge">em.flush()</code>)</li>
  <li>íŠ¸ëœì­ì…˜ ì»¤ë°‹</li>
  <li>JPQL ì¿¼ë¦¬ ì‹¤í–‰
    <ul>
      <li>JPQLì€ SQLë¡œ ë³€í™˜ë˜ì–´ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì—”í‹°í‹° ì¡°íšŒ</li>
      <li>ë§Œì•½ ì—”í‹°í‹°ê°€ ë°ì´í„°ë² ì´ìŠ¤ì— ì—†ìœ¼ë©´ ì¡°íšŒ ë¶ˆê°€</li>
      <li>ë”°ë¼ì„œ í”ŒëŸ¬ì‹œë¥¼ í†µí•´ ë³€ê²½ ë‚´ìš©ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•´ì•¼ í•¨</li>
    </ul>
  </li>
</ol>

<div class="notice--info">
<p><strong>ì°¸ê³ </strong><br />
ì‹ë³„ìë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¡°íšŒí•˜ëŠ” <code class="language-plaintext highlighter-rouge">find()</code> ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•  ë•ŒëŠ” í”ŒëŸ¬ì‹œê°€ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤.</p>
</div>
<p><br />
<br /></p>

<h3 id="351-í”ŒëŸ¬ì‹œ-ëª¨ë“œ-ì˜µì…˜">3.5.1 í”ŒëŸ¬ì‹œ ëª¨ë“œ ì˜µì…˜</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">FlushModeType.AUTO</code>: ì»¤ë°‹ì´ë‚˜ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•  ë•Œ í”ŒëŸ¬ì‹œ(ê¸°ë³¸ê°’)</li>
  <li><code class="language-plaintext highlighter-rouge">FlushModeType.COMMIT</code>: ì»¤ë°‹í•  ë•Œë§Œ í”ŒëŸ¬ì‹œ</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">em</span><span class="o">.</span><span class="na">setFlushMode</span><span class="o">(</span><span class="nc">FlushModeType</span><span class="o">.</span><span class="na">COMMIT</span><span class="o">);</span> <span class="c1">// í”ŒëŸ¬ì‹œ ëª¨ë“œ ì§ì ‘ ì„¤ì •</span>
</code></pre></div></div>
<p><br />
<br />
<br /></p>

<h2 id="36-ì¤€ì˜ì†">3.6 ì¤€ì˜ì†</h2>
<ul>
  <li>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ê´€ë¦¬í•˜ëŠ” <strong>ì˜ì† ìƒíƒœì˜ ì—”í‹°í‹°ê°€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ë¶„ë¦¬ëœ ê²ƒì„ ì¤€ì˜ì† ìƒíƒœ</strong>ë¼ í•œë‹¤.</li>
  <li><strong>ì¤€ì˜ì† ìƒíƒœì˜ ì—”í‹°í‹°ëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.</strong><br />
<br /></li>
</ul>

<p><strong>ì˜ì† ìƒíƒœì˜ ì—”í‹°í‹°ë¥¼ ì¤€ì˜ì† ìƒíƒœë¡œ ë§Œë“œëŠ” ë°©ë²•</strong></p>
<ol>
  <li><code class="language-plaintext highlighter-rouge">em.detach(entity)</code>: íŠ¹ì • ì—”í‹°í‹°ë§Œ ì¤€ì˜ì† ìƒíƒœë¡œ ì „í™˜</li>
  <li><code class="language-plaintext highlighter-rouge">em.clear()</code>: ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì™„ì „íˆ ì´ˆê¸°í™”</li>
  <li><code class="language-plaintext highlighter-rouge">em.close()</code>: ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì¢…ë£Œ<br />
<br />
<br /></li>
</ol>

<h3 id="361-ì—”í‹°í‹°ë¥¼-ì¤€ì˜ì†-ìƒíƒœë¡œ-ì „í™˜-detach">3.6.1 ì—”í‹°í‹°ë¥¼ ì¤€ì˜ì† ìƒíƒœë¡œ ì „í™˜: detach()</h3>
<p>íŠ¹ì • ì—”í‹°í‹°ë§Œ ì¤€ì˜ì† ìƒíƒœë¡œ ì „í™˜</p>
<center><img src="/assets/images/posts/books/2/3_6_detach1.png" width="100%" height="100%" /></center>
<center><img src="/assets/images/posts/books/2/3_6_detach2.png" width="100%" height="100%" /></center>
<p><br /></p>

<h3 id="362-ì˜ì†ì„±-ì»¨í…ìŠ¤íŠ¸-ì´ˆê¸°í™”-clear">3.6.2 ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ì´ˆê¸°í™”: clear()</h3>
<p>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì´ˆê¸°í™”í•´ì„œ í•´ë‹¹ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ëª¨ë“  ì—”í‹°í‹°ë¥¼ ì¤€ì˜ì† ìƒíƒœë¡œ ë§Œë“¬</p>
<center><img src="/assets/images/posts/books/2/3_6_clear1.png" width="100%" height="100%" /></center>
<center><img src="/assets/images/posts/books/2/3_6_clear2.png" width="100%" height="100%" /></center>
<p><br /></p>

<h3 id="363-ì˜ì†ì„±-ì»¨í…ìŠ¤íŠ¸-ì¢…ë£Œ-close">3.6.3 ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ì¢…ë£Œ: close()</h3>
<p>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì¢…ë£Œí•˜ë©´ í•´ë‹¹ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ê´€ë¦¬í•˜ë˜ ì˜ì† ìƒíƒœì˜ ì—”í‹°í‹°ê°€ ëª¨ë‘” ì¤€ì˜ì† ìƒíƒœê°€ ëœë‹¤.</p>
<center><img src="/assets/images/posts/books/2/3_6_close.png" width="100%" height="100%" /></center>
<center><img src="/assets/images/posts/books/2/3_6_close2.png" width="100%" height="100%" /></center>
<p><br /></p>

<h3 id="364-ì¤€ì˜ì†-ìƒíƒœì˜-íŠ¹ì§•">3.6.4 ì¤€ì˜ì† ìƒíƒœì˜ íŠ¹ì§•</h3>
<ul>
  <li>ê±°ì˜ ë¹„ì˜ì† ìƒíƒœì— ê°€ê¹ë‹¤.</li>
  <li>ì‹ë³„ì ê°’ì„ ê°€ì§€ê³  ìˆë‹¤. <em>(ì¤€ì˜ì† ìƒíƒœëŠ” ì´ë¯¸ í•œ ë²ˆ ì˜ì† ìƒíƒœì˜€ìœ¼ë¯€ë¡œ ì‹ë³„ì ê°’ì„ ê°€ì§€ê³  ìˆë‹¤)</em></li>
  <li>ì§€ì—° ë¡œë”©ì„ í•  ìˆ˜ ì—†ë‹¤.<br />
<br />
<br /></li>
</ul>

<h3 id="365-ë³‘í•©-merge">3.6.5 ë³‘í•©: merge()</h3>
<p>ì¤€ì˜ì† ìƒíƒœì˜ ì—”í‹°í‹°ë¥¼ ë‹¤ì‹œ ì˜ì† ìƒíƒœë¡œ ë³€ê²½í•˜ë ¤ë©´ ë³‘í•©ì„ ì‚¬ìš©í•œë‹¤. <code class="language-plaintext highlighter-rouge">merge()</code> ë©”ì†Œë“œëŠ” ì¤€ì˜ì† ìƒíƒœì˜ ì—”í‹°í‹°ë¥¼ ë°›ì•„ì„œ ê·¸ ì •ë³´ë¡œ <strong>ìƒˆë¡œìš´ ì˜ì† ìƒíƒœì˜ ì—”í‹°í‹°ë¥¼ ë°˜í™˜í•œë‹¤.</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Member</span> <span class="n">mergeMember</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">merge</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ì¤€ì˜ì† ë³‘í•©</strong><br />
ì¤€ì˜ì† ìƒíƒœì¸ <code class="language-plaintext highlighter-rouge">member</code>ì—”í‹°í‹°ì™€ ì˜ì† ìƒíƒœì¸ <code class="language-plaintext highlighter-rouge">mergeMember</code> ì—”í‹°í‹°ëŠ” ì„œë¡œ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ë‹¤. ë”°ë¼ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì°¸ì¡°í•˜ë„ë¡ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì•ˆì „í•˜ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Member mergeMember = em.merge(member); // ì´ ì½”ë“œëŠ” ìœ„í—˜</span>
<span class="n">member</span> <span class="o">=</span> <span class="n">em2</span><span class="o">.</span><span class="na">merge</span><span class="o">(</span><span class="n">member</span><span class="o">);</span> <span class="c1">// ì´ë ‡ê²Œ ì‚¬ìš©</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ë¹„ì˜ì† ë³‘í•©</strong><br />
ë³‘í•©ì€ ë¹„ì˜ì† ì—”í‹°í‹°ë„ ì˜ì† ìƒíƒœë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">();</span>
<span class="nc">Mmeber</span> <span class="n">newMember</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">merge</span><span class="o">(</span><span class="n">member</span><span class="o">);</span> <span class="c1">// ë¹„ì˜ì† ë³‘í•©</span>
<span class="n">tx</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ë³‘í•© ë™ì‘ ìˆœì„œ</strong></p>
<ol>
  <li>íŒŒë¼ë¯¸í„°ë¡œ ë„˜ì–´ì˜¨ ì—”í‹°í‹°ì˜ ì‹ë³„ì ê°’ìœ¼ë¡œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ì¡°íšŒ</li>
  <li>ì°¾ëŠ” ì—”í‹°í‹°ê°€ ì—†ìœ¼ë©´ ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒ</li>
  <li>ë°ì´í„°ë² ì´ìŠ¤ì—ì„œë„ ì—†ìœ¼ë©´ ì—”í‹°í‹° ìƒì„±í•´ì„œ ë³‘í•©<br />
<br />
<br /></li>
</ol>

<h2 id="37-ì •ë¦¬">3.7 ì •ë¦¬</h2>
<ul>
  <li>ì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” ì•¤í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ì—ì„œ ìƒì„±í•œë‹¤.</li>
  <li>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ í†µí•´ì„œ ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.</li>
  <li><strong>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ì´ì—ì„œ ê°ì²´ë¥¼ ë³´ê´€í•˜ëŠ” ê°€ìƒì˜ ë°ì´í„°ë² ì´ìŠ¤ ê°™ì€ ì—­í• </strong>ì„ í•œë‹¤.</li>
  <li>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ë•ë¶„ì— <strong>1ì°¨ ìºì‹œ, ë™ì¼ì„± ë³´ì¥, íŠ¸ëœì­ì…˜ì„ ì§€ì›í•˜ëŠ” ì“°ê¸°ì§€ì—°, ë³€ê²½ ê°ì§€, ì§€ì—° ë¡œë”© ê¸°ëŠ¥</strong>ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
  <li>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥í•œ <strong>ì—”í‹°í‹°ëŠ” í”ŒëŸ¬ì‹œ ì‹œì ì— ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜</strong>ëœë‹¤.</li>
  <li><strong>í”ŒëŸ¬ì‹œëŠ” ì¼ë°˜ì ìœ¼ë¡œ íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•  ë•Œ ë™ì‘</strong>í•œë‹¤.</li>
  <li><strong>ì˜ì† ìƒíƒœ: ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ê´€ë¦¬í•˜ëŠ” ì—”í‹°í‹°</strong></li>
  <li><strong>ì¤€ì˜ì† ìƒíƒœ: ì˜ì† ìƒíƒœì˜ ì—”í‹°í‹°ê°€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ë¶„ë¦¬ëœ ê²ƒì„ ì¤€ì˜ì† ìƒíƒœ</strong></li>
</ul>

<p><br />
<br />
<br />
<br /></p>

<h1 id="4-ì—”í‹°í‹°-ë§¤í•‘">4. ì—”í‹°í‹° ë§¤í•‘</h1>
<ul>
  <li>ê°ì²´ì™€ í…Œì´ë¸” ë§¤í•‘: <code class="language-plaintext highlighter-rouge">@Entity</code>, <code class="language-plaintext highlighter-rouge">@Table</code></li>
  <li>ê¸°ë³¸ í‚¤ ë§¤í•‘: <code class="language-plaintext highlighter-rouge">@Id</code></li>
  <li>í•„ë“œì™€ ì»¬ëŸ¼ ë§¤í•‘: <code class="language-plaintext highlighter-rouge">@Column</code></li>
  <li>ì—°ê´€ê´€ê³„ ë§¤í•‘: <code class="language-plaintext highlighter-rouge">@ManyToOne</code>, <code class="language-plaintext highlighter-rouge">@JoinColumn</code></li>
</ul>

<p><br /></p>

<h2 id="41-entity">4.1 @Entity</h2>
<p>JPAë¥¼ ì‚¬ìš©í•´ì„œ í…Œì´ë¸”ê³¼ ë§¤í•‘í•  í´ë˜ìŠ¤</p>

<table>
  <thead>
    <tr>
      <th><strong>ì†ì„±</strong></th>
      <th><strong>ê¸°ëŠ¥</strong></th>
      <th><strong>ê¸°ë³¸ê°’</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>name</td>
      <td>JPAì—ì„œ ì‚¬ìš©í•  ì—”í‹°í‹° ì´ë¦„ì„ ì§€ì •í•œë‹¤. ê¸°ë³¸ê°’ì€ í´ë˜ìŠ¤ ì´ë¦„ì´ë‹¤. ë§Œì•½ ë‹¤ë¥¸ íŒ¨í‚¤ì§€ì— ì´ë¦„ì´ ê°™ì€ ì—”í‹°í‹° í´ë˜ìŠ¤ê°€ ìˆë‹¤ë©´ ì¶œëŒí•œë‹¤.</td>
      <td>í´ë˜ìŠ¤ì´ë¦„ (ì˜ˆ: Member)</td>
    </tr>
  </tbody>
</table>

<div class="notice--warning">
<p><strong>ì£¼ì˜ì‚¬í•­</strong></p>
<ul>
  <li>ê¸°ë³¸ ìƒì„±ìëŠ” í•„ìˆ˜ (<code class="language-plaintext highlighter-rouge">public</code> ë˜ëŠ” <code class="language-plaintext highlighter-rouge">protected</code>)</li>
  <li><code class="language-plaintext highlighter-rouge">final, enum, interface, inner</code> í´ë˜ìŠ¤ì—ëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.</li>
  <li>ì €ì¥í•  í•„ë“œì— <code class="language-plaintext highlighter-rouge">final</code>ì„ ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤.</li>
</ul>
</div>
<p><br />
<br /></p>

<h2 id="42-table">4.2 @Table</h2>
<p>ì—”í‹°í‹°ì™€ ë§¤í•‘í•  í…Œì´ë¸”ì„ ì§€ì •. ìƒëµí•˜ë©´ ë§¤í•‘í•œ ì—”í‹°í‹° ì´ë¦„ì„ í…Œì´ë¸” ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.</p>

<table>
  <thead>
    <tr>
      <th><strong>ì†ì„±</strong></th>
      <th><strong>ê¸°ëŠ¥</strong></th>
      <th><strong>ê¸°ë³¸ê°’</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>name</td>
      <td>ë§¤í•‘í•  í…Œì´ë¸” ì´ë¦„</td>
      <td>ì—”í‹°í‹° ì´ë¦„ì„ ì‚¬ìš©í•œë‹¤.</td>
    </tr>
    <tr>
      <td>catalog</td>
      <td>catalog ê¸°ëŠ¥ì´ ìˆëŠ” ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ catalogë¥¼ ë§¤í•‘í•œë‹¤.</td>
      <td>Â </td>
    </tr>
    <tr>
      <td>schema</td>
      <td>schema ê¸°ëŠ¥ì´ ìˆëŠ” ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ schemaë¥¼ ë§¤í•‘í•œë‹¤.</td>
      <td>Â </td>
    </tr>
    <tr>
      <td>uniqueConstraints</td>
      <td>DDL ìƒì„± ì‹œ ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ì„ ë§Œë“ ë‹¤. 2ê°œ ì´ìƒì˜ ë³µí•© ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ë„ ë§Œë“¤ ìˆ˜ ìˆë‹¤. ì´ ê¸°ëŠ¥ì€ ìŠ¤í‚¤ë§ˆ ìë™ ìƒì„± ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ì„œ DDLì„ ë§Œë“¤ ë•Œë§Œ ì‚¬ìš©ëœë‹¤.</td>
      <td>Â </td>
    </tr>
  </tbody>
</table>

<p><br />
<br /></p>

<h2 id="43-ë‹¤ì–‘í•œ-ë§¤í•‘-ì‚¬ìš©">4.3 ë‹¤ì–‘í•œ ë§¤í•‘ ì‚¬ìš©</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"MEMBER"</span><span class="o">,</span>
    <span class="n">uniqueConstraints</span> <span class="o">=</span> <span class="o">{</span><span class="nd">@UniqueConstraint</span><span class="o">(</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">"NAME_AGE_UNIQUE"</span><span class="o">,</span>
        <span class="n">columnNames</span> <span class="o">=</span> <span class="o">{</span><span class="s">"NAME"</span><span class="o">,</span> <span class="s">"AGE"</span><span class="o">}</span> 
    <span class="o">)}</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>

    <span class="c1">// enumì„ ì‚¬ìš©í•˜ë ¤ë©´ @Enumerated ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ë§¤í•‘</span>
    <span class="nd">@Enumerated</span><span class="o">(</span><span class="nc">EnumType</span><span class="o">.</span><span class="na">STRING</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">RoleType</span> <span class="n">roleType</span><span class="o">;</span>

    <span class="c1">// ìë°”ì˜ ë‚ ì§œ íƒ€ì…ì€ @Temporal ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ë§¤í•‘</span>
    <span class="nd">@Temporal</span><span class="o">(</span><span class="nc">TemporalType</span><span class="o">.</span><span class="na">TIMESTAMP</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Date</span> <span class="n">createdDate</span><span class="o">;</span>

    <span class="c1">// CLOB, BLOBíƒ€ì…ì€ @Lob ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ë§¤í•‘</span>
    <span class="nd">@Lob</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">description</span><span class="o">;</span>

    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h2 id="44-ë°ì´í„°ë² ì´ìŠ¤-ìŠ¤í‚¤ë§ˆ-ìë™-ìƒì„±">4.4 ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ìë™ ìƒì„±</h2>
<p>JPAëŠ” ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•˜ëŠ” ê¸°ëŠ¥ì„ ì§€ì›í•œë‹¤.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- ìŠ¤í‚¤ë§ˆ ìë™ ìƒì„± --&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"hibernate.hbm2ddl.auto"</span> <span class="na">value=</span><span class="s">"create"</span> <span class="nt">/&gt;</span>

<span class="c">&lt;!-- ì½˜ì†”ì— í…Œì´ë¸” ìƒì„± DDL ì¶œë ¥ --&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"hibernate.show_sql"</span> <span class="na">value=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>hibernate.hbm2ddl.auto ì†ì„±</strong></p>

<table>
  <thead>
    <tr>
      <th><strong>ì˜µì…˜</strong></th>
      <th><strong>ì„¤ëª…</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>create</td>
      <td>ê¸°ì¡´ í…Œì´ë¸”ì„ ì‚­ì œí•˜ê³  ìƒˆë¡œ ìƒì„±í•œë‹¤. DROP + CREATE</td>
    </tr>
    <tr>
      <td>create-drop</td>
      <td>create ì†ì„±ì— ì¶”ê°€ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¢…ë£Œí•  ë•Œ ìƒì„±í•œ DDLì„ ì œê±°í•œë‹¤. DROP + CREATE + DROP</td>
    </tr>
    <tr>
      <td>update</td>
      <td>ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ê³¼ ì—”í‹°í‹° ë§¤í•‘ì •ë³´ë¥¼ ë¹„êµí•´ì„œ ë³€ê²½ ì‚¬í•­ë§Œ ìˆ˜ì •í•œë‹¤.</td>
    </tr>
    <tr>
      <td>validate</td>
      <td>ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ê³¼ ì—”í‹°í‹° ë§¤í•‘ì •ë³´ë¥¼ ë¹„êµí•´ì„œ ì°¨ì´ê°€ ìˆìœ¼ë©´ ê²½ê³ ë¥¼ ë‚¨ê¸°ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ì§€ ì•ŠëŠ”ë‹¤.</td>
    </tr>
    <tr>
      <td>none</td>
      <td>ìë™ ìƒì„± ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë ¤ë©´ hibernate.hbm2ddl.auto ì†ì„± ìì²´ë¥¼ ì‚­ì œí•˜ê±°ë‚˜ ìœ íš¨í•˜ì§€ ì•Šì€ ì˜µì…˜ ê°’ì„ ì£¼ë©´ ëœë‹¤.</td>
    </tr>
  </tbody>
</table>

<div class="notice--warning">
<p><strong>hibernate.hbm2ddl.auto ì£¼ì˜ì‚¬í•­</strong><br />
ìš´ì˜ ì„œë²„ì—ì„œëŠ” DDLì„ ìˆ˜ì •í•˜ëŠ” ì˜µì…˜ì€ ì ˆëŒ€ ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤.</p>
<ul>
  <li>ê°œë°œ ì´ˆê¸° ë‹¨ê³„: <code class="language-plaintext highlighter-rouge">create</code>, <code class="language-plaintext highlighter-rouge">update</code></li>
  <li>ì´ˆê¸°í™” ìƒíƒœë¡œ í…ŒìŠ¤íŠ¸, CIì„œë²„: <code class="language-plaintext highlighter-rouge">create</code>, <code class="language-plaintext highlighter-rouge">create-drop</code></li>
  <li>í…ŒìŠ¤íŠ¸ ì„œë²„: <code class="language-plaintext highlighter-rouge">update</code>, <code class="language-plaintext highlighter-rouge">validate</code></li>
  <li>ìŠ¤í…Œì´ì§•, ìš´ì˜ ì„œë²„: <code class="language-plaintext highlighter-rouge">validate</code>, <code class="language-plaintext highlighter-rouge">none</code></li>
</ul>
</div>
<p><br />
<br /></p>

<p><strong>ê¸°ë³¸ ì´ë¦„ ë§¤í•‘ ì „ëµ ë³€ê²½í•˜ê¸°</strong><br />
í…Œì´ë¸” ëª…ì´ë‚˜ ì»¬ëŸ¼ ëª…ì´ ìƒëµë˜ë©´ ìë°”ì˜ ì¹´ë©œ í‘œê¸°ë²•ì„ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì˜ ì–¸ë”ìŠ¤ì½”ì–´ í‘œê¸°ë²•ìœ¼ë¡œ ë§¤í•‘í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="n">property</span> <span class="n">name</span><span class="o">=</span><span class="s">"hibernate.ejb.naming_strategy"</span> <span class="n">value</span><span class="o">=</span><span class="s">"org.hibernate.cfg.ImprovedNamingStrategy"</span> <span class="o">/&gt;</span>
</code></pre></div></div>
<p><br />
<br />
<br /></p>

<h2 id="45-ddl-ìƒì„±-ê¸°ëŠ¥">4.5 DDL ìƒì„± ê¸°ëŠ¥</h2>
<p><strong>ì œì•½ ì¡°ê±´ ì¶”ê°€</strong><br />
ìŠ¤í‚¤ë§ˆ ìë™ ìƒì„±í•˜ê¸°ë¥¼ í†µí•´ DDLì— ì œì•½ì¡°ê±´ì„ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤. ë‹¤ë§Œ <strong>DDLì„ ìë™ ìƒì„±í•  ë•Œë§Œ ì‚¬ìš©ë˜ê³  JPAì˜ ì‹¤í–‰ ë¡œì§ì—ëŠ” ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ”ë‹¤.</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"MEMBER"</span><span class="o">,</span> 
    <span class="cm">/** 
     *  ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ ì¶”ê°€
     *  ALET TABLE MEMBER
     *      ADD CONSTRAINT NAME_AGE_UNIQUE UNIQUE (NAME, AGE)
     */</span>
    <span class="n">uniqueConstraints</span> <span class="o">=</span> <span class="o">{</span><span class="nd">@UniqueConstraint</span><span class="o">(</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">"NAME_AGE_UNIQUE"</span><span class="o">,</span>
        <span class="n">columnNames</span> <span class="o">=</span> <span class="o">{</span><span class="s">"NAME"</span><span class="o">,</span> <span class="s">"AGE"</span><span class="o">}</span> 
    <span class="o">)}</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>

    <span class="c1">// ì»¬ëŸ¼ëª… NAME, not null, ë¬¸ìí¬ê¸° 10</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"NAME"</span><span class="o">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">10</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>

    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h2 id="46-ddl-ìƒì„±-ê¸°ëŠ¥">4.6 DDL ìƒì„± ê¸°ëŠ¥</h2>
<p>JPAê°€ ì œê³µí•˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ê¸°ë³¸ í‚¤ ìƒì„± ì „ëµì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<ul>
  <li>ì§ì ‘ í• ë‹¹: ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì§ì ‘ í• ë‹¹</li>
  <li>ìë™ ìƒì„±: ëŒ€ë¦¬ í‚¤ ì‚¬ìš© ë°©ì‹
    <ul>
      <li>IDENTITY: ê¸°ë³¸ í‚¤ ìƒì„±ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ìœ„ì„</li>
      <li>SEQUENCE: ë°ì´í„°ë² ì´ìŠ¤ ì‹œí€€ìŠ¤ë¥¼ ì‚¬ìš©</li>
      <li>TABLE: í‚¤ ìƒì„± í…Œì´ë¸”ì„ ì‚¬ìš©</li>
    </ul>
  </li>
</ul>

<p>ìë™ ìƒì„± ì „ëµì´ ë‹¤ì–‘í•œ ì´ìœ ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ë²¤ë”ë§ˆë‹¤ ì§€ì›í•˜ëŠ” ë°©ì‹ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì´ë‹¤. í‚¤ ìƒì„± ì „ëµì„ ì‚¬ìš©í•˜ë ¤ë©´ ë‹¤ìŒ ì†ì„±ì„ ì¶”ê°€í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="n">property</span> <span class="n">name</span><span class="o">=</span><span class="s">"hibernate.id.new_generator_mappings"</span> <span class="n">value</span><span class="o">=</span><span class="s">"true"</span> <span class="o">/&gt;</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="461-ê¸°ë³¸-í‚¤-ì§ì ‘-í• ë‹¹-ì „ëµ">4.6.1 ê¸°ë³¸ í‚¤ ì§ì ‘ í• ë‹¹ ì „ëµ</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Id</span>
<span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ID"</span><span class="o">)</span>
<span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Board</span> <span class="n">board</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Board</span><span class="o">();</span>
<span class="n">board</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="s">"id"</span><span class="o">);</span> <span class="c1">// ê¸°ë³¸ í‚¤ ì§ì ‘ í• ë‹¹</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">board</span><span class="o">);</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="462-identity-ì „ëµ">4.6.2 IDENTITY ì „ëµ</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">IDENTITY</code>ëŠ” ê¸°ë³¸ í‚¤ ìƒì„±ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ìœ„ì„í•˜ëŠ” ì „ëµì´ë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">IDENTITY</code> ì‹ë³„ì ìƒì„± ì „ëµì€ ì—”í‹°í‹°ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•´ì•¼ ì‹ë³„ìë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">em.persist()</code>ë¥¼ í˜¸ì¶œí•˜ëŠ” ì¦‰ì‹œ <code class="language-plaintext highlighter-rouge">INSERT SQL</code>ì´ ë°ì´í„°ë² ì´ìŠ¤ì— ì „ë‹¬ëœë‹¤.</strong></li>
  <li>ë”°ë¼ì„œ <strong>íŠ¸ëœì­ì…˜ì„ ì§€ì›í•˜ëŠ” ì“°ê¸° ì§€ì—°ì´ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.</strong></li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Id</span>
<span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
<span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Board</span> <span class="n">board</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Board</span><span class="o">();</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">board</span><span class="o">);</span>
<span class="n">board</span><span class="o">.</span><span class="na">getId</span><span class="o">();</span> <span class="c1">// 1</span>
</code></pre></div></div>

<div class="notice--info">
<p><strong>ì°¸ê³ </strong><br />
IDENTITY ì „ëµì€ ë°ì´í„°ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— INSERTí•œ í›„ì— ê¸°ë³¸ í‚¤ê°’ì„ ì¡°íšŒí•  ìˆ˜ìˆë‹¤. ë”°ë¼ì„œ ì—”í‹°í‹°ì— ì‹ë³„ì ê°’ì„ í• ë‹¹í•˜ë ¤ë©´ JPAëŠ” ì¶”ê°€ë¡œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¡°íšŒí•´ì•¼ í•œë‹¤. í•˜ì§€ë§Œ <strong>í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” JDBC3ì— ì¶”ê°€ëœ <code class="language-plaintext highlighter-rouge">Statement.getGeneratedKeys()</code> ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•´ì„œ ë°ì´í„°ë² ì´ìŠ¤ì™€ í•œë²ˆë§Œ í†µì‹ í•œë‹¤.</strong></p>
</div>
<p><br />
<br /></p>

<h3 id="463-sequence-ì „ëµ">4.6.3 SEQUENCE ì „ëµ</h3>
<p>SEQUENCE ì „ëµì€ ë°ì´í„°ë² ì´ìŠ¤ ì‹œí€€ìŠ¤ë¥¼ ì´ìš©í•´ ê¸°ë³¸ í‚¤ë¥¼ ìƒì„±í•œë‹¤.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- ë°ì´í„°ë² ì´ìŠ¤ ì‹œí€€ìŠ¤ ìƒì„±</span>
<span class="k">CREATE</span> <span class="n">SEQUENCE</span> <span class="n">BOARD_SEQ</span> <span class="k">START</span> <span class="k">WITH</span> <span class="mi">1</span> <span class="k">INCREMENT</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@SequenceGenerator</span><span class="o">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"BOARD_SEQ_GENERATOR"</span><span class="o">,</span>
    <span class="n">sequenceName</span> <span class="o">=</span> <span class="s">"BOARD_SEQ"</span><span class="o">,</span> <span class="c1">// ë§¤í•‘í•  ë°ì´í„°ë² ì´ìŠ¤ ì‹œí€€ìŠ¤ ì´ë¦„</span>
    <span class="n">initialValue</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span>
    <span class="n">allocationsSize</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BOARD</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span>
        <span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">SEQUENCE</span><span class="o">,</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="s">"BOARD_SEQ_GENERATOR"</span>
    <span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>@SequenceGenerator</strong></p>

<table>
  <thead>
    <tr>
      <th><strong>ì†ì„±</strong></th>
      <th><strong>ê¸°ëŠ¥</strong></th>
      <th><strong>ê¸°ë³¸ê°’</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>name</td>
      <td>ì‹ë³„ì ìƒì„±ê¸° ì´ë¦„</td>
      <td>í•„ìˆ˜</td>
    </tr>
    <tr>
      <td>sequenceName</td>
      <td>ë°ì´í„°ë² ì´ìŠ¤ì— ë“±ë¡ë˜ì–´ ìˆëŠ” ì‹œí€€ìŠ¤ ì´ë¦„</td>
      <td>hibernate_sequence</td>
    </tr>
    <tr>
      <td>initialValue</td>
      <td>DDL ìƒì„± ì‹œì—ë§Œ ì‚¬ìš©ë¨. ì‹œí€€ìŠ¤ DDLì„ ìƒì„±í•  ë•Œ ì²˜ìŒ ì‹œì‘í•˜ëŠ” ìˆ˜ë¥¼ ì§€ì •í•œë‹¤.</td>
      <td>1</td>
    </tr>
    <tr>
      <td>allocationsSize</td>
      <td>ì‹œí€€ìŠ¤ í•œ ë²ˆ í˜¸ì¶œì— ì¦ê°€í•˜ëŠ” ìˆ˜ (ì„±ëŠ¥ ìµœì í™”ì— ì‚¬ìš©ë¨)</td>
      <td>50</td>
    </tr>
    <tr>
      <td>catalog, schema</td>
      <td>ë°ì´í„°ë² ì´ìŠ¤ catalog, schema ì´ë¦„</td>
      <td>Â </td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p><strong>SEQUENCE ì „ëµê³¼ ìµœì í™”</strong><br />
SEQUENCE ì „ëµì€ ë°ì´í„°ë² ì´ìŠ¤ì™€ 2ë²ˆ í†µì‹ í•œë‹¤.</p>
<ol>
  <li>ì‹ë³„ì êµ¬í•˜ê¸° <em>(SELECT BOARD_SEQ.NEXTVAL FROM DUAL)</em></li>
  <li>ì¡°íšŒí•œ ì‹œí€€ìŠ¤ë¥¼ ê¸°ë³¸ í‚¤ ê°’ìœ¼ë¡œ ì‚¬ìš©í•´ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ <em>(INSERT INTO BOARD â€¦)</em></li>
</ol>

<p>JPAëŠ” ì‹œí€€ìŠ¤ ì ‘ê·¼í•˜ëŠ” íšŸìˆ˜ë¥¼ ì¤„ì´ê¸° ìœ„í•´ <code class="language-plaintext highlighter-rouge">@SequenceGenerator.allocationsSize</code>ë¥¼ ì‚¬ìš©í•œë‹¤. ì—¬ê¸°ì— ì„¤ì •í•œ ê°’ë§Œí¼ í•œ ë²ˆì— ì‹œí€€ìŠ¤ ê°’ì„ ì¦ê°€ì‹œí‚¤ê³ , ê·¸ë§Œí¼ ë©”ëª¨ë¦¬ì— ì‹œí€€ìŠ¤ ê°’ì„ í• ë‹¹í•œë‹¤. ì´ ë°©ë²•ì€ ì‹œí€€ìŠ¤ ê°’ì„ ì„ ì í•˜ë¯€ë¡œ ì—¬ëŸ¬ JVMì´ ë™ì‹œì— ë™ì‘í•´ë„ ê¸°ë³¸ í‚¤ ê°’ì´ ì¶©ëŒí•˜ì§€ ì•ŠëŠ”ë‹¤. ë°˜ë©´ì— ì‹œí€€ìŠ¤ ê°’ì„ í•œ ë²ˆì— ë§ì´ ì¦ê°€ì‹œí‚¨ë‹¤. ì´ëŸ° ìƒí™©ì´ ë¶€ë‹´ìŠ¤ëŸ½ê³  <code class="language-plaintext highlighter-rouge">INSERT</code> ì„±ëŠ¥ì´ ì¤‘ìš”í•˜ì§€ ì•Šìœ¼ë©´ <code class="language-plaintext highlighter-rouge">allocationsSize</code>ê°’ì„ 1ë¡œ ì„¤ì •í•œë‹¤.<br />
<br />
<br /></p>

<h3 id="464-table-ì „ëµ">4.6.4 TABLE ì „ëµ</h3>
<p>TABLE ì „ëµì€ í‚¤ ìƒì„± ì „ìš© í…Œì´ë¸”ì„ í•˜ë‚˜ ë§Œë“¤ê³  ì—¬ê¸°ì— ì´ë¦„ê³¼ ê°’ìœ¼ë¡œ ì‚¬ìš©í•  ì»¬ëŸ¼ì„ ë§Œë“¤ì–´ ë°ì´í„°ë² ì´ìŠ¤ ì‹œí€€ìŠ¤ë¥¼ í‰ë‚´ë‚´ëŠ” ì „ëµì´ë‹¤.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- ë°ì´í„°ë² ì´ìŠ¤ í‚¤ ìƒì„± ìš©ë„ í…Œì´ë¸” ìƒì„±</span>
<span class="k">create</span> <span class="k">table</span> <span class="n">MY_SEQUENCES</span> <span class="p">(</span>
    <span class="n">sequence_name</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
    <span class="n">next_val</span> <span class="nb">bigint</span><span class="p">,</span>
    <span class="k">primary</span> <span class="k">key</span> <span class="p">(</span><span class="n">sequence_name</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@TableGenerator</span><span class="o">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"BOARD_SEQ_GENERATOR"</span><span class="o">,</span>
    <span class="n">table</span> <span class="o">=</span> <span class="s">"MY_SEQUENCES"</span><span class="o">,</span>
    <span class="n">pkColumnValue</span> <span class="o">=</span> <span class="s">"BOARD_SEQ"</span><span class="o">,</span>
    <span class="n">allocationsSize</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BOARD</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span>
        <span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">TABLE</span><span class="o">,</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="s">"BOARD_SEQ_GENERATOR"</span>
    <span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<p><strong>@TableGenerator</strong></p>

<table>
  <thead>
    <tr>
      <th><strong>ì†ì„±</strong></th>
      <th><strong>ê¸°ëŠ¥</strong></th>
      <th><strong>ê¸°ë³¸ê°’</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>name</td>
      <td>ì‹ë³„ì ìƒì„±ê¸° ì´ë¦„</td>
      <td>í•„ìˆ˜</td>
    </tr>
    <tr>
      <td>table</td>
      <td>í‚¤ìƒì„± í…Œì´ë¸”ëª…</td>
      <td>hibernate_sequences</td>
    </tr>
    <tr>
      <td>pkColumnName</td>
      <td>ì‹œí€€ìŠ¤ ì»¬ëŸ¼ëª…</td>
      <td>sequence_name</td>
    </tr>
    <tr>
      <td>valueColumnName</td>
      <td>ì‹œí€€ìŠ¤ ê°’ ì»¬ëŸ¼ëª…</td>
      <td>next_val</td>
    </tr>
    <tr>
      <td>pkColumnValue</td>
      <td>í‚¤ë¡œ ì‚¬ìš©í•  ê°’ ì´ë¦„</td>
      <td>ì—”í‹°í‹° ì´ë¦„</td>
    </tr>
    <tr>
      <td>initialValue</td>
      <td>ì´ˆê¸° ê°’, ë§ˆì§€ë§‰ìœ¼ë¡œ ìƒì„±ëœ ê°’ì´ ê¸°ì¤€ì´ë‹¤.</td>
      <td>0</td>
    </tr>
    <tr>
      <td>allocationsSize</td>
      <td>ì‹œí€€ìŠ¤ í•œ ë²ˆ í˜¸ì¶œì— ì¦ê°€í•˜ëŠ” ìˆ˜ (ì„±ëŠ¥ ìµœì í™”ì— ì‚¬ìš©ë¨)</td>
      <td>50</td>
    </tr>
    <tr>
      <td>catalog, schema</td>
      <td>ë°ì´í„°ë² ì´ìŠ¤ catalog, schema ì´ë¦„</td>
      <td>Â </td>
    </tr>
    <tr>
      <td>uniqueConstraints(DDL)</td>
      <td>ìœ ë‹ˆí¬ ì œì•½ ì¡°ê±´ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤.</td>
      <td>Â </td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p><strong>TABLE ì „ëµê³¼ ìµœì í™”</strong><br />
TABLE ì „ëµì€ ê°’ì„ ì¡°íšŒí•˜ë©´ì„œ SELECT ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ê³ , ë‹¤ìŒ ê°’ìœ¼ë¡œ ì¦ê°€ì‹œí‚¤ê¸° ìœ„í•´ UPDATE ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•œë‹¤. SEQUENCE ì „ëµê³¼ ë¹„êµí•´ì„œ ë°ì´í„°ë² ì´ìŠ¤ì™€ í•œ ë²ˆ ë” í†µì‹ í•˜ëŠ” ë‹¨ì ì´ ìˆë‹¤.<br />
<br />
<br /></p>

<h3 id="465-auto-ì „ëµ">4.6.5 AUTO ì „ëµ</h3>
<p>ë°ì´í„°ë² ì´ìŠ¤ì˜ ë°©ì–¸ì— ë”°ë¼ IDENTITY, SEQUENCE, TABLE ì „ëµ ì¤‘ í•˜ë‚˜ë¥¼ ìë™ìœ¼ë¡œ ì„ íƒí•œë‹¤. <strong><code class="language-plaintext highlighter-rouge">@GeneratedValue.strategy</code>ì˜ ê¸°ë³¸ê°’ì€ <code class="language-plaintext highlighter-rouge">AUTO</code>ë‹¤.</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
<span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="466-ê¸°ë³¸-í‚¤-ë§¤í•‘-ì •ë¦¬">4.6.6 ê¸°ë³¸ í‚¤ ë§¤í•‘ ì •ë¦¬</h3>
<ul>
  <li>ì§ì ‘ í• ë‹¹: ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì§ì ‘ ì‹ë³„ì ê°’ì„ í• ë‹¹</li>
  <li>SEQUENCE: ë°ì´í„°ë² ì´ìŠ¤ ì‹œí€€ìŠ¤ì—ì„œ ì‹ë³„ì ê°’ì„ íšë“ í›„ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥</li>
  <li>TABLE: ë°ì´í„°ë² ì´ìŠ¤ ì‹œí€€ìŠ¤ ìƒì„±ìš© í…Œì´ë¸”ì—ì„œ ì‹ë³„ì ê°’ì„ íšë“± í›„ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥</li>
  <li>IDENTITY: ë°ì´í„°ë² ì´ìŠ¤ì— ì—”í‹°í‹°ë¥¼ ì €ì¥í•´ì„œ ì‹ë³„ì ê°’ì„ íšë“í•œ í›„ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥<br />
<br /></li>
</ul>

<p><strong>ì‹ë³„ì ì„ íƒ ì „ëµ</strong><br />
í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ë¥¼ ì„ íƒí•˜ëŠ” ì „ëµì€ í¬ê²Œ 2ê°€ì§€ê°€ ìˆë‹¤.</p>
<ol>
  <li>ìì—° í‚¤(natural key)
    <ul>
      <li>ë¹„ì¦ˆë‹ˆìŠ¤ì— ì˜ë¯¸ê°€ ìˆëŠ” í‚¤</li>
      <li>ì˜ˆ) ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸, ì´ë©”ì¼, ì „í™”ë²ˆí˜¸</li>
    </ul>
  </li>
  <li>ëŒ€ë¦¬ í‚¤(surrogate key)
    <ul>
      <li>ë¹„ì¦ˆë‹ˆìŠ¤ì™€ ê´€ë ¨ì´ ì—†ëŠ” ì„ì˜ë¡œ ë§Œë“¤ì–´ì§„ í‚¤, ëŒ€ì²´ í‚¤ë¡œë„ ë¶ˆë¦°ë‹¤</li>
      <li>ì˜ˆ) ì˜¤ë¼í´ ì‹œí€€ìŠ¤, auto_increment, í‚¤ ìƒì„± í…Œì´ë¸” ì‚¬ìš©</li>
    </ul>
  </li>
</ol>

<div class="notice--info">
<p><strong>ê¶Œì¥í•˜ëŠ” ì‹ë³„ì ì„ íƒ ì „ëµ</strong><br />
ìì—° í‚¤ë³´ë‹¤ëŠ” <strong>ëŒ€ë¦¬ í‚¤ë¥¼ ê¶Œì¥</strong>í•œë‹¤.</p>
<ul>
  <li>ìì—° í‚¤ëŠ” ë³€ê²½ë  ìˆ˜ ìˆë‹¤.</li>
  <li>ë¹„ì¦ˆë‹ˆìŠ¤ í™˜ê²½ì€ ì–¸ì  ê°€ ë³€í•œë‹¤.</li>
  <li>í…Œì´ë¸”ì€ í•œ ë²ˆ ì •ì˜í•˜ë©´ ë³€ê²½í•˜ê¸° ì–´ë µë‹¤.</li>
</ul>
</div>
<p><br />
<br />
<br /></p>

<h2 id="47-í•„ë“œì™€-ì»¬ëŸ¼-ë§¤í•‘-ë ˆí¼ëŸ°ìŠ¤">4.7 í•„ë“œì™€ ì»¬ëŸ¼ ë§¤í•‘: ë ˆí¼ëŸ°ìŠ¤</h2>
<table>
    <thead>
        <tr>
            <th>ë¶„ë¥˜</th>
            <th>ë§¤í•‘ ì–´ë…¸í…Œì´ì…˜</th>
            <th>ì„¤ëª…</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td rowspan="5">í•„ë“œì™€ ì»¬ëŸ¼ ë§¤í•‘</td>
            <td>@Column</td>
            <td>ì»¬ëŸ¼ì„ ë§¤í•‘í•œë‹¤.</td>
        </tr>
        <tr>
            <td>@Enumerated</td>
            <td>ìë°”ì˜ enum íƒ€ì…ì„ ë§¤í•‘í•œë‹¤.</td>
        </tr>
        <tr>
            <td>@Temporal</td>
            <td>ë‚ ì§œ íƒ€ì…ì„ ë§¤í•‘í•œë‹¤.</td>
        </tr>
        <tr>
            <td>@Lob</td>
            <td>BLOB, CLOB íƒ€ì…ì„ ë§¤í•‘í•œë‹¤.</td>
        </tr>
        <tr>
            <td>@Transient</td>
            <td>íŠ¹ì • í•„ë“œë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ë§¤í•‘í•˜ì§€ ì•ŠëŠ”ë‹¤.</td>
        </tr>
        <tr>
            <td>ê¸°íƒ€</td>
            <td>@Access</td>
            <td>JPAê°€ ì—”í‹°í‹°ì— ì ‘ê·¼í•˜ëŠ” ë°©ì‹ì„ ì§€ì •í•œë‹¤.</td>
        </tr>
    </tbody>
</table>
<p><br />
<br /></p>

<h3 id="471-column">4.7.1 @Column</h3>
<p>@Columnì€ ê°ì²´ í•„ë“œë¥¼ í…Œì´ë¸” ì»¬ëŸ¼ì— ë§¤í•‘í•œë‹¤.</p>

<table>
  <thead>
    <tr>
      <th><strong>ì†ì„±</strong></th>
      <th><strong>ê¸°ëŠ¥</strong></th>
      <th><strong>ê¸°ë³¸ê°’</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>name</td>
      <td>í•„ë“œì™€ ë§¤í•‘í•  í…Œì´ë¸”ì˜ ì»¬ëŸ¼ ì´ë¦„</td>
      <td>ê°ì²´ì˜ í•„ë“œ ì´ë¦„</td>
    </tr>
    <tr>
      <td>insertable (ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)</td>
      <td>ì—”í‹°í‹° ì €ì¥ ì‹œ ì´ í•„ë“œë„ ê°™ì´ ì €ì¥í•œë‹¤. falseë¡œ ì„¤ì •í•˜ë©´ ì´ í•„ë“œëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ì§€ ì•ŠëŠ”ë‹¤.</td>
      <td>true</td>
    </tr>
    <tr>
      <td>updatable (ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)</td>
      <td>ì—”í‹°í‹° ìˆ˜ì • ì‹œ ì´ í•„ë“œë„ ê°™ì´ ìˆ˜ì •í•œë‹¤. falseë¡œ ì„¤ì •í•˜ë©´ ì´ í•„ë“œëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— ìˆ˜ì •í•˜ì§€ ì•ŠëŠ”ë‹¤.</td>
      <td>true</td>
    </tr>
    <tr>
      <td>table (ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)</td>
      <td>í•˜ë‚˜ì˜ ì—”í‹°í‹°ë¥¼ ë‘ ê°œ ì´ìƒì˜ í…Œì´ë¸”ì— ë§¤í•‘í•  ë•Œ ì‚¬ìš©í•œë‹¤. ì§€ì •í•œ í•„ë“œë¥¼ ë‹¤ë¥¸ í…Œì´ë¸”ì— ë§¤í•‘í•  ìˆ˜ ìˆë‹¤.</td>
      <td>í˜„ì¬ í´ë˜ìŠ¤ê°€ ë§¤í•‘ëœ í…Œì´ë¸”</td>
    </tr>
    <tr>
      <td>nullable (DDL)</td>
      <td>null ê°’ì˜ í—ˆìš© ì—¬ë¶€ ì„¤ì •.</td>
      <td>true</td>
    </tr>
    <tr>
      <td>unique (DDL)</td>
      <td>@Tableì˜ uniqueConstraintsì™€ ê°™ì§€ë§Œ í•œ ì»¬ëŸ¼ì— ê°„ë‹¨íˆ ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ì„ ê±¸ ë•Œ ì‚¬ìš©í•œë‹¤. ë§Œì•½ ë‘ ì»¬ëŸ¼ ì´ìƒì„ ì‚¬ìš©í•´ì„œ ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ì„ ì‚¬ìš©í•˜ë ¤ë©´ @Table.uniqueConstraintsë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</td>
      <td>Â </td>
    </tr>
    <tr>
      <td>length (DDL)</td>
      <td>ë¬¸ì ê¸¸ì´ ì œì•½ì¡°ê±´, String íƒ€ì…ì—ë§Œ ì‚¬ìš©í•œë‹¤.</td>
      <td>255</td>
    </tr>
    <tr>
      <td>precision, scale (DDL)</td>
      <td>BigDecimal íƒ€ì…ì—ì„œ ì‚¬ìš©í•œë‹¤. precisionì€ ì†Œìˆ˜ì ì„ í¬í•¨í•œ ì „ì²´ ìë¦¿ìˆ˜, scaleì€ ì†Œìˆ˜ì˜ ìë¦¿ìˆ˜ë‹¤. double, floatíƒ€ì…ì—ëŠ” ì ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.</td>
      <td>precision = 19, scale=2</td>
    </tr>
    <tr>
      <td>columnDefinition</td>
      <td>ë°ì´í„°ë² ì´ìŠ¤ ì»¬ëŸ¼ ì •ë³´ë¥¼ ì§ì ‘ ì¤„ ìˆ˜ ìˆë‹¤.</td>
      <td>í•„ë“œì˜ ìë°” íƒ€ì…ê³¼ ë°©ì–¸ ì •ë³´ë¥¼ ì‚¬ìš©í•´ì„œ ì ì ˆí•œ ì»¬ëŸ¼ íƒ€ì…ì„ ìƒì„±í•œë‹¤.</td>
    </tr>
  </tbody>
</table>

<p><br />
<br /></p>

<h3 id="472-enumerated">4.7.2 @Enumerated</h3>
<p>ìë°”ì˜ enum íƒ€ì…ì„ ë§¤í•‘í•  ë•Œ ì‚¬ìš©í•œë‹¤.</p>
<table>
    <thead>
        <tr>
            <th>ì†ì„±</th>
            <th>ê¸°ëŠ¥</th>
            <th>ê¸°ë³¸ê°’</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>value</td>
            <td style="word-break:break-all">EnumType.ORDINAL: enum ìˆœì„œë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ <br />
            EnumType.STRING: enum ì´ë¦„ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥
            </td>
            <td>EnumType.ORDINAL</td>
        </tr>
    </tbody>
</table>
<p><br />
<br /></p>

<h3 id="473-temporal">4.7.3 @Temporal</h3>
<p>ë‚ ì§œ íƒ€ì…(<code class="language-plaintext highlighter-rouge">java.util.Date</code>, <code class="language-plaintext highlighter-rouge">java.util.Calendar</code>)ì„ ë§¤í•‘í•  ë•Œ ì‚¬ìš©í•œë‹¤.</p>
<table>
    <thead>
        <tr>
            <th>ì†ì„±</th>
            <th>ê¸°ëŠ¥</th>
            <th>ê¸°ë³¸ê°’</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>value</td>
            <td style="word-break:break-all">
            - TemporalType.DATE: ë‚ ì§œ, ë°ì´í„°ë² ì´ìŠ¤ date íƒ€ì…ê³¼ ë§¤í•‘ (ì˜ˆ: 2013-10-11)
            <br />
            - TemporalType.TIME: ì‹œê°„, ë°ì´í„°ë² ì´ìŠ¤ time íƒ€ì…ê³¼ ë§¤í•‘ (ì˜ˆ: 11:11:11)
            <br />
            - TemporalType.TIMESTAMP: ë‚ ì§œì™€ ì‹œê°„, ë°ì´í„°ë² ì´ìŠ¤ timestamp íƒ€ì…ê³¼ ë§¤í•‘ (ì˜ˆ: 2013-10-11 11:11:11)
            </td>
            <td>TemporalTypeì€ í•„ìˆ˜ ì§€ì •</td>
        </tr>
    </tbody>
</table>
<p><br /></p>

<h3 id="474-lob">4.7.4 @Lob</h3>
<p>ë°ì´í„°ë² ì´ìŠ¤ BLOB, CLOB íƒ€ì…ê³¼ ë§¤í•‘í•œë‹¤. ë§¤í•‘í•˜ëŠ” í•„ë“œ íƒ€ì…ì— ë”°ë¼ ë§¤í•‘ì„ ë‹¬ë¦¬í•œë‹¤.</p>
<ul>
  <li>CLOB: String, char[], java.sql.CLOB</li>
  <li>BLOB: byte[], java.sql.BLOB<br />
<br />
<br /></li>
</ul>

<h3 id="475-transient">4.7.5 @Transient</h3>
<p>ì´ í•„ë“œëŠ” ë§¤í•‘í•˜ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ì§€ ì•Šê³  ì¡°íšŒí•˜ì§€ ì•ŠëŠ”ë‹¤.<br />
<br />
<br /></p>

<h3 id="476-access">4.7.6 @Access</h3>
<p>JPAê°€ ì—”í‹°í‹° ë°ì´í„°ì— ì ‘ê·¼í•˜ëŠ” ë°©ì‹ì„ ì§€ì •í•œë‹¤.</p>
<ul>
  <li>AccessType.FIELD: í•„ë“œ ì ‘ê·¼</li>
  <li>AccessType.PROPERTY: í”„ë¡œí¼í‹° ì ‘ê·¼, ì ‘ê·¼ì(Getter) ì‚¬ìš©</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Access</span><span class="o">(</span><span class="nc">AccessType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{...}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Access</span><span class="o">(</span><span class="nc">AccessType</span><span class="o">.</span><span class="na">PROPERTY</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{...}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * ë‘ ì ‘ê·¼ ë°©ì‹ì„ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ë„ ìˆë‹¤.
 *
 * @IdëŠ” í•„ë“œ ì ‘ê·¼ ë°©ì‹
 * getFullName()ëŠ” í”„ë¡œí¼í‹° ì ‘ê·¼ ë°©ì‹
 * Member ì—”í‹°í‹°ë¥¼ ì €ì¥í•˜ë©´ í…Œì´ë¸”ì˜ FULLNAME ì»¬ëŸ¼ì—
 * firstName + lastNameì˜ ê²°ê³¼ê°€ ì €ì¥ëœë‹¤.
 */</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    
    <span class="nd">@Id</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@Transient</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">firstName</span><span class="o">;</span>

    <span class="nd">@Transient</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">lastName</span><span class="o">;</span>

    <span class="nd">@Access</span><span class="o">(</span><span class="nc">AccessType</span><span class="o">.</span><span class="na">PROPERTY</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getFullName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">firstName</span> <span class="o">+</span> <span class="n">lastName</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br />
<br />
<br />
<br /></p>

<h1 id="5-ì—°ê´€ê´€ê³„-ë§¤í•‘-ê¸°ì´ˆ">5. ì—°ê´€ê´€ê³„ ë§¤í•‘ ê¸°ì´ˆ</h1>
<p>ì—°ê´€ê´€ê³„ ë§¤í•‘ í‚¤ì›Œë“œ ì •ë¦¬</p>
<ul>
  <li>ë°©í–¥(Direction): <strong>[ë‹¨ë°©í–¥, ì–‘ë°©í–¥]</strong>ì´ ìˆë‹¤. ë°©í–¥ì€ ê°ì²´ê´€ê³„ì—ì„œë§Œ ì¡´ì¬í•˜ê³  í…Œì´ë¸” ê´€ê³„ëŠ” í•­ìƒ ì–‘ë°©í–¥ì´ë‹¤.</li>
  <li>ë‹¤ì¤‘ì„±(Multiplcity): <strong>[ë‹¤ëŒ€ì¼(N:1), ì¼ëŒ€ë‹¤(1:N), ì¼ëŒ€ì¼(1:1), ë‹¤ëŒ€ë‹¤(N:M)]</strong> ë‹¤ì¤‘ì„±ì´ ìˆë‹¤.</li>
  <li>ì—°ê´€ê´€ê³„ ì£¼ì¸(Owner): <strong>ê°ì²´ë¥¼ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¡œ ë§Œë“¤ë©´ ì—°ê´€ê´€ê³„ ì£¼ì¸ì„ ì •í•´ì•¼ í•œë‹¤.</strong><br />
<br />
<br /></li>
</ul>

<h2 id="51-ë‹¨ë°©í–¥-ì—°ê´€ê´€ê³„">5.1 ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„</h2>
<center><img src="/assets/images/posts/books/2/5_1_ê°ì²´í…Œì´ë¸”ì—°ê´€ê´€ê³„.png" width="100%" height="100%" /></center>
<p><br /></p>

<p><strong>ê°ì²´ ì—°ê´€ê´€ê³„ì™€ í…Œì´ë¸” ì—°ê´€ê´€ê³„ì˜ ì°¨ì´</strong></p>
<ul>
  <li>ê°ì²´
    <ul>
      <li>ì°¸ì¡°(ì£¼ì†Œ)ë¡œ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.</li>
      <li>ì–¸ì œë‚˜ ë‹¨ë°©í–¥</li>
      <li>ì–‘ë°©í–¥ì„ í•˜ë ¤ë©´ ì„œë¡œë‹¤ë¥¸ ë‹¨ë°©í–¥ ê´€ê³„ 2ê°œë¡œ êµ¬í˜„</li>
    </ul>
  </li>
  <li>í…Œì´ë¸”
    <ul>
      <li>ì™¸ë˜ í‚¤ë¡œ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.</li>
      <li>ì™¸ë˜ í‚¤ í•˜ë‚˜ë¡œ ì–‘ë°©í–¥ ì¡°ì¸ ê°€ëŠ¥<br />
<br />
<br /></li>
    </ul>
  </li>
</ul>

<h3 id="511-ìˆœìˆ˜í•œ-ê°ì²´-ì—°ê´€ê´€ê³„">5.1.1 ìˆœìˆ˜í•œ ê°ì²´ ì—°ê´€ê´€ê³„</h3>
<p>ê°ì²´ ì°¸ì¡°ë¥¼ ì‚¬ìš©í•´ì„œ ì—°ê´€ê´€ê³„ë¥¼ íƒìƒ‰í•  ìˆ˜ ìˆëŠ”ë° ì´ê²ƒì„ <strong>ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰</strong>ì´ë¼ í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Member</span> <span class="n">member1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Memeber</span><span class="o">(</span><span class="s">"member1"</span><span class="o">,</span> <span class="s">"íšŒì›1"</span><span class="o">);</span>
    <span class="nc">Member</span> <span class="n">member2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Memeber</span><span class="o">(</span><span class="s">"member2"</span><span class="o">,</span> <span class="s">"íšŒì›1"</span><span class="o">);</span>
    <span class="nc">Team</span> <span class="n">team</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Team</span><span class="o">(</span><span class="s">"team"</span><span class="o">,</span> <span class="s">"íŒ€"</span><span class="o">);</span>

    <span class="n">member1</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="n">team</span><span class="o">);</span>
    <span class="n">member2</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="n">team</span><span class="o">);</span>

    <span class="c1">// ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰</span>
    <span class="nc">Team</span> <span class="n">findTeam</span> <span class="o">=</span> <span class="n">member1</span><span class="o">.</span><span class="na">getTeam</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="512-í…Œì´ë¸”-ì—°ê´€ê´€ê³„">5.1.2 í…Œì´ë¸” ì—°ê´€ê´€ê³„</h3>
<p>ì™¸ë˜ í‚¤ë¥¼ ì‚¬ìš©í•´ì„œ ì—°ê´€ê´€ê³„ë¥¼ íƒìƒ‰í•  ìˆ˜ ì‡ëŠ”ë° ì´ê²ƒì„ ì¡°ì¸ì´ë¼ í•œë‹¤.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">T</span><span class="p">.</span><span class="o">*</span>
<span class="k">FROM</span> <span class="n">MEMBER</span> <span class="n">M</span>
    <span class="k">JOIN</span> <span class="n">TEAM</span> <span class="n">T</span> <span class="k">ON</span> <span class="n">M</span><span class="p">.</span><span class="n">TEAM_ID</span> <span class="o">=</span> <span class="n">T</span><span class="p">.</span><span class="n">ID</span>
<span class="k">WHERE</span> <span class="n">M</span><span class="p">.</span><span class="n">MEMBER_ID</span> <span class="o">=</span> <span class="s1">'member1'</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="513-ê°ì²´-ê´€ê³„-ë§¤í•‘">5.1.3 ê°ì²´ ê´€ê³„ ë§¤í•‘</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>

    <span class="c1">//ì—°ê´€ ê´€ê³„ ë§¤í•‘</span>
    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"TEAM_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Team</span> <span class="n">team</span><span class="o">;</span>

    <span class="c1">//ì—°ê´€ê´€ê³„ ì„¤ì •</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTeam</span><span class="o">(</span><span class="nc">Team</span> <span class="n">team</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">team</span> <span class="o">=</span> <span class="n">team</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Team</span> <span class="o">{</span>
    
    <span class="nd">@Id</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"TEAM_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>@ManyToOne</strong></p>
<ul>
  <li>ë‹¤ëŒ€ì¼(N:1) ê´€ê³„ë¼ëŠ” ë§¤í•‘ ì •ë³´</li>
  <li>ì—°ê´€ê´€ê³„ ë§¤í•‘í•  ë•Œ ë‹¤ì¤‘ì„±ì„ ë‚˜íƒ€ë‚´ëŠ” ì–´ë…¸í…Œì´ì…˜ í•„ìˆ˜ë¡œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.<br />
<br /></li>
</ul>

<p><strong>@JoinColumn(name=â€TEAM_IDâ€)</strong></p>
<ul>
  <li>ì¡°ì¸ì»¬ëŸ¼ì€ ì™¸ë˜ í‚¤ë¥¼ ë§¤í•‘í•  ë•Œ ì‚¬ìš©í•œë‹¤.</li>
  <li>name ì†ì„±ì— ë§¤í•‘í•  ì™¸ë˜ í‚¤ ì´ë¦„ì„ ì§€ì •í•œë‹¤. (ì—¬ê¸°ì„  íŒ€ í…Œì´ë¸”ì˜ TEAM_ID)</li>
  <li>ìƒëµí•  ìˆ˜ ìˆë‹¤.<br />
<br />
<br /></li>
</ul>

<h3 id="514-joincolumn">5.1.4 @JoinColumn</h3>
<p>@JoinColumnì€ ì™¸ë˜ í‚¤ë¥¼ ë§¤í•‘í•  ë•Œ ì‚¬ìš©í•œë‹¤.</p>

<table>
  <thead>
    <tr>
      <th><strong>ì†ì„±</strong></th>
      <th><strong>ê¸°ëŠ¥</strong></th>
      <th><strong>ê¸°ë³¸ê°’</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>name</td>
      <td>ë§¤í•‘í•  ì™¸ë˜ í‚¤ ì´ë¦„</td>
      <td>í•„ë“œëª… + _ + ì°¸ì¡°í•˜ëŠ” í…Œì´ë¸”ì˜ ì»¬ëŸ¬ëª…</td>
    </tr>
    <tr>
      <td>referencedColumnName</td>
      <td>ì™¸ë˜ í‚¤ê°€ ì°¸ì¡°í•˜ëŠ” ëŒ€ìƒ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ëª…</td>
      <td>ì°¸ì¡°í•˜ëŠ” í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ ì»¬ëŸ¼ëª…</td>
    </tr>
    <tr>
      <td>foreignKey (DDL)</td>
      <td>ì™¸ë˜ í‚¤ ì œì•½ì¡°ê±´ì„ ì§ì ‘ ì§€ì •í•  ìˆ˜ ìˆë‹¤. ì´ ì†ì„±ì€ í…Œì´ë¸”ì„ ìƒì„±í•  ë•Œë§Œ ì‚¬ìš©í•œë‹¤.</td>
      <td>Â </td>
    </tr>
    <tr>
      <td>unique, nullable, insertable, updatable, columnDefinition, table</td>
      <td>@Columnì˜ ì†ì„±ê³¼ ê°™ë‹¤.</td>
      <td>Â </td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<h3 id="515-manytoone">5.1.5 @ManyToOne</h3>
<p>@ManyToOne ì–´ë…¸í…Œì´ì…˜ì€ ë‹¤ëŒ€ì¼ ê´€ê³„ì—ì„œ ì‚¬ìš©í•œë‹¤.</p>

<table>
  <thead>
    <tr>
      <th><strong>ì†ì„±</strong></th>
      <th><strong>ê¸°ëŠ¥</strong></th>
      <th><strong>ê¸°ë³¸ê°’</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>optional</td>
      <td>falseë¡œ ì„¤ì •í•˜ë©´ ì—°ê´€ëœ ì—”í‹°í‹°ê°€ í•­ìƒ ìˆì–´ì•¼ í•œë‹¤.</td>
      <td>true</td>
    </tr>
    <tr>
      <td>fetch</td>
      <td>ê¸€ë¡œë²Œ í˜ì¹˜ ì „ëµì„ ì„¤ì •í•œë‹¤.</td>
      <td>@ManyToOne=FetchType.EAGER   @OneToMany=FetchType.LAZY</td>
    </tr>
    <tr>
      <td>cascade</td>
      <td>ì˜ì†ì„± ì „ì´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•œë‹¤.</td>
      <td>Â </td>
    </tr>
    <tr>
      <td>targetEntity (ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)</td>
      <td>ì—°ê´€ëœ ì—”í‹°í‹°ì˜ íƒ€ì… ì •ë³´ë¥¼ ì„¤ì •í•œë‹¤. ì´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì»¬ë ‰ì…˜ì„ ì‚¬ìš©í•´ë„ ì œë„¤ë¦­ìœ¼ë¡œ íƒ€ì… ì •ë³´ë¥¼ ì•Œ ìˆ˜ ìˆë‹¤.</td>
      <td>Â </td>
    </tr>
  </tbody>
</table>

<p><br />
<br /></p>

<h2 id="52-ì—°ê´€ê´€ê³„-ì‚¬ìš©">5.2 ì—°ê´€ê´€ê³„ ì‚¬ìš©</h2>
<p>ì—°ê´€ê´€ê³„ë¥¼ ë“±ë¡, ìˆ˜ì •, ì‚­ì œ, ì¡°íšŒí•˜ëŠ” ì˜ˆì œë¥¼ í†µí•´ ì—°ê´€ê´€ê³„ë¥¼ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ”ì§€ ì•Œì•„ë³¸ë‹¤.<br />
<br />
<br /></p>

<h3 id="521-ì €ì¥">5.2.1 ì €ì¥</h3>
<p>JPAì—ì„œ ì—”í‹°í‹°ë¥¼ ì €ì¥í• ë•Œ <strong>ì—°ê´€ëœ ëª¨ë“  ì—”í‹°í‹°ëŠ” ì˜ì† ìƒíƒœ</strong>ì—¬ì•¼ í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">testSave</span><span class="o">()</span> <span class="o">{</span>

    <span class="c1">// íŒ€1 ì €ì¥</span>
    <span class="nc">Team</span> <span class="n">team1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Team</span><span class="o">(</span><span class="s">"team1"</span><span class="o">,</span> <span class="s">"íŒ€1"</span><span class="o">);</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">team1</span><span class="o">);</span>

    <span class="c1">// íšŒì›1 ì €ì¥</span>
    <span class="nc">Member</span> <span class="n">member1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">(</span><span class="s">"member1"</span><span class="o">,</span> <span class="s">"íšŒì›1"</span><span class="o">);</span>
    <span class="n">member1</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="n">team1</span><span class="o">);</span> <span class="c1">//ì—°ê´€ê´€ê³„ ì„¤ì • member1 -&gt; team1</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member1</span><span class="o">);</span>

    <span class="c1">// íšŒì›2 ì €ì¥</span>
    <span class="nc">Member</span> <span class="n">member2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">(</span><span class="s">"member2"</span><span class="o">,</span> <span class="s">"íšŒì›2"</span><span class="o">);</span>
    <span class="n">member2</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="n">team1</span><span class="o">);</span> <span class="c1">//ì—°ê´€ê´€ê³„ ì„¤ì • member2 -&gt; team1</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member2</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="522-ì¡°íšŒ">5.2.2 ì¡°íšŒ</h3>
<p>ì—°ê´€ê´€ê³„ê°€ ìˆëŠ” ì—”í‹°í‹° ì¡°íšŒ ë°©ë²•ì€ í¬ê²Œ 2ê°€ì§€ë‹¤.</p>
<ul>
  <li>ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰(ê°ì²´ ì—°ê´€ê´€ê³„ë¥¼ ì‚¬ìš©í•œ ì¡°íšŒ)</li>
  <li>ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì‚¬ìš©(JPQL)<br />
<br /></li>
</ul>

<p><strong>ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"member1"</span><span class="o">);</span>
<span class="nc">Team</span> <span class="n">team</span> <span class="o">=</span> <span class="n">member</span><span class="o">.</span><span class="na">getTeam</span><span class="o">();</span> <span class="c1">// ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"íŒ€ ì´ë¦„ = "</span> <span class="o">+</span> <span class="n">team</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ê°ì²´ ì§€í–¥ ì¿¼ë¦¬ ì‚¬ìš©</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">testJPQL</span><span class="o">(</span><span class="nc">EntityManager</span> <span class="n">em</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">jpql1</span> <span class="o">=</span> <span class="s">"select m from Member m join m.team t where t.name=:teamName"</span><span class="o">;</span>

    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">jpql1</span><span class="o">,</span> <span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="s">"teamName"</span><span class="o">,</span> <span class="s">"íŒ€1"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>

    <span class="k">for</span> <span class="o">(</span><span class="nc">Member</span> <span class="n">member</span> <span class="o">:</span> <span class="n">resultList</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[query] member.username = "</span> <span class="o">+</span> <span class="n">member</span><span class="o">.</span><span class="na">getUsername</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="cm">/*
* ê²°ê³¼
* [query] member.username=íšŒì›1
* [query] member.username=íšŒì›2
*/</span>
</code></pre></div></div>
<p>ì‹¤í–‰ë˜ëŠ” SQLì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">M</span><span class="p">.</span><span class="o">*</span> <span class="k">FROM</span> <span class="n">MEMBER</span> <span class="n">MEMBER</span> 
<span class="k">INNER</span> <span class="k">JOIN</span> 
    <span class="n">TEAM</span> <span class="n">TEAM</span> <span class="k">ON</span> <span class="n">MEMBER</span><span class="p">.</span><span class="n">TEAM_ID</span> <span class="o">=</span> <span class="n">TEAM1_</span><span class="p">.</span><span class="n">ID</span> 
<span class="k">WHERE</span>
    <span class="n">TEAM1_</span><span class="p">.</span><span class="n">NAME</span><span class="o">=</span><span class="s1">'íŒ€1'</span>
</code></pre></div></div>
<p>ì‹¤í–‰ëœ SQLê³¼ JPQLì„ ë¹„êµí•˜ë©´ <strong>JPQLì€ ê°ì²´(ì—”í‹°í‹°)ë¥¼ ëŒ€ìƒ</strong>ìœ¼ë¡œ í•˜ê³  SQLë³´ë‹¤ ê°„ê²°í•˜ë‹¤.<br />
<br />
<br /></p>

<h3 id="523-ìˆ˜ì •">5.2.3 ìˆ˜ì •</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">updateRelation</span><span class="o">(</span><span class="nc">EntityManager</span> <span class="n">em</span><span class="o">)</span> <span class="o">{</span>

    <span class="c1">// ìƒˆë¡œìš´ íŒ€2</span>
    <span class="nc">Team</span> <span class="n">team2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Team</span><span class="o">(</span><span class="s">"team2"</span><span class="o">,</span> <span class="s">"íŒ€2"</span><span class="o">);</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">team2</span><span class="o">);</span>

    <span class="c1">//íšŒì›1ì— ìƒˆë¡œìš´ íŒ€2 ì„¤ì •</span>
    <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"member1"</span><span class="o">);</span>
    <span class="n">member</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="n">team2</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ì‹¤í–‰ë˜ëŠ” ìˆ˜ì • SQLì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="n">MEMBER</span>
<span class="k">SET</span>
    <span class="n">TEAM_ID</span><span class="o">=</span><span class="s1">'team2'</span><span class="p">,</span> <span class="p">...</span>
<span class="k">WHERE</span> <span class="n">ID</span> <span class="o">=</span> <span class="s1">'member1'</span> 
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="524-ì—°ê´€ê´€ê³„-ì œê±°">5.2.4 ì—°ê´€ê´€ê³„ ì œê±°</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">deleteRelation</span><span class="o">(</span><span class="nc">EntityManager</span> <span class="n">em</span><span class="o">)</span> <span class="o">{</span>

    <span class="nc">Member</span> <span class="n">member1</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"member1"</span><span class="o">);</span>
    <span class="n">member1</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span> <span class="c1">//ì—°ê´€ê´€ê³„ ì œê±°</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ì‹¤í–‰ë˜ëŠ” ì—°ê´€ê´€ê³„ ì œê±° SQLì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="n">MEMBER</span>
<span class="k">SET</span>
    <span class="n">TEAM_ID</span><span class="o">=</span><span class="k">null</span><span class="p">,</span> <span class="p">...</span>
<span class="k">WHERE</span> <span class="n">ID</span> <span class="o">=</span> <span class="s1">'member1'</span> 
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="525-ì—°ê´€ê´€ê³„-ì‚­ì œ">5.2.5 ì—°ê´€ê´€ê³„ ì‚­ì œ</h3>
<p>ì—°ê´€ëœ ì—”í‹°í‹°ë¥¼ ì‚­ì œí•˜ë ¤ë©´ ê¸°ì¡´ì— ìˆë˜ ì—°ê´€ê´€ê³„ë¥¼ ë¨¼ì € ì œê±°í•˜ê³  ì‚­ì œí•´ì•¼ í•œë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì™¸ë˜ í‚¤ ì œì•½ì¡°ê±´ìœ¼ë¡œ ì¸í•´, ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">member1</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span> <span class="c1">// íšŒì›1 ì—°ê´€ê´€ê³„ ì œê±°</span>
<span class="n">member2</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span> <span class="c1">// íšŒì›2 ì—°ê´€ê´€ê³„ ì œê±°</span>
<span class="n">em</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">team</span><span class="o">);</span>       <span class="c1">// íŒ€ ì‚­ì œ</span>
</code></pre></div></div>
<p><br />
<br />
<br /></p>

<h2 id="53-ì–‘ë°©í–¥-ì—°ê´€ê´€ê³„">5.3 ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„</h2>
<p><strong>ê°ì²´</strong></p>
<center><img src="/assets/images/posts/books/2/5_3_ì–‘ë°©í–¥ê°ì²´ì—°ê´€ê´€ê³„1.png" width="100%" height="100%" /></center>

<ul>
  <li>íšŒì›ê³¼ íŒ€ì€ ë‹¤ëŒ€ì¼ ê´€ê³„</li>
  <li>íŒ€ì—ì„œ íšŒì›ì˜ ê´€ê³„ëŠ” ì¼ëŒ€ë‹¤ ê´€ê³„<br />
<br /></li>
</ul>

<p><strong>ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”</strong></p>
<center><img src="/assets/images/posts/books/2/5_3_ì–‘ë°©í–¥í…Œì´ë¸”ì—°ê´€ê´€ê³„.png" width="100%" height="100%" /></center>

<ul>
  <li>ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì€ ì™¸ë˜ í‚¤ í•˜ë‚˜ë¡œ ì–‘ë°©í–¥ ì¡°íšŒ<br />
<br />
<br /></li>
</ul>

<h3 id="531-ì–‘ë°©í•­-ì—°ê´€ê´€ê³„-ë§¤í•‘">5.3.1 ì–‘ë°©í•­ ì—°ê´€ê´€ê³„ ë§¤í•‘</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>

    <span class="c1">// ì—°ê´€ ê´€ê³„ ë§¤í•‘</span>
    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"TEAM_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Team</span> <span class="n">team</span><span class="o">;</span>

    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Team</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>

    <span class="c1">// @OneToMany ë§¤í•‘ ì •ë³´ë¥¼ ì‚¬ìš©í–ˆë‹¤.</span>
    <span class="c1">// mappedBy ì†ì„±ì€ ì–‘ë°©í–¥ ë§¤í•‘ì¼ ë•Œ ì‚¬ìš©í•˜ëŠ”ë° ë°˜ëŒ€ìª½ ë§¤í•‘ì˜ í•„ë“œ ì´ë¦„ì„ ê°’ìœ¼ë¡œ ì£¼ë©´ ëœë‹¤.</span>
    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"team"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;();</span>
    
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>  
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br />
<br /></p>

<h2 id="54-ì—°ê´€ê´€ê³„-ì£¼ì¸">5.4 ì—°ê´€ê´€ê³„ ì£¼ì¸</h2>
<ul>
  <li>ê°ì²´ì—ëŠ” ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¼ëŠ” ê²ƒì´ ì—†ë‹¤.</li>
  <li>ì„œë¡œ ë‹¤ë¥¸ ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„ 2ê°œë¥¼ ì–‘ë°©í–¥ì¸ ê²ƒì²˜ëŸ¼ ë³´ì´ê²Œ í•  ë¿ì´ë‹¤.</li>
  <li>ì—”í‹°í‹°ë¥¼ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¡œ ì„¤ì •í•˜ë©´ ê°ì²´ì˜ ì°¸ì¡°ëŠ” ë‘˜ì¸ë° ì™œë˜ í‚¤ëŠ” í•˜ë‚˜ë‹¤.</li>
  <li>JPAì—ì„œëŠ” <strong>ë‘ ê°ì²´ ì—°ê´€ê´€ê³„ ì¤‘ í•˜ë‚˜ë¥¼ ì •í•´ì„œ í…Œì´ë¸”ì˜ ì™¸ë˜ í‚¤ë¥¼ ê´€ë¦¬í•´ì•¼ í•˜ëŠ”ë° ì´ê²ƒì„ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸</strong>ì´ë¼ í•œë‹¤.<br />
<br />
<br /></li>
</ul>

<h3 id="541-ì–‘ë°©í–¥-ë§¤í•‘ì˜-ê·œì¹™-ì—°ê´€ê´€ê³„ì˜-ì£¼ì¸">5.4.1 ì–‘ë°©í–¥ ë§¤í•‘ì˜ ê·œì¹™: ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸</h3>
<ul>
  <li>ë‘ ì—°ê´€ê´€ê³„ ì¤‘ í•˜ë‚˜ë¥¼ ì—°ê´€ê´€ê³„ ì£¼ì¸ìœ¼ë¡œ ì •í•´ì•¼ í•œë‹¤.</li>
  <li>ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ë§Œì´ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê´€ê´€ê³„ì™€ ë§¤í•‘ë˜ê³  ì™œë˜ í‚¤ë¥¼ ê´€ë¦¬(ë“±ë¡,ìˆ˜ì •,ì‚­ì œ)í•  ìˆ˜ ìˆë‹¤.</li>
  <li>ì£¼ì¸ì´ ì•„ë‹Œ ìª½ì€ ì½ê¸°ë§Œ í•  ìˆ˜ ìˆë‹¤.<br />
<br /></li>
</ul>

<p><strong>mappedBy</strong></p>
<ul>
  <li>ì£¼ì¸ì€ <code class="language-plaintext highlighter-rouge">mappedBy</code> ì†ì„±ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
  <li>ì£¼ì¸ì´ ì•„ë‹ˆë©´ <code class="language-plaintext highlighter-rouge">mappedBy</code> ì†ì„±ì„ ì‚¬ìš©í•´ì„œ ì†ì„±ì˜ ê°’ìœ¼ë¡œ ì—°ê´€ê´€ê³„ ì£¼ì¸ì„ ì§€ì •í•œë‹¤. (â€˜ë‚´ê°€ ìƒëŒ€ì—ê²Œ ë§¤í•‘ë˜ì—ˆë‹¤â€™ë¼ê³  ìƒê°í•˜ë©´ í¸í•¨)<br />
<strong>ì—°ê´€ê´€ê³„ ì£¼ì¸ì„ ì •í•œë‹¤ëŠ” ê²ƒì€ ì™¸ë˜ í‚¤ ê´€ë¦¬ìë¥¼ ì„ íƒí•˜ëŠ” ê²ƒì´ë‹¤.</strong><br />
<br />
<br /></li>
</ul>

<h3 id="542-ì—°ê´€ê´€ê³„ì˜-ì£¼ì¸ì€-ì™¸ë˜-í‚¤ê°€-ìˆëŠ”-ê³³">5.4.2 ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì€ ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ê³³</h3>
<center><img src="/assets/images/posts/books/2/5_4_ì—°ê´€ê´€ê³„ì˜ì£¼ì¸ê³¼ë°˜ëŒ€í¸.png " width="100%" height="100%" /></center>

<ul>
  <li>ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì€ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ê³³ìœ¼ë¡œ ì •í•´ì•¼ í•œë‹¤.</li>
  <li>ë‹¤ëŒ€ì¼, ì¼ëŒ€ë‹¤ ê´€ê³„ì—ì„œëŠ” <strong>í•­ìƒ ë‹¤ ìª½ì´ ì™¸ë˜ í‚¤ë¥¼ ê°€ì§„ë‹¤</strong>.</li>
  <li>ë‹¤ ìª½ì¸ <code class="language-plaintext highlighter-rouge">@ManyToOne</code>ì€ í•­ìƒ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ ë˜ë¯€ë¡œ <code class="language-plaintext highlighter-rouge">mappedBy</code>ë¥¼ ì„¤ì •í•  ìˆ˜ ì—†ë‹¤.</li>
  <li>ë”°ë¼ì„œ <code class="language-plaintext highlighter-rouge">@ManyToOne</code>ì—ëŠ” <code class="language-plaintext highlighter-rouge">mappedBy</code> ì†ì„±ì´ ì—†ë‹¤.<br />
<br />
<br />
<br /></li>
</ul>

<h2 id="55-ì–‘ë°©í–¥-ì—°ê´€ê´€ê³„-ì €ì¥">5.5 ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ ì €ì¥</h2>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">testSave</span><span class="o">()</span> <span class="o">{</span>

    <span class="c1">// íŒ€1 ì €ì¥</span>
    <span class="nc">Team</span> <span class="n">team1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Team</span><span class="o">(</span><span class="s">"team1"</span><span class="o">,</span> <span class="s">"íŒ€1"</span><span class="o">);</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">team1</span><span class="o">);</span>

    <span class="c1">// íšŒì›1 ì €ì¥</span>
    <span class="nc">Member</span> <span class="n">member1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">(</span><span class="s">"member1"</span><span class="o">,</span> <span class="s">"íšŒì›1"</span><span class="o">);</span>
    <span class="n">member1</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="n">team1</span><span class="o">);</span> <span class="c1">//ì—°ê´€ê´€ê³„ ì„¤ì • member1 -&gt; team1</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member1</span><span class="o">);</span>

    <span class="c1">// íšŒì›2 ì €ì¥</span>
    <span class="nc">Member</span> <span class="n">member2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">(</span><span class="s">"member2"</span><span class="o">,</span> <span class="s">"íšŒì›2"</span><span class="o">);</span>
    <span class="n">member2</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="n">team1</span><span class="o">);</span> <span class="c1">//ì—°ê´€ê´€ê³„ ì„¤ì • member2 -&gt; team1</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member2</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì£¼ì¸ì´ ì•„ë‹Œ ê³³ì— ì…ë ¥ëœ ê°’ì€ ì™¸ë˜ í‚¤ì— ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ”ë‹¤. </span>
<span class="n">team1</span><span class="o">.</span><span class="na">getMembers</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">member1</span><span class="o">);</span> <span class="c1">//ë¬´ì‹œ(ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ ì•„ë‹˜)</span>
<span class="n">team1</span><span class="o">.</span><span class="na">getMembers</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">member2</span><span class="o">);</span> <span class="c1">//ë¬´ì‹œ(ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ ì•„ë‹˜)</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Member.teamì€ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ë‹¤.</span>
<span class="c1">// ì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” ì´ê³³ì— ì…ë ¥ëœ ê°’ì„ ì‚¬ìš©í•´ ì™¸ë˜ í‚¤ ê´€ë¦¬í•œë‹¤.</span>
<span class="n">member1</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="n">team1</span><span class="o">);</span> <span class="c1">//ì—°ê´€ê´€ê³„ ì„¤ì •(ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸)</span>
<span class="n">member2</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="n">team1</span><span class="o">);</span> <span class="c1">//ì—°ê´€ê´€ê³„ ì„¤ì •(ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸)</span>
</code></pre></div></div>
<p><br />
<br />
<br /></p>

<h2 id="56-ì–‘ë°©í–¥-ì—°ê´€ê´€ê³„ì˜-ì£¼ì˜ì ">5.6 ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ì˜ ì£¼ì˜ì </h2>
<p>ê°€ì¥ í”í•œ ì‹¤ìˆ˜ëŠ” ì—°ê´€ê´€ê³„ ì£¼ì¸ì—ëŠ” ê°’ì„ ì…ë ¥í•˜ì§€ ì•Šê³ , ì£¼ì¸ì´ ì•„ë‹Œ ê³³ì—ë§Œ ê°’ì„ ì…ë ¥í•˜ëŠ” ê²ƒì´ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">testSaveNonOwner</span><span class="o">()</span> <span class="o">{</span>

    <span class="c1">// íšŒì›1 ì €ì¥</span>
    <span class="nc">Member</span> <span class="n">member1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">(</span><span class="s">"member1"</span><span class="o">,</span> <span class="s">"íšŒì›1"</span><span class="o">);</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member1</span><span class="o">);</span>

    <span class="c1">// íšŒì›2 ì €ì¥</span>
    <span class="nc">Member</span> <span class="n">member2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">(</span><span class="s">"member2"</span><span class="o">,</span> <span class="s">"íšŒì›2"</span><span class="o">);</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member2</span><span class="o">);</span>

    <span class="nc">Team</span> <span class="n">team1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Team</span><span class="o">(</span><span class="s">"team1"</span><span class="o">,</span> <span class="s">"íŒ€1"</span><span class="o">);</span>

    <span class="c1">// ì£¼ì¸ì´ ì•„ë‹Œ ê³³ì— ì—°ê´€ê´€ê³„ ì„¤ì •</span>
    <span class="n">team1</span><span class="o">.</span><span class="na">getMembers</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">member1</span><span class="o">);</span>
    <span class="n">team2</span><span class="o">.</span><span class="na">getMembers</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">member2</span><span class="o">);</span>

    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">team1</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ì¡°íšŒ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<table>
  <thead>
    <tr>
      <th><strong>MEMBER_ID</strong></th>
      <th><strong>USERNAME</strong></th>
      <th><strong>TEAM_ID</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>member1</td>
      <td>íšŒì›1</td>
      <td>null</td>
    </tr>
    <tr>
      <td>member2</td>
      <td>íšŒì›2</td>
      <td>null</td>
    </tr>
  </tbody>
</table>

<p><br />
<br /></p>

<h3 id="561-ìˆœìˆ˜í•œ-ê°ì²´ê¹Œì§€-ê³ ë ¤í•œ-ì–‘ë°©í–¥-ì—°ê´€ê´€ê³„">5.6.1 ìˆœìˆ˜í•œ ê°ì²´ê¹Œì§€ ê³ ë ¤í•œ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„</h3>
<p>ê·¸ë ‡ë‹¤ë©´ ì •ë§ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì—ë§Œ ê°’ì„ ì €ì¥í•˜ê³  ì£¼ì¸ì´ ì•„ë‹Œ ê³³ì—ëŠ” ê°’ì„ ì €ì¥í•˜ì§€ ì•Šì•„ë„ ë ê¹Œ? <strong>ê°ì²´ ê´€ì ì—ì„œëŠ” ì–‘ìª½ ë°©í–¥ ëª¨ë‘ ê°’ì„ ì…ë ¥í•´ì£¼ëŠ” ê²ƒì´ ê°€ì¥ ì•ˆì „í•˜ë‹¤.</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">member1</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="n">team1</span><span class="o">);</span> <span class="c1">// íšŒì› -&gt; íŒ€</span>
<span class="n">team1</span><span class="o">.</span><span class="na">getMembers</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">member1</span><span class="o">);</span> <span class="c1">// íŒ€ -&gt; íšŒì›</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="562-ì—°ê´€ê´€ê³„-í¸ì˜-ë©”ì†Œë“œ">5.6.2 ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì†Œë“œ</h3>
<p>í•œ ë²ˆì— ì–‘ë°©í–¥ ê´€ê³„ë¥¼ ì„¤ì •í•˜ëŠ” ë©”ì†Œë“œë¥¼ ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì†Œë“œë¼ í•œë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ì‹¤ìˆ˜ë„ ì¤„ì–´ë“¤ê³  ì¢€ ë” í¸í•˜ê²Œ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">Team</span> <span class="n">team</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTeam</span><span class="o">(</span><span class="nc">Team</span> <span class="n">team</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">team</span> <span class="o">=</span> <span class="n">team</span><span class="o">;</span>
        <span class="n">team</span><span class="o">.</span><span class="na">getMembers</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="563-ì—°ê´€ê´€ê³„-í¸ì˜-ë©”ì†Œë“œ-ì‘ì„±-ì‹œ-ì£¼ì˜ì‚¬í•­">5.6.3 ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì†Œë“œ ì‘ì„± ì‹œ ì£¼ì˜ì‚¬í•­</h3>
<p>ì—°ê´€ê´€ê³„ë¥¼ ë³€ê²½í•  ë•ŒëŠ” ê¸°ì¡´ íŒ€ì´ ìˆìœ¼ë©´ ê¸°ì¡´ íŒ€ê³¼ íšŒì›ì˜ ì—°ê´€ê´€ê³„ë¥¼ ì‚­ì œí•˜ëŠ” ì½”ë“œë¥¼ ì¶”ê°€í•´ì•¼ í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">member1</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="n">teamA</span><span class="o">);</span> <span class="c1">// 1</span>
<span class="n">member1</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="n">teamB</span><span class="o">);</span> <span class="c1">// 2</span>
<span class="nc">Member</span> <span class="n">findMember</span> <span class="o">=</span> <span class="n">teamA</span><span class="o">.</span><span class="na">getMember</span><span class="o">();</span> <span class="c1">// member1ì´ ì—¬ì „íˆ ì¡°íšŒëœë‹¤.</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTeam</span><span class="o">(</span><span class="nc">Team</span> <span class="n">team</span><span class="o">)</span> <span class="o">{</span>

    <span class="c1">// ê¸°ì¡´ íŒ€ê³¼ ê´€ê³„ë¥¼ ì œê±°</span>
    <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">team</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">team</span><span class="o">.</span><span class="na">getMembers</span><span class="o">().</span><span class="na">remove</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>    
    <span class="k">this</span><span class="o">.</span><span class="na">team</span> <span class="o">=</span> <span class="n">team</span><span class="o">;</span>
    <span class="n">team</span><span class="o">.</span><span class="na">getMembers</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br />
<br /></p>

<h2 id="57-ì •ë¦¬">5.7 ì •ë¦¬</h2>
<ul>
  <li>ë‹¨ë°©í–¥ ë§¤í•‘ì€ ì–¸ì œë‚˜ ì—°ê´€ê´€ê³„ ì£¼ì¸ì´ë‹¤.</li>
  <li>ì–‘ë°©í–¥ì€ ë‹¨ë°©í–¥ì— ì£¼ì¸ì´ ì•„ë‹Œ ì—°ê´€ê´€ê³„ë¥¼ í•˜ë‚˜ ì¶”ê°€í–ˆì„ ë¿ì´ë‹¤.</li>
  <li>ì–‘ë°©í–¥ì˜ ì¥ì ì€ ë°˜ëŒ€ë°©í–¥ìœ¼ë¡œ ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰ ê¸°ëŠ¥ì´ ì¶”ê°€ëœ ê²ƒ ë¿ì´ë‹¤.</li>
  <li>ì£¼ì¸ì˜ ë°˜ëŒ€í¸ì€ <code class="language-plaintext highlighter-rouge">mappedBy</code>ë¡œ ì£¼ì¸ì„ ì§€ì •í•´ì•¼ í•œë‹¤.</li>
  <li>ì£¼ì¸ì˜ ë°˜ëŒ€í¸ì€ ë‹¨ìˆœíˆ ë³´ì—¬ì£¼ëŠ” ì¼ë§Œ í•  ìˆ˜ ìˆë‹¤.</li>
  <li>ì—°ê´€ê´€ê³„ ì£¼ì¸ì€ ì™¸ë˜ í‚¤ì˜ ìœ„ì¹˜ì™€ ê´€ë ¨í•´ì„œ ì •í•´ì•¼ì§€ ë¹„ì¦ˆë‹ˆìŠ¤ ì¤‘ìš”ë„ë¡œ ì ‘ê·¼í•˜ë©´ ì•ˆëœë‹¤.<br />
<br />
<br />
<br />
<br />
<br /></li>
</ul>

<h1 id="6-ë‹¤ì–‘í•œ-ì—°ê´€ê´€ê³„-ë§¤í•‘">6. ë‹¤ì–‘í•œ ì—°ê´€ê´€ê³„ ë§¤í•‘</h1>
<p>ì—”í‹°í‹° ì—°ê´€ê´€ê³„ë¥¼ ë§¤í•‘í•  ë•Œ ê³ ë ¤ì‚¬í•­</p>

<ul>
  <li><strong>ë‹¤ì¤‘ì„±</strong>
    <ul>
      <li>ë‹¤ëŒ€ì¼(@ManyToOne)</li>
      <li>ì¼ëŒ€ë‹¤(@OneToMany)</li>
      <li>ì¼ëŒ€ì¼(@OneToOne)</li>
      <li>ë‹¤ëŒ€ë‹¤(@ManyToMany)</li>
    </ul>
  </li>
  <li><strong>ë‹¨ë°©í–¥, ì–‘ë°©í–¥</strong>
    <ul>
      <li>ë‹¨ë°©í–¥: í•œìª½ë§Œ ì°¸ì¡°í•˜ëŠ” ê²ƒ</li>
      <li>ì–‘ë°©í–¥: ì–‘ìª½ì´ ì„œë¡œ ì°¸ì¡°í•˜ëŠ” ê²ƒ</li>
    </ul>
  </li>
  <li><strong>ì—°ê´€ê´€ê³„ ì£¼ì¸</strong><br />
<br /></li>
</ul>

<h2 id="61-ë‹¤ëŒ€ì¼">6.1 ë‹¤ëŒ€ì¼</h2>
<p>ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì˜ ì¼ëŒ€ë‹¤ ê´€ê³„ì—ì„œ ì™¸ë˜ í‚¤ëŠ” í•­ìƒ ë‹¤ìª½ì— ìˆë‹¤. ë”°ë¼ì„œ ê°ì²´ ì–‘ë°©í–¥ ê´€ê³„ì—ì„œ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì€ í•­ìƒ ë‹¤ìª½ì´ë‹¤.<br />
<br />
<br /></p>

<h3 id="611-ë‹¤ëŒ€ì¼-ë‹¨ë°©í–¥-n1">6.1.1 ë‹¤ëŒ€ì¼ ë‹¨ë°©í–¥ [N:1]</h3>
<center><img src="/assets/images/posts/books/2/6_1_ë‹¤ëŒ€ì¼ë‹¨ë°©í–¥.png" width="100%" height="100%" /></center>

<ul>
  <li><code class="language-plaintext highlighter-rouge">@ManyToOne</code> ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•´ì„œ ë‹¤ëŒ€ì¼ ê´€ê³„ë¥¼ ë§¤í•‘í•œë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">@JoinColumn</code>ì€ í•„ë“œë¥¼ ì™¸ë˜ í‚¤ì™€ ë§¤í•‘í•  ë•Œ ì‚¬ìš©í•œë‹¤.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinCoulmn</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"TEAM_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Team</span> <span class="n">team</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="612-ë‹¤ëŒ€ì¼-ì–‘ë°©í–¥-n1-1n">6.1.2 ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥ [N:1, 1:N]</h3>
<center><img src="/assets/images/posts/books/2/6_1_ë‹¤ëŒ€ì¼ì–‘ë°©í–¥.png" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinCoulmn</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"TEAM_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Team</span> <span class="n">team</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTeam</span><span class="o">(</span><span class="nc">Team</span> <span class="n">team</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">team</span> <span class="o">=</span> <span class="n">team</span><span class="o">;</span>

        <span class="c1">// ë¬´í•œë£¨í”„ì— ë¹ ì§€ì§€ ì•Šë„ë¡ ì²´í¬</span>
        <span class="k">if</span><span class="o">(!</span><span class="n">team</span><span class="o">.</span><span class="na">getMembers</span><span class="o">().</span><span class="na">contains</span><span class="o">(</span><span class="k">this</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">team</span><span class="o">.</span><span class="na">getMembers</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Team</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"team"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addMember</span><span class="o">(</span><span class="nc">Member</span> <span class="n">member</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">members</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>

        <span class="c1">// ë¬´í•œë£¨í”„ì— ë¹ ì§€ì§€ ì•Šë„ë¡ ì²´í¬</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">getTeam</span><span class="o">()</span> <span class="o">!=</span> <span class="k">this</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">member</span><span class="o">.</span><span class="na">setTeam</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>ì–‘ë°©í–¥ì€ ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ìª½ì´ ì—°ê´€ê´€ê³„ ì£¼ì¸ì´ë‹¤.</li>
  <li>ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ëŠ” í•­ìƒ ì„œë¡œë¥¼ ì°¸ì¡°í•´ì•¼ í•œë‹¤.<br />
<br />
<br />
<br /></li>
</ul>

<h2 id="62-ì¼ëŒ€ë‹¤">6.2 ì¼ëŒ€ë‹¤</h2>
<p>ì¼ëŒ€ë‹¤ ê´€ê³„ëŠ” ì—”í‹°í‹°ë¥¼ í•˜ë‚˜ ì´ìƒ ì°¸ì¡°í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ìë°” ì»¬ë ‰ì…˜ì¸ Collection, List, Set, Map ì¤‘ì— í•˜ë‚˜ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</p>

<h3 id="621-ì¼ëŒ€ë‹¤-ë‹¨ë°©í–¥-1n">6.2.1 ì¼ëŒ€ë‹¤ ë‹¨ë°©í–¥ [1:N]</h3>
<center><img src="/assets/images/posts/books/2/6_1_ì¼ëŒ€ë‹¤ë‹¨ë°©í–¥.png" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Team</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="nd">@OneToMany</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"TEAM_ID"</span><span class="o">)</span> <span class="c1">// MEMBER í…Œì´ë¸”ì˜ TEAM_ID (FK)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>ì¼ëŒ€ë‹¤ ê´€ê³„ì—ì„œëŠ” ì¼ì´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ë‹¤.</li>
  <li>ì¼ ìª½ì—ì„œ ì™¸ë˜í‚¤ë¥¼ ê´€ë¦¬í•˜ê² ë‹¤ëŠ” ì˜ë¯¸ê°€ ëœë‹¤.</li>
  <li>ì¼ëŒ€ ë‹¤ ë‹¨ë°©í–¥ ê´€ê³„ë¥¼ ë§¤í•‘í•  ë•ŒëŠ” <code class="language-plaintext highlighter-rouge">@JoinColumn</code>ì„ ëª…ì‹œí•´ì•¼ í•œë‹¤.</li>
  <li>ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ JPAëŠ” ì—°ê²° í…Œì´ë¸”ì„ ì¤‘ê°„ì— ë‘ê³  ì—°ê´€ê´€ê³„ë¥¼ ê´€ë¦¬í•˜ëŠ” ì¡°ì¸ í…Œì´ë¸” ì „ëµì„ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.<br />
<br /></li>
</ul>

<p><strong>ì¼ëŒ€ë‹¤ ë¬¸ì œì </strong></p>
<ul>
  <li>ì—”í‹°í‹°ë¥¼ ë§¤í•‘í•œ í…Œì´ë¸”ì´ ì•„ë‹Œ ë‹¤ì„ í…Œì´ë¸”ì˜ ì™¸ë˜ í‚¤ë¥¼ ê´€ë¦¬í•´ì•¼ í•œë‹¤.</li>
  <li>ì„±ëŠ¥ ë¬¸ì œ</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Member</span> <span class="n">member1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Memeber</span><span class="o">(</span><span class="s">"member1"</span><span class="o">);</span>
<span class="nc">Member</span> <span class="n">member2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Memeber</span><span class="o">(</span><span class="s">"member2"</span><span class="o">);</span>

<span class="nc">Team</span> <span class="n">team1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Team</span><span class="o">(</span><span class="s">"team1"</span><span class="o">);</span>
<span class="n">team1</span><span class="o">.</span><span class="na">getMembers</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">member1</span><span class="o">);</span>
<span class="n">team1</span><span class="o">.</span><span class="na">getMembers</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">member2</span><span class="o">);</span>

<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member1</span><span class="o">);</span> <span class="c1">// INSERT MEMBER1</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member2</span><span class="o">);</span> <span class="c1">// INSERT MEMBER2</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">team1</span><span class="o">);</span> <span class="c1">// INSERT TEAM, UPDATE MEMBER1, UPDATE MEMBER2</span>

<span class="n">tx</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</code></pre></div></div>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- ì—…ë°ì´íŠ¸ ì¿¼ë¦¬ê°€ ì¶”ê°€ëœë‹¤.</span>
<span class="k">insert</span> <span class="k">into</span> <span class="n">Member</span> <span class="p">(</span><span class="n">MEMBER_ID</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span> <span class="k">values</span> <span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="o">?</span><span class="p">);</span>
<span class="k">insert</span> <span class="k">into</span> <span class="n">Team</span> <span class="p">(</span><span class="n">TEAM_ID</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="k">values</span> <span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="o">?</span><span class="p">);</span>
<span class="k">update</span> <span class="n">Member</span> <span class="k">set</span> <span class="n">TEAM_ID</span><span class="o">=?</span> <span class="k">where</span> <span class="n">MEMBER_ID</span><span class="o">=?</span>
</code></pre></div></div>

<div class="notice--info">
<p>ì¼ëŒ€ë‹¤ ë‹¨ë°©í–¥ ë§¤í•‘ë³´ë‹¤ëŠ” ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥ ë§¤í•‘ì„ ì‚¬ìš©í•˜ì</p>
</div>
<p><br />
<br /></p>

<h3 id="622-ì¼ëŒ€ë‹¤-ì–‘ë°©í–¥-1n-n1">6.2.2 ì¼ëŒ€ë‹¤ ì–‘ë°©í–¥ [1:N, N:1]</h3>
<center><img src="/assets/images/posts/books/2/6_2_ì¼ëŒ€ë‹¤ì–‘ë°©í–¥.png" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Team</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="nd">@OneToMany</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"TEAM_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinCoulmn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"TEAM_ID"</span><span class="o">,</span>
        <span class="n">insertable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">updatable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="c1">// ì½ê¸° ì „ìš© ë§¤í•‘</span>
    <span class="kd">private</span> <span class="nc">Team</span> <span class="n">team</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ì¼ëŒ€ë‹¤ ë‹¨ë°©í–¥ ë§¤í•‘ì´ ê°€ì§€ëŠ” ë‹¨ì ì„ ê·¸ëŒ€ë¡œ ê°€ì§„ë‹¤.<br />
<br />
<br />
<br /></p>

<h2 id="63-ì¼ëŒ€ì¼-11">6.3 ì¼ëŒ€ì¼ [1:1]</h2>
<p>ì¼ëŒ€ì¼ ê´€ê³„ íŠ¹ì§•</p>
<ul>
  <li>ì¼ëŒ€ì¼ ê´€ê³„ëŠ” ê·¸ ë°˜ëŒ€ë„ ì¼ëŒ€ì¼ ê´€ê³„ë‹¤.</li>
  <li>í…Œì´ë¸” ê´€ê³„ì—ì„œ ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ì€ í•­ìƒ ë‹¤(N)ìª½ì´ ì™¸ë˜ í‚¤ë¥¼ ê°€ì§„ë‹¤. ë°˜ë©´ ì¼ëŒ€ì¼ ê´€ê³„ëŠ” <strong>ì£¼ í…Œì´ë¸”ì´ë‚˜ ëŒ€ìƒ í…Œì´ë¸” ë‘˜ ì¤‘ ì–´ëŠ ê³³ì´ë‚˜ ì™¸ë˜ í‚¤ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.</strong><br />
<br />
<br /></li>
</ul>

<h3 id="631-ì£¼-í…Œì´ë¸”ì—-ì™¸ë˜-í‚¤">6.3.1 ì£¼ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤</h3>
<p>ì£¼ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ë‹¨ë°©í–¥ ê´€ê³„ë¥¼ ë¨¼ì € ì‚´í´ë³´ê³ , ì–‘ë°©í–¥ ê´€ê³„ë„ ì‚´í´ ë³´ì.</p>

<p><strong>ë‹¨ë°©í–¥</strong></p>
<center><img src="/assets/images/posts/books/2/6_3_ì£¼í…Œì´ë¸”ë‹¨ë°©í–¥.png" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="c1">// @OneToOneì„ ì‚¬ìš©í•´ ì¼ëŒ€ì¼ ë§¤í•‘í•œë‹¤.</span>
    <span class="nd">@OneToOne</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"LOCKER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Locker</span> <span class="n">locker</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Locker</span> <span class="o">{</span>
    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"LOCKER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ì–‘ë°©í–¥</strong></p>
<center><img src="/assets/images/posts/books/2/6_3_ì£¼í…Œì´ë¸”ì–‘ë°©í–¥.png" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@OneToOne</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"LOCKER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Locker</span> <span class="n">locker</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Locker</span> <span class="o">{</span>
    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"LOCKER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@OneToOne</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"locker"</span><span class="o">)</span> <span class="c1">// ì—°ê´€ê´€ê³„ ì£¼ì¸ í•„ë“œëª…ì„ ì„ ì–¸</span>
    <span class="kd">private</span> <span class="nc">Member</span> <span class="n">member</span><span class="o">;</span>

    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="632-ëŒ€ìƒ-í…Œì´ë¸”ì—-ì™¸ë˜-í‚¤">6.3.2 ëŒ€ìƒ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤</h3>
<p>ëŒ€ìƒ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ì¼ëŒ€ì¼ ê´€ê³„ë¥¼ ì•Œì•„ë³¸ë‹¤.</p>

<p><strong>ë‹¨ë°©í–¥</strong></p>
<center><img src="/assets/images/posts/books/2/6_3_ëŒ€ìƒí…Œì´ë¸”ë‹¨ë°©í–¥.png" width="100%" height="100%" /></center>
<p>ì¼ëŒ€ì¼ ë‹¨ë°©í–¥ì€ ì´ëŸ° ë§¤í•‘ì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.<br />
<br /></p>

<p><strong>ì–‘ë°©í–¥</strong></p>
<center><img src="/assets/images/posts/books/2/6_3_ëŒ€ìƒí…Œì´ë¸”ì–‘ë°©í–¥.png" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@OneToOne</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"member"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Locker</span> <span class="n">locker</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Locker</span> <span class="o">{</span>
    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"LOCKER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@OneToOne</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Member</span> <span class="n">member</span><span class="o">;</span>

    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ì¼ëŒ€ì¼ ë§¤í•‘ì—ì„œ ëŒ€ìƒ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤ë¥¼ ë‘ê³  ì‹¶ìœ¼ë©´ ì´ë ‡ê²Œ ì–‘ë°©í–¥ìœ¼ë¡œ ë§¤í•‘í•œë‹¤.<br />
<br />
<br />
<br /></p>

<h2 id="64-ë‹¤ëŒ€ë‹¤-nn">6.4 ë‹¤ëŒ€ë‹¤ [N:N]</h2>
<center><img src="/assets/images/posts/books/2/6_4_ë‹¤ëŒ€ë‹¤1.png" width="100%" height="100%" /></center>
<p>í…Œì´ë¸” 2ê°œë¡œëŠ” ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ í‘œí˜„í•  ìˆ˜ ì—†ë‹¤.<br />
<br /></p>

<center><img src="/assets/images/posts/books/2/6_4_ë‹¤ëŒ€ë‹¤2.png" width="100%" height="100%" /></center>
<p>ì¤‘ê°„ì— ì—°ê²° í…Œì´ë¸”ì„ ì¶”ê°€í•´ì•¼ í•œë‹¤.<br />
<br />
<br /></p>

<h3 id="641-ë‹¤ëŒ€ë‹¤-ë‹¨ë°©í–¥">6.4.1 ë‹¤ëŒ€ë‹¤: ë‹¨ë°©í–¥</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@ManyToMany</span>
    <span class="nd">@JoinTable</span><span class="o">(</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_PRODUCT"</span><span class="o">,</span> <span class="c1">// ì—°ê²° í…Œì´ë¸” ì§€ì •</span>
        <span class="n">joinColumn</span> <span class="o">=</span> <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">),</span> <span class="c1">// í˜„ì¬ ì—”í‹°í‹°ì™€ ë§¤í•‘í•  ì—°ê²° í…Œì´ë¸”ì˜ ì¡°ì¸ ì»¬ëŸ¼</span>
        <span class="n">inverseJoinColumns</span> <span class="o">=</span> <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PRODUCT_ID"</span><span class="o">)</span> <span class="c1">// ìƒëŒ€ ì—”í‹°í‹°ì™€ ë§¤í•‘í•  ì—°ê²° í…Œì´ë¸”ì˜ ì¡°ì¸ ì»¬ëŸ¼</span>
    <span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Product</span><span class="o">&gt;</span> <span class="n">products</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Product</span><span class="o">&gt;();</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Product</span> <span class="o">{</span>
    <span class="nd">@Id</span> <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PRODUCT_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="642-ë‹¤ëŒ€ë‹¤-ì–‘ë°©í–¥">6.4.2 ë‹¤ëŒ€ë‹¤: ì–‘ë°©í–¥</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@ManyToMany</span>
    <span class="nd">@JoinTable</span><span class="o">(</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_PRODUCT"</span><span class="o">,</span> <span class="c1">// ì—°ê²° í…Œì´ë¸” ì§€ì •</span>
        <span class="n">joinColumn</span> <span class="o">=</span> <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">),</span> <span class="c1">// í˜„ì¬ ì—”í‹°í‹°ì™€ ë§¤í•‘í•  ì—°ê²° í…Œì´ë¸”ì˜ ì¡°ì¸ ì»¬ëŸ¼</span>
        <span class="n">inverseJoinColumns</span> <span class="o">=</span> <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PRODUCT_ID"</span><span class="o">)</span> <span class="c1">// ìƒëŒ€ ì—”í‹°í‹°ì™€ ë§¤í•‘í•  ì—°ê²° í…Œì´ë¸”ì˜ ì¡°ì¸ ì»¬ëŸ¼</span>
    <span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Product</span><span class="o">&gt;</span> <span class="n">products</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Product</span><span class="o">&gt;();</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Product</span> <span class="o">{</span>
    <span class="nd">@Id</span> <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PRODUCT_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@ManyToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"products"</span><span class="o">)</span> <span class="c1">// ì—­ë°©í–¥ ì¶”ê°€</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">members</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="643-ë‹¤ëŒ€ë‹¤-ë§¤í•‘ì˜-í•œê³„ì™€-ê·¹ë³µ-ì—°ê²°-ì—”í‹°í‹°-ì‚¬ìš©">6.4.3 ë‹¤ëŒ€ë‹¤: ë§¤í•‘ì˜ í•œê³„ì™€ ê·¹ë³µ, ì—°ê²° ì—”í‹°í‹° ì‚¬ìš©</h3>
<p>ì—°ê²°í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ë¥¼ <code class="language-plaintext highlighter-rouge">@IdClass</code> ì‚¬ìš©í•œ ë³µí•© í‚¤ ì‚¬ìš© ì˜ˆì œë¼ì„œ ë„˜ê¹€.<br />
<br />
<br /></p>

<h3 id="644-ë‹¤ëŒ€ë‹¤-ìƒˆë¡œìš´-ê¸°ë³¸-í‚¤-ì‚¬ìš©">6.4.4 ë‹¤ëŒ€ë‹¤: ìƒˆë¡œìš´ ê¸°ë³¸ í‚¤ ì‚¬ìš©</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">@ManyToMany</code>ëŠ” í¸ë¦¬í•˜ì§€ë§Œ, ì‹¤ë¬´ì—ì„œ ì‚¬ìš©í•˜ê¸°ì—ëŠ” í•œê³„ê°€ ìˆë‹¤.</li>
  <li>ë³´í†µì€ <strong>ì—°ê²° í…Œì´ë¸”ì— ìƒˆë¡œìš´ ì»¬ëŸ¼ì´ ì¶”ê°€ë˜ê¸° ë§ˆë ¨</strong>ì´ë‹¤.</li>
  <li>ê²°êµ­ <strong>ì—°ê²° í…Œì´ë¸”ì„ ë§¤í•‘í•˜ëŠ” ì—°ê²° ì—”í‹°í‹°ë¥¼ ë§Œë“¤ê³  ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ ê´€ê³„ë¡œ í’€ì–´ì•¼ í•œë‹¤</strong>.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"member"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberProduct</span><span class="o">&gt;</span> <span class="n">memberProducts</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Product</span> <span class="o">{</span>
    <span class="nd">@Id</span> <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PRODUCT_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="c1">// ìƒí’ˆ ì—”í‹°í‹°ì—ì„œ íšŒì›ìƒí’ˆ ì—”í‹°í‹°ë¡œ ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰ ê¸°ëŠ¥ì´ í•„ìš” ì—†ë‹¤ íŒë‹¨.</span>
    <span class="c1">// ì—°ê´€ê´€ê³„ë¥¼ ë§Œë“¤ì§€ ì•Šì•˜ë‹¤.</span>
    <span class="c1">// @OneToMany(mappedBy = "product")</span>
    <span class="c1">// private List&lt;MemberProduct&gt; memberProducts = new ArrayList&lt;&gt;();</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberProduct</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Member</span> <span class="n">member</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PRODUCT_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Product</span> <span class="n">product</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="645-ë‹¤ëŒ€ë‹¤-ì—°ê´€ê´€ê³„-ì •ë¦¬">6.4.5 ë‹¤ëŒ€ë‹¤ ì—°ê´€ê´€ê³„ ì •ë¦¬</h3>
<ul>
  <li>ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ ê´€ê³„ë¡œ í’€ì–´ë‚¸ë‹¤.</li>
  <li>ì—°ê²° í…Œì´ë¸”ì„ ë§Œë“¤ ë•Œ ì‹ë³„ìë¥¼ ì–´ë–»ê²Œ êµ¬ì„±í• ì§€ ì„ íƒí•œë‹¤.
    <ul>
      <li>ì‹ë³„ ê´€ê³„: ë°›ì•„ì˜¨ ì‹ë³„ìë¥¼ ê¸°ë³¸ í‚¤ + ì™¸ë˜ í‚¤ë¡œ ì‚¬ìš©í•œë‹¤.</li>
      <li>ë¹„ì‹ë³„ ê´€ê³„: ë°›ì•„ì˜¨ ì‹ë³„ìëŠ” ì™¸ë˜ í‚¤ë¡œë§Œ ì‚¬ìš©í•˜ê³  ìƒˆë¡œìš´ ì‹ë³„ìë¥¼ ì¶”ê°€í•œë‹¤. ì¶”ì²œ ğŸ‘<br />
<br />
<br />
<br />
<br />
<br /></li>
    </ul>
  </li>
</ul>

<h1 id="7-ê³ ê¸‰-ë§¤í•‘">7. ê³ ê¸‰ ë§¤í•‘</h1>
<p>ë‹¤ë£° ë‚´ìš©ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<ul>
  <li><strong>ìƒì† ê´€ê³„ ë§¤í•‘</strong>: ê°ì²´ì˜ ìƒì† ê´€ê³„ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì–´ë–»ê²Œ ë§¤í•‘í•˜ëŠ”ì§€</li>
  <li><strong>@MappedSuperclass</strong>: ë“±ë¡ì¼, ìˆ˜ì •ì¼ ê°™ì´ ì—¬ëŸ¬ ì—”í‹°í‹°ì—ì„œ ê³µí†µìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë§¤í•‘ ì •ë³´ë§Œ ìƒì†ë°›ê³  ì‹¶ì„ ë•Œ</li>
  <li><strong>ë³µí•© í‚¤ì™€ ì‹ë³„ ê´€ê³„ ë§¤í•‘</strong>: ë°ì´í„°ë² ì´ìŠ¤ì˜ ì‹ë³„ìê°€ í•˜ë‚˜ ì´ìƒì¼ ë•Œ ë§¤í•‘í•˜ëŠ” ë°©ë²•</li>
  <li><strong>ì¡°ì¸ í…Œì´ë¸”</strong>: ì—°ê²° í…Œì´ë¸”ì„ ë§¤í•‘í•˜ëŠ” ë°©ë²•</li>
  <li><strong>ì—”í‹°í‹° í•˜ë‚˜ì— ì—¬ëŸ¬ í…Œì´ë¸” ë§¤í•‘</strong>í•˜ëŠ” ë°©ë²•<br />
<br />
<br /></li>
</ul>

<h2 id="71-ìƒì†-ê´€ê³„-ë§¤í•‘">7.1 ìƒì† ê´€ê³„ ë§¤í•‘</h2>
<center><img src="/assets/images/posts/books/2/7_1_ê°ì²´ìƒì†ëª¨ë¸.png" width="100%" height="100%" /></center>

<p><br /></p>

<p>ìŠˆí¼íƒ€ì… ì„œë¸Œíƒ€ì… ë…¼ë¦¬ ëª¨ë¸ì„ í…Œì´ë¸”ë¡œ êµ¬í˜„í•˜ëŠ” 3ê°€ì§€ ë°©ë²•</p>
<ul>
  <li><strong>ê°ê°ì˜ í…Œì´ë¸”ë¡œ ë³€í™˜</strong>: JPAì—ì„œëŠ” <strong>ì¡°ì¸ ì „ëµ</strong>ì´ë¼ í•œë‹¤.</li>
  <li><strong>í†µí•© í…Œì´ë¸”ë¡œ ë³€í™˜</strong>: JPAì—ì„œëŠ” <strong>ë‹¨ì¼ í…Œì´ë¸” ì „ëµ</strong>ì´ë¼ í•œë‹¤.</li>
  <li><strong>ì„œë¸Œíƒ€ì… í…Œì´ë¸”ë¡œ ë³€í™˜</strong>: JPAì—ì„œëŠ” <strong>êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµ</strong>ì´ë¼ í•œë‹¤.<br />
<br />
<br /></li>
</ul>

<h3 id="711-ì¡°ì¸-ì „ëµ">7.1.1 ì¡°ì¸ ì „ëµ</h3>
<p>ì—”í‹°í‹° ê°ê°ì„ ëª¨ë‘ í…Œì´ë¸”ë¡œ ë§Œë“¤ê³  ìì‹ í…Œì´ë¸”ì´ ë¶€ëª¨ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ë¥¼ ë°›ì•„ì„œ ê¸°ë³¸ í‚¤ + ì™¸ë˜ í‚¤ë¡œ ì‚¬ìš©í•˜ëŠ” ì „ëµ</p>
<center><img src="/assets/images/posts/books/2/7_1_ì¡°ì¸ì „ëµ.png" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Inheritance</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">InheritanceType</span><span class="o">.</span><span class="na">JOIN</span><span class="o">)</span> <span class="c1">// ë¶€ëª¨ í´ë˜ìŠ¤ì— ìƒì† ë§¤í•‘, ì „ëµ ì§€ì •</span>
<span class="nd">@DiscriminatorColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"DTYPE"</span><span class="o">)</span> <span class="c1">// ë¶€ëª¨ í´ë˜ìŠ¤ì— êµ¬ë¶„ ì»¬ëŸ¼ ì§€ì •</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Item</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ITEM_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span> <span class="c1">//ì´ë¦„</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">price</span><span class="o">;</span>   <span class="c1">//ê°€ê²©</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@DiscriminatorValue</span><span class="o">(</span><span class="s">"A"</span><span class="o">)</span> <span class="c1">// ì—”í‹°í‹°ë¥¼ ì €ì¥í•  ë•Œ êµ¬ë¶„ ì»¬ëŸ¼ì— ì…ë ¥í•  ê°’ì„ ì§€ì •</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Album</span> <span class="kd">extends</span> <span class="nc">Item</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">artist</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Entity</span>
<span class="nd">@DiscriminatorValue</span><span class="o">(</span><span class="s">"M"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Movie</span> <span class="kd">extends</span> <span class="nc">Item</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">director</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">actor</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Entity</span>
<span class="nd">@DiscriminatorValue</span><span class="o">(</span><span class="s">"B"</span><span class="o">)</span>
<span class="nd">@PrimaryKeyJoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"BOOK_ID"</span><span class="o">)</span> <span class="c1">// ê¸°ë³¸ í‚¤ ì»¬ëŸ¼ëª… ë³€ê²½, ê¸°ë³¸ê°’ì€ ë¶€ëª¨ í…Œì´ë¸” ID ì»¬ëŸ¼ëª…</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Book</span> <span class="kd">extends</span> <span class="nc">Item</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">author</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">isbn</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p><strong>ì¥ì </strong></p>
<ul>
  <li>í…Œì´ë¸”ì´ ì •ê·œí™”ëœë‹¤.</li>
  <li>ì™¸ë˜ í‚¤ ì°¸ì¡° ë¬´ê²°ì„± ì œì•½ì¡°ê±´ì„ í™œìš©í•  ìˆ˜ ìˆë‹¤.</li>
  <li>ì €ì¥ê³µê°„ì„ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.</li>
</ul>

<p><strong>ë‹¨ì </strong></p>
<ul>
  <li>ì¡°íšŒí•  ë•Œ ì¡°ì¸ì´ ë§ì´ ì‚¬ìš©ë˜ì–´ ì„±ëŠ¥ì´ ì €í•˜ë  ìˆ˜ ìˆë‹¤.</li>
  <li>ì¡°íšŒ ì¿¼ë¦¬ê°€ ë³µì¡í•˜ë‹¤.</li>
  <li>ë°ì´í„°ë¥¼ ë“±ë¡í•  ë•Œ INSERT SQLì´ ë‘ ë²ˆ ì‹¤í–‰ëœë‹¤.</li>
</ul>

<p><strong>íŠ¹ì§•</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">@DiscriminatorColumn</code> ì—†ì´ë„ ë™ì‘í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><strong>ê´€ë ¨ ì–´ë…¸í…Œì´ì…˜</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">@PrimaryKeyJoinColumn</code>, <code class="language-plaintext highlighter-rouge">@DiscriminatorColumn</code>, <code class="language-plaintext highlighter-rouge">@DiscriminatorValue</code><br />
<br />
<br />
<br /></li>
</ul>

<h3 id="712-ë‹¨ì¼-í…Œì´ë¸”-ì „ëµ">7.1.2 ë‹¨ì¼ í…Œì´ë¸” ì „ëµ</h3>
<center><img src="/assets/images/posts/books/2/7_1_ë‹¨ì¼í…Œì´ë¸”ì „ëµ.png" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Inheritance</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">InheritanceType</span><span class="o">.</span><span class="na">SINGLE_TABLE</span><span class="o">)</span> <span class="c1">// ë¶€ëª¨ í´ë˜ìŠ¤ì— ìƒì† ë§¤í•‘, ì „ëµ ì§€ì •</span>
<span class="nd">@DiscriminatorColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"DTYPE"</span><span class="o">)</span> <span class="c1">// ë¶€ëª¨ í´ë˜ìŠ¤ì— êµ¬ë¶„ ì»¬ëŸ¼ ì§€ì •</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Item</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ITEM_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">price</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@DiscriminatorValue</span><span class="o">(</span><span class="s">"A"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Album</span> <span class="kd">extends</span> <span class="nc">Item</span> <span class="o">{...}</span>

<span class="nd">@Entity</span>
<span class="nd">@DiscriminatorValue</span><span class="o">(</span><span class="s">"M"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Movie</span> <span class="kd">extends</span> <span class="nc">Item</span> <span class="o">{...}</span>

<span class="nd">@Entity</span>
<span class="nd">@DiscriminatorValue</span><span class="o">(</span><span class="s">"B"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Book</span> <span class="kd">extends</span> <span class="nc">Item</span> <span class="o">{...}</span>
</code></pre></div></div>

<p><strong>ì¥ì </strong></p>
<ul>
  <li>ì¡°ì¸ì´ í•„ìš” ì—†ìœ¼ë¯€ë¡œ ì¡°íšŒ ì„±ëŠ¥ì´ ë¹ ë¥´ë‹¤.</li>
  <li>ì¡°íšŒ ì¿¼ë¦¬ê°€ ë‹¨ìˆœí•˜ë‹¤.</li>
</ul>

<p><strong>ë‹¨ì </strong></p>
<ul>
  <li>ìì‹ ì—”í‹°í‹°ê°€ ë§¤í•‘í•œ ì»¬ëŸ¼ì€ ëª¨ë‘ nullì„ í—ˆìš©í•´ì•¼ í•œë‹¤.</li>
  <li>ë‹¨ì¼ í…Œì´ë¸”ì— ëª¨ë“  ê²ƒì„ ì €ì¥í•˜ë¯€ë¡œ í…Œì´ë¸”ì´ ì»¤ì§ˆ ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë¯€ë¡œ ìƒí™©ì— ë”°ë¼ì„œëŠ” ì¡°íšŒ ì„±ëŠ¥ì´ ì˜¤íˆë ¤ ëŠë ¤ì§ˆ ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><strong>íŠ¹ì§•</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">@DiscriminatorColumn</code>ì„ ê¼­ ì„¤ì •í•´ì•¼ í•œë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">@DiscriminatorValue</code>ë¥¼ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ìœ¼ë¡œ ì—”í‹°í‹° ì´ë¦„ì„ ì‚¬ìš©í•œë‹¤.</li>
</ul>

<p><br />
<br /></p>

<h3 id="713-êµ¬í˜„-í´ë˜ìŠ¤ë§ˆë‹¤-í…Œì´ë¸”-ì „ëµ">7.1.3 êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµ</h3>
<center><img src="/assets/images/posts/books/2/7_1_êµ¬í˜„í´ë˜ìŠ¤ë§ˆë‹¤í…Œì´ë¸”ì „ëµ.png" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Inheritance</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">InheritanceType</span><span class="o">.</span><span class="na">TABLE_PER_CLASS</span><span class="o">)</span>
<span class="nd">@DiscriminatorColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"DTYPE"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Item</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ITEM_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">price</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@DiscriminatorValue</span><span class="o">(</span><span class="s">"A"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Album</span> <span class="kd">extends</span> <span class="nc">Item</span> <span class="o">{...}</span>

<span class="nd">@Entity</span>
<span class="nd">@DiscriminatorValue</span><span class="o">(</span><span class="s">"M"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Movie</span> <span class="kd">extends</span> <span class="nc">Item</span> <span class="o">{...}</span>

<span class="nd">@Entity</span>
<span class="nd">@DiscriminatorValue</span><span class="o">(</span><span class="s">"B"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Book</span> <span class="kd">extends</span> <span class="nc">Item</span> <span class="o">{...}</span>
</code></pre></div></div>

<p><strong>ì¼ë°˜ì ìœ¼ë¡œ ì¶”ì²œí•˜ì§€ ì•ŠëŠ” ì „ëµì´ë‹¤.</strong></p>

<p><strong>ì¥ì </strong></p>
<ul>
  <li>ì„œë¸Œ íƒ€ì…ì„ êµ¬ë¶„í•´ì„œ ì²˜ë¦¬í•  ë•Œ íš¨ê³¼ì ì´ë‹¤.</li>
  <li>not null ì œì•½ ì¡°ê±´ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><strong>ë‹¨ì </strong></p>
<ul>
  <li>ì—¬ëŸ¬ ìì‹ í…Œì´ë¸”ì„ í•¨ê»˜ ì¡°íšŒí•  ë•Œ ì„±ëŠ¥ì´ ëŠë¦¬ë‹¤. (UNIONì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤)</li>
  <li>ìì‹ í…Œì´ë¸”ì„ í†µí•©í•´ì„œ ì¿¼ë¦¬í•˜ê¸° ì–´ë µë‹¤.</li>
</ul>

<p><strong>íŠ¹ì§•</strong></p>
<ul>
  <li>êµ¬ë¶„ ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.<br />
<br />
<br />
<br /></li>
</ul>

<h2 id="72-mappedsuperclass">7.2 @MappedSuperclass</h2>
<p><strong>ë¶€ëª¨ í´ë˜ìŠ¤ëŠ” í…Œì´ë¸”ê³¼ ë§¤í•‘í•˜ì§€ ì•Šê³  ìì‹ í´ë˜ìŠ¤ì—ê²Œ ë§¤í•‘ ì •ë³´ë§Œ ì œê³µ</strong>í•˜ê³  ì‹¶ìœ¼ë©´ <code class="language-plaintext highlighter-rouge">@MappedSuperclass</code>ì„ ì‚¬ìš©í•œë‹¤.</p>

<center><img src="/assets/images/posts/books/2/7_2_mappedSuperclass.png" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ê³µí†µ ë§¤í•‘ ì •ë³´ ì •ì˜</span>
<span class="nd">@MappedSuperclass</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">BaseEntity</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="kd">extends</span> <span class="nc">BaseEntity</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>
<span class="o">}</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Seller</span> <span class="kd">extends</span> <span class="nc">BaseEntity</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">shopName</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>ì—°ê´€ê´€ê³„ë¥¼ ì¬ì •ì˜ í•˜ë ¤ë©´ <code class="language-plaintext highlighter-rouge">@AssociationOverrides</code>, <code class="language-plaintext highlighter-rouge">@AssociationOverride</code> ì‚¬ìš©í•œë‹¤.</li>
  <li><strong>ë¶€ëª¨ë¡œë¶€í„° ë¬¼ë ¤ë°›ì€ ë§¤í•‘ ì •ë³´ë¥¼ ì¬ì •ì˜ í•˜ë ¤ë©´ <code class="language-plaintext highlighter-rouge">@AttributeOverrides</code>, <code class="language-plaintext highlighter-rouge">@AttributeOverride</code> ì‚¬ìš©í•œë‹¤.</strong></li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ë§¤í•‘ ì •ë³´ ì¬ì •ì˜</span>
<span class="c1">// ë¶€ëª¨ì—ê²Œ ìƒì†ë°›ì€ id ì†ì„±ì˜ ì»¬ëŸ¼ëª…ì„ MEMBER_IDë¡œ ì¬ì •ì˜</span>
<span class="nd">@Entity</span>
<span class="nd">@AttributeOverride</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"id"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">))</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="kd">extends</span> <span class="nc">BaseEntity</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ë‘˜ ì´ìƒì˜ ë§¤í•‘ ì •ë³´ ì¬ì •ì˜</span>
<span class="nd">@Entity</span>
<span class="nd">@AttributeOverrides</span><span class="o">({</span>
    <span class="nd">@AttributeOverride</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"id"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">)),</span>
    <span class="nd">@AttributeOverride</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"name"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_NAME"</span><span class="o">))</span>
<span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="kd">extends</span> <span class="nc">BaseEntity</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>@MappedSuperclass íŠ¹ì§•</strong></p>
<ul>
  <li>í…Œì´ë¸”ê³¼ ë§¤í•‘ë˜ì§€ ì•ŠëŠ”ë‹¤.</li>
  <li>ìì‹ í´ë˜ìŠ¤ì—ê²Œ ì—”í‹°í‹°ì˜ ë§¤í•‘ ì •ë³´ë¥¼ ìƒì†í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤.</li>
  <li>ì—”í‹°í‹°ê°€ ì•„ë‹ˆë¯€ë¡œ <code class="language-plaintext highlighter-rouge">em.find()</code>, <code class="language-plaintext highlighter-rouge">JPQL</code>ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.</li>
  <li>ì§ì ‘ ìƒì„±í•´ì„œ ì‚¬ìš©í•  ì¼ì´ ê±°ì˜ ì—†ìœ¼ë¯€ë¡œ ì¶”ìƒ í´ë˜ìŠ¤ë¡œ ë§Œë“œëŠ” ê²ƒì„ ê¶Œì¥í•œë‹¤.</li>
  <li>ë“±ë¡ì¼ì, ìˆ˜ì •ì¼ì, ë“±ë¡ì, ìˆ˜ì •ì ê°™ì€ ê³¹ì˜¤ ì†ì„±ì„ íš¨ê³¼ì ìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.<br />
<br />
<br />
<br /></li>
</ul>

<h2 id="73-ë³µí•©-í‚¤ì™€-ì‹ë³„-ê´€ê³„-ë§¤í•‘">7.3 ë³µí•© í‚¤ì™€ ì‹ë³„ ê´€ê³„ ë§¤í•‘</h2>
<p>ë³µí•© í‚¤ë¥¼ ë§¤í•‘í•˜ëŠ” ë°©ë²•ê³¼ ì‹ë³„ ê´€ê³„, ë¹„ì‹ë³„ ê´€ê³„ë¥¼ ë§¤í•‘í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³¸ë‹¤.<br />
<br /></p>

<h3 id="731-ì‹ë³„-ê´€ê³„-vs-ë¹„ì‹ë³„-ê´€ê³„">7.3.1 ì‹ë³„ ê´€ê³„ vs ë¹„ì‹ë³„ ê´€ê³„</h3>
<p><strong>ì‹ë³„ ê´€ê³„</strong><br />
ë¶€ëª¨ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ë¥¼ ë‚´ë ¤ë°›ì•„ì„œ ìì‹ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ + ì™¸ë˜ í‚¤ë¡œ ì‚¬ìš©í•˜ëŠ” ê´€ê³„ë‹¤.</p>
<center><img src="/assets/images/posts/books/2/7_3_ì‹ë³„ê´€ê³„.png" width="100%" height="100%" /></center>
<p><br /></p>

<p><strong>ë¹„ì‹ë³„ ê´€ê³„</strong><br />
ë¶€ëª¨ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ë¥¼ ë°›ì•„ì„œ ìì‹ í…Œì´ë¸”ì˜ ì™¸ë˜ í‚¤ë¡œë§Œ ì‚¬ìš©í•˜ëŠ” ê´€ê³„ë‹¤.</p>
<center><img src="/assets/images/posts/books/2/7_3_ë¹„ì‹ë³„ê´€ê³„.png" width="100%" height="100%" /></center>
<ul>
  <li>í•„ìˆ˜ì  ë¹„ì‹ë³„ ê´€ê³„(Mandatory): ì™¸ë˜ í‚¤ì— nullì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. ì—°ê´€ê´€ê³„ë¥¼ í•„ìˆ˜ì ìœ¼ë¡œ ë§ºì–´ì•¼ í•œë‹¤.</li>
  <li>ì„ íƒì  ë¹„ì‹ë³„ ê´€ê³„(Optional): ì™¸ë˜ í‚¤ì— nullì„ í—ˆìš©í•œë‹¤. ì—°ê´€ê´€ê³„ë¥¼ ë§ºì„ì§€ ë§ì§€ ì„ íƒí•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<div class="notice--info">
<p><strong>ì°¸ê³ </strong><br />
ìµœê·¼ì—ëŠ” ë¹„ì‹ë³„ ê´€ê³„ë¥¼ ì£¼ë¡œ ì‚¬ìš©í•˜ê³  ê¼­ í•„ìš”í•œ ê³³ì—ë§Œ ì‹ë³„ ê´€ê³„ë¥¼ ì‚¬ìš©í•˜ëŠ” ì¶”ì„¸</p>
</div>
<p><br />
<br /></p>

<h3 id="732-ë³µí•©-í‚¤-ë¹„ì‹ë³„-ê´€ê³„-ë§¤í•‘">7.3.2 ë³µí•© í‚¤: ë¹„ì‹ë³„ ê´€ê³„ ë§¤í•‘</h3>
<p>JPAëŠ” ë³µí•© í‚¤ë¥¼ ì§€ì›í•˜ê¸° ìœ„í•´ ë‹¤ìŒ 2ê°€ì§€ ë°©ë²•ì„ ì œê³µí•œë‹¤.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">@IdClass</code>: ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ì— ê°€ê¹Œìš´ ë°©ë²•</li>
  <li><code class="language-plaintext highlighter-rouge">@EmbeddedId</code>: ê°ì²´ì§€í–¥ì— ê°€ê¹Œìš´ ë°©ë²•<br />
<br /></li>
</ul>

<p><strong>@IdClass</strong></p>
<center><img src="/assets/images/posts/books/2/7_3_ë³µí•©í‚¤í…Œì´ë¸”.png" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@IdClass</span><span class="o">(</span><span class="nc">ParentId</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Parent</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID1"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id1</span><span class="o">;</span>

    <span class="nd">@Id</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID2"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id1</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ParentId</span> <span class="kd">implements</span> <span class="nc">Serializable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id1</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id2</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">ParentId</span><span class="o">()</span> <span class="o">{}</span>

    <span class="o">...</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span> <span class="o">(</span><span class="nc">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{...}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{...}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>@IdClassë¥¼ ì‚¬ìš©í•  ë•Œ ì‹ë³„ì í´ë˜ìŠ¤ëŠ” ë‹¤ìŒ ì¡°ê±´ì„ ë§Œì¡±í•´ì•¼ í•œë‹¤.</strong></p>
<ul>
  <li>ì‹ë³„ì í´ë˜ìŠ¤ì˜ ì†ì„±ëª…ê³¼ ì—”í‹°í‹°ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì‹ë³„ìì˜ ì†ì„±ëª…ì´ ê°™ì•„ì•¼ í•œë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">Serializable</code> ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•´ì•¼ í•œë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">equals</code>, <code class="language-plaintext highlighter-rouge">hashCode</code>ë¥¼ êµ¬í˜„í•´ì•¼ í•œë‹¤.</li>
  <li>ê¸°ë³¸ ìƒì„±ìê°€ ìˆì–´ì•¼ í•œë‹¤.</li>
  <li>ì‹ë³„ì í´ë˜ìŠ¤ëŠ” <code class="language-plaintext highlighter-rouge">public</code>ì´ì–´ì•¼ í•œë‹¤.<br />
<br /></li>
</ul>

<p><strong>ì‚¬ìš©ë°©ë²•</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì €ì¥</span>
<span class="nc">Parent</span> <span class="n">parent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Parent</span><span class="o">();</span>
<span class="n">parent</span><span class="o">.</span><span class="na">setId1</span><span class="o">(</span><span class="s">"1"</span><span class="o">);</span>
<span class="n">parent</span><span class="o">.</span><span class="na">setId2</span><span class="o">(</span><span class="s">"2"</span><span class="o">);</span>

<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">parent</span><span class="o">);</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì¡°íšŒ</span>
<span class="nc">ParentId</span> <span class="n">parentId</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ParentId</span><span class="o">(</span><span class="s">"1"</span><span class="o">,</span><span class="s">"2"</span><span class="o">);</span>
<span class="nc">Parent</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Parent</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">parentId</span><span class="o">);</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ìì‹ í´ë˜ìŠ¤</strong><br />
ìì‹ í…Œì´ë¸”ì—ì„œ ì™¸ë˜ í‚¤ ë§¤í•‘ ë°©ë²•</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Child</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinColumns</span><span class="o">({</span>
        <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID1"</span><span class="o">,</span> <span class="n">referencedColumnName</span> <span class="o">=</span> <span class="s">"PARENT_ID1"</span><span class="o">),</span>
        <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID2"</span><span class="o">,</span> <span class="n">referencedColumnName</span> <span class="o">=</span> <span class="s">"PARENT_ID2"</span><span class="o">)</span>
    <span class="o">})</span>
    <span class="kd">private</span> <span class="nc">Parent</span> <span class="n">parent</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br />
<br /></p>

<p><strong>@EmbeddedId</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Parent</span> <span class="o">{</span>

    <span class="nd">@EmbeddedId</span>
    <span class="kd">private</span> <span class="nc">ParentId</span> <span class="n">id</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Embeddable</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ParentId</span> <span class="kd">implements</span> <span class="nc">Serializable</span> <span class="o">{</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID1"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id1</span><span class="o">;</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID2"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id2</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">ParentId</span><span class="o">()</span> <span class="o">{}</span>

    <span class="o">...</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span> <span class="o">(</span><span class="nc">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{...}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{...}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>@EmbeddedIdë¥¼ ì‚¬ìš©í•  ë•Œ ì‹ë³„ì í´ë˜ìŠ¤ëŠ” ë‹¤ìŒ ì¡°ê±´ì„ ë§Œì¡±í•´ì•¼ í•œë‹¤.</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">@Embeddable</code> ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ì£¼ì–´ì•¼ í•œë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">Serializable</code> ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•´ì•¼ í•œë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">equals</code>, <code class="language-plaintext highlighter-rouge">hashCode</code>ë¥¼ êµ¬í˜„í•´ì•¼ í•œë‹¤.</li>
  <li>ê¸°ë³¸ ìƒì„±ìê°€ ìˆì–´ì•¼ í•œë‹¤.</li>
  <li>ì‹ë³„ì í´ë˜ìŠ¤ëŠ” <code class="language-plaintext highlighter-rouge">public</code>ì´ì–´ì•¼ í•œë‹¤.<br />
<br /></li>
</ul>

<p><strong>ì‚¬ìš©ë°©ë²•</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì €ì¥</span>
<span class="nc">Parent</span> <span class="n">parent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Parent</span><span class="o">();</span>
<span class="nc">ParentId</span> <span class="n">parentId</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ParentId</span><span class="o">(</span><span class="s">"1"</span><span class="o">,</span><span class="s">"2"</span><span class="o">);</span>
<span class="n">parent</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">parentId</span><span class="o">);</span>

<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">parent</span><span class="o">);</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì¡°íšŒ</span>
<span class="nc">ParentId</span> <span class="n">parentId</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ParentId</span><span class="o">(</span><span class="s">"1"</span><span class="o">,</span><span class="s">"2"</span><span class="o">);</span>
<span class="nc">Parent</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Parent</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">parentId</span><span class="o">);</span>
</code></pre></div></div>
<p><br />
<br /></p>

<p><strong>@IdClass vs @EmbeddedId</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">@IdClass</code>: ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ì— ê°€ê¹Œìš´ ë°©ë²•</li>
  <li><code class="language-plaintext highlighter-rouge">@EmbeddedId</code>: ê°ì²´ì§€í–¥ì— ê°€ê¹Œìš´ ë°©ë²•</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// JPQL</span>
<span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"select p.id.id1, p.id.id2 from Parent p"</span><span class="o">);</span> <span class="c1">// @EmbeddedId</span>
<span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"select p.id1, p.id2 from Parent p"</span><span class="o">);</span> <span class="c1">// @IdClass</span>
</code></pre></div></div>

<div class="notice--info">
<p><strong>ì°¸ê³ </strong><br />
ë³µí•© í‚¤ì—ëŠ” <code class="language-plaintext highlighter-rouge">@GenerateValue</code>ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. ë³µí•© í‚¤ë¥¼ êµ¬ì„±í•˜ëŠ” ì—¬ëŸ¬ ì»¬ëŸ¼ì¤‘ í•˜ë‚˜ì—ë„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.</p>
</div>
<p><br />
<br />
<br /></p>

<h3 id="733-ë³µí•©-í‚¤-ì‹ë³„-ê´€ê³„-ë§¤í•‘">7.3.3 ë³µí•© í‚¤: ì‹ë³„ ê´€ê³„ ë§¤í•‘</h3>
<center><img src="/assets/images/posts/books/2/7_3_ì‹ë³„ê´€ê³„êµ¬í˜„.png" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ë¶€ëª¨</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Parent</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ìì‹</span>
<span class="nd">@Entity</span>
<span class="nd">@IdClass</span><span class="o">(</span><span class="nc">ChildId</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Child</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Parent</span> <span class="n">parent</span><span class="o">;</span>

    <span class="nd">@Id</span> <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"CHILD_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">childId</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// ìì‹ ID</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ChildId</span> <span class="kd">implements</span> <span class="nc">Serializable</span> <span class="o">{</span>
    
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">parent</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">childId</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì†ì</span>
<span class="nd">@Entity</span>
<span class="nd">@IdClass</span><span class="o">(</span><span class="nc">GrandChildId</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GrandChild</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinColumns</span><span class="o">({</span>
        <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID"</span><span class="o">),</span>
        <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"CHILD_ID"</span><span class="o">)</span>
    <span class="o">})</span>
    <span class="kd">private</span> <span class="nc">Child</span> <span class="n">child</span><span class="o">;</span>

    <span class="nd">@Id</span> <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"GRANDCHILD_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// ì†ì ID</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GrandChildId</span> <span class="kd">implements</span> <span class="nc">Serializable</span> <span class="o">{</span>
    
    <span class="kd">private</span> <span class="nc">ChildId</span> <span class="n">child</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<p><strong>@EmbeddedIdì™€ ì‹ë³„ ê´€ê³„</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ë¶€ëª¨</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Parent</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ìì‹</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Child</span> <span class="o">{</span>

    <span class="nd">@EmbeddedId</span>
    <span class="kd">private</span> <span class="nc">ChildId</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@MapsId</span><span class="o">(</span><span class="s">"parentId"</span><span class="o">)</span>
    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Parent</span> <span class="n">parent</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// ìì‹ ID</span>
<span class="nd">@Embeddable</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ChildId</span> <span class="kd">implements</span> <span class="nc">Serializable</span> <span class="o">{</span>
    
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">parentId</span><span class="o">;</span> <span class="c1">// @MapsId("parentId")ë¡œ ë§¤í•‘</span>
    
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"CHILD_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì†ì</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GrandChild</span> <span class="o">{</span>

    <span class="nd">@EmbeddedId</span>
    <span class="kd">private</span> <span class="nc">GrandChildId</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@MapsId</span><span class="o">(</span><span class="s">"childId"</span><span class="o">)</span>
    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinColumns</span><span class="o">({</span>
        <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID"</span><span class="o">),</span>
        <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"CHILD_ID"</span><span class="o">)</span>
    <span class="o">})</span>
    <span class="kd">private</span> <span class="nc">Child</span> <span class="n">child</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// ì†ì ID</span>
<span class="nd">@Embeddable</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GrandChildId</span> <span class="kd">implements</span> <span class="nc">Serializable</span> <span class="o">{</span>
    
    <span class="kd">private</span> <span class="nc">ChildId</span> <span class="n">childId</span><span class="o">;</span> <span class="c1">// @MapsId("childId")ë¡œ ë§¤í•‘</span>
    
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"GRANDCHILD_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br />
<br /></p>

<h3 id="734-ë¹„ì‹ë³„-ê´€ê³„ë¡œ-êµ¬í˜„">7.3.4 ë¹„ì‹ë³„ ê´€ê³„ë¡œ êµ¬í˜„</h3>
<center><img src="/assets/images/posts/books/2/7_3_ë¹„ì‹ë³„ê´€ê³„êµ¬í˜„.png" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ë¶€ëª¨</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Parent</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ìì‹</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Child</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"CHILD_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Parent</span> <span class="n">parent</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì†ì</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GrandChild</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"GRANDCHILD_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"CHILD_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Child</span> <span class="n">child</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ì‹ë³„ ê´€ê³„ì˜ ë³µí•© í‚¤ë¥¼ ì‚¬ìš©í•œ ì½”ë“œì™€ ë¹„êµí•˜ë©´ ë§¤í•‘ë„ ì‰½ê³  ì½”ë“œë„ ë‹¨ìˆœí•˜ë‹¤.<br />
<br />
<br /></p>

<h3 id="735-ì¼ëŒ€ì¼-ì‹ë³„-ê´€ê³„">7.3.5 ì¼ëŒ€ì¼ ì‹ë³„ ê´€ê³„</h3>
<center><img src="/assets/images/posts/books/2/7_3_ì‹ë³„ê´€ê³„ì¼ëŒ€ì¼.png" width="100%" height="100%" /></center>

<p>ì¼ëŒ€ì¼ ì‹ë³„ ê´€ê³„ëŠ” ìì‹ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ ê°’ìœ¼ë¡œ ë¶€ëª¨ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ ê°’ë§Œ ì‚¬ìš©í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ë¶€ëª¨</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Board</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"BOARD_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@OneToOne</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"board"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">BoardDetail</span> <span class="n">boardDetail</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BoardDetail</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">boardId</span><span class="o">;</span>

    <span class="c1">// ì‹ë³„ìê°€ ë‹¨ìˆœíˆ ì»¬ëŸ¼ í•˜ë‚˜ë©´ @MapsIdë¥¼ ì‚¬ìš©í•˜ê³  ì†ì„± ê°’ì€ ë¹„ì›Œë‘ë©´ ëœë‹¤.</span>
    <span class="nd">@MapsId</span> <span class="c1">// BoardDetail.boardId ë§¤í•‘</span>
    <span class="nd">@OneToOne</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"BOARD_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Board</span> <span class="n">board</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ì‚¬ìš©ë°©ë²•</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Board</span> <span class="n">board</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Board</span><span class="o">();</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">board</span><span class="o">);</span>

<span class="nc">BoardDetail</span> <span class="n">boardDetail</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BoardDetail</span><span class="o">();</span>
<span class="n">boardDetail</span><span class="o">.</span><span class="na">setBoard</span><span class="o">(</span><span class="n">board</span><span class="o">);</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">boardDetail</span><span class="o">);</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="736-ì‹ë³„-ë¹„ì‹ë³„-ê´€ê³„ì˜-ì¥ë‹¨ì ">7.3.6 ì‹ë³„, ë¹„ì‹ë³„ ê´€ê³„ì˜ ì¥ë‹¨ì </h3>

<p><strong>ì‹ë³„ ê´€ê³„ ì¥ì </strong></p>
<ul>
  <li>íŠ¹ì • ìƒí™©ì—ì„œ ì¡°ì¸ ì—†ì´ í•˜ìœ„ í…Œì´ë¸”ë§Œìœ¼ë¡œ ê²€ìƒ‰í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><strong>ì‹ë³„ ê´€ê³„ ë‹¨ì </strong></p>
<ul>
  <li>ì‹ë³„ ê´€ê³„ëŠ” ë¶€ëª¨ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ë¥¼ ìì‹ í…Œì´ë¸”ë¡œ ì „íŒŒí•˜ë©´ì„œ ìì‹ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ ì»¬ëŸ¼ì´ ì ì  ëŠ˜ì–´ë‚œë‹¤.
    <ul>
      <li><strong>SQLë³µì¡, ê¸°ë³¸ í‚¤ ì¸ë±ìŠ¤ê°€ ì»¤ì§</strong></li>
    </ul>
  </li>
  <li>ì‹ë³„ ê´€ê³„ëŠ” ë³µí•© ê¸°ë³¸ í‚¤ë¥¼ ë§Œë“¤ì–´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ë§ë‹¤.</li>
  <li>ì‹ë³„ ê´€ê³„ë¥¼ ì‚¬ìš©í•  ë•Œ ê¸°ë³¸ í‚¤ë¡œ <strong>ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ë¯¸ê°€ ìˆëŠ” ìì—° í‚¤ ì»¬ëŸ¼ì„ ì¡°í•© í•˜ëŠ” ê²½ìš°ê°€ ë§ë‹¤</strong>.
    <ul>
      <li><strong>ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ì€ ì–¸ì œë‚˜ ë³€í•  ìˆ˜ ìˆë‹¤</strong>.</li>
    </ul>
  </li>
  <li>ì‹ë³„ ê´€ê³„ëŠ” <strong>í…Œì´ë¸” êµ¬ì¡°ê°€ ìœ ì—°í•˜ì§€ ëª»í•˜ë‹¤</strong>.</li>
  <li>ì‹ë³„ ê´€ê³„ëŠ” ì¼ëŒ€ì¼ ê´€ê³„ë¥¼ ì œì™¸í•˜ê³  ë³„ë„ì˜ ë³µí•© í‚¤ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•œë‹¤.
    <ul>
      <li><strong>ê¸°ë³¸ í‚¤ ë§¤í•‘ì— ë§ì€ ë…¸ë ¥ì´ í•„ìš”í•˜ë‹¤.</strong><br />
<br /></li>
    </ul>
  </li>
</ul>

<p><strong>ë¹„ì‹ë³„ ê´€ê³„ ì¥ì </strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">@GenerateValue</code>ì²˜ëŸ¼ í¸ë¦¬í•œ ëŒ€ë¦¬ í‚¤ ìƒì„± ë°©ë²• ì‚¬ìš© ê°€ëŠ¥</li>
  <li>ì‹ë³„ì ì»¬ëŸ¼ì´ í•˜ë‚˜ì—¬ì„œ ë§¤í•‘ì´ ì‰½ë‹¤.</li>
</ul>

<p><strong>ë¹„ì‹ë³„ ê´€ê³„ ë‹¨ì </strong></p>
<ul>
  <li>JPQL ì¡°íšŒì‹œ ê¸¸ì–´ì§ˆ ìˆ˜ ìˆë‹¤.<br />
<br /></li>
</ul>

<div class="notice--info">
<p><strong>ê²°ë¡ </strong><br />
ë¹„ì‹ë³„ ê´€ê³„ë¥¼ ì‚¬ìš©í•˜ê³  ê¸°ë³¸ í‚¤ëŠ” <code class="language-plaintext highlighter-rouge">Long</code> íƒ€ì…ì˜ ëŒ€ë¦¬ í‚¤ë¥¼ ì‚¬ìš©í•œë‹¤.</p>
</div>
<p><br />
<br />
<br /></p>

<h2 id="74-ì¡°ì¸-í…Œì´ë¸”">7.4 ì¡°ì¸ í…Œì´ë¸”</h2>
<p>ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì˜ ì—°ê´€ê´€ê³„ë¥¼ ì„¤ê³„í•˜ëŠ” ë°©ë²•ì€ í¬ê²Œ 2ê°€ì§€ë‹¤.</p>

<p><strong>ì¡°ì¸ ì»¬ëŸ¼</strong></p>
<center><img src="/assets/images/posts/books/2/7_4_ì¡°ì¸ì»¬ëŸ¼ì‚¬ìš©.png" width="100%" height="100%" /></center>
<p><br />
<br /></p>

<p><strong>ì¡°ì¸ í…Œì´ë¸”</strong></p>
<center><img src="/assets/images/posts/books/2/7_4_ì¡°ì¸í…Œì´ë¸”ì‚¬ìš©.png" width="100%" height="100%" /></center>

<div class="notice--info">
<p><strong>ì¶”ì²œ ë°©ë²•</strong><br />
ê¸°ë³¸ì€ ì¡°ì¸ ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ê³  í•„ìš”í•˜ë‹¤ê³  íŒë‹¨ë˜ë©´ ì¡°ì¸ í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì.</p>
</div>
<p><br />
<br />
<br /></p>

<h3 id="741-ì¼ëŒ€ì¼-ì¡°ì¸-í…Œì´ë¸”">7.4.1 ì¼ëŒ€ì¼ ì¡°ì¸ í…Œì´ë¸”</h3>
<center><img src="/assets/images/posts/books/2/7_4_ì¡°ì¸í…Œì´ë¸”ì¼ëŒ€ì¼.png" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ë¶€ëª¨</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Parent</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>


    <span class="nd">@OneToOne</span>
    <span class="nd">@JoinTable</span><span class="o">(</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_CHILD"</span><span class="o">,</span>
        <span class="n">joinColumn</span> <span class="o">=</span> <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID"</span><span class="o">),</span>
        <span class="n">inverseJoinColumns</span> <span class="o">=</span> <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"CHILD_ID"</span><span class="o">)</span>
    <span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Child</span> <span class="n">child</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ìì‹</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Child</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"CHILD_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="c1">// ì–‘ë°©í–¥ìœ¼ë¡œ ë§¤í•‘í•˜ë ¤ë©´ ë‹¤ìŒ ì½”ë“œë¥¼ ì¶”ê°€í•œë‹¤.</span>
    <span class="c1">// @OneToOne(mappedBy = "child")</span>
    <span class="c1">// private Parent parent;</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="742-ì¼ëŒ€ë‹¤-ì¡°ì¸-í…Œì´ë¸”">7.4.2 ì¼ëŒ€ë‹¤ ì¡°ì¸ í…Œì´ë¸”</h3>
<center><img src="/assets/images/posts/books/2/7_4_ì¡°ì¸í…Œì´ë¸”ì¼ëŒ€ë‹¤.png" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ë¶€ëª¨</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Parent</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@OneToMany</span>
    <span class="nd">@JoinTable</span><span class="o">(</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_CHILD"</span><span class="o">,</span>
        <span class="n">joinColumn</span> <span class="o">=</span> <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID"</span><span class="o">),</span>
        <span class="n">inverseJoinColumns</span> <span class="o">=</span> <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"CHILD_ID"</span><span class="o">)</span>
    <span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Child</span><span class="o">&gt;</span> <span class="n">child</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Child</span><span class="o">&gt;();</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ìì‹</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Child</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"CHILD_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="742-ë‹¤ëŒ€ì¼-ì¡°ì¸-í…Œì´ë¸”">7.4.2 ë‹¤ëŒ€ì¼ ì¡°ì¸ í…Œì´ë¸”</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ë¶€ëª¨</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Parent</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"parent"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Child</span><span class="o">&gt;</span> <span class="n">child</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Child</span><span class="o">&gt;();</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ìì‹</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Child</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"CHILD_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinTable</span><span class="o">(</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_CHILD"</span><span class="o">,</span>
        <span class="n">joinColumn</span> <span class="o">=</span> <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"CHILD_ID"</span><span class="o">),</span>
        <span class="n">inverseJoinColumns</span> <span class="o">=</span> <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID"</span><span class="o">)</span>
    <span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Parent</span> <span class="n">parent</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="744-ë‹¤ëŒ€ë‹¤-ì¡°ì¸-í…Œì´ë¸”">7.4.4 ë‹¤ëŒ€ë‹¤ ì¡°ì¸ í…Œì´ë¸”</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ë¶€ëª¨</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Parent</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@ManyToMany</span>
    <span class="nd">@JoinTable</span><span class="o">(</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_CHILD"</span><span class="o">,</span>
        <span class="n">joinColumn</span> <span class="o">=</span> <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"PARENT_ID"</span><span class="o">),</span>
        <span class="n">inverseJoinColumns</span> <span class="o">=</span> <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"CHILD_ID"</span><span class="o">)</span>
    <span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Child</span><span class="o">&gt;</span> <span class="n">child</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Child</span><span class="o">&gt;();</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ìì‹</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Child</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"CHILD_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br />
<br /></p>

<h2 id="75-ì—”í‹°í‹°-í•˜ë‚˜ì—-ì—¬ëŸ¬-í…Œì´ë¸”-ë§¤í•‘">7.5 ì—”í‹°í‹° í•˜ë‚˜ì— ì—¬ëŸ¬ í…Œì´ë¸” ë§¤í•‘</h2>
<p><code class="language-plaintext highlighter-rouge">@SecondaryTable</code>ì„ ì‚¬ìš©í•˜ë©´ í•œ ì—”í‹°í‹°ì— ì—¬ëŸ¬ í…Œì´ë¸”ì„ ë§¤í•‘í•  ìˆ˜ ìˆë‹¤.</p>

<center><img src="/assets/images/posts/books/2/7_5_í•˜ë‚˜ì˜ì—”í‹°í‹°ì—ì—¬ëŸ¬í…Œì´ë¸”ë§¤í•‘.png" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"BOARD"</span><span class="o">)</span>
<span class="nd">@SecondaryTable</span><span class="o">(</span> 
    <span class="n">name</span> <span class="o">=</span> <span class="s">"BOARD_DETAIL"</span><span class="o">,</span>
    <span class="n">pkJoinColumns</span> <span class="o">=</span> <span class="nd">@PrimaryKeyJoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"BOARD_DETAIL_ID"</span><span class="o">)</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Board</span> <span class="o">{</span>
    
    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"BOARD_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"BOARD_DETAIL"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">content</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">@SecondaryTable.name</code>: ë§¤í•‘í•  ë‹¤ë¥¸ í…Œì´ë¸” ì´ë¦„</li>
  <li><code class="language-plaintext highlighter-rouge">@SecondaryTable.pkJoinColumns</code>: ë§¤í•‘í•  ë‹¤ë¥¸ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ ì»¬ëŸ¼ ì†ì„±</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì—¬ëŸ¬ê°œ ê°€ëŠ¥</span>
<span class="nd">@SecondaryTables</span><span class="o">({</span>
    <span class="nd">@SecondaryTable</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"BOARD_DETAIL"</span><span class="o">),</span>
    <span class="nd">@SecondaryTable</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"BOARD_FILE"</span><span class="o">)</span>
<span class="o">})</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">@SecondaryTable</code>ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒë³´ë‹¨ <strong>í…Œì´ë¸”ë‹¹ ì—”í‹°í‹°ë¥¼ ê°ê° ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•œë‹¤.</strong></p>

<p><br />
<br />
<br />
<br />
<br /></p>

<h1 id="8-í”„ë¡ì‹œì™€-ì—°ê´€ê´€ê³„-ê´€ë¦¬">8. í”„ë¡ì‹œì™€ ì—°ê´€ê´€ê³„ ê´€ë¦¬</h1>
<ul>
  <li>í”„ë¡ì‹œì™€ ì¦‰ì‹œë¡œë”©, ì§€ì—°ë¡œë”©</li>
  <li>ì˜ì†ì„± ì „ì´ì™€ ê³ ì•„ ê°ì²´</li>
</ul>

<h2 id="81-í”„ë¡ì‹œ">8.1 í”„ë¡ì‹œ</h2>
<ul>
  <li>ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•  ë•Œ ì—°ê´€ëœ ì—”í‹°í‹°ë“¤ì´ í•­ìƒ ì‚¬ìš©ë˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.</li>
  <li>ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì—”í‹°í‹°ë¥¼ í•¨ê»˜ ì¡°íšŒí•´ ë‘ëŠ” ê²ƒì€ íš¨ìœ¨ì ì´ì§€ ì•Šë‹¤.</li>
  <li>JPAëŠ” ì´ëŸ° ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ê³  ì§€ì—° ë¡œë”©ì„ ì œê³µí•œë‹¤.</li>
  <li>ì§€ì—° ë¡œë”©ì´ë€ ì‹¤ì œ ì‚¬ìš©í•˜ëŠ” ì‹œì ì— ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¡°íšŒí•˜ëŠ” ê²ƒì´ë‹¤.</li>
  <li>ì§€ì—° ë¡œë”© ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ ì‹¤ì œ ì—”í‹°í‹° ê°ì²´ ëŒ€ì‹ ì— ê°€ì§œ ê°ì²´ê°€ í•„ìš”í•œë° ì´ê²ƒì„ í”„ë¡ì‹œ ê°ì²´ë¼ í•œë‹¤.<br />
<br /></li>
</ul>

<h3 id="811-í”„ë¡ì‹œ-ê¸°ì´ˆ">8.1.1 í”„ë¡ì‹œ ê¸°ì´ˆ</h3>
<p><strong>í”„ë¡ì‹œì˜ íŠ¹ì§•</strong></p>
<center><img src="/assets/images/posts/books/2/8_1_í”„ë¡ì‹œêµ¬ì¡°.png" width="100%" height="100%" /></center>

<ul>
  <li>í”„ë¡ì‹œ í´ë˜ìŠ¤ëŠ” ì‹¤ì œ í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ì•„ì„œ ë§Œë“¤ì–´ì§„ë‹¤.</li>
  <li>ë”°ë¼ì„œ ì‚¬ìš©í•˜ëŠ” ì…ì¥ì—ì„œëŠ” ì´ê²ƒì´ ì§„ì§œ ê°ì²´ì¸ì§€ í”„ë¡ì‹œ ê°ì²´ì¸ì§€ êµ¬ë¶„í•˜ì§€ ì•Šê³  ì‚¬ìš©í•˜ë©´ ëœë‹¤.</li>
  <li>í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹¤ì œ ê°ì²´ì— ëŒ€í•œ ì°¸ì¡°ë¥¼ ë³´ê´€í•œë‹¤.</li>
  <li>í”„ë¡ì‹œ ê°ì²´ì˜ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ë©´, í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹¤ì œ ê°ì²´ì˜ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•œë‹¤.</li>
  <li>í”„ë¡ì‹œ ê°ì²´ëŠ” ì²˜ìŒ ì‚¬ìš©í•  ë•Œ í•œ ë²ˆë§Œ ì´ˆê¸°í™” í•œë‹¤.<br />
<br /></li>
</ul>

<p><strong>í”„ë¡ì‹œ ê°ì²´ì˜ ì´ˆê¸°í™”</strong></p>
<center><img src="/assets/images/posts/books/2/8_1_í”„ë¡ì‹œì´ˆê¸°í™”.png" width="100%" height="100%" /></center>

<ul>
  <li>í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹¤ì œ ì‚¬ìš©ë  ë•Œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¡°íšŒí•´ì„œ ì‹¤ì œ ì—”í‹°í‹° ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.</li>
  <li>ì´ë¥¼ í”„ë¡ì‹œ ê°ì²´ì˜ ì´ˆê¸°í™”ë¼ í•œë‹¤.<br />
<br /></li>
</ul>

<p><strong>ì¤€ì˜ì† ìƒíƒœì™€ ì´ˆê¸°í™”</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// em.getReference()ë¥¼ í˜¸ì¶œí•˜ë©´ ì—”í‹°í‹°ë¥¼ ì‹¤ì œ ì‚¬ìš©í•˜ëŠ” ì‹œì ê¹Œì§€ ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒë¥¼ ë¯¸ë£¬ë‹¤.</span>
<span class="c1">// MemberProxy ë°˜í™˜</span>
<span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getReference</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"id1"</span><span class="o">);</span>

<span class="n">tx</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
<span class="n">em</span><span class="o">.</span><span class="na">close</span><span class="o">();</span> <span class="c1">// ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ì¢…ë£Œ</span>
<span class="n">member</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span> <span class="c1">// ì¤€ì˜ì† ìƒíƒœì—ì„œ ì´ˆê¸°í™” ì‹œë„</span>
                  <span class="c1">// org.hibernate.LazyInitializationException ë°œìƒ</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="812-í”„ë¡ì‹œì™€-ì‹ë³„ì">8.1.2 í”„ë¡ì‹œì™€ ì‹ë³„ì</h3>
<p>ì—”í‹°í‹°ë¥¼ í”„ë¡ì‹œë¡œ ì¡°íšŒí•  ë•Œ ì‹ë³„ì(PK) ê°’ì„ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬í•˜ëŠ”ë° í”„ë¡ì‹œ ê°ì²´ëŠ” ì´ ì‹ë³„ì ê°’ì„ ë³´ê´€í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Team</span> <span class="n">team</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getReference</span><span class="o">(</span><span class="nc">Team</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"team1"</span><span class="o">);</span> <span class="c1">// ì‹ë³„ì ë³´ê´€</span>
<span class="n">team</span><span class="o">.</span><span class="na">getId</span><span class="o">();</span> <span class="c1">// ì´ˆê¸°í™”ë˜ì§€ ì•ŠìŒ</span>
</code></pre></div></div>
<p>ë‹¨ <code class="language-plaintext highlighter-rouge">@Access(AccessType.PROPERTY)</code>ì¼ ë•Œë§Œ ìœ„ì²˜ëŸ¼ ë™ì‘í•˜ê³ , <code class="language-plaintext highlighter-rouge">@Access(AccessType.FIELD)</code>ë¡œ ì„¤ì •í•˜ë©´ í”„ë¡ì‹œ ê°ì²´ë¥¼ ì´ˆê¸°í™” í•œë‹¤.<br />
<br />
<br /></p>

<h3 id="813-í”„ë¡ì‹œ-í™•ì¸">8.1.3 í”„ë¡ì‹œ í™•ì¸</h3>
<p>JPAê°€ ì œê³µí•˜ëŠ” <code class="language-plaintext highlighter-rouge">PersistenceUnitUtil.isLoaded(Object entity)</code> ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ í”„ë¡ì‹œ ì¸ìŠ¤í„´ìŠ¤ì˜ ì´ˆê¸°í™” ì—¬ë¶€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">boolean</span> <span class="n">isLoad</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getEntityManagerFactory</span><span class="o">()</span>
                <span class="o">.</span><span class="na">getPersistenceUnitUtil</span><span class="o">().</span><span class="na">isLoaded</span><span class="o">(</span><span class="n">entity</span><span class="o">);</span>
</code></pre></div></div>
<p><br />
<br />
<br /></p>

<h2 id="82-ì¦‰ì‹œ-ë¡œë”©ê³¼-ì§€ì—°-ë¡œë”©">8.2 ì¦‰ì‹œ ë¡œë”©ê³¼ ì§€ì—° ë¡œë”©</h2>
<p>JPAëŠ” ê°œë°œìê°€ ì—°ê´€ëœ ì—”í‹°í‹°ì˜ ì¡°íšŒ ì‹œì ì„ ì„ íƒí•  ìˆ˜ ìˆë„ë¡ ë‹¤ìŒ ë‘ ê°€ì§€ ë°©ë²•ì„ ì œê³µí•œë‹¤.</p>
<ul>
  <li>ì¦‰ì‹œ ë¡œë”©: ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•  ë•Œ ì—°ê´€ëœ ì—”í‹°í‹°ë„ í•¨ê»˜ ì¡°íšŒí•œë‹¤.
    <ul>
      <li>ì„¤ì • ë°©ë²•: <code class="language-plaintext highlighter-rouge">@ManyToOne(fetch = FetchType.EAGER)</code></li>
    </ul>
  </li>
  <li>ì§€ì—° ë¡œë”©: ì—°ê´€ëœ ì—”í‹°í‹°ë¥¼ ì‹¤ì œ ì‚¬ìš©í•  ë•Œ ì¡°íšŒí•œë‹¤.
    <ul>
      <li>ì„¤ì • ë°©ë²•: <code class="language-plaintext highlighter-rouge">@ManyToOne(fetch = FetchType.LAZY)</code><br />
<br />
<br /></li>
    </ul>
  </li>
</ul>

<h3 id="821-ì¦‰ì‹œ-ë¡œë”©">8.2.1 ì¦‰ì‹œ ë¡œë”©</h3>
<p>ì¦‰ì‹œ ë¡œë”©ì„ ì‚¬ìš©í•˜ë ¤ë©´ <code class="language-plaintext highlighter-rouge">@ManyToOne(fetch = FetchType.EAGER)</code>ë¡œ ì§€ì •í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="nd">@ManyToOne</span><span class="o">(</span><span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">EAGER</span><span class="o">)</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"TEAM_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Team</span> <span class="n">team</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="822-ì§€ì—°-ë¡œë”©">8.2.2 ì§€ì—° ë¡œë”©</h3>
<p>ì§€ì—° ë¡œë”©ì„ ì‚¬ìš©í•˜ë ¤ë©´ <code class="language-plaintext highlighter-rouge">@ManyToOne(fetch = FetchType.LAZY)</code>ë¡œ ì§€ì •í•œë‹¤. ì§€ì—° ë¡œë”©ì€ í”„ë¡ì‹œ ê°ì²´ë¥¼ ì´ìš©í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="nd">@ManyToOne</span><span class="o">(</span><span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"TEAM_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Team</span> <span class="n">team</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p class="notice--info"><strong>ì°¸ê³ </strong><br />
ì¡°íšŒ ëŒ€ìƒì´ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì´ë¯¸ ìˆìœ¼ë©´ í”„ë¡ì‹œ ê°ì²´ë¥¼ ì‚¬ìš©í•  ì´ìœ ê°€ ì—†ë‹¤. ë”°ë¼ì„œ ì‹¤ì œ ê°ì²´ë¥¼ ì‚¬ìš©í•œë‹¤.</p>
<p><br /></p>

<h3 id="823-ì¦‰ì‹œ-ë¡œë”©-ì§€ì—°-ë¡œë”©-ì •ë¦¬">8.2.3 ì¦‰ì‹œ ë¡œë”©, ì§€ì—° ë¡œë”© ì •ë¦¬</h3>
<ul>
  <li>ì§€ì—° ë¡œë”©: ì—°ê´€ëœ ì—”í‹°í‹°ë¥¼ í”„ë¡ì‹œë¡œ ì¡°íšŒí•œë‹¤. í”„ë¡ì‹œë¥¼ ì‹¤ì œ ì‚¬ìš©í•  ë•Œ ì´ˆê¸°í™”í•˜ë©´ì„œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¡°íšŒí•œë‹¤.</li>
  <li>ì¦‰ì‹œ ë¡œë”©: ì—°ê´€ëœ ì—”í‹°í‹°ë¥¼ ì¦‰ì‹œ ì¡°íšŒí•œë‹¤. í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” ê°€ëŠ¥í•˜ë©´ SQL ì¡°ì¸ì„ ì‚¬ìš©í•´ì„œ í•œ ë²ˆì— ì¡°íšŒí•œë‹¤.<br />
<br />
<br />
<br /></li>
</ul>

<h2 id="83-ì§€ì—°-ë¡œë”©-í™œìš©">8.3 ì§€ì—° ë¡œë”© í™œìš©</h2>
<p>ì—°ê´€ëœ ì—”í‹°í‹°ê°€ ìì£¼ í•¨ê»˜ ì‚¬ìš©ë˜ëŠ”ì§€ ì•„ë‹Œì§€ì— ë”°ë¼ ì¦‰ì‹œ ë¡œë”©, ì§€ì—° ë¡œë”©ì„ ê²°ì •í•œë‹¤.</p>

<h3 id="831-í”„ë¡ì‹œì™€-ì»¬ë ‰ì…˜-ë˜í¼">8.3.1 í”„ë¡ì‹œì™€ ì»¬ë ‰ì…˜ ë˜í¼</h3>
<p>ì»¬ë ‰ì…˜ì˜ ì§€ì—° ë¡œë”©</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"member1"</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">member</span><span class="o">.</span><span class="na">getOrders</span><span class="o">();</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">orders</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span> 

<span class="c1">// ì¶œë ¥</span>
<span class="c1">// org.hibernate.collection.internal.PersistenBag</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="832-jpa-ê¸°ë³¸-í˜ì¹˜-ì „ëµ">8.3.2 JPA ê¸°ë³¸ í˜ì¹˜ ì „ëµ</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">@ManyToOne</code>, <code class="language-plaintext highlighter-rouge">@OneToOne</code>: ì¦‰ì‹œ ë¡œë”©(FetchType.EAGER)</li>
  <li><code class="language-plaintext highlighter-rouge">@OneToMany</code>, <code class="language-plaintext highlighter-rouge">@ManyToMany</code>: ì§€ì—° ë¡œë”©(FetchType.LAZY)</li>
</ul>

<p class="notice--info"><strong>ì¶”ì²œí•˜ëŠ” ë°©ë²•ì€ ëª¨ë“  ì—°ê´€ê´€ê³„ì— ì§€ì—° ë¡œë”©ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤.</strong> ê·¸ë¦¬ê³  ê¼­ í•„ìš”í•œ ê³³ì—ë§Œ ì¦‰ì‹œ ë¡œë”©ì„ ì‚¬ìš©í•˜ë„ë¡ í•œë‹¤.</p>
<p><br />
<br /></p>

<h3 id="833-ì»¬ë ‰ì…˜ì—-fetchtypeeager-ì‚¬ìš©-ì‹œ-ì£¼ì˜ì ">8.3.3 ì»¬ë ‰ì…˜ì— FetchType.EAGER ì‚¬ìš© ì‹œ ì£¼ì˜ì </h3>
<p>ì»¬ë ‰ì…˜ì— <code class="language-plaintext highlighter-rouge">FetchType.EAGER</code>ë¥¼ ì‚¬ìš©í•  ê²½ìš° ì£¼ì˜í•  ì ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<ul>
  <li><strong>ì»¬ë ‰ì…˜ì„ ì¦‰ì‹œ ë¡œë”©í•˜ëŠ” ê²ƒì€ ê¶Œì¥í•˜ì§€ ì•ŠëŠ”ë‹¤</strong>.
    <ul>
      <li>ë„ˆë¬´ ë§ì€ ë°ì´í„°ë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆê³ , ê²°ê³¼ì ìœ¼ë¡œ <strong>ì„±ëŠ¥ì´ ì €í•˜ë  ìˆ˜ ìˆë‹¤</strong>.</li>
    </ul>
  </li>
  <li>ì»¬ë ‰ì…˜ ì¦‰ì‹œ ë¡œë”©ì€ í•­ìƒ <code class="language-plaintext highlighter-rouge">OUTER JOIN</code>ì„ ì‚¬ìš©í•œë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">@ManyToOne</code>, <code class="language-plaintext highlighter-rouge">@OneToOne</code>
    <ul>
      <li>(optional = false): ë‚´ë¶€ ì¡°ì¸</li>
      <li>(optional = true): ì™¸ë¶€ ì¡°ì¸</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">@OneToMany</code>, <code class="language-plaintext highlighter-rouge">@ManyToMany</code>
    <ul>
      <li>(optional = false): ì™¸ë¶€ ì¡°ì¸</li>
      <li>(optional = true): ë‚´ë¶€ ì¡°ì¸<br />
<br />
<br /></li>
    </ul>
  </li>
</ul>

<h2 id="84-ì˜ì†ì„±-ì „ì´-cascade">8.4 ì˜ì†ì„± ì „ì´: CASCADE</h2>
<p>íŠ¹ì • ì—”í‹°í‹°ë¥¼ ì—°ì† ìƒíƒœë¡œ ë§Œë“¤ ë•Œ ì—°ê´€ëœ ì—”í‹°í‹°ë„ í•¨ê»˜ ì˜ì† ìƒíƒœë¡œ ë§Œë“¤ê³  ì‹¶ìœ¼ë©´ ì˜ì†ì„± ì „ì´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•œë‹¤. <strong>JPAì—ì„œ ì—”í‹°í‹°ë¥¼ ì €ì¥í•  ë•Œ ì—°ê´€ëœ ëª¨ë“  ì—”í‹°í‹°ëŠ” ì˜ì† ìƒíƒœì—¬ì•¼ í•œë‹¤.</strong></p>

<h3 id="841-ì˜ì†ì„±-ì „ì´-ì €ì¥">8.4.1 ì˜ì†ì„± ì „ì´: ì €ì¥</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Parent</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"parent"</span><span class="o">,</span> <span class="n">cascade</span> <span class="o">=</span> <span class="nc">CascadeType</span><span class="o">.</span><span class="na">PERSIST</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Child</span><span class="o">&gt;</span> <span class="n">children</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Child</span><span class="o">&gt;();</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Parent</span> <span class="n">parent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Parent</span><span class="o">();</span>
<span class="nc">Child</span> <span class="n">child</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Child</span><span class="o">();</span>

<span class="n">child</span><span class="o">.</span><span class="na">setParent</span><span class="o">(</span><span class="n">parent</span><span class="o">);</span>
<span class="n">parent</span><span class="o">.</span><span class="na">getChildren</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">child</span><span class="o">);</span>

<span class="c1">// Parentë§Œ ì €ì¥í–ˆì§€ë§Œ, ì˜ì†ì„± ì „ì´ì— ì˜í•´ Childë„ ì €ì¥ë¨</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">parent</span><span class="o">);</span>
</code></pre></div></div>
<p>ì˜ì†ì„± ì „ì´ëŠ” ì—°ê´€ê´€ê³„ë¥¼ ë§¤í•‘í•˜ëŠ” ê²ƒê³¼ëŠ” ì•„ë¬´ ê´€ë ¨ì´ ì—†ë‹¤. ë‹¨ì§€ <strong>ì—”í‹°í‹°ë¥¼ ì˜ì†í™”í•  ë•Œ ì—°ê´€ëœ ì—”í‹°í‹°ë„ ê°™ì´ ì˜ì†í™”í•˜ëŠ” í¸ë¦¬í•¨ì„ ì œê³µí•  ë¿ì´ë‹¤.</strong><br />
<br /></p>

<h3 id="842-ì˜ì†ì„±-ì „ì´-ì‚­ì œ">8.4.2 ì˜ì†ì„± ì „ì´: ì‚­ì œ</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Parent</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"parent"</span><span class="o">,</span> <span class="n">cascade</span> <span class="o">=</span> <span class="nc">CascadeType</span><span class="o">.</span><span class="na">REMOVE</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Child</span><span class="o">&gt;</span> <span class="n">children</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Child</span><span class="o">&gt;();</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Parent</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Parent</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="mi">1L</span><span class="o">);</span>

<span class="c1">// Parentë§Œ ì‚­ì œí–ˆì§€ë§Œ, ì˜ì†ì„± ì „ì´ì— ì˜í•´ Childë„ ì‚­ì œë¨</span>
<span class="n">em</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">parent</span><span class="o">);</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="843-cascadeì˜-ì¢…ë¥˜">8.4.3 CASCADEì˜ ì¢…ë¥˜</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">enum</span> <span class="nc">CascadeType</span> <span class="o">{</span>
    <span class="no">ALL</span><span class="o">,</span>        <span class="c1">// ëª¨ë‘ ì ìš©</span>
    <span class="no">PERSIST</span><span class="o">,</span>    <span class="c1">// ì˜ì†</span>
    <span class="no">MERGE</span><span class="o">,</span>      <span class="c1">// ë³‘í•©</span>
    <span class="no">REMOVE</span><span class="o">,</span>     <span class="c1">// ì‚­ì œ</span>
    <span class="no">REFRESH</span><span class="o">,</span>
    <span class="no">DETACH</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br />
<br /></p>

<h2 id="85-ê³ ì•„-ê°ì²´">8.5 ê³ ì•„ ê°ì²´</h2>
<p>JPAëŠ” ë¶€ëª¨ ì—”í‹°í‹°ì™€ ì—°ê´€ê´€ê³„ê°€ ëŠì–´ì§„ ìì‹ ì—”í‹°í‹°ë¥¼ ìë™ìœ¼ë¡œ ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ”ë° ì´ê²ƒì„ ê³ ì•„ ê°ì²´(<code class="language-plaintext highlighter-rouge">ORPHAN</code>) ì œê±°ë¼ í•œë‹¤. <strong>ë¶€ëª¨ ì—”í‹°í‹°ì˜ ì»¬ë ‰ì…˜ì—ì„œ ìì‹ ì—”í‹°í‹°ì˜ ì°¸ì¡°ë§Œ ì œê±°í•˜ë©´ ìì‹ ì—”í‹°í‹°ê°€ ìë™ìœ¼ë¡œ ì‚­ì œëœë‹¤.</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Parent</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mapeedBy</span> <span class="o">=</span> <span class="s">"parent"</span><span class="o">,</span> <span class="n">orphanRemoval</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Child</span><span class="o">&gt;</span> <span class="n">children</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Child</span><span class="o">&gt;();</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Parent</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Parent</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>
<span class="n">parent</span><span class="o">.</span><span class="na">getChildren</span><span class="o">().</span><span class="na">remove</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">// ìì‹ ì—”í‹°í‹°ë¥¼ ì»¬ë ‰ì…˜ì—ì„œ ì‚­ì œ</span>

<span class="c1">// SQL</span>
<span class="no">DELETE</span> <span class="no">FROM</span> <span class="no">CHILD</span> <span class="no">WHERE</span> <span class="no">ID</span><span class="o">=?</span>
</code></pre></div></div>
<p>ê³ ì•„ ê°ì²´ ì œê±°ëŠ” <strong>ì°¸ì¡°ê°€ ì œê±°ëœ ì—”í‹°í‹°ëŠ” ë‹¤ë¥¸ ê³³ì—ì„œ ì°¸ì¡°í•˜ì§€ ì•ŠëŠ” ê³ ì•„ ê°ì²´ë¡œ ë³´ê³  ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥</strong>ì´ë‹¤. ë˜, ë¶€ëª¨ë¥¼ ì œê±°í•˜ë©´ ìì‹ë„ ê°™ì´ ì œê±°ëœë‹¤.<br />
<br />
<br /></p>

<h2 id="86-ì˜ì†ì„±-ì „ì´--ê³ ì•„-ê°ì²´-ìƒëª…-ì£¼ê¸°">8.6 ì˜ì†ì„± ì „ì´ + ê³ ì•„ ê°ì²´, ìƒëª… ì£¼ê¸°</h2>
<p><code class="language-plaintext highlighter-rouge">CascadeType.All + orphanRemoval = true</code>ë¥¼ ë™ì‹œì— ì‚¬ìš©í•˜ë©´ ì–´ë–»ê²Œ ë ê¹Œ? ë‘ ì˜µì…˜ì„ ëª¨ë‘ í™œì„±í™” í•˜ë©´ ë¶€ëª¨ ì—”í‹°í‹°ë¥¼ í†µí•´ì„œ ìì‹ì˜ ìƒëª…ì£¼ê¸°ë¥¼ ê´€ë¦¬ í•  ìˆ˜ ìˆë‹¤.</p>
<ul>
  <li>ìì‹ì„ ì €ì¥í•˜ë ¤ë©´ ë¶€ëª¨ì— ë“±ë¡í•˜ë©´ ëœë‹¤ (CASCADE)</li>
  <li>ìì‹ì„ ì‚­ì œí•˜ë ¤ë©´ ë¶€ëª¨ì—ì„œ ì œê±°í•˜ë©´ ëœë‹¤ (orphanRemoval)<br />
<br />
<br />
<br />
<br />
<br /></li>
</ul>

<h1 id="9-ê°’-íƒ€ì…">9. ê°’ íƒ€ì…</h1>
<p>JPAì˜ ë°ì´í„° íƒ€ì…</p>
<ul>
  <li>ì—”í‹°í‹° íƒ€ì…
    <ul>
      <li><code class="language-plaintext highlighter-rouge">@Entity</code></li>
    </ul>
  </li>
  <li>ê°’ íƒ€ì…
    <ul>
      <li>ê¸°ë³¸ê°’ íƒ€ì…
        <ul>
          <li>ìë°” ê¸°ë³¸ íƒ€ì…(ì˜ˆ: int, double)</li>
          <li>ë˜í¼ í´ë˜ìŠ¤(ì˜ˆ: Integer)</li>
          <li>String</li>
        </ul>
      </li>
      <li>ì„ë² ë””ë“œ íƒ€ì…
        <ul>
          <li>embedded type</li>
        </ul>
      </li>
      <li>ì»¬ë ‰ì…˜ ê°’ íƒ€ì…
        <ul>
          <li>collection value type</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="91-ê¸°ë³¸ê°’-íƒ€ì…">9.1 ê¸°ë³¸ê°’ íƒ€ì…</h2>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
<span class="kd">private</span> <span class="kt">int</span> <span class="n">age</span><span class="o">;</span>
<span class="o">...</span>
</code></pre></div></div>
<p><br /></p>

<h2 id="92-ì„ë² ë””ë“œ-íƒ€ì…ë³µí•©-ê°’-íƒ€ì…">9.2 ì„ë² ë””ë“œ íƒ€ì…(ë³µí•© ê°’ íƒ€ì…)</h2>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="nd">@Embedded</span> <span class="nc">Address</span> <span class="n">homeAddress</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Embeddable</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Address</span> <span class="o">{</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"city"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">city</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">street</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">zipcode</span><span class="o">;</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li><code class="language-plaintext highlighter-rouge">@Embeddable</code>: ê°’ íƒ€ì…ì„ ì •ì˜í•˜ëŠ” ê³³ì— í‘œì‹œ</li>
  <li><code class="language-plaintext highlighter-rouge">@Embedded</code>: ê°’ íƒ€ì…ì„ ì‚¬ìš©í•˜ëŠ” ê³³ì— í‘œì‹œ<br />
<br />
<br /></li>
</ul>

<h3 id="921-ì„ë² ë””ë“œ-íƒ€ì…ê³¼-í…Œì´ë¸”-ë§¤í•‘">9.2.1 ì„ë² ë””ë“œ íƒ€ì…ê³¼ í…Œì´ë¸” ë§¤í•‘</h3>
<center><img src="/assets/images/posts/books/2/9_2_ê°’íƒ€ì…í…Œì´ë¸”ë§¤í•‘.png" width="100%" height="100%" /></center>
<center><img src="/assets/images/posts/books/2/9_2_ê°’íƒ€ì…í…Œì´ë¸”ë§¤í•‘2.png" width="100%" height="100%" /></center>
<p>UMLì—ì„œ ì„ë² ë””ë“œ ê°’ íƒ€ì…ì€ ë‹¨ìˆœí•˜ê²Œ í‘œí˜„í•˜ëŠ” ê²ƒì´ í¸ë¦¬í•˜ë‹¤.<br />
<br />
<br /></p>

<h3 id="922-ì„ë² ë””ë“œ-íƒ€ì…ê³¼-ì—°ê´€ê´€ê³„">9.2.2 ì„ë² ë””ë“œ íƒ€ì…ê³¼ ì—°ê´€ê´€ê³„</h3>
<center><img src="/assets/images/posts/books/2/9_2_ì„ë² ë””ë“œíƒ€ì…ê³¼ì—°ê´€ê´€ê³„.png" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="nd">@Embedded</span> <span class="nc">Address</span> <span class="n">address</span><span class="o">;</span>
    <span class="nd">@Embedded</span> <span class="nc">PhoneNumber</span> <span class="n">phoneNumber</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Embeddable</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Address</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">city</span><span class="o">;</span>
    <span class="nc">String</span> <span class="n">street</span><span class="o">;</span>
    <span class="nc">String</span> <span class="n">state</span><span class="o">;</span>
    <span class="nd">@Embedded</span> <span class="nc">Zipcode</span> <span class="n">zipcode</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Embeddable</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Zipcode</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">zip</span><span class="o">;</span>
    <span class="nc">String</span> <span class="n">plusFour</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Embeddable</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PhoneNumber</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">areaCode</span><span class="o">;</span>
    <span class="nc">String</span> <span class="n">localNumber</span><span class="o">;</span>
    <span class="nd">@ManyToOne</span> <span class="nc">PhoneServiceProvider</span> <span class="n">provider</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PhoneServiceProvider</span> <span class="o">{</span>
    <span class="nd">@Id</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="923-attributeoverride-ì†ì„±-ì¬ì •ì˜">9.2.3 @AttributeOverride: ì†ì„± ì¬ì •ì˜</h3>
<p>ì„ë² ë””ë“œ íƒ€ì…ì— ì •ì˜í•œ ë§¤í•‘ì •ë³´ë¥¼ ì¬ì •ì˜ í•˜ë ¤ë©´ ì—”í‹°í‹°ì— <code class="language-plaintext highlighter-rouge">@AttributeOverride</code>ë¥¼ ì‚¬ìš©í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="nd">@Embedded</span>
    <span class="kd">private</span> <span class="nc">Address</span> <span class="n">address</span><span class="o">;</span>

    <span class="nd">@Embedded</span>
    <span class="nd">@AttributeOverrides</span><span class="o">({</span>
        <span class="nd">@AttributeOverride</span><span class="o">(</span><span class="n">ame</span><span class="o">=</span><span class="s">"city"</span><span class="o">,</span> <span class="n">column</span><span class="o">=</span><span class="nd">@Column</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"COMPANY_CITY"</span><span class="o">)),</span>
        <span class="nd">@AttributeOverride</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"street"</span><span class="o">,</span> <span class="n">column</span><span class="o">=</span><span class="nd">@Column</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"COMPANY_STREET"</span><span class="o">)),</span>
        <span class="nd">@AttributeOverride</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"zipcode"</span><span class="o">,</span> <span class="n">column</span><span class="o">=</span><span class="nd">@Column</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"COMPANY_ZIPCODE"</span><span class="o">))</span>
    <span class="o">})</span>
    <span class="kd">private</span> <span class="nc">Address</span> <span class="n">companyAddress</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="924-ì„ë² ë””ë“œ-íƒ€ì…ê³¼-null">9.2.4 ì„ë² ë””ë“œ íƒ€ì…ê³¼ null</h3>
<p>ì„ë² ë””ë“œ íƒ€ì…ì´ nullì´ë©´ ë§¤í•‘í•œ ì»¬ëŸ¼ ê°’ì€ ëª¨ë‘ nullì´ ëœë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">member</span><span class="o">.</span><span class="na">setAddress</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>
<span class="c1">// íšŒì› í…Œì´ë¸”ì˜ ì£¼ì†Œì™€ ê´€ë ¨ëœ CITY,STREET,ZIPCODE ì»¬ëŸ¼ ê°’ì€ ëª¨ë‘ nullì´ ëœë‹¤.</span>
</code></pre></div></div>
<p><br />
<br />
<br /></p>

<h2 id="93-ê°’-íƒ€ì…ê³¼-ë¶ˆë³€-ê°ì²´">9.3 ê°’ íƒ€ì…ê³¼ ë¶ˆë³€ ê°ì²´</h2>
<p>ê°’ íƒ€ì…ì€ ë³µì¡í•œ ê°ì²´ë¥¼ ì¡°ê¸ˆì´ë¼ë„ ë‹¨ìˆœí™”í•˜ë ¤ê³  ë§Œë“  ê°œë…ì´ë‹¤. ë”°ë¼ì„œ ê°’ íƒ€ì…ì€ ë‹¨ìˆœí•˜ê³  ì•ˆì „í•˜ê²Œ ë‹¤ë£° ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.</p>

<h3 id="931-ê°’-íƒ€ì…-ê³µìœ -ì°¸ì¡°">9.3.1 ê°’ íƒ€ì… ê³µìœ  ì°¸ì¡°</h3>
<p>ì„ë² ë””ë“œ íƒ€ì… ê°™ì€ ê°’ íƒ€ì…ì„ ì—¬ëŸ¬ ì—”í‹°í‹°ì—ì„œ ê³µìœ í•˜ë©´ ìœ„í•¨í•˜ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">member1</span><span class="o">.</span><span class="na">setAddress</span><span class="o">(</span><span class="k">new</span> <span class="nc">Address</span><span class="o">(</span><span class="s">"OldCity"</span><span class="o">));</span>
<span class="nc">Address</span> <span class="n">address</span> <span class="o">=</span> <span class="n">member1</span><span class="o">.</span><span class="na">getAddress</span><span class="o">();</span>

<span class="n">address</span><span class="o">.</span><span class="na">setCity</span><span class="o">(</span><span class="s">"NewCity"</span><span class="o">);</span>
<span class="n">member2</span><span class="o">.</span><span class="na">setAddress</span><span class="o">(</span><span class="n">address</span><span class="o">);</span>

<span class="c1">// íšŒì›2ì˜ ì£¼ì†Œë§Œ NewCityë¡œ ë³€ê²½ë˜ê¸°ë¥¼ ê¸°ëŒ€í•˜ì§€ë§Œ íšŒì›1ì˜ ì£¼ì†Œë„ NewCityë¡œ ë³€ê²½ë˜ì–´ ë²„ë¦°ë‹¤.</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="932-ê°’-íƒ€ì…-ë³µì‚¬">9.3.2 ê°’ íƒ€ì… ë³µì‚¬</h3>
<p>ê°’ íƒ€ì…ì˜ ì‹¤ì œ ì¸ìŠ¤í„´ìŠ¤ì¸ ê°’ì„ ê³µìœ í•˜ëŠ” ê²ƒì€ ìœ„í—˜í•˜ë‹¤. ëŒ€ì‹ ì— ê°’(ì¸ìŠ¤í„´ìŠ¤)ì„ ë³µì‚¬í•´ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">member1</span><span class="o">.</span><span class="na">setAddress</span><span class="o">(</span><span class="k">new</span> <span class="nc">Address</span><span class="o">(</span><span class="s">"OldCity"</span><span class="o">));</span>
<span class="nc">Address</span> <span class="n">address</span> <span class="o">=</span> <span class="n">member1</span><span class="o">.</span><span class="na">getAddress</span><span class="o">();</span>

<span class="c1">// ë³µì‚¬</span>
<span class="nc">Address</span> <span class="n">newAddress</span> <span class="o">=</span> <span class="n">address</span><span class="o">.</span><span class="na">clone</span><span class="o">();</span>
<span class="n">newAddress</span><span class="o">.</span><span class="na">setCity</span><span class="o">(</span><span class="s">"NewCity"</span><span class="o">);</span>
<span class="n">member2</span><span class="o">.</span><span class="na">setAddress</span><span class="o">(</span><span class="n">newAddress</span><span class="o">);</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="933-ë¶ˆë³€-ê°ì²´">9.3.3 ë¶ˆë³€ ê°ì²´</h3>
<p>ê°’ íƒ€ì…ì€ ë¶€ì‘ìš© ê±±ì • ì—†ì´ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤. <strong>ê°ì²´ë¥¼ ë¶ˆë³€í•˜ê²Œ ë§Œë“¤ë©´ ê°’ì„ ìˆ˜ì •í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ë¶€ì‘ìš©ì„ ì›ì²œ ì°¨ë‹¨í•  ìˆ˜ ìˆë‹¤.</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì£¼ì†Œ ë¶ˆë³€ ê°ì²´</span>
<span class="nd">@Embeddable</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Address</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">city</span><span class="o">;</span>
    
    <span class="kd">protected</span> <span class="nf">Address</span> <span class="o">()</span> <span class="o">{}</span>

    <span class="kd">public</span> <span class="nf">Address</span><span class="o">(</span><span class="nc">String</span> <span class="n">city</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">city</span> <span class="o">=</span> <span class="n">city</span><span class="o">;</span>
    <span class="o">}</span>
    

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getCity</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">city</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// SetterëŠ” ë§Œë“¤ì§€ ì•ŠëŠ”ë‹¤.</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h2 id="94-ê°’-íƒ€ì…ì˜-ë¹„êµ">9.4 ê°’ íƒ€ì…ì˜ ë¹„êµ</h2>
<ul>
  <li>ë™ì¼ì„± ë¹„êµ: ì¸ìŠ¤í„´ìŠ¤ì˜ ì°¸ì¡° ê°’ì„ ë¹„êµ, <code class="language-plaintext highlighter-rouge">==</code> ì‚¬ìš©</li>
  <li>ë™ë“±ì„± ë¹„êµ: ì¸ìŠ¤í„´ìŠ¤ì˜ ê°’ì„ ë¹„êµ, <code class="language-plaintext highlighter-rouge">equals()</code> ì‚¬ìš©</li>
  <li>ê°’ íƒ€ì…ì„ ë¹„êµí•  ë•ŒëŠ” <code class="language-plaintext highlighter-rouge">equals()</code>ë¥¼ ì‚¬ìš©í•´ì„œ ë™ë“±ì„± ë¹„êµë¥¼ í•´ì•¼ í•œë‹¤.</li>
  <li>ê°’ íƒ€ì…ì˜ <code class="language-plaintext highlighter-rouge">equals()</code>, <code class="language-plaintext highlighter-rouge">hashCode()</code> ë©”ì†Œë“œë¥¼ ì¬ì •ì˜í•´ì•¼ í•œë‹¤.<br />
<br />
<br /></li>
</ul>

<h2 id="95-ê°’-íƒ€ì…-ì»¬ë ‰ì…˜">9.5 ê°’ íƒ€ì… ì»¬ë ‰ì…˜</h2>
<p>ê°’ íƒ€ì…ì„ í•˜ë‚˜ ì´ìƒ  ì»¬ë ‰ì…˜ì— ë³´ê´€í•˜ê³  <code class="language-plaintext highlighter-rouge">@ElementCollection</code>, <code class="language-plaintext highlighter-rouge">@CollectionTable</code> ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@ElementCollection</span>
    <span class="nd">@CollectionTable</span><span class="o">(</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">"FAVORITE_FOODS"</span><span class="o">,</span>
        <span class="n">joinColumns</span> <span class="o">=</span> <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">)</span>
    <span class="o">)</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"FOOD_NAME"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">favoriteFoods</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;();</span>

    <span class="nd">@ElementCollection</span>
    <span class="nd">@CollectionTable</span><span class="o">(</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">"ADDRESS"</span><span class="o">,</span>
        <span class="n">joinColumns</span> <span class="o">=</span> <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">)</span>
    <span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Address</span><span class="o">&gt;</span> <span class="n">addressHistory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Address</span><span class="o">&gt;();</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Embeddable</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Address</span> <span class="o">{</span>

    <span class="nd">@Column</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">city</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">street</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">zipcode</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<center><img src="/assets/images/posts/books/2/9_5_ê°’íƒ€ì…ì»¬ë ‰ì…˜.png" width="100%" height="100%" /></center>
<p><br /></p>

<h3 id="951-ê°’-íƒ€ì…-ì»¬ë ‰ì…˜-ì‚¬ìš©">9.5.1 ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ì‚¬ìš©</h3>
<p>ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì€ ì˜ì†ì„± ì „ì´(Cascade) + ê³ ì•„ ê°ì²´ ì œê±°(Orphan remove) ê¸°ëŠ¥ì´ í¬í•¨ë˜ì–´ ìˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ê°’ íƒ€ì… ì»¬ë ‰ì…˜ë„ ì¡°íšŒí•  ë•Œ í˜ì¹˜ ì „ëµì„ ì„ íƒí•  ìˆ˜ ìˆë‹¤.</span>
<span class="nd">@ElementCollection</span><span class="o">(</span><span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span> <span class="c1">// ê¸°ë³¸ê°’ LAZY</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="952-ê°’-íƒ€ì…-ì»¬ë ‰ì…˜ì˜-ì œì•½ì‚¬í•­">9.5.2 ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì˜ ì œì•½ì‚¬í•­</h3>

<p><strong>ì œì•½ì‚¬í•­</strong></p>
<ul>
  <li>ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì— ë³´ê´€ëœ ê°’ íƒ€ì…ë“¤ì€ ë³„ë„ì˜ í…Œì´ë¸”ì— ë³´ê´€í•œë‹¤.</li>
  <li>ë”°ë¼ì„œ ì—¬ê¸°ì— ë³´ê´€ëœ ê°’ íƒ€ì…ì˜ ê°’ì´ ë³€ê²½ë˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ì°¾ê¸° ì–´ë µë‹¤.</li>
  <li>ì´ëŸ° ë¬¸ì œë¡œ JPA êµ¬í˜„ì²´ë“¤ì€ ê°’ íƒ€ì… ë³€ê²½ ì‚¬í•­ì´ ë°œìƒí•˜ë©´ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì´ ë§¤í•‘ëœ í…Œì´ë¸”ì˜ ì—°ê´€ëœ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œ, í˜„ì¬ ê°’ìœ¼ë¡œ ì €ì¥í•œë‹¤.</li>
  <li>ì„±ëŠ¥ ë¬¸ì œ ë°œìƒ</li>
  <li>ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì„ ë§¤í•‘í•˜ëŠ” í…Œì´ë¸”ì€ ëª¨ë“  ì»¬ëŸ¼ì„ ë¬¶ì–´ì„œ ê¸°ë³¸ í‚¤ë¥¼ êµ¬ì„± í•´ì•¼í•œë‹¤.</li>
  <li>ë”°ë¼ì„œ ë°ì´í„°ë² ì´ìŠ¤ ê¸°ë³¸ í‚¤ ì œì•½ ì¡°ê±´ìœ¼ë¡œ ì¸í•´ ì»¬ëŸ¼ì— nullì„ ì…ë ¥í•  ìˆ˜ ì—†ê³ , ê°’ì€ ê°’ì„ ì¤‘ë³µí•´ì„œ ì €ì¥í•  ìˆ˜ ì—†ëŠ” ì œì•½ë„ ìˆë‹¤.</li>
</ul>

<p><strong>í•´ê²°ë°©ë²•</strong></p>
<ul>
  <li>ë”°ë¼ì„œ ì‹¤ë¬´ì—ì„œëŠ” ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì´ ë§¤í•‘ëœ í…Œì´ë¸”ì— ë°ì´í„°ê°€ ë§ë‹¤ë©´ <strong>ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ëŒ€ì‹ ì— ì¼ëŒ€ë‹¤ ê´€ê³„ë¥¼ ê³ ë ¤</strong>í•´ì•¼ í•œë‹¤.</li>
  <li>ê·¸ë¦¬ê³  ì˜ì†ì„± ì „ì´ + ê³ ì•„ ê°ì²´ ì œê±° ê¸°ëŠ¥ì„ ì ìš©í•˜ë©´ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ì²˜ëŸ¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ëŒ€ì‹ ì— ì¼ëŒ€ë‹¤ ê´€ê³„ ì‚¬ìš©</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AddressEntity</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@Embedded</span>
    <span class="kd">private</span> <span class="nc">Address</span> <span class="n">address</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Embeddable</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Address</span> <span class="o">{</span>

    <span class="nd">@Column</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">city</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">street</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">zipcode</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì„¤ì • ì½”ë“œ</span>
<span class="nd">@OneToMany</span><span class="o">(</span><span class="n">cascade</span> <span class="o">=</span> <span class="nc">CascadeType</span><span class="o">.</span><span class="na">ALL</span><span class="o">,</span> <span class="n">orphanRemoval</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">)</span>
<span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">AddressEntity</span><span class="o">&gt;</span> <span class="n">addressHistory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">AddressEntity</span><span class="o">&gt;();</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h2 id="96-ì •ë¦¬">9.6 ì •ë¦¬</h2>
<p><strong>ì—”í‹°í‹° íƒ€ì…ì˜ íŠ¹ì§•</strong></p>
<ul>
  <li>ì‹ë³„ì(<code class="language-plaintext highlighter-rouge">@Id</code>)ê°€ ìˆë‹¤.</li>
  <li>ìƒëª… ì£¼ê¸°ê°€ ìˆë‹¤.
    <ul>
      <li>ìƒì„±, ì˜ì†, ì†Œë©¸</li>
    </ul>
  </li>
  <li>ê³µìœ í•  ìˆ˜ ìˆë‹¤.
    <ul>
      <li>ì°¸ì¡° ê°’ì„ ê³µìœ í•  ìˆ˜ ìˆë‹¤.</li>
      <li>ì˜ˆë¥¼ ë“¤ì–´ íšŒì› ì—”í‹°í‹°ê°€ ìˆë‹¤ë©´ ë‹¤ë¥¸ ì—”í‹°í‹°ì—ì„œ íšŒì› ì—”í‹°í‹°ë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆë‹¤.</li>
    </ul>
  </li>
</ul>

<p><strong>ê°’ íƒ€ì…ì˜ íŠ¹ì§•</strong></p>
<ul>
  <li>ì‹ë³„ìê°€ ì—†ë‹¤</li>
  <li>ìƒëª… ì£¼ê¸°ë¥¼ ì—”í‹°í‹°ì— ì˜ì¡´í•œë‹¤.
    <ul>
      <li>ì˜ì¡´í•˜ëŠ” ì—”í‹°í‹°ë¥¼ ì œê±°í•˜ë©´ ê°™ì´ ì œê±°ëœë‹¤.</li>
    </ul>
  </li>
  <li>ê³µìœ í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ì•ˆì „í•˜ë‹¤.
    <ul>
      <li>ëŒ€ì‹ ì— ê°’ì„ ë³µì‚¬í•´ì„œ ì‚¬ìš©í•œë‹¤.</li>
      <li>ì˜¤ì§ í•˜ë‚˜ì˜ ì£¼ì¸ë§Œì´ ê´€ë¦¬í•´ì•¼ í•œë‹¤.</li>
      <li>ë¶ˆë³€ ê°ì²´ë¡œ ë§Œë“œëŠ” ê²ƒì´ ì•ˆì „í•˜ë‹¤.<br />
<br />
<br />
<br />
<br /></li>
    </ul>
  </li>
</ul>

<h1 id="10-ê°ì²´ì§€í–¥-ì¿¼ë¦¬-ì–¸ì–´">10. ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´</h1>

<h2 id="101-ê°ì²´ì§€í–¥-ì¿¼ë¦¬-ì†Œê°œ">10.1 ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì†Œê°œ</h2>
<p><strong>JPQL ì´ë€?</strong></p>
<ul>
  <li>í…Œì´ë¸”ì´ ì•„ë‹Œ ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ê²€ìƒ‰í•˜ëŠ” ê°ì²´ì§€í–¥ ì¿¼ë¦¬ë‹¤</li>
  <li>SQLì„ ì¶”ìƒí™”í•´ì„œ íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ SQLì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
  <li>SQLì´ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì„ ëŒ€ìƒìœ¼ë¡œ í•˜ëŠ” ë°ì´í„° ì¤‘ì‹¬ì˜ ì¿¼ë¦¬ë¼ë©´ JPQLì€ ì—”í‹°í‹° ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ í•˜ëŠ” <strong>ê°ì²´ì§€í–¥ ì¿¼ë¦¬ë‹¤.</strong><br />
<br /></li>
</ul>

<p>JPAëŠ” JPQLë¿ë§Œ ì•„ë‹ˆë¼ ë‹¤ì–‘í•œ ê²€ìƒ‰ ë°©ë²•ì„ ì œê³µí•œë‹¤.</p>

<p><strong>ê³µì‹ ì§€ì› ê¸°ëŠ¥</strong></p>
<ul>
  <li>JPQL(Java Persistence Query Language)</li>
  <li>Criteria ì¿¼ë¦¬: JPAì„ í¸í•˜ê²Œ ì‘ì„±í•˜ë„ë¡ ë„ì™€ì£¼ëŠ” API, ë¹Œë” í´ë˜ìŠ¤ ëª¨ìŒ</li>
  <li>ë„¤ì´í‹°ë¸Œ SQL: JPAì—ì„œ JPQL ëŒ€ì‹  ì§ì ‘ SQLì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><strong>ë¹„ ê³µì‹ ê¸°ëŠ¥</strong></p>
<ul>
  <li><strong>QueryDSL</strong>: Criteria ì¿¼ë¦¬ì²˜ëŸ¼ JPQLì„ í¸í•˜ê²Œ ì‘ì„±í•˜ë„ë¡ ë„ì™€ì£¼ëŠ” ë¹Œë” í´ë˜ìŠ¤ ëª¨ìŒ, ë¹„í‘œì¤€ ì˜¤í”ˆì†ŒìŠ¤ í”„ë ˆì„ì›Œí¬ë‹¤.</li>
  <li>JDBC ì§ì ‘ ì‚¬ìš©</li>
  <li>MyBatis ê°™ì€ SQL ë§¤í¼ í”„ë ˆì„ì›Œí¬ ì‚¬ìš©<br />
<br />
<br /></li>
</ul>

<h3 id="1011-jpql-ì†Œê°œ">10.1.1 JPQL ì†Œê°œ</h3>
<ul>
  <li>JPQLì€ ì—”í‹°í‹° ê°ì²´ë¥¼ ì¡°íšŒí•˜ëŠ” ê°ì²´ì§€í–¥ ì¿¼ë¦¬ë‹¤.</li>
  <li>JPQLì€ SQLì„ ì¶”ìƒí™”í•´ì„œ íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ”ë‹¤.
    <ul>
      <li>ë°©ì–¸ë§Œ ë³€ê²½í•˜ë©´ ëœë‹¤.</li>
    </ul>
  </li>
  <li>JPQLì€ SQLë³´ë‹¤ ê°„ê²°í•˜ë‹¤.
    <ul>
      <li>ì—”í‹°í‹° ì§ì ‘ ì¡°íšŒ</li>
      <li>ë¬µì‹œì  ì¡°ì¸</li>
      <li>ë‹¤í˜•ì„± ì§€ì›</li>
    </ul>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"Member"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"name"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// JPQL ì‚¬ìš©</span>
<span class="nc">String</span> <span class="n">jpql</span> <span class="o">=</span> <span class="s">"select m from Member as m where m.username = 'kim'"</span><span class="o">;</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">jpql</span><span class="o">,</span> <span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">getResultList</span><span class="o">();</span>
</code></pre></div></div>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- ì‹¤ì œ ì‹¤í–‰ëœ SQL, ë³„ì¹­ì€ ë„ˆë¬´ ë³µì¡í•´ ì„ì˜ ìˆ˜ì •</span>
<span class="k">select</span>
    <span class="n">member</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">id</span><span class="p">,</span>
    <span class="n">member</span><span class="p">.</span><span class="n">age</span> <span class="k">as</span> <span class="n">age</span><span class="p">,</span>
    <span class="n">member</span><span class="p">.</span><span class="n">team_id</span> <span class="k">as</span> <span class="n">team</span><span class="p">,</span>
    <span class="n">member</span><span class="p">.</span><span class="n">name</span> <span class="k">as</span> <span class="n">name</span>
<span class="k">from</span>
    <span class="n">Member</span> <span class="n">member</span>
<span class="k">where</span>
    <span class="n">member</span><span class="p">.</span><span class="n">name</span><span class="o">=</span><span class="s1">'kim'</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1012-criteria-ì†Œê°œ">10.1.2 Criteria ì†Œê°œ</h3>
<p>CriteriaëŠ” JPQLì„ ìƒì„±í•˜ëŠ” ë¹Œë” í´ë˜ìŠ¤ë‹¤. <strong>Criteriaì˜ ì¥ì ì€ ë¬¸ìê°€ ì•„ë‹Œ <code class="language-plaintext highlighter-rouge">query.select(m).where(...)</code>ì²˜ëŸ¼ í”„ë¡œê·¸ë˜ë° ì½”ë“œë¡œ JPQLì„ ì‘ì„±í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì´ë‹¤.</strong></p>

<p><strong>ì¥ì </strong></p>
<ul>
  <li>ì»´íŒŒì¼ ì‹œì ì— ì˜¤ë¥˜ë¥¼ ë°œê²¬í•  ìˆ˜ ìˆë‹¤.</li>
  <li>IDEë¥¼ ì‚¬ìš©í•˜ë©´ ì½”ë“œ ìë™ì™„ì„±ì„ ì§€ì›í•œë‹¤.</li>
  <li>ë™ì  ì¿¼ë¦¬ë¥¼ ì‘ì„±í•˜ê¸° í¸í•˜ë‹¤.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Criteria ì‚¬ìš© ì¤€ë¹„</span>
<span class="nc">CriteriaBuilder</span> <span class="n">cb</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getCriteriaBuilder</span><span class="o">();</span>
<span class="nc">CriteriaQuery</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">query</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="c1">// ë£¨íŠ¸ í´ë˜ìŠ¤(ì¡°íšŒë¥¼ ì‹œì‘í•  í´ë˜ìŠ¤)</span>
<span class="nc">Root</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="c1">// ì¿¼ë¦¬ ìƒì„±</span>
<span class="nc">CriteriaQuery</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">cq</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">m</span><span class="o">).</span><span class="na">where</span><span class="o">(</span><span class="n">cb</span><span class="o">.</span><span class="na">equal</span><span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"username"</span><span class="o">),</span> <span class="s">"kim"</span><span class="o">));</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">cq</span><span class="o">).</span><span class="na">getResultList</span><span class="o">();</span>
</code></pre></div></div>
<p><strong>Criteriaê°€ ê°€ì§„ ì¥ì ì´ ë§ì§€ë§Œ ëª¨ë“  ì¥ì ì„ ìƒì‡„í•  ì •ë„ë¡œ ë³µì¡í•˜ê³  ì¥í™©í•˜ë‹¤.</strong><br />
<br />
<br /></p>

<h3 id="1013-querydsl-ì†Œê°œ">10.1.3 QueryDSL ì†Œê°œ</h3>
<ul>
  <li>QueryDSLë„ Criteriaì²˜ëŸ¼ JPQL ë¹Œë” ì—­í• ì„ í•œë‹¤.</li>
  <li>ì½”ë“œ ê¸°ë°˜ì´ë‹¤</li>
  <li>ë‹¨ìˆœí•˜ê³  ì‚¬ìš©í•˜ê¸° ì‰½ë‹¤</li>
  <li>ì‘ì„±í•œ ì½”ë“œë„ JPQLê³¼ ë¹„ìŠ·í•´ì„œ í•œëˆˆì— ë“¤ì–´ì˜¨ë‹¤</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì¤€ë¹„</span>
<span class="nc">JPAQuery</span> <span class="n">query</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JPAQuery</span><span class="o">(</span><span class="n">em</span><span class="o">);</span>
<span class="nc">QMember</span> <span class="n">member</span> <span class="o">=</span> <span class="nc">QMember</span><span class="o">.</span><span class="na">member</span><span class="o">;</span>

<span class="c1">// ì¿¼ë¦¬, ê²°ê³¼ì¡°íšŒ</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"kim"</span><span class="o">))</span>
                    <span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1014-ë„¤ì´í‹°ë¸Œ-sql-ì†Œê°œ">10.1.4 ë„¤ì´í‹°ë¸Œ SQL ì†Œê°œ</h3>
<p>JPAëŠ” SQLì„ ì§ì ‘ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì§€ì›í•˜ëŠ”ë° ì´ê²ƒì„ ë„¤ì´í‹°ë¸Œ SQLì´ë¼ í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">"SELECT ID, AGE, TEAM_ID, NAME FROM MEMBER WHERE NAME = 'kim'"</span><span class="o">;</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createNativeQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">getResultList</span><span class="o">();</span>
</code></pre></div></div>
<p>ë„¤ì´í‹°ë¸Œ SQLì˜ ë‹¨ì ì€ íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ì— ì˜ì¡´í•˜ëŠ” SQLì„ ì‘ì„±í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ë”°ë¼ì„œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë³€ê²½í•˜ë©´ ë„¤ì´í‹°ë¸Œ SQLë„ ìˆ˜ì •í•´ì•¼ í•œë‹¤.<br />
<br />
<br /></p>

<h3 id="1015-jdbc-ì§ì ‘-ì‚¬ìš©-ë§ˆì´ë°”í‹°ìŠ¤-ê°™ì€-sql-ë§¤í¼-í”„ë ˆì„ì›Œí¬-ì‚¬ìš©">10.1.5 JDBC ì§ì ‘ ì‚¬ìš©, ë§ˆì´ë°”í‹°ìŠ¤ ê°™ì€ SQL ë§¤í¼ í”„ë ˆì„ì›Œí¬ ì‚¬ìš©</h3>
<p>ë‹¤ìŒì€ í•˜ì´ë²„ë„¤ì´íŠ¸ì—ì„œ ì§ì ‘ JDBC Connectionì„ íšë“í•˜ëŠ” ë°©ë²•ì´ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Session</span> <span class="n">session</span> <span class="o">=</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">unwrap</span><span class="o">(</span><span class="nc">Session</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">session</span><span class="o">.</span><span class="na">doWork</span><span class="o">(</span><span class="k">new</span> <span class="nc">Work</span><span class="o">()</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">execute</span><span class="o">(</span><span class="nc">Connection</span> <span class="n">connection</span><span class="o">)</span> <span class="k">throw</span> <span class="nc">SQLException</span> <span class="o">{...}</span>
<span class="o">});</span>
</code></pre></div></div>
<ul>
  <li><strong>JDBCë‚˜ ë§ˆì´ë°”í‹°ìŠ¤ë¥¼ JPAì™€ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì ì ˆí•œ ì‹œì ì— ê°•ì œë¡œ í”ŒëŸ¬ì‹œí•´ì•¼ í•œë‹¤.</strong></li>
  <li><strong>ë°ì´í„°ë² ì´ìŠ¤ì™€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ë™ê¸°í™” í•˜ê¸° ìœ„í•¨ì´ë‹¤.</strong><br />
<br />
<br />
<br /></li>
</ul>

<h2 id="102-jpql">10.2 JPQL</h2>
<p><strong>JPQL íŠ¹ì§•</strong></p>
<ul>
  <li>JPQLì€ ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´ë‹¤. ë”°ë¼ì„œ í…Œì´ë¸”ì´ ì•„ë‹Œ ì—”í‹°í‹° ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì¿¼ë¦¬í•œë‹¤.</li>
  <li>JPQLì€ SQLì„ ì¶”ìƒí™”í•´ì„œ íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ SQLì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
  <li>JPQLì€ ê²°êµ­ SQLë¡œ ë³€í™˜ëœë‹¤.</li>
</ul>

<h3 id="1021-ê¸°ë³¸-ë¬¸ë²•ê³¼-ì¿¼ë¦¬-api">10.2.1 ê¸°ë³¸ ë¬¸ë²•ê³¼ ì¿¼ë¦¬ API</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>JPQL ë¬¸ë²•

select_ë¬¸ :: =
    select_ì ˆ
    from_ì ˆ
    [where_ì ˆ]
    [groupby_ì ˆ]
    [having_ì ˆ]
    [orderby_ì ˆ]

update_ë¬¸ :: update_ì ˆ [where_ì ˆ]
delete_ë¬¸ :: delete_ì ˆ [where_ì ˆ]
</code></pre></div></div>
<p><br /></p>

<p><strong>SELECT ë¬¸</strong></p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">m</span> <span class="k">FROM</span> <span class="n">Member</span> <span class="k">AS</span> <span class="n">m</span> <span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">username</span> <span class="o">=</span> <span class="s1">'Hello'</span>
</code></pre></div></div>

<ul>
  <li>ëŒ€ì†Œë¬¸ì êµ¬ë¶„
    <ul>
      <li>ì—”í‹°í‹°ì™€ ì†ì„±ì€ ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë¶„í•œë‹¤.</li>
      <li>JPQL í‚¤ì›Œë“œ(SELECT, FROM, AS..)ëŠ” ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë¶„í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
    </ul>
  </li>
  <li>ì—”í‹°í‹° ì´ë¦„
    <ul>
      <li>í…Œì´ë¸” ëª…ì´ ì•„ë‹ˆë¼ ì—”í‹°í‹° ëª…ì„ ì‚¬ìš©í•œë‹¤.</li>
      <li>@Entity(name=â€xxxâ€)ë¡œ ì§€ì •í•  ìˆ˜ ìˆë‹¤.</li>
      <li>ì—”í‹°í‹° ëª…ì„ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ í´ë˜ìŠ¤ëª…ì„ ê¸°ë³¸ê°’ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.</li>
    </ul>
  </li>
  <li>ë³„ì¹­ì€ í•„ìˆ˜
    <ul>
      <li>JPQLì€ ë³„ì¹­ì„ í•„ìˆ˜ë¡œ ì‚¬ìš©í•´ì•¼ í•œë‹¤. (JPA ëª…ì„¸ë¡œ ì¹˜ë©´ ì •í™•íˆëŠ” ì‹ë³„ ë³€ìˆ˜)</li>
      <li>ASëŠ” ìƒëµí•  ìˆ˜ ìˆë‹¤.</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<p><strong>TypeQuery, Query</strong><br />
ì‘ì„±í•œ JPQLì„ ì‹¤í–‰í•˜ë ¤ë©´ ì¿¼ë¦¬ ê°ì²´ë¥¼ ë§Œë“¤ì–´ì•¼ í•œë‹¤.</p>
<ul>
  <li>TypeQuery ê°ì²´: ë°˜í™˜ íƒ€ì…ì„ ëª…í™•í•˜ê²Œ ì§€ì •í•  ìˆ˜ ìˆìœ¼ë©´ ì‚¬ìš©</li>
  <li>Query ê°ì²´: ë°˜í™˜ íƒ€ì…ì„ ëª…í™•í•˜ê²Œ ì§€ì •í•  ìˆ˜ ì—†ìœ¼ë©´ ì‚¬ìš”</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// TypeQuery ì‚¬ìš©</span>

<span class="nc">TypeQuery</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">query</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"SELECT m FROM Member m"</span><span class="o">,</span> <span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
<span class="k">for</span> <span class="o">(</span><span class="nc">Member</span> <span class="n">member</span> <span class="o">:</span> <span class="n">resultList</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Query ì‚¬ìš©</span>

<span class="nc">Query</span> <span class="n">query</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"SELECT m FROM Member m"</span><span class="o">);</span>

<span class="nc">List</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
<span class="k">for</span> <span class="o">(</span><span class="nc">Object</span> <span class="n">o</span> <span class="o">:</span> <span class="n">resultList</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Object</span><span class="o">[]</span> <span class="n">result</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Object</span><span class="o">[])</span> <span class="n">o</span><span class="o">;</span> <span class="c1">// ê²°ê³¼ê°€ ë‘˜ ì´ìƒì´ë©´ Object[] ë°˜í™˜</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"username = "</span> <span class="o">+</span> <span class="n">result</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"age = "</span> <span class="o">+</span> <span class="n">result</span><span class="o">[</span><span class="mi">1</span><span class="o">]);</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ê²°ê³¼ ì¡°íšŒ</strong><br />
ë‹¤ìŒ ë©”ì†Œë“œë“¤ì„ í˜¸ì¶œí•˜ë©´ ì‹¤ì œ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•´ì„œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¡°íšŒí•œë‹¤.</p>
<ul>
  <li>query.getResultList(): ê²°ê³¼ë¥¼ ë°˜í™˜. ë§Œì•½ ê²°ê³¼ê°€ ì—†ìœ¼ë©´ ë¹ˆ ì»¬ë ‰ì…˜ ë°˜í™˜</li>
  <li>query.getSingleResult(): ê²°ê³¼ê°€ ì •í™•íˆ í•˜ë‚˜ì¼ ë•Œ ì‚¬ìš©í•œë‹¤.
    <ul>
      <li>ê²°ê³¼ê°€ ì—†ìœ¼ë©´ javax.persistence.NoResultException ë°œìƒ</li>
      <li>ê²°ê³¼ê°€ 1ê°œë³´ë‹¤ ë§ìœ¼ë©´ javax.persistence.NonUniqueResultException ë°œìƒ</li>
    </ul>
  </li>
</ul>

<p><br />
<br /></p>

<h3 id="1022-íŒŒë¼ë¯¸í„°-ë°”ì¸ë”©">10.2.2 íŒŒë¼ë¯¸í„° ë°”ì¸ë”©</h3>
<p>JDBCëŠ” ìœ„ì¹˜ ê¸°ì¤€ íŒŒë¼ë¯¸í„° ë°”ì¸ë”©ë§Œ ì§€ì›í•˜ì§€ë§Œ JPQLì€ ì´ë¦„ ê¸°ì¤€ íŒŒë¼ë¯¸í„° ë°”ì¸ë”©ë„ ì§€ì›í•œë‹¤.</p>

<p><strong>ì´ë¦„ ê¸°ì¤€ íŒŒë¼ë¯¸í„°</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">usernameParam</span> <span class="o">=</span> <span class="s">"user1"</span><span class="o">;</span>

<span class="c1">// íŒŒë¼ë¯¸í„° ì•ì— :ì„ ë¶™ì¸ë‹¤.</span>
<span class="nc">TypeQuery</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">query</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"SELECT m FROM Member m where m.username = :username"</span><span class="o">,</span> <span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">query</span><span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="s">"username"</span><span class="o">,</span> <span class="n">usernameParam</span><span class="o">);</span>

<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ìœ„ì¹˜ ê¸°ì¤€ íŒŒë¼ë¯¸í„°</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">usernameParam</span> <span class="o">=</span> <span class="s">"user1"</span><span class="o">;</span>

<span class="c1">// íŒŒë¼ë¯¸í„°ëŠ” ? ë‹¤ìŒì— ìœ„ì¹˜ ê°’ì„ ì£¼ë©´ ëœë‹¤.</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"SELECT m FROM Member m where m.username = ?1"</span><span class="o">,</span> <span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="n">query</span><span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">usernameParam</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
</code></pre></div></div>

<div class="notice--warning">
<p><strong>ê²½ê³ </strong><br />
íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ë°©ì‹ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì§ì ‘ JPQLì„ ë§Œë“¤ë©´ SQL ì¸ì ì…˜ ê³µê²©ì„ ë‹¹í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"SELECT m FROM Member m where m.username = '"</span> <span class="o">+</span> <span class="n">usernameParam</span> <span class="o">+</span> <span class="s">"'"</span>
</code></pre></div></div>
</div>
<p><br /></p>

<h3 id="1023-í”„ë¡œì ì…˜">10.2.3 í”„ë¡œì ì…˜</h3>
<p><strong>SELECT ì ˆì— ì¡°íšŒí•  ëŒ€ìƒì„ ì§€ì •í•˜ëŠ” ê²ƒì„ í”„ë¡œì ì…˜ì´ë¼ê³  í•œë‹¤</strong>. [SELECT {í”„ë¡œì ì…˜ ëŒ€ìƒ} FROM]ìœ¼ë¡œ ëŒ€ìƒì„ ì„ íƒí•œë‹¤. <strong>í”„ë¡œì ì…˜ ëŒ€ìƒì€ ì—”í‹°í‹°, ì„ë² ë””ë“œ íƒ€ì…, ìŠ¤ì¹¼ë¼ íƒ€ì…ì´ ìˆë‹¤.</strong> ìŠ¤ì¹¼ë¼ íƒ€ì…ì€ ìˆ«ì, ë¬¸ì ë“± ê¸°ë³¸ ë°ì´í„° íƒ€ì…ì„ ëœ»í•œë‹¤.</p>

<p><strong>ì—”í‹°í‹° í”„ë¡œì ì…˜</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">SELECT</span> <span class="n">m</span> <span class="no">FROM</span> <span class="nc">Member</span> <span class="n">m</span>      <span class="c1">// íšŒì›</span>
<span class="no">SELECT</span> <span class="n">m</span><span class="o">.</span><span class="na">team</span> <span class="no">FROM</span> <span class="nc">Member</span> <span class="n">m</span> <span class="c1">// íŒ€</span>
</code></pre></div></div>
<p>ì¡°íšŒí•œ ì—”í‹°í‹°ëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ê´€ë¦¬í•œë‹¤.<br />
<br /></p>

<p><strong>ì„ë² ë””ë“œ íƒ€ì… í”„ë¡œì ì…˜</strong><br />
ì„ë² ë””ë“œ íƒ€ì…ì€ ì¡°íšŒì˜ ì‹œì‘ì ì´ ë  ìˆ˜ ì—†ë‹¤ëŠ” ì œì•½ì´ ìˆë‹¤. ì•„ë˜ì— AddressëŠ” ì„ë² ë””ë“œ íƒ€ì…ì´ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì˜ëª»ëœ ì¿¼ë¦¬</span>
<span class="nc">String</span> <span class="n">query</span> <span class="o">=</span> <span class="s">"SELECT a From Address a"</span><span class="o">;</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì˜¬ë°”ë¥¸ ì¿¼ë¦¬</span>
<span class="nc">String</span> <span class="n">query</span> <span class="o">=</span> <span class="s">"SELECT o.address From Order o"</span><span class="o">;</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Address</span><span class="o">&gt;</span> <span class="n">addresses</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="nc">Address</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">getResultList</span><span class="o">();</span>
</code></pre></div></div>
<p>ì‹¤í–‰ëœ ì¿¼ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span>
    <span class="k">order</span><span class="p">.</span><span class="n">city</span><span class="p">,</span>
    <span class="k">order</span><span class="p">.</span><span class="n">street</span><span class="p">,</span>
    <span class="k">order</span><span class="p">.</span><span class="n">zipcode</span>
<span class="k">from</span>
    <span class="n">Orders</span> <span class="k">order</span>
</code></pre></div></div>
<p>ì„ë² ë””ë“œ íƒ€ì…ì€ ì—”í‹°í‹° íƒ€ì…ì´ ì•„ë‹ˆë‹¤. ë”°ë¼ì„œ ì´ë ‡ê²Œ ì§ì ‘ ì¡°íšŒí•œ ì„ë² ë””ë“œ íƒ€ì…ì€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ê´€ë¦¬ë˜ì§€ ì•ŠëŠ”ë‹¤.<br />
<br /></p>

<p><strong>ìŠ¤ì¹¼ë¼ íƒ€ì… í”„ë¡œì ì…˜</strong><br />
ìˆ«ì, ë¬¸ì, ë‚ ì§œì™€ ê°™ì€ ê¸°ë³¸ ë°ì´í„° íƒ€ì…ë“¤ì€ ìŠ¤ì¹¼ë¼ íƒ€ì…ì´ë¼ í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">query</span> <span class="o">=</span> <span class="s">"SELECT username FROM Member m"</span><span class="o">;</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">usernames</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">getResultList</span><span class="o">();</span>


<span class="c1">// ì¤‘ë³µ ë°ì´í„°ë¥¼ ì œê±°í•˜ë ¤ë©´ DISTINCTë¥¼ ì‚¬ìš©í•œë‹¤.</span>
<span class="no">SELECT</span> <span class="no">DISTINCT</span> <span class="n">username</span> <span class="nc">From</span> <span class="nc">Member</span> <span class="n">m</span>

<span class="c1">// í†µê³„</span>
<span class="nc">String</span> <span class="n">query</span> <span class="o">=</span> <span class="s">"SELECT AVG(o.orderAmount) FROM Order o"</span>
<span class="nc">Double</span> <span class="n">orderAmountAvg</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="nc">Double</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">getSingleResult</span><span class="o">();</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ì—¬ëŸ¬ ê°’ ì¡°íšŒ</strong><br />
ê¼­ í•„ìš”í•œ ë°ì´í„°ë“¤ë§Œ ì„ íƒí•´ì„œ ì¡°íšŒí•´ì•¼ í•  ë•Œë„ ìˆë‹¤. ì´ ë•ŒëŠ” TypeQueryë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ê³  ëŒ€ì‹ ì— Queryë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Query</span> <span class="n">query</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"SELECT m.username, m.age FROM Member m"</span><span class="o">);</span>
<span class="nc">List</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>

<span class="nc">Iterator</span> <span class="n">iterator</span> <span class="o">=</span> <span class="n">resultList</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
<span class="k">while</span> <span class="o">(</span><span class="n">iterator</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
    <span class="nc">Object</span><span class="o">[]</span> <span class="n">row</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Object</span><span class="o">[])</span> <span class="n">iterator</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
    <span class="nc">String</span> <span class="n">username</span> <span class="o">=</span> <span class="o">(</span><span class="nc">String</span><span class="o">)</span> <span class="n">row</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
    <span class="nc">Integer</span> <span class="n">age</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Integer</span><span class="o">)</span> <span class="n">row</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Query</span> <span class="n">query</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"SELECT m.username, m.age FROM Member m"</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">[]&gt;</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>

<span class="k">for</span> <span class="o">(</span><span class="nc">Object</span><span class="o">[]</span> <span class="n">row</span> <span class="o">:</span> <span class="n">resultList</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">username</span> <span class="o">=</span> <span class="o">(</span><span class="nc">String</span><span class="o">)</span> <span class="n">row</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
    <span class="nc">Integer</span> <span class="n">age</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Integer</span><span class="o">)</span> <span class="n">row</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ìŠ¤ì¹¼ë¼ íƒ€ì…ë¿ë§Œ ì•„ë‹ˆë¼ ì—”í‹°í‹° íƒ€ì…ë„ ì—¬ëŸ¬ ê°’ì„ í•¨ê»˜ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Query</span> <span class="n">query</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"SELECT o.member, o.product, o.orderAmount FROM Order o"</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">[]&gt;</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>

<span class="k">for</span> <span class="o">(</span><span class="nc">Object</span><span class="o">[]</span> <span class="n">row</span> <span class="o">:</span> <span class="n">resultList</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Member</span><span class="o">)</span> <span class="n">row</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>    <span class="c1">// ì—”í‹°í‹°</span>
    <span class="nc">Product</span> <span class="n">product</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Product</span><span class="o">)</span> <span class="n">row</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span> <span class="c1">// ì—”í‹°í‹°</span>
    <span class="kt">int</span> <span class="n">orderAmount</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Integer</span><span class="o">)</span> <span class="n">row</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span> <span class="c1">// ìŠ¤ì¹¼ë¼</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ë¬¼ë¡  ì´ë•Œë„ ì¡°íšŒí•œ ì—”í‹°í‹°ëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ê´€ë¦¬ëœë‹¤.<br />
<br /></p>

<p><strong>NEW ëª…ë ¹ì–´</strong><br />
í”„ë¡œì ì…˜ì„ UserDTOì²˜ëŸ¼ ì˜ë¯¸ ìˆëŠ” ê°ì²´ë¡œ ë³€í™˜í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDTO</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">age</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">UserDTO</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">,</span> <span class="kt">int</span> <span class="n">age</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">username</span> <span class="o">=</span> <span class="n">username</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">age</span> <span class="o">=</span> <span class="n">age</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">TypeQuery</span><span class="o">&lt;</span><span class="nc">UserDTO</span><span class="o">&gt;</span> <span class="n">query</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"SELECT new jpabook.jpql.UserDTO(m.username, m.age) FROM Member m"</span><span class="o">,</span> <span class="nc">UserDTO</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="nc">List</span><span class="o">&lt;</span><span class="nc">UserDTO</span><span class="o">&gt;</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
</code></pre></div></div>
<p>NEW ëª…ë ¹ì–´ ì‚¬ìš©ì‹œ ì£¼ì˜ ì‚¬í•­ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<ul>
  <li>íŒ¨í‚¤ì§€ ëª…ì„ í¬í•¨í•œ ì „ì²´ í´ë˜ìŠ¤ ëª…ì„ ì…ë ¥í•´ì•¼ í•œë‹¤.</li>
  <li>ìˆœì„œì™€ íƒ€ì…ì´ ì¼ì¹˜í•˜ëŠ” ìƒì„±ìê°€ í•„ìš”í•œë‹¤.<br />
<br />
<br /></li>
</ul>

<h3 id="1024-í˜ì´ì§•-api">10.2.4 í˜ì´ì§• API</h3>
<p>JPA í˜ì´ì§•</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">TypeQuery</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">query</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"SELECT m FROM Member m ORDER BY m.username DESC"</span><span class="o">,</span> <span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="n">query</span><span class="o">.</span><span class="na">setFirstResult</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span> <span class="c1">// ì¡°íšŒ ì‹œì‘ ìœ„ì¹˜(0ë¶€í„° ì‹œì‘)</span>
<span class="n">query</span><span class="o">.</span><span class="na">setMaxResult</span><span class="o">(</span><span class="mi">20</span><span class="o">);</span>   <span class="c1">// ì¡°íšŒí•  ë°ì´í„° ìˆ˜</span>
<span class="n">query</span><span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>HSQLDB í˜ì´ì§•</strong></p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="n">M</span><span class="p">.</span><span class="n">ID</span> <span class="k">AS</span> <span class="n">ID</span><span class="p">,</span>
    <span class="n">M</span><span class="p">.</span><span class="n">AGE</span> <span class="k">AS</span> <span class="n">AGE</span><span class="p">,</span>
    <span class="n">M</span><span class="p">.</span><span class="n">TEAM_ID</span> <span class="k">AS</span> <span class="n">TEAM_ID</span><span class="p">,</span>
    <span class="n">M</span><span class="p">.</span><span class="n">NAME</span> <span class="k">AS</span> <span class="n">NAME</span>
<span class="k">FROM</span>
    <span class="n">MEMBER</span> <span class="n">M</span>
<span class="k">ORDER</span> <span class="k">BY</span>
    <span class="n">M</span><span class="p">.</span><span class="n">NAME</span> <span class="k">DESC</span> <span class="k">OFFSET</span> <span class="o">?</span> <span class="k">LIMIT</span> <span class="o">?</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>MySQL í˜ì´ì§•</strong></p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="n">M</span><span class="p">.</span><span class="n">ID</span> <span class="k">AS</span> <span class="n">ID</span><span class="p">,</span>
    <span class="n">M</span><span class="p">.</span><span class="n">AGE</span> <span class="k">AS</span> <span class="n">AGE</span><span class="p">,</span>
    <span class="n">M</span><span class="p">.</span><span class="n">TEAM_ID</span> <span class="k">AS</span> <span class="n">TEAM_ID</span><span class="p">,</span>
    <span class="n">M</span><span class="p">.</span><span class="n">NAME</span> <span class="k">AS</span> <span class="n">NAME</span>
<span class="k">FROM</span>
    <span class="n">MEMBER</span> <span class="n">M</span>
<span class="k">ORDER</span> <span class="k">BY</span>
    <span class="n">M</span><span class="p">.</span><span class="n">NAME</span> <span class="k">DESC</span> <span class="k">LIMIT</span> <span class="o">?</span><span class="p">,</span> <span class="o">?</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>PostgreSQL í˜ì´ì§•</strong></p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="n">M</span><span class="p">.</span><span class="n">ID</span> <span class="k">AS</span> <span class="n">ID</span><span class="p">,</span>
    <span class="n">M</span><span class="p">.</span><span class="n">AGE</span> <span class="k">AS</span> <span class="n">AGE</span><span class="p">,</span>
    <span class="n">M</span><span class="p">.</span><span class="n">TEAM_ID</span> <span class="k">AS</span> <span class="n">TEAM_ID</span><span class="p">,</span>
    <span class="n">M</span><span class="p">.</span><span class="n">NAME</span> <span class="k">AS</span> <span class="n">NAME</span>
<span class="k">FROM</span>
    <span class="n">MEMBER</span> <span class="n">M</span>
<span class="k">ORDER</span> <span class="k">BY</span>
    <span class="n">M</span><span class="p">.</span><span class="n">NAME</span> <span class="k">DESC</span> <span class="k">LIMIT</span> <span class="o">?</span> <span class="k">OFFSET</span> <span class="o">?</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ì˜¤ë¼í´ í˜ì´ì§•</strong></p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span>
    <span class="p">(</span>
        <span class="k">SELECT</span> <span class="n">ROW_</span><span class="p">.</span><span class="o">*</span><span class="p">,</span> <span class="n">ROWNUM</span> <span class="n">ROWNUM_</span>
            <span class="k">FROM</span>
                <span class="p">(</span>
                    <span class="k">SELECT</span>
                        <span class="n">M</span><span class="p">.</span><span class="n">ID</span> <span class="k">AS</span> <span class="n">ID</span><span class="p">,</span>
                        <span class="n">M</span><span class="p">.</span><span class="n">AGE</span> <span class="k">AS</span> <span class="n">AGE</span><span class="p">,</span>
                        <span class="n">M</span><span class="p">.</span><span class="n">TEAM_ID</span> <span class="k">AS</span> <span class="n">TEAM_ID</span><span class="p">,</span>
                        <span class="n">M</span><span class="p">.</span><span class="n">NAME</span> <span class="k">AS</span> <span class="n">NAME</span>
                    <span class="k">FROM</span>
                        <span class="n">MEMBER</span> <span class="n">M</span>
                    <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">M</span><span class="p">.</span><span class="n">NAME</span>
                <span class="p">)</span> <span class="n">ROW_</span>
            <span class="k">WHERE</span> <span class="n">ROWNUM</span> <span class="o">&lt;=</span> <span class="o">?</span>
    <span class="p">)</span>
<span class="k">WHERE</span> <span class="n">ROWNUM_</span> <span class="o">&gt;</span> <span class="o">?</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>SQLServer í˜ì´ì§•</strong></p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WITH</span> <span class="n">query</span> <span class="k">AS</span> <span class="p">(</span>
    <span class="k">SELECT</span>
    <span class="n">inner_query</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
    <span class="n">ROW_NUMBER</span><span class="p">()</span> <span class="n">OVER</span> <span class="p">(</span><span class="k">ORDER</span> <span class="k">BY</span> <span class="k">CURRENT_TIMESTAMP</span><span class="p">)</span> <span class="k">as</span>
        <span class="n">__hibernate_row_nr__</span>
    <span class="k">FROM</span>
        <span class="p">(</span>
            <span class="k">select</span>
                <span class="n">TOP</span><span class="p">(</span><span class="o">?</span><span class="p">)</span> <span class="n">m</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">id</span><span class="p">,</span>
                <span class="n">m</span><span class="p">.</span><span class="n">age</span> <span class="k">as</span> <span class="n">age</span><span class="p">,</span>
                <span class="n">m</span><span class="p">.</span><span class="n">team_id</span> <span class="k">as</span> <span class="n">team_id</span><span class="p">,</span>
                <span class="n">m</span><span class="p">.</span><span class="n">name</span> <span class="k">as</span> <span class="n">name</span>
            <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span>
            <span class="k">order</span> <span class="k">by</span> <span class="n">m</span><span class="p">.</span><span class="n">name</span> <span class="k">DESC</span>
        <span class="p">)</span> <span class="n">inner_query</span>
<span class="p">)</span>
<span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">team_id</span><span class="p">,</span> <span class="n">name</span>
<span class="k">FROM</span> <span class="n">query</span>
<span class="k">WHERE</span> <span class="n">__hibernate_row_nr__</span> <span class="o">&gt;=</span> <span class="o">?</span> <span class="k">AND</span> <span class="n">__hibernate_row_nr__</span> <span class="o">&lt;</span> <span class="o">?</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1025-ì§‘í•©ê³¼-ì •ë ¬">10.2.5 ì§‘í•©ê³¼ ì •ë ¬</h3>
<p>ì§‘í•©ì€ ì§‘í•©í•¨ìˆ˜ì™€ í•¨ê»˜ í†µê³„ ì •ë³´ë¥¼ êµ¬í•  ë•Œ ì‚¬ìš©í•œë‹¤.</p>

<p><strong>ì§‘í•© í•¨ìˆ˜</strong></p>

<table>
  <thead>
    <tr>
      <th><strong>í•¨ìˆ˜</strong></th>
      <th><strong>ì„¤ëª…</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>COUNT</td>
      <td>ê²°ê³¼ ìˆ˜ë¥¼ êµ¬í•œë‹¤. ë°˜í™˜ íƒ€ì…: Long</td>
    </tr>
    <tr>
      <td>MAX, MIN</td>
      <td>ìµœëŒ€, ìµœì†Œ ê°’ì„ êµ¬í•œë‹¤. ë¬¸ì, ìˆ«ì, ë‚ ì§œ ë“±ì— ì‚¬ìš©í•œë‹¤.</td>
    </tr>
    <tr>
      <td>AVG</td>
      <td>í‰ê· ê°’ì„ êµ¬í•œë‹¤. ìˆ«ìíƒ€ì…ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë°˜í™˜ íƒ€ì…: Double</td>
    </tr>
    <tr>
      <td>SUM</td>
      <td>í•©ì„ êµ¬í•œë‹¤. ìˆ«ìíƒ€ì…ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë°˜í™˜ íƒ€ì…: ì •ìˆ˜í•© Long, ì†Œìˆ˜í•©: Double, BigIntegerí•©: BigInteger, BigDecimalí•©: BigDecimal</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p><strong>ì§‘í•© í•¨ìˆ˜ ì‚¬ìš© ì‹œ ì°¸ê³ ì‚¬í•­</strong></p>
<ul>
  <li>NULL ê°’ì€ ë¬´ì‹œí•˜ë¯€ë¡œ í†µê³„ì— ì¡íˆì§€ ì•ŠëŠ”ë‹¤. (DISTINCTê°€ ì •ì˜ë˜ì–´ ìˆì–´ë„ ë¬´ì‹œëœë‹¤.)</li>
  <li>ë§Œì•½ ê°’ì´ ì—†ëŠ”ë° SUM, AVG, MAX, MIN í•©ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ NULL ê°’ì´ ëœë‹¤. ë‹¨ COUNTëŠ” 0ì´ ëœë‹¤.</li>
  <li>DISTINCTë¥¼ ì§‘í•© í•¨ìˆ˜ ì•ˆì— ì‚¬ìš©í•´ì„œ ì¤‘ë³µëœ ê°’ì„ ì œê±°í•˜ê³  ë‚˜ì„œ ì§‘í•©ì„ êµ¬í•  ìˆ˜ ìˆë‹¤. ì˜ˆ: <code class="language-plaintext highlighter-rouge">select COUNT( DISTINCT m.age ) from Member m</code></li>
  <li>DISTINCTë¥¼ COUNTì—ì„œ ì‚¬ìš©í•  ë•Œ ì„ë² ë””ë“œ íƒ€ì…ì€ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
</ul>

<p><br /></p>

<p><strong>GROUP BY, HAVING</strong><br />
GROUP BYëŠ” í†µê³„ ë°ì´í„°ë¥¼ êµ¬í•  ë•Œ íŠ¹ì • ê·¸ë£¹ë¼ë¦¬ ë¬¶ì–´ì¤€ë‹¤. HAVINGì€ GROUP BYì™€ í•¨ê»˜ ì‚¬ìš©ë˜ëŠ”ë° GROUP BYë¡œ ê·¸ë£¹í™”í•œ í†µê³„ ë°ì´í„°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•„í„°ë§ í•œë‹¤.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span>
    <span class="n">t</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
    <span class="k">COUNT</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">age</span><span class="p">),</span>
    <span class="k">SUM</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">age</span><span class="p">),</span>
    <span class="k">AVG</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">age</span><span class="p">),</span>
    <span class="k">MAX</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">age</span><span class="p">),</span>
    <span class="k">MIN</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">age</span><span class="p">)</span>
<span class="k">from</span> <span class="n">Member</span> <span class="n">m</span> <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">m</span><span class="p">.</span><span class="n">team</span> <span class="n">t</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">t</span><span class="p">.</span><span class="n">name</span>
<span class="k">HAVING</span> <span class="k">AVG</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">age</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">10</span>
</code></pre></div></div>
<p>ë¬¸ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>groupby_ì ˆ ::= GORUP BY {ë‹¨ì¼ê°’ ê²½ë¡œ | ë³„ì¹­} +
having_ì ˆ ::= HAVING ì¡°ê±´ì‹
</code></pre></div></div>
<p><br /></p>

<p><strong>ì •ë ¬(ORDER BY)</strong><br />
ê²°ê³¼ë¥¼ ì •ë ¬í•  ë•Œ ì‚¬ìš©í•œë‹¤.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">m</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span> <span class="k">order</span> <span class="k">by</span> <span class="n">m</span><span class="p">.</span><span class="n">age</span> <span class="k">DESC</span><span class="p">,</span> <span class="n">m</span><span class="p">.</span><span class="n">username</span> <span class="k">ASC</span>
</code></pre></div></div>
<p>ë¬¸ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>orderby_ì ˆ ::= ORDER BY {ìƒíƒœí•„ë“œ ê²½ë¡œ | ê²°ê³¼ ë³€ìˆ˜ [ASC | DESC]}+
</code></pre></div></div>
<ul>
  <li>ASC: ì˜¤ë¦„ì°¨ìˆœ(ê¸°ë³¸ê°’)</li>
  <li>DESC: ë‚´ë¦¼ì°¨ìˆœ</li>
</ul>

<p><br /></p>

<h3 id="1026-jpql-ì¡°ì¸">10.2.6 JPQL ì¡°ì¸</h3>
<p>JPQLë„ ì¡°ì¸ì„ ì§€ì›í•˜ëŠ”ë° SQL ì¡°ì¸ê³¼ ê¸°ëŠ¥ì€ ê°™ê³  ë¬¸ë²•ë§Œ ì•½ê°„ ë‹¤ë¥´ë‹¤.</p>

<p><strong>ë‚´ë¶€ ì¡°ì¸</strong><br />
ë‚´ë¶€ì¡°ì¸ì€ INNER JOINì„ ì‚¬ìš©í•œë‹¤. ì°¸ê³ ë¡œ INNERëŠ” ìƒëµí•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">teamName</span> <span class="o">=</span> <span class="s">"íŒ€A"</span><span class="o">;</span>
<span class="nc">String</span> <span class="n">query</span> <span class="o">=</span> <span class="s">"SELECT m FROM Member m INNER JOIN m.team t WHERE t.name = :teamName"</span><span class="o">;</span>

<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="s">"teamName"</span><span class="o">,</span> <span class="n">teamName</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
</code></pre></div></div>

<div class="notice--warning">
<p><strong>ì£¼ì˜ì‚¬í•­</strong><br />
<strong>JPQL ì¡°ì¸ì€ ì—°ê´€ í•„ë“œë¥¼ ì‚¬ìš©</strong>í•œë‹¤ëŠ” ê²ƒì´ë‹¤. SQL ì¡°ì¸ì²˜ëŸ¼ ì‚¬ìš©í•˜ë©´ ë¬¸ë²• ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤. ë‹¤ìŒì€ ì˜ëª»ëœ ì˜ˆì´ë‹¤.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- ì˜ëª»ëœ JPQL ì¡°ì¸</span>
<span class="k">FROM</span> <span class="n">Member</span> <span class="n">m</span> <span class="k">JOIN</span> <span class="n">Team</span> <span class="n">t</span> 
</code></pre></div></div>
</div>
<p><br /></p>

<p><strong>ì™¸ë¶€ ì¡°ì¸</strong><br />
JPQLì˜ ì™¸ë¶€ ì¡°ì¸ì€ ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•œë‹¤.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">m</span>
<span class="k">FROM</span> <span class="n">Member</span> <span class="n">m</span> <span class="k">LEFT</span> <span class="p">[</span><span class="k">OUTER</span><span class="p">]</span> <span class="k">JOIN</span> <span class="n">m</span><span class="p">.</span><span class="n">team</span> <span class="n">t</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ì»¬ë ‰ì…˜ ì¡°ì¸</strong><br />
ì¼ëŒ€ë‹¤ ê´€ê³„ë‚˜ ë‹¤ëŒ€ë‹¤ ê´€ê³„ì²˜ëŸ¼ ì»¬ë ‰ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ê³³ì—ì„œ ì¡°ì¸í•˜ëŠ” ê²ƒì„ ì»¬ë ‰ì…˜ ì¡°ì¸ì´ë¼ í•œë‹¤.</p>
<ul>
  <li>[íšŒì› -&gt; íŒ€]ìœ¼ë¡œì˜ ì¡°ì¸ì€ ë‹¤ëŒ€ì¼ ì¡°ì¸, ë‹¨ì¼ ê°’ ì—°ê´€í•„ë“œ(m.team) ì‚¬ìš©</li>
  <li>[íŒ€ -&gt; íšŒì›]ìœ¼ë¡œì˜ ì¡°ì¸ì€ ì¼ëŒ€ë‹¤ ì¡°ì¸, ì»¬ë ‰ì…˜ ê°’ ì—°ê´€í•„ë“œ(m.members) ì‚¬ìš©</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- íŒ€ê³¼ íšŒì›ëª©ë¡ì„ ì»¬ë ‰ì…˜ ê°’ ì—°ê´€ í•„ë“œë¡œ ì™¸ë¶€ì¡°ì¸ í–ˆë‹¤.</span>
<span class="k">SELECT</span> <span class="n">t</span><span class="p">,</span> <span class="n">m</span> <span class="k">FROM</span> <span class="n">Team</span> <span class="n">t</span> <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">t</span><span class="p">.</span><span class="n">members</span> <span class="n">m</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ì„¸íƒ€ ì¡°ì¸</strong><br />
WHERE ì ˆì„ ì‚¬ìš©í•´ì„œ ì„¸íƒ€ ì¡°ì¸ì„ í•  ìˆ˜ ìˆë‹¤. <strong>ì„¸íƒ€ ì¡°ì¸ì€ ë‚´ë¶€ ì¡°ì¸ë§Œ ì§€ì›í•œë‹¤.</strong> ì„¸íƒ€ ì¡°ì¸ì„ ì‚¬ìš©í•˜ë©´ ì „í˜€ ê´€ê³„ì—†ëŠ” ì—”í‹°í‹°ë„ ì¡°ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- JPQL</span>
<span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span><span class="p">,</span> <span class="n">Team</span> <span class="n">t</span>
<span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">team</span>

<span class="c1">-- sql</span>
<span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
<span class="k">from</span>
    <span class="n">member</span> <span class="n">m</span> <span class="k">cross</span> <span class="k">join</span> <span class="n">team</span> <span class="n">t</span>
<span class="k">where</span>
    <span class="n">m</span><span class="p">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">name</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>JOIN ON ì ˆ(JPA 2.1)</strong><br />
JPA 2.1ë¶€í„° ì¡°ì¸í•  ë•Œ ON ì ˆì„ ì§€ì›í•œë‹¤. ì°¸ê³ ë¡œ ë‚´ë¶€ ì¡°ì¸ì´ ON ì ˆì€ WHERE ì ˆì„ ì‚¬ìš©í•  ë•Œì™€ ê²°ê³¼ê°€ ê°™ìœ¼ë¯€ë¡œ ë³´í†µ ON ì ˆì€ ì™¸ë¶€ ì¡°ì¸ì—ì„œë§Œ ì‚¬ìš©í•œë‹¤.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- JPQL</span>
<span class="k">select</span> <span class="n">m</span><span class="p">,</span> <span class="n">t</span>
<span class="k">from</span> <span class="n">Member</span> <span class="n">m</span>
    <span class="k">left</span> <span class="k">join</span> <span class="n">m</span><span class="p">.</span><span class="n">team</span> <span class="n">t</span> <span class="k">on</span> <span class="n">t</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'A'</span>

<span class="c1">-- SQL</span>
<span class="k">select</span> <span class="n">m</span><span class="p">.</span><span class="o">*</span><span class="p">,</span> <span class="n">t</span><span class="p">.</span><span class="o">*</span>
<span class="k">from</span> <span class="n">Member</span> <span class="n">m</span>
    <span class="k">left</span> <span class="k">join</span> <span class="n">Team</span> <span class="n">t</span> <span class="k">on</span> <span class="n">m</span><span class="p">.</span><span class="n">team_id</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">id</span> 
    <span class="k">and</span> <span class="n">t</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'A'</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1027-í˜ì¹˜-ì¡°ì¸">10.2.7 í˜ì¹˜ ì¡°ì¸</h3>
<ul>
  <li>í˜ì¹˜(fetch) ì¡°ì¸ì€ JPQLì—ì„œ ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤.</li>
  <li>ì—°ê´€ëœ ì—”í‹°í‹°ë‚˜ ì»¬ë ‰ì…˜ì„ í•œ ë²ˆì— ê°™ì´ ì¡°íšŒí•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤.</li>
  <li>join fetch ëª…ë ¹ì–´ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><strong>ë¬¸ë²•</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>í˜ì¹˜ ì¡°ì¸ ::= [ LEFT [OUTER] | INNER ] JOIN FETCH ì¡°ì¸ê²½ë¡œ
</code></pre></div></div>
<p><br /></p>

<p><strong>ì—”í‹°í‹° í˜ì¹˜ ì¡°ì¸</strong><br />
ë‹¤ìŒì€ í˜ì¹˜ ì¡°ì¸ì„ ì‚¬ìš©í•´ì„œ íšŒì› ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•˜ë©´ì„œ ì—°ê´€ëœ íŒ€ ì—”í‹°í‹°ë„ í•¨ê»˜ ì¡°íšŒ í•˜ëŠ” JPQL</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- í˜ì¹˜ ì¡°ì¸ JPQL</span>
<span class="k">select</span> <span class="n">m</span>
<span class="k">from</span> <span class="n">Member</span> <span class="n">m</span> <span class="k">join</span> <span class="k">fetch</span> <span class="n">m</span><span class="p">.</span><span class="n">team</span>


<span class="c1">-- ì‹¤í–‰ëœ SQL</span>
<span class="k">SELECT</span>
    <span class="n">M</span><span class="p">.</span><span class="o">*</span><span class="p">,</span> <span class="n">T</span><span class="p">.</span><span class="o">*</span>
<span class="k">FROM</span> <span class="n">MEMBER</span> <span class="n">T</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">TEAM</span> <span class="n">T</span> <span class="k">ON</span> <span class="n">M</span><span class="p">.</span><span class="n">TEAM_ID</span> <span class="o">=</span> <span class="n">T</span><span class="p">.</span><span class="n">ID</span>

</code></pre></div></div>
<p>JPQLì¡°ì¸ê³¼ëŠ” ë‹¤ë¥´ê²Œ m.team ë‹¤ìŒì— ë³„ì¹­ì´ ì—†ëŠ”ë° í˜ì¹˜ ì¡°ì¸ì€ ë³„ì¹­ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. (í•˜ì§€ë§Œ í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” í˜ì¹˜ ì¡°ì¸ì—ë„ ë³„ì¹­ì„ í—ˆìš©í•œë‹¤.)<br />
<br /></p>

<p><strong>ì»¬ë ‰ì…˜ í˜ì¹˜ ì¡°ì¸</strong><br />
ì¼ëŒ€ë‹¤ ê´€ê³„ì¸ ì»¬ë ‰ì…˜ì„ í˜ì¹˜ ì¡°ì¸</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- ì»¬ë ‰ì…˜ í˜ì¹˜ ì¡°ì¸ JPQL</span>
<span class="k">select</span> <span class="n">t</span>
<span class="k">from</span> <span class="n">Team</span> <span class="n">t</span> <span class="k">join</span> <span class="k">fetch</span> <span class="n">t</span><span class="p">.</span><span class="n">members</span>
<span class="k">where</span> <span class="n">t</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'íŒ€A'</span>


<span class="c1">-- ì‹¤í–‰ëœ SQL</span>
<span class="k">SELECT</span>
    <span class="n">T</span><span class="p">.</span><span class="o">*</span><span class="p">,</span> <span class="n">M</span><span class="p">.</span><span class="o">*</span>
<span class="k">FROM</span> <span class="n">TEAM</span> <span class="n">T</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">MEMBER</span> <span class="n">M</span> <span class="k">ON</span> <span class="n">T</span><span class="p">.</span><span class="n">ID</span> <span class="o">=</span> <span class="n">M</span><span class="p">.</span><span class="n">TEAM_ID</span>
<span class="k">WHERE</span> <span class="n">T</span><span class="p">.</span><span class="n">NAME</span> <span class="o">=</span> <span class="s1">'íŒ€A'</span>
</code></pre></div></div>
<p>ë¬¸ì œëŠ” TEAM í…Œì´ë¸”ì—ì„œ íŒ€AëŠ” í•˜ë‚˜ì§€ë§Œ MEMBERí…Œì´ë¸”ê³¼ ì¡°ì¸í•˜ë©´ì„œ ê²°ê³¼ê°€ ì¦ê°€í•œë‹¤. í…Œì´ë¸”ì˜ ë°ì´í„°ê°€ íŒ€A, íšŒì›1, íšŒì›2 ìˆë‹¤ê³  í•˜ë©´ ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>teamname = íŒ€A, team = Team@0x100
    username = íšŒì›1, member = Member@0x200
    username = íšŒì›2, member = Member@0x300
teamname = íŒ€A, team = Team@0x100
    username = íšŒì›1, member = Member@0x200
    username = íšŒì›2, member = Member@0x300
</code></pre></div></div>

<p><br /></p>

<p><strong>í˜ì¹˜ ì¡°ì¸ê³¼ DISTINCT</strong><br />
ìœ„ì˜ ì»¬ë ‰ì…˜ í˜ì¹˜ ì¡°ì¸ì€ íŒ€Aê°€ ì¤‘ë³µìœ¼ë¡œ ì¡°íšŒëœë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ DISTINCTë¥¼ ì‚¬ìš©í•œë‹¤.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">distinct</span> <span class="n">t</span>
<span class="k">from</span> <span class="n">Team</span> <span class="n">t</span> <span class="k">join</span> <span class="k">fetch</span> <span class="n">t</span><span class="p">.</span><span class="n">members</span>
<span class="k">where</span> <span class="n">t</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'íŒ€A'</span>
</code></pre></div></div>
<p>ìœ„ ìƒí™©ì˜ ë°ì´í„°ëŠ” SQLì—ì„œ DISTINCTë¥¼ í•´ë„ íš¨ê³¼ê°€ ì—†ë‹¤.</p>

<table>
  <thead>
    <tr>
      <th><strong>ë¡œìš° ë²ˆí˜¸</strong></th>
      <th><strong>íŒ€</strong></th>
      <th><strong>íšŒì›</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>íŒ€A</td>
      <td>íšŒì›1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>íŒ€A</td>
      <td>íšŒì›2</td>
    </tr>
  </tbody>
</table>

<p>í•˜ì§€ë§Œ <strong>JPQLì˜ select distinct tì˜ ì˜ë¯¸ëŠ” ì—”í‹°í‹°ì˜ ì¤‘ë³µì„ ì œê±°í•˜ë¼ëŠ” ê²ƒì´ë‹¤. ë”°ë¼ì„œ íŒ€AëŠ” í•˜ë‚˜ë§Œ ì¡°íšŒëœë‹¤.</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>teamname = íŒ€A, team = Team@0x100
    username = íšŒì›1, member = Member@0x200
    username = íšŒì›2, member = Member@0x300
</code></pre></div></div>
<p><br /></p>

<p><strong>í˜ì¹˜ ì¡°ì¸ê³¼ ì¼ë°˜ ì¡°ì¸ì˜ ì°¨ì´</strong></p>
<ul>
  <li>ì¼ë°˜ ì¡°ì¸: JPQLì˜ ê²°ê³¼ë¥¼ ë°˜í™˜í•  ë•Œ ì—°ê´€ê´€ê³„ê¹Œì§€ ê³ ë ¤í•˜ì§€ ì•ŠëŠ”ë‹¤. ë‹¨ì§€ SELECT ì ˆì— ì§€ì •í•œ ì—”í‹°í‹°ë§Œ ì¡°íšŒí•  ë¿ì´ë‹¤.</li>
  <li>í˜ì¹˜ ì¡°ì¸: SELECT ì ˆì— ì§€ì •í•œ ì—”í‹°í‹°ë¿ë§Œ ì•„ë‹ˆë¼ ì§€ì •í•˜ì§€ ì•Šì•˜ì–´ë„ ì—°ê´€ëœ ì—”í‹°í‹°ë„ í•¨ê»˜ ì¡°íšŒí•œë‹¤.</li>
</ul>

<p><br /></p>

<p><strong>í˜ì¹˜ ì¡°ì¸ì˜ íŠ¹ì§•ê³¼ í•œê³„</strong></p>
<ul>
  <li>SQL í•œë²ˆìœ¼ë¡œ ì—°ê´€ëœ ì—”í‹°í‹°ë“¤ì„ ì¡°íšŒí•˜ì—¬ SQL í˜¸ì¶œ íšŸìˆ˜ë¥¼ ì¤„ì—¬ ì„±ëŠ¥ì„ ìµœì í™”í•  ìˆ˜ ìˆë‹¤.</li>
  <li>JPQLì—ì„œ í˜ì¹˜ ì¡°ì¸ì„ ì‚¬ìš©í•˜ë©´ ê¸€ë¡œë²Œ ì „ëµë³´ë‹¤ ìš°ì„  ì ìš©ëœë‹¤.
    <ul>
      <li>ê¸€ë¡œë²Œ ì „ëµ ì˜ˆ: @OneToMany(fetch = FetchType.LAZY)</li>
    </ul>
  </li>
  <li>í˜ì¹˜ ì¡°ì¸ì„ í•˜ë©´ ì¿¼ë¦¬ ì‹œì ì— ì¡°íšŒí•˜ë¯€ë¡œ ì¤€ì˜ì† ìƒíƒœì—ì„œë„ ê°ì²´ ê·¸ë˜í”„ë¥¼ íƒìƒ‰í•  ìˆ˜ ìˆë‹¤.</li>
  <li>í˜ì¹˜ ì¡°ì¸ ëŒ€ìƒì—ëŠ” ë³„ì¹­ì„ ì¤„ ìˆ˜ ì—†ë‹¤.
    <ul>
      <li>ë”°ë¼ì„œ SELECT, WHERE, ì„œë¹„ ì¿¼ë¦¬ì— í˜ì¹˜ ì¡°ì¸ ëŒ€ìƒì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.</li>
      <li>í•˜ì´ë²„ë„¤ì´íŠ¸ì—ì„œëŠ” í˜ì¹˜ ì¡°ì¸ì— ë³„ì¹­ì„ ì§€ì›í•œë‹¤. í•˜ì§€ë§Œ ì˜ëª» ì‚¬ìš©í•˜ë©´ ì—°ê´€ëœ ë°ì´í„° ìˆ˜ê°€ ë‹¬ë¼ì ¸ ë¬´ê²°ì„±ì´ ê¹¨ì§ˆ ìˆ˜ ìˆë‹¤.</li>
    </ul>
  </li>
  <li>ë‘˜ ì´ìƒì˜ ì»¬ë ‰ì…˜ì„ í˜ì¹˜í•  ìˆ˜ ì—†ë‹¤.</li>
  <li>ì»¬ë ‰ì…˜ì„ í˜ì¹˜ ì¡°ì¸í•˜ë©´ í˜ì´ì§• APIë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.
    <ul>
      <li>ì»¬ë ‰ì…˜(ì¼ëŒ€ë‹¤)ì´ ì•„ë‹Œ ë‹¨ì¼ ê°’ ì—°ê´€ í•„ë“œ(ì¼ëŒ€ì¼, ë‹¤ëŒ€ì¼)ì€ í˜ì¹˜ ì¡°ì¸ ê°€ëŠ¥</li>
      <li>í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” ì»¬ë ‰ì…˜ì„ í˜ì¹˜ ì¡°ì¸í•˜ê³  í˜ì´ì§• APIë¥¼ ì‚¬ìš©í•˜ë©´ ê²½ê³  ë¡œê·¸ë¥¼ ë‚¨ê¸°ê³  ë©”ëª¨ë¦¬ì—ì„œ í˜ì´ì§• ì²˜ë¦¬í•œë‹¤. í•˜ì§€ë§Œ ì„±ëŠ¥ ì´ìŠˆê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.</li>
    </ul>
  </li>
</ul>

<p class="notice--info"><strong>ì¶”ì²œì€ ê¸€ë¡œë²Œ ì „ëµì€ ì§€ì—° ë¡œë”©ì„ ì‚¬ìš©í•˜ê³  ìµœì í™”ê°€ í•„ìš”í•˜ë©´ ê·¸ ë•Œ í˜ì¹˜ ì¡°ì¸ì„ ì ìš©í•œë‹¤.</strong></p>

<p><br />
<br /></p>

<h3 id="1028-ê²½ë¡œ-í‘œí˜„ì‹">10.2.8 ê²½ë¡œ í‘œí˜„ì‹</h3>
<p>ê²½ë¡œ í‘œí˜„ì‹ì´ë€ m.username, m.team ì²˜ëŸ¼ .(ì )ì„ ì°ì–´ ê°ì²´ ê·¸ë˜í”„ë¥¼ íƒìƒ‰í•˜ëŠ” ê²ƒì´ë‹¤.</p>

<p><strong>ê²½ë¡œ í‘œí˜„ì‹ì˜ ìš©ì–´ ì •ë¦¬</strong></p>
<ul>
  <li>ìƒíƒœ í•„ë“œ: ë‹¨ìˆœíˆ ê°’ì„ ì €ì¥í•˜ê¸° ìœ„í•œ í•„ë“œ</li>
  <li>ì—°ê´€ í•„ë“œ: ì—°ê´€ê´€ê³„ë¥¼ ìœ„í•œ í•„ë“œ, ì„ë² ë””ë“œ íƒ€ì… í¬í•¨
    <ul>
      <li>ë‹¨ì¼ ê°’ ì—°ê´€í•„ë“œ: @ManyToOne, @OneToOne, ëŒ€ìƒì´ ì—”í‹°í‹°</li>
      <li>ì»¬ë ‰ì…˜ ê°’ ì—°ê´€ í•„ë“œ: @OneToMany, @ManyToMany, ëŒ€ìƒì´ ì»¬ë ‰ì…˜</li>
    </ul>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"name"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>    <span class="c1">// ìƒíƒœ í•„ë“œ</span>

    <span class="nd">@ManyToOne</span><span class="o">(...)</span>
    <span class="kd">private</span> <span class="nc">Team</span> <span class="n">team</span><span class="o">;</span>          <span class="c1">// ì—°ê´€ í•„ë“œ (ë‹¨ì¼ ê°’)</span>

    <span class="nd">@OneToMany</span><span class="o">(...)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">orders</span><span class="o">;</span> <span class="c1">// ì—°ê´€ í•„ë“œ (ì»¬ë ‰ì…˜ ê°’)</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ê²½ë¡œ í‘œí˜„ì‹ íŠ¹ì§•</strong><br />
JPQLì—ì„œ ê²½ë¡œ í‘œí˜„ì‹ì˜ íŠ¹ì§•</p>
<ul>
  <li>
    <p>ìƒíƒœ í•„ë“œ ê²½ë¡œ: ê²½ë¡œ íƒìƒ‰ì˜ ëì´ë‹¤. ë”ëŠ” íƒìƒ‰í•  ìˆ˜ ì—†ë‹¤.</p>

    <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">-- JPQL</span>
  <span class="k">select</span> <span class="n">m</span><span class="p">.</span><span class="n">username</span><span class="p">,</span> <span class="n">m</span><span class="p">.</span><span class="n">age</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span>

  <span class="c1">-- SQL ë³€í™˜</span>
  <span class="k">select</span> <span class="n">m</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">m</span><span class="p">.</span><span class="n">age</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span>
</code></pre></div>    </div>
    <p><br /></p>
  </li>
  <li>
    <p>ë‹¨ì¼ ê°’ ì—°ê´€ ê²½ë¡œ: ë¬µì‹œì ìœ¼ë¡œ ë‚´ë¶€ ì¡°ì¸ì´ ì¼ì–´ë‚œë‹¤. ë‹¨ì¼ ê°’ ì—°ê´€ ê²½ë¡œëŠ” ê³„ì† íƒìƒ‰í•  ìˆ˜ ìˆë‹¤.</p>

    <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">-- JPQL</span>
  <span class="k">select</span> <span class="n">o</span><span class="p">.</span><span class="n">member</span> <span class="k">from</span> <span class="k">Order</span> <span class="n">o</span>  <span class="c1">-- ë¬µì‹œì  ì¡°ì¸</span>
  <span class="c1">-- where o.product.name = 'productA' ì´ë ‡ê²Œ ê³„ì† íƒìƒ‰ ê°€ëŠ¥</span>

  <span class="c1">-- SQL ë³€í™˜</span>
  <span class="k">select</span> <span class="n">m</span><span class="p">.</span><span class="o">*</span>
  <span class="k">from</span> <span class="k">Order</span> <span class="n">o</span>
      <span class="k">inner</span> <span class="k">join</span> <span class="n">Member</span> <span class="n">m</span> <span class="k">on</span> <span class="n">o</span><span class="p">.</span><span class="n">member_id</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">id</span> <span class="c1">-- ë¬µì‹œì ìœ¼ë¡œ ë‚´ë¶€ ì¡°ì¸ì´ ì¼ì–´ë‚¬ë‹¤</span>
</code></pre></div>    </div>
    <p><br /></p>
  </li>
  <li>
    <p>ì»¬ë ‰ì…˜ ê°’ ì—°ê´€ ê²½ë¡œ: ë¬µì‹œì ìœ¼ë¡œ ë‚´ë¶€ ì¡°ì¸ì´ ì¼ì–´ë‚œë‹¤. ë”ëŠ” íƒìƒ‰í•  ìˆ˜ ì—†ë‹¤. ë‹¨ FROM ì ˆì—ì„œ ì¡°ì¸ì„ í†µí•´ ë³„ì¹­ì„ ì–»ìœ¼ë©´ ë³„ì¹­ìœ¼ë¡œ íƒìƒ‰í•  ìˆ˜ ìˆë‹¤.</p>

    <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">-- JPQL</span>
  <span class="c1">-- ì„±ê³µ</span>
  <span class="k">select</span> <span class="n">t</span><span class="p">.</span><span class="n">members</span> <span class="k">from</span> <span class="n">Team</span> <span class="n">t</span> 

  <span class="c1">-- ì‹¤íŒ¨, ì»¬ë ‰ì…˜ ê°’ì€ íƒìƒ‰ì´ ë¶ˆê°€ </span>
  <span class="k">select</span> <span class="n">t</span><span class="p">.</span><span class="n">members</span><span class="p">.</span><span class="n">username</span> <span class="k">from</span> <span class="n">Team</span> <span class="n">t</span> 
  <span class="c1">-- ë‹¤ìŒì²˜ëŸ¼ ë³„ì¹­ì„ ì–»ì–´ì„œ ê²½ë¡œíƒìƒ‰ì„ í•´ì•¼ í•œë‹¤.</span>
  <span class="k">select</span> <span class="n">m</span><span class="p">.</span><span class="n">username</span> <span class="k">from</span> <span class="n">Team</span> <span class="n">t</span> <span class="k">join</span> <span class="n">t</span><span class="p">.</span><span class="n">members</span> <span class="n">m</span>

  <span class="c1">-- ì»¬ë ‰ì…˜ì˜ í¬ê¸°ë¥¼ êµ¬í•  ìˆ˜ ìˆëŠ” sizeê¸°ëŠ¥ ì œê³µ, ì´ë¥¼ ì‚¬ìš©í•˜ë©´ countí•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” SQLë¡œ ë³€í™˜ëœë‹¤.</span>
  <span class="k">select</span> <span class="n">t</span><span class="p">.</span><span class="n">members</span><span class="p">.</span><span class="k">size</span> <span class="k">from</span> <span class="n">Team</span> <span class="n">t</span> 
</code></pre></div>    </div>
    <p><br />
<br /></p>
  </li>
</ul>

<p><strong>ê²½ë¡œ íƒìƒ‰ì„ ì‚¬ìš©í•œ ë¬µì‹œì  ì¡°ì¸ ì‹œ ì£¼ì˜ì‚¬í•­</strong></p>
<ul>
  <li>í•­ìƒ ë‚´ë¶€ ì¡°ì¸ì´ë‹¤.</li>
  <li>ì»¬ë ‰ì…˜ì€ ê²½ë¡œ íƒìƒ‰ì˜ ëì´ë‹¤. ì»¬ë ‰ì…˜ì—ì„œ ê²½ë¡œ íƒìƒ‰ì„ í•˜ë ¤ë©´ ëª…ì‹œì ìœ¼ë¡œ ì¡°ì¸í•´ì„œ ë³„ì¹­ì„ ì–»ì–´ì•¼ í•œë‹¤.</li>
  <li>ê²½ë¡œ íƒìƒ‰ì€ ì£¼ë¡œ SELECT, WHERE ì ˆ(ë‹¤ë¥¸ ê³³ì—ì„œë„ ì‚¬ìš©ë¨)ì—ì„œ ì‚¬ìš©í•˜ì§€ë§Œ ë¬µì‹œì  ì¡°ì¸ìœ¼ë¡œ ì¸í•´ SQLì˜ FROMì ˆì— ì˜í–¥ì„ ì¤€ë‹¤.</li>
</ul>

<p class="notice--info"><strong>ë‹¨ìˆœí•˜ê³  ì„±ëŠ¥ì— ì´ìŠˆê°€ ì—†ìœ¼ë©´ ë¬¸ì œê°€ ì•ˆ ë˜ì§€ë§Œ, ì„±ëŠ¥ì´ ì¤‘ìš”í•˜ë©´ ë¶„ì„í•˜ê¸° ì‰½ë„ë¡ ë¬µì‹œì  ì¡°ì¸ë³´ë‹¤ëŠ” ëª…ì‹œì  ì¡°ì¸ì„ ì‚¬ìš©í•˜ì.</strong></p>
<p><br />
<br /></p>

<h3 id="1029-ì„œë¸Œ-ì¿¼ë¦¬">10.2.9 ì„œë¸Œ ì¿¼ë¦¬</h3>
<p>JPQLë„ SQLì²˜ëŸ¼ ì„œë¸Œ ì¿¼ë¦¬ë¥¼ ì§€ì›í•œë‹¤.</p>
<ul>
  <li>ì‚¬ìš©ê°€ëŠ¥: WHERE, HAVING ì ˆ</li>
  <li>ì‚¬ìš©ë¶ˆê°€: SELECT, FROM ì ˆ
    <ul>
      <li>í•˜ì´ë²„ë„¤ì´íŠ¸ì˜ HQLì€ SELECT ì ˆì˜ ì„œë¸Œ ì¿¼ë¦¬ë„ í—ˆìš©í•œë‹¤. í•˜ì§€ë§Œ FROM ì ˆì˜ ì„œë¸Œ ì¿¼ë¦¬ëŠ” ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤.<br />
<br /></li>
    </ul>
  </li>
</ul>

<p><strong>ì„œë¸Œì¿¼ë¦¬ ì˜ˆ</strong></p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- ë‚˜ì´ê°€ í‰ê· ë³´ë‹¤ ë§ì€ íšŒì›</span>
<span class="k">select</span> <span class="n">m</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span>
<span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">age</span> <span class="o">&gt;</span> <span class="p">(</span><span class="k">select</span> <span class="k">avg</span><span class="p">(</span><span class="n">m2</span><span class="p">.</span><span class="n">age</span><span class="p">)</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m2</span><span class="p">)</span>

<span class="c1">-- í•œ ê±´ì´ë¼ë„ ì£¼ë¬¸í•œ ê³ ê°</span>
<span class="k">select</span> <span class="n">m</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span>
<span class="k">where</span> <span class="p">(</span><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">from</span> <span class="k">Order</span> <span class="n">o</span> <span class="k">where</span> <span class="n">m</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="n">member</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

<span class="c1">-- í•œ ê±´ì´ë¼ë„ ì£¼ë¬¸í•œ ê³ ê°</span>
<span class="c1">-- size ì´ìš©, ìœ„ì™€ ê²°ê³¼ê°€ ê°™ë‹¤.(ì‹¤í–‰ SQLë„ ê°™ë‹¤)</span>
<span class="k">select</span> <span class="n">m</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span>
<span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">orders</span><span class="p">.</span><span class="k">size</span> <span class="o">&gt;</span> <span class="mi">0</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ì„œë¸Œ ì¿¼ë¦¬ í•¨ìˆ˜</strong><br />
ì„œë¸Œ ì¿¼ë¦¬ëŠ” ë‹¤ìŒ í•¨ìˆ˜ë“¤ê³¼ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<ul>
  <li>EXISTS
    <ul>
      <li>ë¬¸ë²•: [NOT] EXISTS (subquery)</li>
      <li>ì„¤ëª…: ì„œë¸Œì¿¼ë¦¬ì— ê²°ê³¼ê°€ ì¡´ì¬í•˜ë©´ ì°¸ì´ë‹¤.
        <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">m</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span>
<span class="k">where</span> <span class="k">exists</span> <span class="p">(</span><span class="k">select</span> <span class="n">t</span> <span class="k">from</span> <span class="n">m</span><span class="p">.</span><span class="n">team</span> <span class="n">t</span> <span class="k">where</span> <span class="n">t</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'íŒ€A'</span><span class="p">)</span>
</code></pre></div>        </div>
        <p><br /></p>
      </li>
    </ul>
  </li>
  <li>{ALL | ANY | SOME}
    <ul>
      <li>ë¬¸ë²•: {ALL | ANY | SOME} (subquery)</li>
      <li>ì„¤ëª…: ë¹„êµ ì—°ì‚°ìì™€ ê°™ì´ ì‚¬ìš©í•œë‹¤. {= | &gt; | &gt;= | &lt; | &lt;= | &lt;&gt;}
        <ul>
          <li>ALL: ì¡°ê±´ì„ ëª¨ë‘ ë§Œì¡±í•˜ë©´ ì°¸ì´ë‹¤.</li>
          <li>ANY í˜¹ì€ SOME: ë‘˜ì€ ê°™ì€ ì˜ë¯¸ë‹¤. ì¡°ê±´ì„ í•˜ë‚˜ë¼ë„ ë§Œì¡±í•˜ë©´ ì°¸ì´ë‹¤.</li>
        </ul>

        <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">o</span> <span class="k">from</span> <span class="k">Order</span> <span class="n">o</span>
<span class="k">where</span> <span class="n">o</span><span class="p">.</span><span class="n">orderAmount</span> <span class="o">&gt;</span> <span class="k">ALL</span> <span class="p">(</span><span class="k">select</span> <span class="n">p</span><span class="p">.</span><span class="n">stockAmount</span> <span class="k">from</span> <span class="n">Product</span> <span class="n">p</span><span class="p">)</span>

<span class="k">select</span> <span class="n">m</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span>
<span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">team</span> <span class="o">=</span> <span class="k">ANY</span> <span class="p">(</span><span class="k">select</span> <span class="n">t</span> <span class="k">from</span> <span class="n">Team</span> <span class="n">t</span><span class="p">)</span>
</code></pre></div>        </div>
        <p><br /></p>
      </li>
    </ul>
  </li>
  <li>IN
    <ul>
      <li>ë¬¸ë²•: [NOT] IN (subquery)</li>
      <li>ì„¤ëª…: ì„œë¸Œì¿¼ë¦¬ì˜ ê²°ê³¼ ì¤‘ í•˜ë‚˜ë¼ë„ ê°™ì€ ê²ƒì´ ìˆìœ¼ë©´ ì°¸ì´ë‹¤. ì°¸ê³ ë¡œ INì€ ì„œë¸Œì¿¼ë¦¬ê°€ ì•„ë‹Œê³³ì—ì„œë„ ì‚¬ìš©í•œë‹¤.
        <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">t</span> <span class="k">from</span> <span class="n">Team</span> <span class="n">t</span>
<span class="k">where</span> <span class="n">t</span> <span class="k">IN</span> <span class="p">(</span><span class="k">select</span> <span class="n">t2</span> <span class="k">From</span> <span class="n">Team</span> <span class="n">t2</span> <span class="k">JOIN</span> <span class="n">t2</span><span class="p">.</span><span class="n">members</span> <span class="n">m2</span> <span class="k">where</span> <span class="n">m2</span><span class="p">.</span><span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">20</span><span class="p">)</span>
</code></pre></div>        </div>
        <p><br />
<br /></p>
      </li>
    </ul>
  </li>
</ul>

<h3 id="10210-ì¡°ê±´ì‹">10.2.10 ì¡°ê±´ì‹</h3>

<p><strong>íƒ€ì… í‘œí˜„</strong><br />
JPQLì—ì„œ ì‚¬ìš©í•˜ëŠ” íƒ€ì…ì€ ë‹¤ìŒê³¼ ê°™ì´ í‘œì‹œí•œë‹¤. ëŒ€ì†Œë¬¸ìëŠ” êµ¬ë¶„í•˜ì§€ ì•ŠëŠ”ë‹¤.</p>

<table>
    <thead>
        <tr>
            <th>ì¢…ë¥˜</th>
            <th>ì„¤ëª…</th>
            <th>ì˜ˆì œ</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>ë¬¸ì</td>
            <td style="word-break:break-all">
            ì‘ì€ ë”°ì˜´í‘œ ì‚¬ì´ì— í‘œí˜„<br />
            ì‘ì€ ë”°ì˜´í‘œë¥¼ í‘œí˜„í•˜ê³  ì‹¶ìœ¼ë©´ ì‘ì€ ë”°ì˜´í‘œ ì—°ì† ë‘ê°œ('') ì‚¬ìš©
            </td>
            <td style="word-break:break-all">
            'HELLO'<br />
            'She''s'
            </td>
        </tr>
        <tr>
            <td>ìˆ«ì</td>
            <td style="word-break:break-all">
                L(Long íƒ€ì… ì§€ì •)<br />
                D(Doublc íƒ€ì… ì§€ì •)<br />
                F(Float íƒ€ì… ì§€ì •)
            </td>
            <td style="word-break:break-all">
                10L<br />
                10D<br />
                10F
            </td>
        </tr>
        <tr>
            <td>ë‚ ì§œ</td>
            <td style="word-break:break-all">
                DATE {d 'yyyy-mm-dd'}<br />
                TIME {t 'hh-mm-ss'}<br />
                DATETIME {ts 'yyyy-mm-dd hh-mm:ss.f'}<br />
            </td>
            <td style="word-break:break-all">
                {d '2012-03-24'}<br />
                {t '10-11-28'}<br />
                {ts '2012-03-24 10-11-28.123'}<br />
                m.createDate = {d '2012-03-24'}
            </td>
        </tr>
        <tr>
            <td>Boolen</td>
            <td style="word-break:break-all">
                TRUE, FALSE
            </td>
            <td style="word-break:break-all"></td>
        </tr>
        <tr>
            <td>Enum</td>
            <td style="word-break:break-all">
                íŒ¨í‚¤ì§•ëª…ì„ í¬í•¨í•œ ì „ì²´ ì´ë¦„ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
            </td>
            <td style="word-break:break-all">
                jpabook.MemberType.Admin
            </td>
        </tr>
        <tr>
            <td>ì—”í‹°í‹° íƒ€ì…</td>
            <td style="word-break:break-all">
                ì—”í‹°í‹°ì˜ íƒ€ì…ì„ í‘œí˜„í•œë‹¤. ì£¼ë¡œ ìƒì†ê³¼ ê´€ë ¨í•´ì„œ ì‚¬ìš©í•œë‹¤.
            </td>
            <td style="word-break:break-all">
                TYPE(m) = Member
            </td>
        </tr>
    </tbody>
</table>
<p><br /></p>

<p><strong>ì—°ì‚°ì ìš°ì„  ìˆœìœ„</strong></p>
<ol>
  <li>ê²½ë¡œ íƒìƒ‰ ì—°ì‚° (.)</li>
  <li>ìˆ˜í•™ ì—°ì‚°: +, -(ë‹¨í•­ ì—°ì‚°ì), *, /, +, -</li>
  <li>ë¹„êµì—°ì‚°: =, &gt;, &gt;=, &lt;, &lt;=, &lt;&gt;</li>
  <li>ë…¼ë¦¬ ì—°ì‚°: NOT, AND, OR</li>
</ol>

<p><br /></p>

<p><strong>ë…¼ë¦¬ ì—°ì‚°ê³¼ ë¹„êµì‹</strong></p>
<ul>
  <li>ë…¼ë¦¬ ì—°ì‚°
    <ul>
      <li>AND</li>
      <li>OR</li>
      <li>NOT</li>
    </ul>
  </li>
  <li>ë¹„êµì‹
    <ul>
      <li>=, &gt;, &gt;=, &lt;, &lt;=, &lt;&gt;</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<p><strong>Between, IN, Like, NULL ë¹„êµ</strong></p>
<ul>
  <li>Between ì‹
    <ul>
      <li>ë¬¸ë²•: x [NOT] BETWEEN A AND B</li>
      <li>ì„¤ëª…: xëŠ” A ~ B ì‚¬ì´ì˜ ê°’ì´ë©´ ì°¸ì´ë‹¤.(A, Bê°’ í¬í•¨)</li>
    </ul>
  </li>
  <li>IN ì‹
    <ul>
      <li>ë¬¸ë²•: x [NOT] IN</li>
      <li>ì„¤ëª…: Xì™€ ê°™ì€ ê°’ì´ í•˜ë‚˜ë¼ë„ ìˆìœ¼ë©´ ì°¸ì´ë‹¤.</li>
    </ul>
  </li>
  <li>Like ì‹
    <ul>
      <li>ë¬¸ë²•: ë¬¸ìí‘œí˜„ì‹ [NOT] LIKE íŒ¨í„´ê°’ [ESCAPE ì´ìŠ¤ì¼€ì´í”„ë¬¸ì]</li>
      <li>ì„¤ëª…: ë¬¸ìí‘œí˜„ì‹ê³¼ íŒ¨í…€ê°’ì„ ë¹„êµí•œë‹¤.
        <ul>
          <li>%(í¼ì„¼íŠ¸): ì•„ë¬´ ê°’ë“¤ì´ ì…ë ¥ë˜ì–´ë„ ëœë‹¤. ê°’ì´ ì—†ì–´ë„ ëœë‹¤.</li>
          <li>_(ì–¸ë”ë¼ì¸): í•œ ê¸€ìëŠ” ì•„ë¬´ ê°’ì´ ì…ë ¥ë˜ì–´ë„ ë˜ì§€ë§Œ ê°’ì´ ìˆì–´ì•¼ ëœë‹¤.</li>
        </ul>
      </li>
    </ul>

    <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- íšŒì›A, íšŒì›1..</span>
<span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">username</span> <span class="k">like</span> <span class="s1">'íšŒì›_'</span>

<span class="c1">-- íšŒì›3</span>
<span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">username</span> <span class="k">like</span> <span class="s1">'__3'</span>

<span class="c1">-- íšŒì›%</span>
<span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">username</span> <span class="k">like</span> <span class="s1">'íšŒì›</span><span class="se">\%</span><span class="s1">'</span> <span class="k">ESCAPE</span> <span class="s1">'</span><span class="se">\'</span><span class="s1">
</span></code></pre></div>    </div>
  </li>
  <li>NULL ë¹„êµì‹
    <ul>
      <li>ë¬¸ë²•: {ë‹¨ì¼ê°’ ê²½ë¡œ | ì…ë ¥ íŒŒë¼ë¯¸í„°} IS [NOT] NULL</li>
      <li>ì„¤ëª…: NULLì¸ì§€ ë¹„êµí•œë‹¤. NULLì€ = ìœ¼ë¡œ ë¹„êµí•˜ë©´ ì•ˆ ë˜ê³  ê¼­ IS NULLì„ ì‚¬ìš© í•´ì•¼ í•œë‹¤.</li>
    </ul>

    <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">username</span> <span class="k">is</span> <span class="k">null</span>
 <span class="k">where</span> <span class="k">null</span> <span class="o">=</span> <span class="k">null</span> <span class="c1">-- ê±°ì§“</span>
 <span class="k">where</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">-- ì°¸</span>
</code></pre></div>    </div>
    <p><br />
<br /></p>
  </li>
</ul>

<p><strong>ì»¬ë ‰ì…˜ ì‹</strong><br />
ì»¬ë ‰ì…˜ì—ë§Œ ì‚¬ìš©í•˜ëŠ” íŠ¹ë³„í•œ ê¸°ëŠ¥ì´ë‹¤. <strong>ì»¬ë ‰ì…˜ì€ ì»¬ë ‰ì…˜ ì‹ ì´ì™¸ì— ë‹¤ë¥¸ ì‹ì€ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.</strong></p>

<ul>
  <li>ë¹ˆ ì»¬ë ‰ì…˜ ë¹„êµ ì‹
    <ul>
      <li>ë¬¸ë²•: {ì»¬ë ‰ì…˜ ê°’ ì—°ê´€ ê²½ë¡œ} IS [NOT] EMPTY</li>
      <li>ì„¤ëª…: ì»¬ë ‰ì…˜ì— ê°’ì´ ë¹„ì—ˆìœ¼ë©´ ì°¸</li>
    </ul>

    <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- JPQL</span>
<span class="k">select</span> <span class="n">m</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span>
<span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">orders</span> <span class="k">is</span> <span class="k">not</span> <span class="n">empty</span>

<span class="c1">-- SQL ë³€í™˜</span>
<span class="k">select</span> <span class="n">m</span><span class="p">.</span><span class="o">*</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span>
<span class="k">where</span> <span class="k">exists</span> <span class="p">(</span>
  <span class="k">select</span> <span class="n">o</span><span class="p">.</span><span class="n">id</span>
  <span class="k">from</span> <span class="n">Orders</span> <span class="n">o</span>
  <span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="n">member_id</span>
<span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>ì»¬ë ‰ì…˜ì˜ ë©¤ë²„ ì‹
    <ul>
      <li>ë¬¸ë²•: {ì—”í‹°í‹°ë‚˜ ê°’} [NOT] MEMBER [OF] {ì»¬ë ‰ì…˜ ê°’ ì—°ê´€ ê²½ë¡œ}</li>
      <li>ì„¤ëª…: ì—”í‹°í‹°ë§ˆ ê°’ì´ ì»¬ë ‰ì…˜ì— í¬í•¨ë˜ì–´ ìˆìœ¼ë©´ ì°¸</li>
    </ul>

    <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">t</span> <span class="k">from</span> <span class="n">Team</span> <span class="n">t</span>
<span class="k">where</span> <span class="p">:</span><span class="n">memberParam</span> <span class="n">member</span> <span class="k">of</span> <span class="n">t</span><span class="p">.</span><span class="n">members</span>
</code></pre></div>    </div>
    <p><br />
<br /></p>
  </li>
</ul>

<p><strong>ìŠ¤ì¹¼ë¼ ì‹</strong><br />
ìŠ¤ì¹¼ë¼ëŠ” ìˆ«ì, ë¬¸ì, ë‚ ì§œ, case, ì—”í‹°í‹° íƒ€ì…ê°™ì€ ê°€ì¥ ê¸°ë³¸ì ì¸ íƒ€ì…ë“¤ì„ ë§í•œë‹¤.</p>

<ul>
  <li>ìˆ˜í•™ ì‹
    <ul>
      <li>+, -: ë‹¨í•­ ì—°ì‚°ì (ì–‘ìˆ˜, ìŒìˆ˜)</li>
      <li>*, /, +, -: ì‚¬ì¹™ ì—°ì‚°<br />
<br /></li>
    </ul>
  </li>
  <li>ë¬¸ì í•¨ìˆ˜</li>
</ul>

<table>
    <thead>
        <tr>
            <th>í•¨ìˆ˜</th>
            <th>ì„¤ëª…</th>
            <th>ì˜ˆì œ</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>CONCAT(ë¬¸ì1, ë¬¸ì2, ...)</td>
            <td style="word-break:break-all">
                ë¬¸ìë¥¼ í•©í•œë‹¤.
            </td>
            <td style="word-break:break-all">
                CONCAT('A', 'B') = AB
            </td>
        </tr>
        <tr>
            <td>SUBSTRING(ë¬¸ì, ìœ„ì¹˜, [ê¸¸ì´])</td>
            <td style="word-break:break-all">
                ìœ„ì¹˜ë¶€í„° ì‹œì‘í•´ ê¸¸ì´ë§Œí¼ ë¬¸ìë¥¼ êµ¬í•œë‹¤.
                ê¸¸ì´ ê°’ì´ ì—†ìœ¼ë©´ ë‚˜ë¨¸ì§€ ì „ì²´ ê¸¸ì´ë¥¼ ëœ»í•œë‹¤.
            </td>
            <td style="word-break:break-all">
                SUBSTRING('ABCDEF', 2, 3) = BCD
            </td>
        </tr>
        <tr>
            <td>TRIM([[LEADING | TRAILING | BOTH] [íŠ¸ë¦¼ë¬¸ì] FROM] ë¬¸ì)</td>
            <td style="word-break:break-all">
                LEADING: ì™¼ìª½ë§Œ íŠ¸ë¦¼<br />
                TRAILING: ì˜¤ë¥¸ìª½ë§Œ íŠ¸ë¦¼<br />
                BOTH: ì–‘ìª½ ë‹¤ íŠ¸ë¦¼<br />
                ê¸°ë³¸ê°’ì€ BOTH<br />
                íŠ¸ë¦¼ ë¬¸ìì˜ ê¸°ë³¸ê°’ì€ ê³µë°±(space)ì´ë‹¤.
            </td>
            <td style="word-break:break-all">
                TRIM('ABC') = 'ABC'
            </td>
        </tr>
        <tr>
            <td>LOWER(ë¬¸ì)</td>
            <td style="word-break:break-all">
                ì†Œë¬¸ìë¡œ ë³€ê²½
            </td>
            <td style="word-break:break-all">
                LOWER('ABC') = 'abc'
            </td>
        </tr>
        <tr>
            <td>UPPER(ë¬¸ì)</td>
            <td style="word-break:break-all">
                ëŒ€ë¬¸ìë¡œ ë³€ê²½
            </td>
            <td style="word-break:break-all">
                UPPER('abc') = 'ABC'
            </td>
        </tr>
        <tr>
            <td>LENGTH(ë¬¸ì)</td>
            <td style="word-break:break-all">
                ë¬¸ì ê¸¸ì´
            </td>
            <td style="word-break:break-all">
                LENGTH('ABC') = 3
            </td>
        </tr>
        <tr>
            <td>LOCATE(ì°¾ì„ ë¬¸ì, ì›ë³¸ ë¬¸ì, [ê²€ìƒ‰ ì‹œì‘ ìœ„ì¹˜])</td>
            <td style="word-break:break-all">
                ê²€ìƒ‰ìœ„ì¹˜ë¶€í„° ë¬¸ìë¥¼ ê²€ìƒ‰í•œë‹¤. 1ë¶€í„° ì‹œì‘, ëª» ì°¾ìœ¼ë©´ 0 ë°˜í™˜
            </td>
            <td style="word-break:break-all">
                LOCATE('DE', 'ABCDEFG') = 4
            </td>
        </tr>
    </tbody>
</table>
<p><br /></p>

<ul>
  <li>ìˆ˜í•™ í•¨ìˆ˜</li>
</ul>

<table>
    <thead>
        <tr>
            <th>í•¨ìˆ˜</th>
            <th>ì„¤ëª…</th>
            <th>ì˜ˆì œ</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>ABS(ìˆ˜í•™ì‹)</td>
            <td style="word-break:break-all">
                ì ˆëŒ€ê°’ì„ êµ¬í•œë‹¤
            </td>
            <td style="word-break:break-all">
                ABS(-10) = 10
            </td>
        </tr>
        <tr>
            <td>SQRT(ìˆ˜í•™ì‹)</td>
            <td style="word-break:break-all">
                ì œê³±ê·¼ì„ êµ¬í•œë‹¤.
            </td>
            <td style="word-break:break-all">
                SQRT(4) = 2.0
            </td>
        </tr>
        <tr>
            <td>MOD(ìˆ˜í•™ì‹, ë‚˜ëˆŒ ìˆ˜)</td>
            <td style="word-break:break-all">
                ë‚˜ë¨¸ì§€ë¥¼ êµ¬í•œë‹¤.
            </td>
            <td style="word-break:break-all">
                MOD(4, 3) = 1
            </td>
        </tr>
        <tr>
            <td>SIZE(ì»¬ë ‰ì…˜ ê°’ ì—°ê´€ ê²½ë¡œì‹)</td>
            <td style="word-break:break-all">
                ì»¬ë ‰ì…˜ì˜ í¬ê¸°ë¥¼ êµ¬í•œë‹¤
            </td>
            <td style="word-break:break-all">
                SIZE(t.members)
            </td>
        </tr>
        <tr>
            <td>INDEX(ë³„ì¹­)</td>
            <td style="word-break:break-all">
                LIST íƒ€ì… ì»¬ë ‰ì…˜ì˜ ìœ„ì¹˜ê°’ì„ êµ¬í•¨, ë‹¨ ì»¬ë ‰ì…˜ì´ @OrderColumnì„ ì‚¬ìš©í•˜ëŠ” LIST íƒ€ì…ì¼ ë•Œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
            </td>
            <td style="word-break:break-all">
                t.members m where INDEX(m) &gt; 0
            </td>
        </tr>
    </tbody>
</table>
<p><br /></p>

<ul>
  <li>ë‚ ì§œ í•¨ìˆ˜<br />
ë‚ ì§œ í•¨ìˆ˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì˜ í˜„ì¬ ì‹œê°„ì„ ì¡°íšŒí•œë‹¤.
    <ul>
      <li>CURRENT_DATE: í˜„ì¬ ë‚ ì§œ</li>
      <li>CURRENT_TIME: í˜„ì¬ ì‹œê°„</li>
      <li>CURRENT_TIMESTAMP: í˜„ì¬ ë‚ ì§œ ì‹œê°„</li>
    </ul>
  </li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">CURRENT_DATE</span><span class="p">,</span> <span class="k">CURRENT_TIME</span><span class="p">,</span> <span class="k">CURRENT_TIMESTAMP</span> <span class="k">from</span> <span class="n">Team</span> <span class="n">t</span>

<span class="k">select</span> <span class="n">e</span> <span class="k">from</span> <span class="n">Event</span> <span class="n">e</span> <span class="k">where</span> <span class="n">e</span><span class="p">.</span><span class="n">endDate</span> <span class="o">&lt;</span> <span class="k">CURRENT_DATE</span>
</code></pre></div></div>
<p>í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” ë‚ ì§œ íƒ€ì…ì—ì„œ ë…„, ì›”, ì¼, ì‹œê°„, ë¶„, ì´ˆ ê°’ì„ êµ¬í•˜ëŠ” ê¸°ëŠ¥ì„ ì§€ì›í•œë‹¤.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- YEAR, MONTH, DAY, HOUR, MINUTE, SECOND</span>
<span class="k">select</span> <span class="nb">year</span><span class="p">(</span><span class="k">CURRENT_TIMESTAMP</span><span class="p">),</span> <span class="k">month</span><span class="p">(</span><span class="k">CURRENT_TIMESTAMP</span><span class="p">)</span> <span class="k">from</span> <span class="n">Member</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>CASE ì‹</strong><br />
íŠ¹ì • ì¡°ê±´ì— ë”°ë¼ ë¶„ê¸°í•  ë•Œ CASE ì‹ì„ ì‚¬ìš©í•œë‹¤.</p>
<ul>
  <li>ê¸°ë³¸ CASE
    <ul>
      <li>ë¬¸ë²•:
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CASE
    {WHEN &lt;ì¡°ê±´ì‹&gt; THEN &lt;ìŠ¤ì¹¼ë¼ì‹&gt;}+
    ELSE &lt;ìŠ¤ì¹¼ë¼ì‹&gt;
END
</code></pre></div>        </div>
        <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span>
    <span class="k">case</span> <span class="k">when</span> <span class="n">m</span><span class="p">.</span><span class="n">age</span> <span class="o">&lt;=</span> <span class="mi">10</span> <span class="k">then</span> <span class="s1">'í•™ìƒìš”ê¸ˆ'</span>
         <span class="k">when</span> <span class="n">m</span><span class="p">.</span><span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="k">then</span> <span class="s1">'ê²½ë¡œìš”ê¸ˆ'</span>
         <span class="k">else</span> <span class="s1">'ì¼ë°˜ìš”ê¸ˆ'</span>
    <span class="k">end</span>
<span class="k">from</span> <span class="n">Member</span> <span class="n">m</span>
</code></pre></div>        </div>
        <p><br /></p>
      </li>
    </ul>
  </li>
  <li>ì‹¬í”Œ CASE
    <ul>
      <li>ë¬¸ë²•:
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    CASE
        {WHEN &lt;ìŠ¤ì¹¼ë¼ì‹1&gt; THEN &lt;ìŠ¤ì¹¼ë¼ì‹2&gt;}+
        ELSE &lt;ìŠ¤ì¹¼ë¼ì‹&gt;
    END
</code></pre></div>        </div>
        <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span>
    <span class="k">case</span> <span class="n">t</span><span class="p">.</span><span class="n">name</span>
        <span class="k">when</span> <span class="s1">'íŒ€A'</span> <span class="k">then</span> <span class="s1">'ì¸ì„¼í‹°ë¸Œ110%'</span>
        <span class="k">when</span> <span class="s1">'íŒ€B'</span> <span class="k">then</span> <span class="s1">'ì¸ì„¼í‹°ë¸Œ120%'</span>
        <span class="k">else</span> <span class="s1">'ì¸ì„¼í‹°ë¸Œ105%'</span>
    <span class="k">end</span>
<span class="k">from</span> <span class="n">Team</span> <span class="n">t</span>
</code></pre></div>        </div>
        <p><br /></p>
      </li>
    </ul>
  </li>
  <li>COALESCE
    <ul>
      <li>ë¬¸ë²•: COALESCE(<ìŠ¤ì¹¼ë¼ì‹> {, <ìŠ¤ì¹¼ë¼ì‹>}+)</ìŠ¤ì¹¼ë¼ì‹></ìŠ¤ì¹¼ë¼ì‹></li>
      <li>ì„¤ëª…: ìŠ¤ì¹¼ë¼ì‹ì„ ì°¨ë¡€ëŒ€ë¡œ ì¡°íšŒí•´ì„œ nullì´ ì•„ë‹ˆë©´ ë°˜í™˜í•œë‹¤.
        <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- m.usernameì´ nullì´ ì•„ë‹ˆë©´ 'ì´ë¦„ ì—†ëŠ” íšŒì›'ì„ ë°˜í™˜í•œë‹¤.</span>
<span class="k">select</span> <span class="n">coalesce</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">username</span><span class="p">,</span> <span class="s1">'ì´ë¦„ ì—†ëŠ” íšŒì›'</span><span class="p">)</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span>
</code></pre></div>        </div>
        <p><br /></p>
      </li>
    </ul>
  </li>
  <li>NULLIF
    <ul>
      <li>ë¬¸ë²•: NULLIF(<ìŠ¤ì¹¼ë¼ì‹>, <ìŠ¤ì¹¼ë¼ì‹>)</ìŠ¤ì¹¼ë¼ì‹></ìŠ¤ì¹¼ë¼ì‹></li>
      <li>ì„¤ëª…: ë‘ ê°’ì´ ê°™ìœ¼ë©´ nullì„ ë°˜í™˜í•˜ê³  ë‹¤ë¥´ë©´ ì²« ë²ˆì§¸ ê°’ì„ ë°˜í™˜í•œë‹¤.
        <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- ê´€ë¦¬ìë©´ nullì„ ë°˜í™˜í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” ë³¸ì¸ ì´ë¦„ì„ ë°˜í™˜</span>
<span class="k">select</span> <span class="k">nullif</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">username</span><span class="p">,</span> <span class="s1">'ê´€ë¦¬ì'</span><span class="p">)</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span>
</code></pre></div>        </div>
        <p><br />
<br />
<br /></p>
      </li>
    </ul>
  </li>
</ul>

<h3 id="10211-ë‹¤í˜•ì„±-ì¿¼ë¦¬">10.2.11 ë‹¤í˜•ì„± ì¿¼ë¦¬</h3>
<p>JPQLë¡œ ë¶€ëª¨ ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•˜ë©´ ê·¸ ìì‹ ì—”í‹°í‹°ë„ í•¨ê»˜ ì¡°íšŒëœë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Inheritance</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">InheritanceType</span><span class="o">.</span><span class="na">SINGLE_TABLE</span><span class="o">)</span>
<span class="nd">@DiscriminatorColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"DTYPE"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Item</span> <span class="o">{...}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@DiscriminatorValue</span><span class="o">(</span><span class="s">"B"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Book</span> <span class="kd">extends</span> <span class="nc">Item</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">author</span><span class="o">;</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ë‹¤ìŒì„ ì¡°íšŒí•˜ë©´ Itemì˜ ìì‹ë„ í•¨ê»˜ ì¡°íšŒëœë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"select t from Item i"</span><span class="o">).</span><span class="na">getResultList</span><span class="o">();</span>
</code></pre></div></div>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- ë‹¨ì¼ í…Œì´ë¸” ì „ëµ(InheritanceType.SINGLE_TABLE) SQL</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">ITEM</span>

<span class="c1">-- ì¡°ì¸ ì „ëµ(InheritanceType.JOINED) SQL</span>
<span class="k">SELECT</span> 
    <span class="n">i</span><span class="p">.</span><span class="n">ITEM_ID</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">DTYPE</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">price</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">stockQuantity</span><span class="p">,</span>
    <span class="n">b</span><span class="p">.</span><span class="n">author</span><span class="p">,</span> <span class="n">b</span><span class="p">.</span><span class="n">isbn</span><span class="p">,</span>
    <span class="n">b</span><span class="p">.</span><span class="n">artist</span><span class="p">,</span> <span class="n">a</span><span class="p">.</span><span class="n">ect</span><span class="p">,</span>
    <span class="n">m</span><span class="p">.</span><span class="n">actor</span><span class="p">,</span> <span class="n">m</span><span class="p">.</span><span class="n">director</span>
<span class="k">FROM</span>
    <span class="n">ITEM</span> <span class="n">i</span>
<span class="k">LEFT</span> <span class="k">OUTER</span> <span class="k">JOIN</span>
    <span class="n">BOOK</span> <span class="n">b</span> <span class="k">on</span> <span class="n">i</span><span class="p">.</span><span class="n">ITEM_ID</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">ITEM_ID</span>
<span class="k">LEFT</span> <span class="k">OUTER</span> <span class="k">JOIN</span>
    <span class="n">ALBUM</span> <span class="n">a</span> <span class="k">on</span> <span class="n">i</span><span class="p">.</span><span class="n">ITEM_ID</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">ITEM_ID</span>
<span class="k">LEFT</span> <span class="k">OUTER</span> <span class="k">JOIN</span>
    <span class="n">MOVIE</span> <span class="n">M</span> <span class="k">on</span> <span class="n">i</span><span class="p">.</span><span class="n">ITEM_ID</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">ITEM_ID</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>TYPE</strong><br />
TYPEì€ ì—”í‹°í‹°ì˜ ìƒì† êµ¬ì¡°ì—ì„œ ì¡°íšŒ ëŒ€ìƒì„ íŠ¹ì • ìì‹ íƒ€ì…ìœ¼ë¡œ í•œì •í•  ë•Œ ì£¼ë¡œ ì‚¬ìš©í•œë‹¤.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Item ì¤‘ì— Book, Movieë¥¼ ì¡°íšŒí•˜ë¼.</span>
<span class="c1">-- JPQL </span>
<span class="k">select</span> <span class="n">i</span> <span class="k">from</span> <span class="n">Item</span> <span class="n">i</span>
<span class="k">where</span> <span class="k">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">IN</span> <span class="p">(</span><span class="n">Book</span><span class="p">,</span> <span class="n">Movie</span><span class="p">)</span>

<span class="c1">-- SQL</span>
<span class="k">SELECT</span> <span class="n">i</span> <span class="k">FROM</span> <span class="n">Item</span> <span class="n">i</span>
<span class="k">WHERE</span> <span class="n">i</span><span class="p">.</span><span class="n">DTYPE</span> <span class="k">in</span> <span class="p">(</span><span class="s1">'B'</span><span class="p">,</span><span class="s1">'M'</span><span class="p">)</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>TREAT (JPA 2.1)</strong><br />
ìë°”ì˜ íƒ€ì… ìºìŠ¤íŒ…ê³¼ ë¹„ìŠ·í•œë‹¤. ìƒì† êµ¬ì¡°ì—ì„œ ë¶€ëª¨ íƒ€ì…ì„ íŠ¹ì • ìì‹ íƒ€ì…ìœ¼ë¡œ ë‹¤ë£° ë•Œ ì‚¬ìš©í•œë‹¤.<br />
JPA í‘œì¤€ì€ FROM, WHERE ì ˆì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” SELECT ì ˆì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- JPQL</span>
<span class="c1">-- treatë¥¼ ì‚¬ìš©í•´ì„œ ë¶€ëª¨ íƒ€ì…ì¸ Itemì„ ìì‹ íƒ€ì…ì¸ Bookìœ¼ë¡œ ë‹¤ë£¬ë‹¤.</span>
<span class="c1">-- ë”°ë¼ì„œ Bookì˜ author í•„ë“œì— ì ‘ê·¼ í•  ìˆ˜ ìˆë‹¤.</span>
<span class="k">select</span> <span class="n">i</span> <span class="k">from</span> <span class="n">Item</span> <span class="n">i</span> <span class="k">where</span> <span class="k">treat</span><span class="p">(</span><span class="n">i</span> <span class="k">as</span> <span class="n">Book</span><span class="p">).</span><span class="n">author</span> <span class="o">=</span> <span class="s1">'kim'</span>
</code></pre></div></div>
<p><br />
<br />
<br /></p>

<h3 id="10212-ì‚¬ìš©ì-ì •ì˜-í•¨ìˆ˜-í˜¸ì¶œ-jpa-21">10.2.12 ì‚¬ìš©ì ì •ì˜ í•¨ìˆ˜ í˜¸ì¶œ (JPA 2.1)</h3>
<p>JPA 2.1ë¶€í„° ì‚¬ìš©ì ì €ì˜ í•¨ìˆ˜ë¥¼ ì§€ì›í•œë‹¤.</p>

<p>ë¬¸ë²•</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function_invocation::= FUNCTION(function_name {, function_arg}*)
</code></pre></div></div>
<p>ì˜ˆ</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">function</span><span class="p">(</span><span class="s1">'group_concat'</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">name</span><span class="p">)</span> <span class="k">from</span> <span class="n">Item</span> <span class="n">i</span>

<span class="c1">-- í•˜ì´ë²„ë„¤ì´íŠ¸ êµ¬í˜„ì²´ëŠ” ì¶•ì•½ ê°€ëŠ¥</span>
<span class="k">select</span> <span class="n">group_concat</span><span class="p">(</span><span class="n">i</span><span class="p">.</span><span class="n">name</span><span class="p">)</span> <span class="k">from</span> <span class="n">Item</span> <span class="n">i</span>
</code></pre></div></div>
<p>í•˜ì´ë²„ë„¤ì´íŠ¸ êµ¬í˜„ì²´ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ë°©ì–¸ í´ë˜ìŠ¤ë¥¼ ìƒì†í•´ì„œ êµ¬í˜„í•˜ê³ , ì‚¬ìš©í•  ë°ì´í„°ë² ì´ìŠ¤ í•¨ìˆ˜ë¥¼ ë¯¸ë¦¬ ë“±ë¡í•´ì•¼ í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ë°©ì–¸ í´ë˜ìŠ¤ ìƒì†</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyH2Dialect</span> <span class="kd">extends</span> <span class="nc">H2Dialect</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">MyH2Dialect</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">registerFunction</span><span class="o">(</span>
            <span class="s">"group_concat"</span><span class="o">,</span>
            <span class="k">new</span> <span class="nf">StandardSQLFunction</span><span class="o">(</span><span class="s">"group_concat"</span><span class="o">,</span> <span class="nc">StandardBasicTypes</span><span class="o">.</span><span class="na">STRING</span><span class="o">)</span>
        <span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- ìƒì†í•œ ë°©ì–¸ í´ë˜ìŠ¤ ë“±ë¡ --&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"hibernate.dialect"</span> <span class="na">value=</span><span class="s">"hello.MyH2Dialect"</span><span class="nt">&gt;</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="10213-ê¸°íƒ€-ì •ë¦¬">10.2.13 ê¸°íƒ€ ì •ë¦¬</h3>
<ul>
  <li>enumì€ = ë¹„êµ ì—°ì‚°ë§Œ ì§€ì›í•œë‹¤.</li>
  <li>ì„ë² ë””ë“œ íƒ€ì…ì€ ë¹„êµë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
</ul>

<p><strong>EMPTY STRING</strong></p>
<ul>
  <li>JPA í‘œì¤€ì€ â€˜â€˜ì„ ê¸¸ì´ 0ì¸ Empty Stringìœ¼ë¡œ ì •í–ˆì§€ë§Œ ë°ì´í„°ë² ì´ìŠ¤ì— ë”°ë¼ â€˜â€˜ë¥¼ NULLë¡œ ì‚¬ìš©í•˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ë„ ìˆìœ¼ë¯€ë¡œ í™•ì¸í•˜ê³  ì‚¬ìš©í•´ì•¼ í•œë‹¤.<br />
<br /></li>
</ul>

<p><strong>NULL ì •ì˜</strong></p>
<ul>
  <li>ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ë°ì´í„°ê°€ í•˜ë‚˜ë„ ì—†ìœ¼ë©´ NULLì´ë‹¤.</li>
  <li>NULLì€ ì•Œ ìˆ˜ ì—†ëŠ” ê°’(unknown value)ì´ë‹¤. NULLê³¼ì˜ ëª¨ë“  ìˆ˜í•™ì  ê³„ì‚° ê²°ê³¼ëŠ” NULLì´ ëœë‹¤.</li>
  <li>NULL == NULLì€ ì•Œ ìˆ˜ ì—†ëŠ” ê°’ì´ë‹¤.</li>
  <li>NULL is NULLì€ ì°¸ì´ë‹¤.<br />
<br /></li>
</ul>

<p><strong>JPA í‘œì¤€ ëª…ì„¸ NULL(U), TRUE(T), FALSE(F)ì˜ ë…¼ë¦¬ ê³„ì‚° í‘œ</strong></p>
<ul>
  <li>AND</li>
</ul>

<table>
  <thead>
    <tr>
      <th><strong>AND</strong></th>
      <th><strong>T</strong></th>
      <th><strong>F</strong></th>
      <th><strong>U</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>T</td>
      <td>T</td>
      <td>F</td>
      <td>U</td>
    </tr>
    <tr>
      <td>F</td>
      <td>F</td>
      <td>F</td>
      <td>F</td>
    </tr>
    <tr>
      <td>U</td>
      <td>U</td>
      <td>F</td>
      <td>U</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>OR</li>
</ul>

<table>
  <thead>
    <tr>
      <th><strong>OR</strong></th>
      <th><strong>T</strong></th>
      <th><strong>F</strong></th>
      <th><strong>U</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>T</td>
      <td>T</td>
      <td>T</td>
      <td>T</td>
    </tr>
    <tr>
      <td>F</td>
      <td>T</td>
      <td>F</td>
      <td>U</td>
    </tr>
    <tr>
      <td>U</td>
      <td>T</td>
      <td>U</td>
      <td>U</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>NOT</li>
</ul>

<table>
  <thead>
    <tr>
      <th><strong>NOT</strong></th>
      <th>Â </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>T</td>
      <td>F</td>
    </tr>
    <tr>
      <td>F</td>
      <td>T</td>
    </tr>
    <tr>
      <td>U</td>
      <td>U</td>
    </tr>
  </tbody>
</table>

<p><br />
<br /></p>

<h3 id="10214-ì—”í‹°í‹°-ì§ì ‘-ì‚¬ìš©">10.2.14 ì—”í‹°í‹° ì§ì ‘ ì‚¬ìš©</h3>

<p><strong>ê¸°ë³¸ í‚¤ ê°’</strong><br />
JPQLì—ì„œ ì—”í‹°í‹° ê°ì²´ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ë©´ SQLì—ì„œëŠ” í•´ë‹¹ ì—”í‹°í‹°ì˜ ê¸°ë³¸ í‚¤ ê°’ì„ ì‚¬ìš©í•œë‹¤.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- JPQL</span>
<span class="c1">-- ì—”í‹°í‹°ì˜ ì•„ì´ë””ë¥¼ ì‚¬ìš©</span>
<span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">id</span><span class="p">)</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span>

<span class="c1">-- ì—”í‹°í‹°ë¥¼ ì§ì ‘ ì‚¬ìš©</span>
<span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì—”í‹°í‹°ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ë°©ë²•</span>
<span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">"select m from Member m where m = :member"</span><span class="o">;</span>
<span class="nc">List</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="s">"member"</span><span class="o">,</span> <span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>


<span class="c1">// ì‹ë³„ì ê°’ì„ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ë°©ë²•</span>
<span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">"select m from Member m where m.id = :memberId"</span><span class="o">;</span>
<span class="nc">List</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="s">"memberId"</span><span class="o">,</span> <span class="mi">1L</span><span class="o">)</span>
            <span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ì™¸ë˜ í‚¤ ê°’</strong><br />
ì™¸ë˜ í‚¤ ê°’ë„ ì—”í‹°í‹° ê°ì²´ë¥¼ ì§ì ‘ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì—”í‹°í‹°ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ë°©ë²•</span>
<span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">"select m from Member m where m.team = :team"</span><span class="o">;</span>
<span class="nc">List</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="s">"team"</span><span class="o">,</span> <span class="n">team</span><span class="o">)</span>
            <span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>


<span class="c1">// ì‹ë³„ì ê°’ì„ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ë°©ë²•</span>
<span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">"select m from Member m where m.team.id = :teamId"</span><span class="o">;</span>
<span class="nc">List</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="s">"teamId"</span><span class="o">,</span> <span class="mi">1L</span><span class="o">)</span>
            <span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="10215-named-ì¿¼ë¦¬-ì •ì -ì¿¼ë¦¬">10.2.15 Named ì¿¼ë¦¬: ì •ì  ì¿¼ë¦¬</h3>
<p>Named ì¿¼ë¦¬ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œë”© ì‹œì ì— JPQL ë¬¸ë²•ì„ ì²´í¬í•˜ê³  ë¯¸ë¦¬ íŒŒì‹±í•´ë‘”ë‹¤. ë”°ë¼ì„œ ì—ëŸ¬ ìœ ë¬´ë¥¼ ë¹¨ë¦¬ í™•ì¸í•  ìˆ˜ ìˆê³ , ì¬ì‚¬ìš©í•˜ë¯€ë¡œ ì„±ëŠ¥ìƒ ì´ì ë„ ìˆë‹¤.</p>

<p><strong>Named ì¿¼ë¦¬ë¥¼ ì–´ë…¸í…Œì´ì…˜ì— ì •ì˜</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// @NamedQueryë¡œ Named ì¿¼ë¦¬ ì •ì˜</span>
<span class="nd">@Entity</span>
<span class="nd">@NamedQuery</span><span class="o">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"Member.findByUsername"</span><span class="o">,</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s">"select m from Member m where m.username = :username"</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// @NamedQueriesë¥¼ ì‚¬ìš©í•´ ì—¬ëŸ¬ê°œì˜ @NamedQuery ì§€ì •</span>
<span class="nd">@Entity</span>
<span class="nd">@NamedQueries</span><span class="o">(</span>
    <span class="nd">@NamedQuery</span><span class="o">(</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">"Member.findByUsername"</span><span class="o">,</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s">"select m from Member m where m.username = :username"</span>
    <span class="o">),</span>
    <span class="nd">@NamedQuery</span><span class="o">(</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">"Member.count"</span><span class="o">,</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s">"select count(m) from Member m"</span>
    <span class="o">)</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì‚¬ìš©</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createNamedQuery</span><span class="o">(</span><span class="s">"Member.findByUsername"</span><span class="o">,</span> <span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">setPrameter</span><span class="o">(</span><span class="s">"username"</span><span class="o">,</span> <span class="s">"íšŒì›1"</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
</code></pre></div></div>
<p class="notice--info">Named ì¿¼ë¦¬ì— Member.findByUsername ì²˜ëŸ¼ Memberë¥¼ ë¶™ì¸ ê²ƒì€ ê¸°ëŠ¥ì ìœ¼ë¡œ íŠ¹ë³„í•œ ì˜ë¯¸ê°€ ìˆëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤. ì¶©ë™ë°©ì§€, ê´€ë¦¬ì˜ ìš©ì´í•¨ì„ ìœ„í•´ ë¶™ì¸ ê²ƒì´ë‹¤.</p>

<p><br />
<br />
<br />
<br />
<br /></p>

<h2 id="103-criteria">10.3 Criteria</h2>
<p>Criteria ì¿¼ë¦¬ëŠ” JPQLì„ ìë°” ì½”ë“œë¡œ ì‘ì„±í•˜ë„ë¡ ë„ì™€ì£¼ëŠ” ë¹Œë” í´ë˜ìŠ¤ APIë‹¤. ë¬¸ìê°€ ì•„ë‹Œ ì½”ë“œë¡œ JPQLì„ ì‘ì„±í•˜ë¯€ë¡œ ë¬¸ë²• ì˜¤ë¥˜ë¥¼ ì»´íŒŒì¼ ë‹¨ê³„ì—ì„œ ì¡ì„ ìˆ˜ ìˆë‹¤. ë™ì  ì¿¼ë¦¬ë¥¼ ì•ˆì „í•˜ê²Œ ìƒì„±í•  ìˆ˜ ìˆë‹¤. ë‹¤ë§Œ ì½”ë“œê°€ ë³µì¡í•˜ê³  ì¥í™©í•´ì„œ ì§ê´€ì ìœ¼ë¡œ ì´í•´ê°€ í˜ë“¤ë‹¤ëŠ” ë‹¨ì ì´ ìˆë‹¤.</p>

<p><strong>ë‚´ìš© ìƒëµ ğŸ˜…</strong></p>

<p><br />
<br />
<br /></p>

<h2 id="104-querydsl">10.4 QueryDSL</h2>
<p>QueryDSLì€ Criteria ì²˜ëŸ¼ JPQL ë¹Œë” ì—­í• ì„ í•˜ëŠ”ë° ì‰½ê³  ê°„ê²°í•˜ë©°, ê·¸ ëª¨ì–‘ë„ ì¿¼ë¦¬ì™€ ë¹„ìŠ·í•˜ê²Œ ê°œë°œí•  ìˆ˜ ìˆë‹¤.</p>

<p>QueryDSLì€ ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸ì´ë‹¤. ì•„ë˜ ì‚¬ì´íŠ¸ ì°¸ê³ </p>

<ul>
  <li><a href="http://querydsl.com" target="_blank">QueryDSL</a></li>
  <li><a href="http://querydsl.com/static/querydsl/4.0.1/reference/ko-KR/html_single/" target="_blank">QueryDSL ë ˆí¼ëŸ°ìŠ¤ ë²ˆì—­ ë¬¸ì„œ</a></li>
</ul>

<p><br /></p>

<h3 id="1041-querydsl-ì„¤ì •">10.4.1 QueryDSL ì„¤ì •</h3>
<p><strong>í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- QueryDSL JPA ë¼ì´ë¸ŒëŸ¬ë¦¬ --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>com.querydsl<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>querydsl-jpa<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>${querydsl.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="c">&lt;!-- ì¿¼ë¦¬ íƒ€ì…(Q)ì„ ìƒì„±í•  ë•Œ í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>com.querydsl<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>querydsl-apt<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>${querydsl.version}<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;scope&gt;</span>provided<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>í™˜ê²½ì„¤ì •</strong><br />
QueryDSLì„ ì‚¬ìš©í•˜ë ¤ë©´ <strong>ì—”í‹°í‹°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì¿¼ë¦¬ íƒ€ì… ì´ë¼ëŠ” ì¿¼ë¦¬ìš© í´ë˜ìŠ¤ë¥¼ ìƒì„±í•´ì•¼ í•œë‹¤.</strong> ë‹¤ìŒì²˜ëŸ¼ í”ŒëŸ¬ê·¸ì¸ì„ ì¶”ê°€í•´ì•¼ í•œë‹¤.</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;project&gt;</span>
  <span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;plugins&gt;</span>
        ...
        <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>com.mysema.maven<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>apt-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>1.1.3<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;executions&gt;</span>
            <span class="nt">&lt;execution&gt;</span>
            <span class="nt">&lt;goals&gt;</span>
                <span class="nt">&lt;goal&gt;</span>process<span class="nt">&lt;/goal&gt;</span>
            <span class="nt">&lt;/goals&gt;</span>
            <span class="nt">&lt;configuration&gt;</span>
                <span class="nt">&lt;outputDirectory&gt;</span>target/generated-sources/java<span class="nt">&lt;/outputDirectory&gt;</span>
                <span class="nt">&lt;processor&gt;</span>com.querydsl.apt.jpa.JPAAnnotationProcessor<span class="nt">&lt;/processor&gt;</span>
            <span class="nt">&lt;/configuration&gt;</span>
            <span class="nt">&lt;/execution&gt;</span>
        <span class="nt">&lt;/executions&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
        ...
    <span class="nt">&lt;/plugins&gt;</span>
  <span class="nt">&lt;/build&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</code></pre></div></div>
<p>ì´ì œ ì½˜ì†”ì—ì„œ mvc compileì„ ì…ë ¥í•˜ë©´ outputDirectoryì— ì§€ì •í•œ target/generated-sources ìœ„ì¹˜ì— QMember.java ì²˜ëŸ¼ Që¡œ ì‹œì‘í•˜ëŠ” ì¿¼ë¦¬ íƒ€ì…ë“¤ì´ ìƒì„±ëœë‹¤.
<br />
<br /></p>

<h3 id="1042-ì‹œì‘">10.4.2 ì‹œì‘</h3>

<p>ê°„ë‹¨ ì˜ˆì œ</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">queryDSL</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">JPAQuery</span> <span class="n">query</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JPAQuery</span><span class="o">(</span><span class="n">entityManager</span><span class="o">);</span>
    <span class="nc">QMember</span> <span class="n">qMember</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QMember</span><span class="o">(</span><span class="s">"m"</span><span class="o">);</span> <span class="c1">// ìƒì„±ë˜ëŠ” JPQLì˜ ë³„ì¹­ì´ m</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">qMember</span><span class="o">)</span>
                                <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">qMember</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"íšŒì›1"</span><span class="o">))</span>
                                <span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="n">qMember</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">desc</span><span class="o">)</span>
                                <span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">qMember</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ê¸°ë³¸ Q ìƒì„±</strong><br />
ì¿¼ë¦¬ íƒ€ì…(Q)ëŠ” ì‚¬ìš©í•˜ê¸° í¸ë¦¬í•˜ë„ë¡ ë‹¤ìŒê³¼ ê°™ì´ ê¸°ë³¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë³´ê´€í•˜ê³  ìˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">QMember</span> <span class="kd">extends</span> <span class="nc">EntityPathBase</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">QMember</span> <span class="n">member</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QMember</span><span class="o">(</span><span class="s">"member1"</span><span class="o">);</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ê°™ì€ ì—”í‹°í‹°ë¥¼ ì¡°ì¸í•˜ê±°ë‚˜, ê°™ì€ ì—”í‹°í‹°ë¥¼ ì„œë¸Œì¿¼ë¦¬ì— ì‚¬ìš©í•˜ë©´ ê°™ì€ ë³„ì¹­ì´ ì‚¬ìš©ë˜ë¯€ë¡œ ì´ë•ŒëŠ” ë³„ì§•ì„ ì§ì ‘ ì§€ì •í•´ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">QMember</span> <span class="n">qMember</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QMember</span><span class="o">(</span><span class="s">"m"</span><span class="o">);</span>  <span class="c1">// ì§ì ‘ ì§€ì •</span>
<span class="nc">QMember</span> <span class="n">qMember</span> <span class="o">=</span> <span class="nc">QMember</span><span class="o">.</span><span class="na">member</span><span class="o">;</span>    <span class="c1">// ê¸°ë³¸ ì¸ìŠ¤í„´ìŠ¤ ì‚¬ìš©</span>
</code></pre></div></div>
<p>ë‹¤ìŒê³¼ ê°™ì´ import staticì„ í™œìš©í•˜ë©´ ì½”ë“œë¥¼ ê°„ê²°í•˜ê²Œ ì‘ì„± ê°€ëŠ¥í•˜ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">static</span> <span class="n">jpabook</span><span class="o">.</span><span class="na">jpashop</span><span class="o">.</span><span class="na">domain</span><span class="o">.</span><span class="na">QMember</span><span class="o">.</span><span class="na">member</span><span class="o">;</span> <span class="c1">// ê¸°ë³¸ ì¸ìŠ¤í„´ìŠ¤</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">basic</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">JPAQuery</span> <span class="n">query</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JPAQuery</span><span class="o">(</span><span class="n">entityManager</span><span class="o">);</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>  <span class="c1">// member ë°”ë¡œ ì‚¬ìš©</span>
                        <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"íšŒì›1"</span><span class="o">))</span>
                        <span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">desc</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1043-ê²€ìƒ‰-ì¡°ê±´-ì¿¼ë¦¬">10.4.3 ê²€ìƒ‰ ì¡°ê±´ ì¿¼ë¦¬</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// where and</span>
<span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">customer</span><span class="o">)</span>
    <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">customer</span><span class="o">.</span><span class="na">firstName</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"Bob"</span><span class="o">).</span><span class="na">and</span><span class="o">(</span><span class="n">customer</span><span class="o">.</span><span class="na">lastName</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"Wilson"</span><span class="o">)));</span>

<span class="c1">// where or</span>
<span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">customer</span><span class="o">)</span>
    <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">customer</span><span class="o">.</span><span class="na">firstName</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"Bob"</span><span class="o">).</span><span class="na">or</span><span class="o">(</span><span class="n">customer</span><span class="o">.</span><span class="na">lastName</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"Wilson"</span><span class="o">)));</span>

<span class="c1">// between</span>
<span class="c1">// 1800 ~ 2000 ë…„ë„</span>
<span class="n">doc</span><span class="o">.</span><span class="na">year</span><span class="o">.</span><span class="na">between</span><span class="o">(</span><span class="s">"1800"</span><span class="o">,</span> <span class="s">"2000"</span><span class="o">);</span>

<span class="c1">// contains</span>
<span class="c1">// sqlì˜ like '%ìƒí’ˆ1%'</span>
<span class="n">item</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"ìƒí’ˆ1"</span><span class="o">);</span>

<span class="c1">// startsWith</span>
<span class="c1">// sqlì˜ like 'ì˜¤%'</span>
<span class="n">person</span><span class="o">.</span><span class="na">firstName</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="s">"ì˜¤"</span><span class="o">);</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1044-ê²°ê³¼-ì¡°íšŒ">10.4.4 ê²°ê³¼ ì¡°íšŒ</h3>
<p>ì¿¼ë¦¬ ì‘ì„±ì´ ëë‚˜ê³  ê²°ê³¼ ì¡°íšŒ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ë©´ ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¡°íšŒí•œë‹¤. ê²°ê³¼ ì¡°íšŒ APIëŠ” com.mysema.query.Projectableì— ì •ì˜ë˜ì–´ ìˆë‹¤.</p>

<ul>
  <li>uniqueResult(): ì¡°íšŒ ê²°ê³¼ê°€ í•œ ê±´ì¼ ë•Œ ì‚¬ìš©. ì¡°íšŒ ê²°ê³¼ê°€ ì—†ìœ¼ë©´ nullì„ ë°˜í™˜í•˜ê³  í•˜ë‚˜ ì´ìƒì´ë©´ ì˜ˆì™¸ ë°œìƒ</li>
  <li>singleResult(): uniqueResult()ì™€ ê°™ì§€ë§Œ ê²°ê³¼ê°€ í•˜ë‚˜ ì´ìƒì´ë©´ ì²˜ìŒ ë°ì´í„°ë¥¼ ë°˜í™˜</li>
  <li>list(): ê²°ê³¼ê°€ í•˜ë‚˜ ì´ìƒì¼ ë•Œ ì‚¬ìš©. ê²°ê³¼ê°€ ì—†ìœ¼ë©´ ë¹ˆ ì»¬ë ‰ì…˜ ë°˜í™˜</li>
</ul>

<p><br />
<br /></p>

<h3 id="1045-í˜ì´ì§•ê³¼-ì •ë ¬">10.4.5 í˜ì´ì§•ê³¼ ì •ë ¬</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">item</span><span class="o">)</span>
    <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">.</span><span class="na">gt</span><span class="o">(</span><span class="mi">20000</span><span class="o">))</span>
    <span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">.</span><span class="na">desc</span><span class="o">(),</span> <span class="n">item</span><span class="o">.</span><span class="na">stockQuantity</span><span class="o">.</span><span class="na">asc</span><span class="o">())</span>
    <span class="o">.</span><span class="na">offset</span><span class="o">(</span><span class="mi">10</span><span class="o">).</span><span class="na">limit</span><span class="o">(</span><span class="mi">20</span><span class="o">)</span>
    <span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
</code></pre></div></div>
<p>ì‹¤ì œ í˜ì´ì§• ì²˜ë¦¬ë¥¼ í•˜ë ¤ë©´ ê²€ìƒ‰ëœ ì „ì²´ ë°ì´í„° ìˆ˜ë¥¼ ì•Œì•„ì•¼ í•œë‹¤. ì´ë•ŒëŠ” list() ëŒ€ì‹ ì— listResults()ë¥¼ ì‚¬ìš©í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">SearchResults</span><span class="o">&lt;</span><span class="nc">Item</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">item</span><span class="o">)</span>
                <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">.</span><span class="na">gt</span><span class="o">(</span><span class="mi">20000</span><span class="o">))</span>
                <span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">.</span><span class="na">desc</span><span class="o">(),</span> <span class="n">item</span><span class="o">.</span><span class="na">stockQuantity</span><span class="o">.</span><span class="na">asc</span><span class="o">())</span>
                <span class="o">.</span><span class="na">offset</span><span class="o">(</span><span class="mi">10</span><span class="o">).</span><span class="na">limit</span><span class="o">(</span><span class="mi">20</span><span class="o">)</span>
                <span class="o">.</span><span class="na">listResults</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>

<span class="kt">long</span> <span class="n">total</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">getTotal</span><span class="o">();</span> <span class="c1">// ê²€ìƒ‰ëœ ì „ì²´ ë°ì´í„° ìˆ˜</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Item</span><span class="o">&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">getResults</span><span class="o">();</span> <span class="c1">// ì¡°íšŒëœ ë°ì´í„°</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1046-ê·¸ë£¹">10.4.6 ê·¸ë£¹</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">item</span><span class="o">)</span>
    <span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">)</span>
    <span class="o">.</span><span class="na">having</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">.</span><span class="na">gt</span><span class="o">(</span><span class="mi">1000</span><span class="o">))</span>
    <span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1047-ì¡°ì¸">10.4.7 ì¡°ì¸</h3>
<p>ì¡°ì¸ì€ innerJoin, leftJoin, rightJoin, fullJoinì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì¶”ê°€ë¡œ JPQLì˜ fetchì¡°ì¸ë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<p>ì¡°ì¸ì˜ ê¸°ë³¸ ë¬¸ë²•ì€ ì²« ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì— ì¡°ì¸ ëŒ€ìƒì„ ì§€ì •í•˜ê³ , ë‘ ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì— ë³„ì¹­ìœ¼ë¡œ ì‚¬ìš©í•  ì¿¼ë¦¬ íƒ€ì…ì„ ì§€ì •í•œë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>join(ì¡°ì¸ëŒ€ìƒ, ë³„ì¹­ìœ¼ë¡œ ì‚¬ìš©í•  ì¿¼ë¦¬ íƒ€ì…)
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ê¸°ë³¸ ì‚¬ìš© ë°©ë²•</span>
<span class="nc">QCat</span> <span class="n">cat</span> <span class="o">=</span> <span class="nc">QCat</span><span class="o">.</span><span class="na">cat</span><span class="o">;</span>
<span class="nc">QCat</span> <span class="n">mate</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QCat</span><span class="o">(</span><span class="s">"mate"</span><span class="o">);</span>
<span class="nc">QCate</span> <span class="n">kitten</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QCat</span><span class="o">(</span><span class="s">"kitten"</span><span class="o">);</span>
<span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">cat</span><span class="o">)</span>
    <span class="o">.</span><span class="na">innerJoin</span><span class="o">(</span><span class="n">cat</span><span class="o">.</span><span class="na">mate</span><span class="o">,</span> <span class="n">mate</span><span class="o">)</span>
    <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">cat</span><span class="o">.</span><span class="na">kittens</span><span class="o">,</span> <span class="n">kitten</span><span class="o">)</span>
    <span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">cat</span><span class="o">);</span>


<span class="c1">// ì¡°ì¸ on ì‚¬ìš©</span>
<span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">cat</span><span class="o">)</span>
    <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">cat</span><span class="o">.</span><span class="na">kittens</span><span class="o">,</span> <span class="n">kitten</span><span class="o">)</span>
    <span class="o">.</span><span class="na">on</span><span class="o">(</span><span class="n">kitten</span><span class="o">.</span><span class="na">bodyWeight</span><span class="o">.</span><span class="na">gt</span><span class="o">(</span><span class="mf">10.0</span><span class="o">))</span>
    <span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">cat</span><span class="o">);</span>


<span class="c1">// í˜ì¹˜ ì¡°ì¸ ì‚¬ìš©</span>
<span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">cat</span><span class="o">)</span>
    <span class="o">.</span><span class="na">innerJoin</span><span class="o">(</span><span class="n">cat</span><span class="o">.</span><span class="na">mate</span><span class="o">,</span> <span class="n">mate</span><span class="o">).</span><span class="na">fetch</span><span class="o">()</span>
    <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">cat</span><span class="o">.</span><span class="na">kittens</span><span class="o">,</span> <span class="n">kitten</span><span class="o">).</span><span class="na">fetch</span><span class="o">()</span>
    <span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">cat</span><span class="o">);</span>

<span class="c1">// ì„¸íƒ€ ì¡°ì¸ ì‚¬ìš©</span>
<span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">cat</span><span class="o">,</span> <span class="n">mate</span><span class="o">)</span>
    <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">cat</span><span class="o">.</span><span class="na">mate</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">mate</span><span class="o">))</span>
    <span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">cat</span><span class="o">);</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1048-ì„œë¸Œ-ì¿¼ë¦¬">10.4.8 ì„œë¸Œ ì¿¼ë¦¬</h3>
<ul>
  <li>ì„œë¸Œ ì¿¼ë¦¬ë¥¼ ë§Œë“¤ë ¤ë©´ com.mysema.query.jpa.JPASubQueryë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.</li>
  <li>ì„œë¸Œ ì¿¼ë¦¬ ê²°ê³¼ê°€ í•˜ë‚˜ë©´ unique(), ì—¬ëŸ¬ ê±´ì´ë©´ list()ë¥¼ ì‚¬ìš©í•œë‹¤.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì„œë¸Œ ì¿¼ë¦¬ í•œ ê±´</span>
<span class="nc">QItem</span> <span class="n">item</span> <span class="o">=</span> <span class="nc">QItem</span><span class="o">.</span><span class="na">item</span><span class="o">;</span>
<span class="nc">QItem</span> <span class="n">itemSub</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QItem</span><span class="o">(</span><span class="s">"itemSub"</span><span class="o">);</span>

<span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">item</span><span class="o">)</span>
    <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span>
        <span class="k">new</span> <span class="nf">JPASubQuery</span><span class="o">().</span><span class="na">from</span><span class="o">(</span><span class="n">itemSub</span><span class="o">).</span><span class="na">unique</span><span class="o">(</span><span class="n">itemSub</span><span class="o">.</span><span class="na">price</span><span class="o">.</span><span class="na">max</span><span class="o">())</span>
    <span class="o">))</span>
    <span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>



<span class="c1">// ì„œë¸Œ ì¿¼ë¦¬ ì—¬ëŸ¬ ê±´</span>
<span class="nc">QItem</span> <span class="n">item</span> <span class="o">=</span> <span class="nc">QItem</span><span class="o">.</span><span class="na">item</span><span class="o">;</span>
<span class="nc">QItem</span> <span class="n">itemSub</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QItem</span><span class="o">(</span><span class="s">"itemSub"</span><span class="o">);</span>

<span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">item</span><span class="o">)</span>
    <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">in</span><span class="o">(</span>
        <span class="k">new</span> <span class="nf">JPASubQuery</span><span class="o">().</span><span class="na">from</span><span class="o">(</span><span class="n">itemSub</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">itemSub</span><span class="o">.</span><span class="na">name</span><span class="o">))</span>
            <span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">itemSub</span><span class="o">)</span>
    <span class="o">))</span>
    <span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1049-í”„ë¡œì ì…˜ê³¼-ê²°ê³¼-ë°˜í™˜">10.4.9 í”„ë¡œì ì…˜ê³¼ ê²°ê³¼ ë°˜í™˜</h3>
<p>select ì ˆì— ì¡°íšŒ ëŒ€ìƒì„ ì§€ì •í•˜ëŠ” ê²ƒì„ í”„ë¡œì ì…˜ì´ë¼ í•œë‹¤.</p>

<p><strong>í”„ë¡œì ì…˜ ëŒ€ìƒì´ í•˜ë‚˜</strong><br />
í”„ë¡œì ì…˜ ëŒ€ìƒì´ í•˜ë‚˜ë©´ í•´ë‹¹ íƒ€ì…ìœ¼ë¡œ ë°˜í™˜í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">QItem</span> <span class="n">item</span> <span class="o">=</span> <span class="nc">QItem</span><span class="o">.</span><span class="na">item</span><span class="o">;</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">item</span><span class="o">).</span><span class="na">list</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">name</span><span class="o">);</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ì—¬ëŸ¬ ì»¬ëŸ¼ ë°˜í™˜ê³  íŠœí”Œ</strong><br />
í”„ë¡œì ì…˜ ëŒ€ìƒì´ ì—¬ëŸ¬ í•„ë“œë¥¼ ì„ íƒí•˜ë©´ QueryDSLì€ ê¸°ë³¸ì ìœ¼ë¡œ com.mysema.query.Tupleì´ë¼ëŠ” ë‚´ë¶€ íƒ€ì…ì„ ì‚¬ìš©í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">QItem</span> <span class="n">item</span> <span class="o">=</span> <span class="nc">QItem</span><span class="o">.</span><span class="na">item</span><span class="o">;</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Tuple</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">item</span><span class="o">).</span><span class="na">list</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">name</span><span class="o">,</span> <span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">);</span>

<span class="k">for</span> <span class="o">(</span><span class="nc">Tuple</span> <span class="n">tuple</span> <span class="o">:</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">tuple</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">name</span><span class="o">);</span>   <span class="c1">// name</span>
    <span class="n">tuple</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">);</span>  <span class="c1">// price</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ë¹ˆ ìƒì„±</strong><br />
ì¿¼ë¦¬ ê²°ê³¼ë¥¼ ì—”í‹°í‹°ê°€ ì•„ë‹Œ íŠ¹ì • ê°ì²´ë¡œ ë°›ê³  ì‹¶ìœ¼ë©´ ë¹ˆ ìƒì„± ê¸°ëŠ¥ì„ ì‚¬ìš©í•œë‹¤. QueryDSLì€ ë‹¤ìŒì„ ì‚¬ìš©í•´ ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.</p>
<ul>
  <li>í”„ë¡œí¼í‹° ì ‘ê·¼</li>
  <li>í•„ë“œ ì§ì ‘ ì ‘ê·¼</li>
  <li>ìƒì„±ì ì‚¬ìš©</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ItemDTO</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">price</span><span class="o">;</span>

    <span class="c1">// ìƒì„±ì ...</span>
    <span class="c1">// Getter, Setter ...</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<p>í”„ë¡œí¼í‹° ì ‘ê·¼</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">QItem</span> <span class="n">item</span> <span class="o">=</span> <span class="nc">QItem</span><span class="o">.</span><span class="na">item</span><span class="o">;</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">ItemDTO</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">item</span><span class="o">)</span>
<span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="nc">Projections</span><span class="o">.</span><span class="na">bean</span><span class="o">(</span><span class="nc">ItemDTO</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">item</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">as</span><span class="o">(</span><span class="s">"username"</span><span class="o">),</span> <span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">));</span>
</code></pre></div></div>
<p>Projections.bean()ë©”ì†Œë“œëŠ” Setterë¥¼ ì‚¬ìš©í•´ì„œ ê°’ì„ ì±„ìš´ë‹¤.
<br /></p>

<p>í•„ë“œ ì§ì ‘ ì ‘ê·¼</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">QItem</span> <span class="n">item</span> <span class="o">=</span> <span class="nc">QItem</span><span class="o">.</span><span class="na">item</span><span class="o">;</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">ItemDTO</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">item</span><span class="o">)</span>
<span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="nc">Projections</span><span class="o">.</span><span class="na">fields</span><span class="o">(</span><span class="nc">ItemDTO</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">item</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">as</span><span class="o">(</span><span class="s">"username"</span><span class="o">),</span> <span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">));</span>
</code></pre></div></div>
<p>Projections.fields()ë©”ì†Œë“œëŠ” í•„ë“œì— ì§ì ‘ ì ‘ê·¼í•´ì„œ ê°’ì„ ì±„ìš´ë‹¤.
<br /></p>

<p>ìƒì„±ì ì‚¬ìš©</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">QItem</span> <span class="n">item</span> <span class="o">=</span> <span class="nc">QItem</span><span class="o">.</span><span class="na">item</span><span class="o">;</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">ItemDTO</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">item</span><span class="o">)</span>
<span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="nc">Projections</span><span class="o">.</span><span class="na">constructor</span><span class="o">(</span><span class="nc">ItemDTO</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">item</span><span class="o">.</span><span class="na">name</span><span class="o">,</span> <span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">));</span>
</code></pre></div></div>
<p>ìƒì„±ìë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì§€ì •í•œ í”„ë¡œì ì…˜ê³¼ íŒŒë¼ë¯¸í„° ìˆœì„œê°€ ê°™ì€ ìƒì„±ìê°€ í•„ìš”í•˜ë‹¤.
<br /></p>

<p>DISTINCT
distinctëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">query</span><span class="o">.</span><span class="na">distinct</span><span class="o">().</span><span class="na">from</span><span class="o">(</span><span class="n">item</span><span class="o">)...</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="10410-ìˆ˜ì •-ì‚­ì œ-ë°°ì¹˜-ì¿¼ë¦¬">10.4.10 ìˆ˜ì •, ì‚­ì œ ë°°ì¹˜ ì¿¼ë¦¬</h3>
<p>QuertDSLë„ ìˆ˜ì •, ì‚­ì œ ê°™ì€ ë°°ì¹˜ ì¿¼ë¦¬ë¥¼ ì§€ì›í•œë‹¤. JPQL ë°°ì¹˜ ì¿¼ë¦¬ì™€ ê°™ì´ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ë¬´ì‹œí•˜ê³  ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì§ì ‘ ì¿¼ë¦¬í•œë‹¤ëŠ” ì ì— ìœ ì˜í•˜ì.</p>

<p><strong>ìˆ˜ì • ë°°ì¹˜ ì¿¼ë¦¬</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">QItem</span> <span class="n">item</span> <span class="o">=</span> <span class="nc">QItem</span><span class="o">.</span><span class="na">item</span><span class="o">;</span>
<span class="nc">JPAUpdateClause</span> <span class="n">updateClause</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JPAUpdateClause</span><span class="o">(</span><span class="n">em</span><span class="o">,</span> <span class="n">item</span><span class="o">);</span>
<span class="kt">long</span> <span class="n">count</span> <span class="o">=</span> <span class="n">updateClause</span><span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"ì‹œê³¨ê°œë°œìì˜ JPAì±…"</span><span class="o">))</span>
                    <span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">,</span> <span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">100</span><span class="o">))</span>
                    <span class="o">.</span><span class="na">execute</span><span class="o">();</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ì‚­ì œ ë°°ì¹˜ ì¿¼ë¦¬</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">QItem</span> <span class="n">item</span> <span class="o">=</span> <span class="nc">QItem</span><span class="o">.</span><span class="na">item</span><span class="o">;</span>
<span class="nc">JPADeleteClause</span> <span class="n">deleteClause</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JPADeleteClause</span><span class="o">(</span><span class="n">em</span><span class="o">,</span> <span class="n">item</span><span class="o">);</span>
<span class="kt">long</span> <span class="n">count</span> <span class="o">=</span> <span class="n">deleteClause</span><span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"ì‹œê³¨ê°œë°œìì˜ JPAì±…"</span><span class="o">)).</span><span class="na">execute</span><span class="o">();</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="10411-ë™ì -ì¿¼ë¦¬">10.4.11 ë™ì  ì¿¼ë¦¬</h3>
<p>com.mysema.query.BooleanBuilderë¥¼ ì‚¬ìš©í•˜ë©´ íŠ¹ì • ì¡°ê±´ì— ë”°ë¥¸ ë™ì  ì¿¼ë¦¬ë¥¼ í¸ë¦¬í•˜ê²Œ ìƒì„±í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">SearchParam</span> <span class="n">param</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SearchParam</span><span class="o">();</span>
<span class="n">param</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">"ì‹œê³¨ê°œë°œì"</span><span class="o">);</span>
<span class="n">param</span><span class="o">.</span><span class="na">setPrice</span><span class="o">(</span><span class="mi">10000</span><span class="o">);</span>

<span class="nc">QItem</span> <span class="n">item</span> <span class="o">=</span> <span class="nc">QItem</span><span class="o">.</span><span class="na">item</span><span class="o">;</span>

<span class="nc">BooleanBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BooleanBuilder</span><span class="o">();</span>
<span class="k">if</span> <span class="o">(</span><span class="nc">StringUtils</span><span class="o">.</span><span class="na">hasText</span><span class="o">(</span><span class="n">param</span><span class="o">.</span><span class="na">getName</span><span class="o">()))</span> <span class="o">{</span>
    <span class="n">builder</span><span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">param</span><span class="o">.</span><span class="na">getName</span><span class="o">()));</span>
<span class="o">}</span>

<span class="k">if</span> <span class="o">(</span><span class="n">param</span><span class="o">.</span><span class="na">getPrice</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">builder</span><span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">.</span><span class="na">gt</span><span class="o">(</span><span class="n">param</span><span class="o">.</span><span class="na">getPrice</span><span class="o">()));</span>
<span class="o">}</span>

<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Item</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">item</span><span class="o">).</span><span class="na">where</span><span class="o">(</span><span class="n">builder</span><span class="o">).</span><span class="na">list</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="10412-ë©”ì†Œë“œ-ìœ„ì„">10.4.12 ë©”ì†Œë“œ ìœ„ì„</h3>
<p>ë©”ì†Œë“œ ìœ„ì„ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ ì¿¼ë¦¬ íƒ€ì…ì— ê²€ìƒ‰ ì¡°ê±´ì„ ì§ì ‘ ì •ì˜í•  ìˆ˜ ìˆë‹¤.</p>

<p><strong>ê²€ìƒ‰ ì¡°ê±´ ì •ì˜</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ItemExpression</span> <span class="o">{</span>

    <span class="nd">@QueryDelegate</span><span class="o">(</span><span class="nc">Item</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">BooleanExpression</span> <span class="nf">isExpensive</span><span class="o">(</span><span class="nc">QItem</span> <span class="n">item</span><span class="o">,</span> <span class="nc">Integer</span> <span class="n">price</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">.</span><span class="na">gt</span><span class="o">(</span><span class="n">price</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>ë©”ì†Œë“œ ìœ„ì„ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ ì •ì (static) ë©”ì†Œë“œë¥¼ ë§Œë“¤ê³  @QueryDelegate ì–´ë…¸í…Œì´ì…˜ì— ì†ì„±ìœ¼ë¡œ ì´ ê¸°ëŠ¥ì„ ì ìš©í•  ì—”í‹°í‹°ë¥¼ ì§€ì •í•œë‹¤.</li>
  <li>ì •ì  ë©”ì†Œë“œì˜ ì²« ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì—ëŠ” ëŒ€ìƒ ì—”í‹°í‹°ì˜ ì¿¼ë¦¬ íƒ€ì…(Q)ì„ ì§€ì •í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” í•„ìš”í•œ íŒŒë¼ë¯¸í„°ë¥¼ ì •ì˜í•œë‹¤.</li>
</ul>

<p><strong>ì¿¼ë¦¬ íƒ€ì…(Q)ì— ìƒì„±ëœ ê²°ê³¼</strong><br />
QItemì— ìƒì„±ëœ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">QItem</span> <span class="kd">extends</span> <span class="nc">EntityPathBase</span><span class="o">&lt;</span><span class="nc">ITem</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="o">...</span>
    <span class="kd">public</span> <span class="n">com</span><span class="o">.</span><span class="na">mysema</span><span class="o">.</span><span class="na">query</span><span class="o">.</span><span class="na">types</span><span class="o">.</span><span class="na">expr</span><span class="o">.</span><span class="na">BooleanExpression</span> <span class="nf">isExpensive</span><span class="o">(</span><span class="nc">Integer</span> <span class="n">price</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">ItemExpression</span><span class="o">.</span><span class="na">isExpensive</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">price</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>ì‚¬ìš©</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">query</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">item</span><span class="o">).</span><span class="na">where</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">isExpensive</span><span class="o">(</span><span class="mi">30000</span><span class="o">)).</span><span class="na">list</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
</code></pre></div></div>
<p><br /></p>

<p>í•„ìš”í•˜ë‹¤ë©´ String, Date ê°™ì€ ìë°” ê¸°ë³¸ ë‚´ì¥ íƒ€ì…ì—ë„ ë©”ì†Œë“œ ìœ„ì„ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@QueryDelegate</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">BooleanExpression</span> <span class="nf">isHelloStart</span><span class="o">(</span><span class="nc">StringPath</span> <span class="n">stringPath</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">stringPath</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="s">"Hello"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br />
<br />
<br /></p>

<h2 id="105-ë„¤ì´í‹°ë¸Œ-sql">10.5 ë„¤ì´í‹°ë¸Œ SQL</h2>
<p>JPQLì€ í‘œì¤€ SQLì´ ì§€ì›í•˜ëŠ” ëŒ€ë¶€ë¶„ì˜ ë¬¸ë²•ê³¼ SQL í•¨ìˆ˜ë“¤ì„ ì§€ì›í•˜ì§€ë§Œ íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ì— ì¢…ì†ì ì¸ ê¸°ëŠ¥ì€ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤. ì˜ˆë¥¼ ë“¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê²ƒë“¤ì´ë‹¤.</p>

<ul>
  <li>íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ë§Œ ì§€ì›í•˜ëŠ” í•¨ìˆ˜, ë¬¸ë²•, SQLì¿¼ë¦¬ íŒíŠ¸</li>
  <li>ì¸ë¼ì¸ë·°(From ì ˆì—ì„œ ì‚¬ìš©í•˜ëŠ” ì„œë¸Œì¿¼ë¦¬), UNION, INTERSECT</li>
  <li>ìŠ¤í† ì–´ë“œ í”„ë¡œì‹œì €<br />
<br /></li>
</ul>

<p>ë•Œë¡œëŠ” íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ì— ì¢…ì†ì ì¸ ê¸°ëŠ¥ì´ í•„ìš”í•˜ë‹¤. JPA êµ¬í˜„ì²´ë“¤ì€ JPA í‘œì¤€ë³´ë‹¤ ë” ë‹¤ì–‘í•œ ë°©ë²•ì„ ì§€ì›í•œë‹¤.</p>
<ul>
  <li>íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ë§Œ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜
    <ul>
      <li>JPQLì—ì„œ ë„¤ì´í‹°ë¸Œ SQL í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.(JPA 2.1)</li>
      <li>í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ë°©ì–¸ì— ê° ë°ì´í„°ë² ì´ìŠ¤ì— ì¢…ì†ì ì¸ í•¨ìˆ˜ë“¤ì„ ì •ì˜í•´ë‘ì—ˆë‹¤. ë˜í•œ ì§ì ‘ í˜¸ì¶œí•  í•¨ìˆ˜ë¥¼ ì •ì˜í•  ìˆ˜ë„ ìˆë‹¤.</li>
    </ul>
  </li>
  <li>íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ë§Œ ì§€ì›í•˜ëŠ” SQL ì¿¼ë¦¬ íŒíŠ¸
    <ul>
      <li>í•˜ì´ë²„ë„¤ì´íŠ¸ë¥¼ í¬í•¨í•œ ëª‡ëª‡ JPA êµ¬í˜„ì²´ë“¤ì´ ì§€ì›í•œë‹¤.</li>
    </ul>
  </li>
  <li>ì¸ë¼ì¸ ë·°(From ì ˆì—ì„œ ì‚¬ìš©í•˜ëŠ” ì„œë¸Œì¿¼ë¦¬), UNION, INTERSECT
    <ul>
      <li>í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” ì§€ì›í•˜ì§€ ì•Šì§€ë§Œ ëª‡ëª‡ JPA êµ¬í˜„ì²´ë“¤ì´ ì§€ì›í•œë‹¤.</li>
    </ul>
  </li>
  <li>ìŠ¤í† ì–´ í”„ë¡œì‹œì €
    <ul>
      <li>JPQLì—ì„œ ìŠ¤í† ì–´ë“œ í”„ë¡œì‹œì €ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.(JPA 2.1)</li>
    </ul>
  </li>
  <li>íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ë§Œ ì§€ì›í•˜ëŠ” ë¬¸ë²•
    <ul>
      <li>ì´ë•ŒëŠ” ë„¤ì´í‹°ë¸Œ SQLì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<p>ë‹¤ì–‘í•œ ì´ìœ ë¡œ JPQLì„ ì‚¬ìš©í•  ìˆ˜ ì—†ì„ ë•Œ JPAëŠ” SQLì„ ì§ì ‘ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ”ë° ì´ë¥¼ ë„¤ì´í‹°ë¸Œ SQLì´ë¼ í•œë‹¤.</p>

<p>ê·¸ë ‡ë‹¤ë©´ <strong>ë„¤ì´í‹°ë¸Œ SQLê³¼ JDBC APIë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ê²ƒê³¼ì˜ ì°¨ì´ì </strong>ì€ ë¬´ì—‡ì¼ê¹Œ?
<strong>ë„¤ì´í‹°ë¸Œ SQLì„ ì‚¬ìš©í•˜ë©´ ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆê³ , JPAê°€ ì§€ì›í•˜ëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ê¸°ëŠ¥ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</strong></p>

<h3 id="1051-ë„¤ì´í‹°ë¸Œ-sql-ì‚¬ìš©">10.5.1 ë„¤ì´í‹°ë¸Œ SQL ì‚¬ìš©</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ê²°ê³¼ íƒ€ì… ì •ì˜</span>
<span class="kd">public</span> <span class="nc">Query</span> <span class="nf">createNativeQuery</span><span class="o">(</span><span class="nc">String</span> <span class="n">sqlString</span><span class="o">,</span> <span class="nc">Calss</span> <span class="n">resultClass</span><span class="o">);</span>

<span class="c1">// ê²°ê³¼ íƒ€ì…ì„ ì •ì˜í•  ìˆ˜ ì—†ì„ ë•Œ</span>
<span class="kd">public</span> <span class="nc">Query</span> <span class="nf">createNativeQuery</span><span class="o">(</span><span class="nc">String</span> <span class="n">sqlString</span><span class="o">);</span>

<span class="c1">// ê²°ê³¼ ë§¤í•‘ ì‚¬ìš©</span>
<span class="kd">public</span> <span class="nc">Query</span> <span class="nf">createNativeQuery</span><span class="o">(</span><span class="nc">String</span> <span class="n">sqlString</span><span class="o">,</span> <span class="nc">String</span> <span class="n">resultSetMapping</span><span class="o">);</span>
</code></pre></div></div>
<p><strong>ë‚´ìš© ìƒëµ ğŸ˜…</strong>
<br />
<br /></p>

<h2 id="106-ê°ì²´ì§€í–¥-ì¿¼ë¦¬-ì‹¬í™”">10.6 ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì‹¬í™”</h2>
<h3 id="1061-ë²Œí¬-ì—°ì‚°">10.6.1 ë²Œí¬ ì—°ì‚°</h3>
<p>í•œ ë²ˆì— ìˆ˜ì •í•˜ê±°ë‚˜ ì‚­ì œí•˜ëŠ” ë²Œí¬ ì—°ì‚°ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<p><strong>UPDATE ë²Œí¬ ì—°ì‚°</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">sqlString</span><span class="o">;</span>
    <span class="s">"update Product p "</span> <span class="o">+</span>
    <span class="s">"set p.price = p.price * 1.1 "</span> <span class="o">+</span>
    <span class="s">"where p.stockAmount &lt; :stockAmount"</span><span class="o">;</span>

<span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">sqlString</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="s">"stockAmount"</span><span class="o">,</span> <span class="mi">10</span><span class="o">)</span>
            <span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>DELETE ë²Œí¬ ì—°ì‚°</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">sqlString</span><span class="o">;</span>
    <span class="s">"delete from Product p "</span> <span class="o">+</span>
    <span class="s">"where p.price &lt; :price"</span><span class="o">;</span>

<span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">sqlString</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="s">"price"</span><span class="o">,</span> <span class="mi">100</span><span class="o">)</span>
            <span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ë²Œí¬ ì—°ì‚°ì˜ ì£¼ì˜ì </strong><br />
ë²Œí¬ ì—°ì‚°ì„ ì‚¬ìš©í•  ë•ŒëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ë¬´ì‹œí•˜ê³  ë°ì´í„°ë² ì´ìŠ¤ì— ì§ì ‘ ì¿¼ë¦¬í•œë‹¤ëŠ” ì ì— ì£¼ì˜í•´ì•¼ í•œë‹¤.</p>

<p><strong>í•´ê²° ë°©ë²•</strong></p>
<ul>
  <li>em.refresh() ì‚¬ìš©</li>
  <li>ë²Œí¬ ì—°ì‚° ë¨¼ì € ì‹¤í–‰</li>
  <li>ë²Œí¬ ì—°ì‚° ìˆ˜í–‰ í›„ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ì´ˆê¸°í™”</li>
</ul>

<p><br />
<br /></p>

<h3 id="1062-ì˜ì†ì„±-ì»¨í…ìŠ¤íŠ¸ì™€-jpql">10.6.2 ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì™€ JPQL</h3>
<p><strong>ì¿¼ë¦¬ í›„ ì˜ì† ìƒíƒœì¸ ê²ƒê³¼ ì•„ë‹Œ ê²ƒ</strong></p>
<ul>
  <li>ì˜ì† ìƒíƒœ
    <ul>
      <li>ì—”í‹°í‹°</li>
    </ul>
  </li>
  <li>ì˜ì† ìƒíƒœ ì•„ë‹Œ ê²ƒ
    <ul>
      <li>ì„ë² ë””ë“œ íƒ€ì…</li>
      <li>ë‹¨ìˆœ í•„ë“œ ì¡°íšŒ</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<p><strong>em.find() ë™ì‘ ìˆœì„œ</strong></p>
<ul>
  <li>ì—”í‹°í‹°ë¥¼ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ë¨¼ì € ì°¾ê³ </li>
  <li>ì—†ìœ¼ë©´ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì°¾ëŠ”ë‹¤.</li>
</ul>

<p><br /></p>

<p><strong>JPQL ë™ì‘ ìˆœì„œ</strong></p>
<ul>
  <li>ìµœì´ˆ ì¡°íšŒ
    <ul>
      <li>ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¡°íšŒ</li>
      <li>ì—”í‹°í‹°ë¥¼ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ë“±ë¡</li>
    </ul>
  </li>
  <li>ë‘ ë²ˆì§¸ ì¡°íšŒ
    <ul>
      <li>ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¡°íšŒ</li>
      <li>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ê°™ì€ ì—”í‹°í‹° ë°œê²¬</li>
      <li>ìƒˆë¡œ ê²€ìƒ‰í•œ ì—”í‹°í‹°ëŠ” ë²„ë¦¬ê³  ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ìˆëŠ” ê¸°ì¡´ ì—”í‹°í‹° ë°˜í™˜</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<p><strong>JPQL íŠ¹ì§• ì •ë¦¬</strong></p>
<ul>
  <li>JPQLì€ í•­ìƒ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¡°íšŒí•œë‹¤.</li>
  <li>JPQLë¡œ ì¡°íšŒí•œ ì—”í‹°í‹°ëŠ” ì˜ì† ìƒíƒœë‹¤.</li>
  <li>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì—”í‹°í‹°ê°€ ìˆìœ¼ë©´ ê¸°ì¡´ ì—”í‹°í‹°ë¥¼ ë°˜í™˜í•œë‹¤.</li>
</ul>

<p><br />
<br /></p>

<h3 id="1063-jpqlê³¼-í”ŒëŸ¬ì‹œ-ëª¨ë“œ">10.6.3 JPQLê³¼ í”ŒëŸ¬ì‹œ ëª¨ë“œ</h3>

<p><strong>í”ŒëŸ¬ì‹œ ëª¨ë“œ</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">em</span><span class="o">.</span><span class="na">setFlushMode</span><span class="o">(</span><span class="nc">FlushModeType</span><span class="o">.</span><span class="na">AUTO</span><span class="o">);</span>    <span class="c1">// ì»¤ë°‹, ì¿¼ë¦¬ ì‹¤í–‰ ì‹œ í”ŒëŸ¬ì‹œ (ê¸°ë³¸ê°’)</span>
<span class="n">em</span><span class="o">.</span><span class="na">setFlushMode</span><span class="o">(</span><span class="nc">FlushModeType</span><span class="o">.</span><span class="na">COMMIT</span><span class="o">);</span>  <span class="c1">// ì»¤ë°‹ì‹œì—ë§Œ í”ŒëŸ¬ì‹œ</span>
</code></pre></div></div>
<ul>
  <li>JPQLì€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ìˆëŠ” ë°ì´í„°ë¥¼ ê³ ë ¤í•˜ì§€ ì•Šê³  ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ì¡°íšŒí•œë‹¤.</li>
  <li>ë”°ë¼ì„œ JPQLì„ ì‹¤í–‰í•˜ê¸° ì „ì— í”ŒëŸ¬ì‹œë¥¼ í†µí•´ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë‚´ìš©ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•´ì•¼ í•œë‹¤.</li>
</ul>

<p><br /></p>

<h2 id="107-ì •ë¦¬">10.7 ì •ë¦¬</h2>
<ul>
  <li>JPQLì€ SQLì„ ì¶”ìƒí™”í•´ì„œ íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ ê¸°ìˆ ì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
  <li>Criteriaë‚˜ QueryDSLì€ JPQLì„ ë§Œë“¤ì–´ì£¼ëŠ” ë¹Œë” ì—­í• ì„ í•  ë¿ì´ë¯€ë¡œ í•µì‹¬ì€ JPQLì„ ì˜ ì•Œì•„ì•¼ í•œë‹¤.</li>
  <li>Criteriaë‚˜ QueryDSLì„ ì‚¬ìš©í•˜ë©´ ë™ì ìœ¼ë¡œ ë³€í•˜ëŠ” ì¿¼ë¦¬ë¥¼ í¸ë¦¬í•˜ê²Œ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.</li>
  <li>CriteriaëŠ” JPAê°€ ê³µì‹ ì§€ì›í•˜ëŠ” ê¸°ëŠ¥ì´ì§€ë§Œ ë¶ˆí¸í•˜ë‹¤. QueryDSLì€ JPAê°€ ê³µì‹ ì§€ì›í•˜ëŠ” ê¸°ëŠ¥ì€ ì•„ë‹ˆì§€ë§Œ í¸ë¦¬í•˜ë‹¤.</li>
  <li>JPAë„ ë„¤ì´í‹°ë¸Œ SQLì„ ì œê³µí•˜ë¯€ë¡œ ì§ì ‘ SQLì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ì— ì¢…ì†ì ì´ ë˜ë¯€ë¡œ ìµœëŒ€í•œ ì‚¬ìš©ì„ ìì œí•˜ì.</li>
  <li>JPQLì€ ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ê±°ë‚˜ ì‚­ì œí•˜ëŠ” ë²Œí¬ ì—°ì‚°ì„ ì§€ì›í•œë‹¤.</li>
</ul>

<p><br />
<br />
<br /></p>

<h1 id="11-ì›¹-ì• í”Œë¦¬ì¼€ì´ì…˜-ì œì‘">11. ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì œì‘</h1>
<p><strong>ë‚´ìš© ìƒëµ ğŸ˜…</strong><br />
<br />
<br />
<br /></p>

<h1 id="12-ìŠ¤í”„ë§-ë°ì´í„°-jpa">12. ìŠ¤í”„ë§ ë°ì´í„° JPA</h1>
<h2 id="121-ìŠ¤í”„ë§-ë°ì´í„°-jpa-ì†Œê°œ">12.1 ìŠ¤í”„ë§ ë°ì´í„° JPA ì†Œê°œ</h2>
<p><a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/" target="blank_">ìŠ¤í”„ë§ ë°ì´í„° JPA ë ˆí¼ëŸ°ìŠ¤ ë¬¸ì„œ</a></p>

<ul>
  <li>ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ì—ì„œ JPAë¥¼ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•˜ëŠ” í”„ë¡œì íŠ¸ë‹¤.</li>
  <li>CURDë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ê³µí†µ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•œë‹¤.</li>
  <li>ì¸í„°í˜ì´ìŠ¤ë§Œ ì‘ì„±í•˜ë©´ ì‹¤í–‰ ì‹œì ì— êµ¬í˜„ ê°ì²´ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•´ì„œ ì£¼ì…í•´ì¤€ë‹¤.</li>
  <li>ë”°ë¼ì„œ ë°ì´í„° ì ‘ê·¼ ê³„ì¸µì„ ê°œë°œí•  ë•Œ êµ¬í˜„ í´ë˜ìŠ¤ ì—†ì´ ì¸í„°í˜ì´ìŠ¤ë§Œ ì‘ì„±í•´ë„ ê°œë°œì„ ì™„ë£Œí•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><br /></p>

<h2 id="122-ìŠ¤í”„ë§-ë°ì´í„°-jpa-ì„¤ì •">12.2 ìŠ¤í”„ë§ ë°ì´í„° JPA ì„¤ì •</h2>
<p><strong>í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- ìŠ¤í”„ë§ ë°ì´í„° JPA --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework.data<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-data-jpa<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>${spring-data-jpa.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>í™˜ê²½ ì„¤ì •</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- xml --&gt;</span>
<span class="c">&lt;!-- ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ í•´ë‹¹ íŒ¨í‚¤ì§€ì™€ ê·¸ í•˜ìœ„ íŒ¨í‚¤ì§€ì—ì„œ ê²€ìƒ‰í•œë‹¤. --&gt;</span>
<span class="nt">&lt;jpa:repositories</span> <span class="na">base-package=</span><span class="s">"jpabook.jpashop.repository"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// java config class</span>
<span class="nd">@Configuration</span>
<span class="nd">@EnableJpaRepositories</span><span class="o">(</span><span class="n">basePackage</span> <span class="o">=</span> <span class="s">"jpabook.jpashop.repository"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AppConfig</span> <span class="o">{}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h2 id="123-ê³µí†µ-ì¸í„°í˜ì´ìŠ¤-ê¸°ëŠ¥">12.3 ê³µí†µ ì¸í„°í˜ì´ìŠ¤ ê¸°ëŠ¥</h2>
<p>ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” ê°„ë‹¨í•œ CRUD ê¸°ëŠ¥ì„ ê³µí†µìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” <code class="language-plaintext highlighter-rouge">JpaRepository</code> ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// JpaRepository ì¸í„°í˜ì´ìŠ¤</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="no">T</span><span class="o">,</span> <span class="no">ID</span> <span class="kd">extends</span> <span class="nc">Serializable</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="nc">PagingAndSortingRepository</span><span class="o">&lt;</span><span class="no">T</span><span class="o">,</span> <span class="no">ID</span><span class="o">&gt;</span> <span class="o">{...}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// JpaRepository ì¸í„°í˜ì´ìŠ¤ ì‚¬ìš©</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{}</span>
</code></pre></div></div>
<center><img src="/assets/images/posts/books/2/12_3_ê³µí†µì¸í„°í˜ì´ìŠ¤êµ¬ì„±.png" width="100%" height="100%" /></center>
<p><br />
<br /></p>

<h2 id="124-ì¿¼ë¦¬-ë©”ì†Œë“œ-ê¸°ëŠ¥">12.4 ì¿¼ë¦¬ ë©”ì†Œë“œ ê¸°ëŠ¥</h2>
<p>ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ ì œê³µí•˜ëŠ” ì¿¼ë¦¬ ë©”ì†Œë“œ ê¸°ëŠ¥</p>
<ul>
  <li>ë©”ì†Œë“œ ì´ë¦„ìœ¼ë¡œ ì¿¼ë¦¬ ìƒì„±</li>
  <li>ë©”ì†Œë“œ ì´ë¦„ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">JPA NamedQuery</code> í˜¸ì¶œ</li>
  <li><code class="language-plaintext highlighter-rouge">@Query</code> ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•´ì„œ ë¦¬í¬ì§€í„°ë¦¬ ì¸í„°í˜ì´ìŠ¤ì— ì¿¼ë¦¬ ì§ì ‘ ì •ì˜</li>
</ul>

<p><br /></p>

<h3 id="1241-ë©”ì†Œë“œ-ì´ë¦„ìœ¼ë¡œ-ì¿¼ë¦¬-ìƒì„±">12.4.1 ë©”ì†Œë“œ ì´ë¦„ìœ¼ë¡œ ì¿¼ë¦¬ ìƒì„±</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì´ë©”ì¼ê³¼ ì´ë¦„ìœ¼ë¡œ íšŒì›ì„ ì¡°íšŒ ë©”ì†Œë“œë¥¼ ì •ì˜</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findByEmailAndName</span><span class="o">(</span><span class="nc">String</span> <span class="n">email</span><span class="o">,</span> <span class="nc">String</span> <span class="n">name</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ ë©”ì†Œë“œë¥¼ ë¶„ì„í•´ì„œ JPQLì„ ìƒì„±í•˜ê³  ì‹¤í–‰í•œë‹¤.</span>
<span class="k">select</span> <span class="n">m</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span> <span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">email</span> <span class="o">=?</span><span class="mi">1</span> <span class="k">and</span> <span class="n">m</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="o">?</span><span class="mi">2</span>
</code></pre></div></div>

<p><strong>ê·œì¹™</strong><br />
<a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#jpa.query-methods.query-creation" target="_blank">ìŠ¤í”„ë§ ë°ì´í„° JPA ì¿¼ë¦¬ ìƒì„± ê¸°ëŠ¥</a></p>

<table>
    <thead>
        <tr>
        <th>í‚¤ì›Œë“œ</th>
        <th>ì˜ˆ</th>
        <th>JPQL ì˜ˆ</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><p><code>Distinct</code></p></td>
            <td><p><code>findDistinctByLastnameAndFirstname</code></p></td>
            <td><p><code>select distinct â€¦â€‹ where x.lastname = ?1 and x.firstname = ?2</code></p></td>
        </tr>
        <tr>
            <td><p><code>And</code></p></td>
            <td><p><code>findByLastnameAndFirstname</code></p></td>
            <td><p><code>â€¦ where x.lastname = ?1 and x.firstname = ?2</code></p></td>
        </tr>
        <tr>
            <td><p><code>Or</code></p></td>
            <td><p><code>findByLastnameOrFirstname</code></p></td>
            <td><p><code>â€¦ where x.lastname = ?1 or x.firstname = ?2</code></p></td>
        </tr>
        <tr>
            <td><p><code>Is</code>, <code>Equals</code></p></td>
            <td><p><code>findByFirstname</code>,<code>findByFirstnameIs</code>,<code>findByFirstnameEquals</code></p></td>
            <td><p><code>â€¦ where x.firstname = ?1</code></p></td>
        </tr>
        <tr>
        <td><p><code>Between</code></p></td>
        <td><p><code>findByStartDateBetween</code></p></td>
        <td><p><code>â€¦ where x.startDate between ?1 and ?2</code></p></td>
        </tr>
        <tr>
        <td><p><code>LessThan</code></p></td>
        <td><p><code>findByAgeLessThan</code></p></td>
        <td><p><code>â€¦ where x.age &lt; ?1</code></p></td>
        </tr>
        <tr>
        <td><p><code>LessThanEqual</code></p></td>
        <td><p><code>findByAgeLessThanEqual</code></p></td>
        <td><p><code>â€¦ where x.age &lt;= ?1</code></p></td>
        </tr>
        <tr>
        <td><p><code>GreaterThan</code></p></td>
        <td><p><code>findByAgeGreaterThan</code></p></td>
        <td><p><code>â€¦ where x.age &gt; ?1</code></p></td>
        </tr>
        <tr>
        <td><p><code>GreaterThanEqual</code></p></td>
        <td><p><code>findByAgeGreaterThanEqual</code></p></td>
        <td><p><code>â€¦ where x.age &gt;= ?1</code></p></td>
        </tr>
        <tr>
        <td><p><code>After</code></p></td>
        <td><p><code>findByStartDateAfter</code></p></td>
        <td><p><code>â€¦ where x.startDate &gt; ?1</code></p></td>
        </tr>
        <tr>
        <td><p><code>Before</code></p></td>
        <td><p><code>findByStartDateBefore</code></p></td>
        <td><p><code>â€¦ where x.startDate &lt; ?1</code></p></td>
        </tr>
        <tr>
        <td><p><code>IsNull</code>, <code>Null</code></p></td>
        <td><p><code>findByAge(Is)Null</code></p></td>
        <td><p><code>â€¦ where x.age is null</code></p></td>
        </tr>
        <tr>
        <td><p><code>IsNotNull</code>, <code>NotNull</code></p></td>
        <td><p><code>findByAge(Is)NotNull</code></p></td>
        <td><p><code>â€¦ where x.age not null</code></p></td>
        </tr>
        <tr>
        <td><p><code>Like</code></p></td>
        <td><p><code>findByFirstnameLike</code></p></td>
        <td><p><code>â€¦ where x.firstname like ?1</code></p></td>
        </tr>
        <tr>
        <td><p><code>NotLike</code></p></td>
        <td><p><code>findByFirstnameNotLike</code></p></td>
        <td><p><code>â€¦ where x.firstname not like ?1</code></p></td>
        </tr>
        <tr>
        <td><p><code>StartingWith</code></p></td>
        <td><p><code>findByFirstnameStartingWith</code></p></td>
        <td><p><code>â€¦ where x.firstname like ?1</code> (parameter bound with appended <code>%</code>)</p></td>
        </tr>
        <tr>
        <td><p><code>EndingWith</code></p></td>
        <td><p><code>findByFirstnameEndingWith</code></p></td>
        <td><p><code>â€¦ where x.firstname like ?1</code> (parameter bound with prepended <code>%</code>)</p></td>
        </tr>
        <tr>
        <td><p><code>Containing</code></p></td>
        <td><p><code>findByFirstnameContaining</code></p></td>
        <td><p><code>â€¦ where x.firstname like ?1</code> (parameter bound wrapped in <code>%</code>)</p></td>
        </tr>
        <tr>
        <td><p><code>OrderBy</code></p></td>
        <td><p><code>findByAgeOrderByLastnameDesc</code></p></td>
        <td><p><code>â€¦ where x.age = ?1 order by x.lastname desc</code></p></td>
        </tr>
        <tr>
        <td><p><code>Not</code></p></td>
        <td><p><code>findByLastnameNot</code></p></td>
        <td><p><code>â€¦ where x.lastname &lt;&gt; ?1</code></p></td>
        </tr>
        <tr>
        <td><p><code>In</code></p></td>
        <td><p><code>findByAgeIn(Collection&lt;Age&gt; ages)</code></p></td>
        <td><p><code>â€¦ where x.age in ?1</code></p></td>
        </tr>
        <tr>
        <td><p><code>NotIn</code></p></td>
        <td><p><code>findByAgeNotIn(Collection&lt;Age&gt; ages)</code></p></td>
        <td><p><code>â€¦ where x.age not in ?1</code></p></td>
        </tr>
        <tr>
        <td><p><code>True</code></p></td>
        <td><p><code>findByActiveTrue()</code></p></td>
        <td><p><code>â€¦ where x.active = true</code></p></td>
        </tr>
        <tr>
        <td><p><code>False</code></p></td>
        <td><p><code>findByActiveFalse()</code></p></td>
        <td><p><code>â€¦ where x.active = false</code></p></td>
        </tr>
        <tr>
        <td><p><code>IgnoreCase</code></p></td>
        <td><p><code>findByFirstnameIgnoreCase</code></p></td>
        <td><p><code>â€¦ where UPPER(x.firstname) = UPPER(?1)</code></p></td>
        </tr>
    </tbody>
</table>
<p><br /></p>

<h3 id="1242-jpa-namedquery">12.4.2 JPA NamedQuery</h3>
<p>ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” ë©”ì†Œë“œ ì´ë¦„ìœ¼ë¡œ JPA Named ì¿¼ë¦¬ë¥¼ í˜¸ì¶œí•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// @NamedQueryë¡œ Named ì¿¼ë¦¬ ì •ì˜</span>
<span class="nd">@Entity</span>
<span class="nd">@NamedQuery</span><span class="o">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"Member.findByUsername"</span><span class="o">,</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s">"select m from Member m where m.username = :username"</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ë„ë©”ì¸ í´ë˜ìŠ¤ + .(ì ) + ë©”ì†Œë“œ ì´ë¦„ ìœ¼ë¡œ Named ì¿¼ë¦¬ë¥¼ ì°¾ì•„ ì‹¤í–‰í•œë‹¤.</span>
<span class="c1">// Named ì¿¼ë¦¬ê°€ ì—†ìœ¼ë©´ ë©”ì†Œë“œ ì´ë¦„ìœ¼ë¡œ ì¿¼ë¦¬ ìƒì„± ì „ëµì„ ì‚¬ìš©í•œë‹¤.</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findByUsername</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="1243-query-ë¦¬í¬ì§€í† ë¦¬-ë©”ì†Œë“œì—-ì¿¼ë¦¬-ì •ì˜">12.4.3 @Query, ë¦¬í¬ì§€í† ë¦¬ ë©”ì†Œë“œì— ì¿¼ë¦¬ ì •ì˜</h3>
<p>ë¦¬í¬ì§€í† ë¦¬ ë©”ì†Œë“œì— ì§ì ‘ ì¿¼ë¦¬ë¥¼ ì •ì˜í•˜ë ¤ë©´ <code class="language-plaintext highlighter-rouge">@Query</code> ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ë©”ì†Œë“œì— JPQL ì¿¼ë¦¬ ì‘ì„±</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Query</span><span class="o">(</span><span class="s">"select m from Member m where m.username = ?1"</span><span class="o">)</span>
    <span class="nc">Member</span> <span class="nf">findByUsername</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// JPA ë„¤ì´í‹°ë¸Œ SQL ì§€ì›</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Query</span><span class="o">(</span><span class="s">"SELECT * FROM MEMBER FROM WHERE USERNAME = ?0"</span><span class="o">,</span> <span class="n">nativeQuery</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="nc">Member</span> <span class="nf">findByUsername</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1244-íŒŒë¼ë¯¸í„°-ë°”ì¸ë”©">12.4.4 íŒŒë¼ë¯¸í„° ë°”ì¸ë”©</h3>
<p>ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” ìœ„ì¹˜ ê¸°ë°˜ íŒŒë¼ë¯¸í„° ë°”ì¸ë”©ê³¼ ì´ë¦„ ê¸°ë°˜ íŒŒë¼ë¯¸í„° ë°”ì¸ë”©ì„ ì§€ì›í•œë‹¤. ê¸°ë³¸ê°’ì€ ìœ„ì¹˜ ê¸°ë°˜ì´ë‹¤.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- ìœ„ì¹˜ ê¸°ë°˜, ê¸°ë³¸ê°’</span>
<span class="k">select</span> <span class="n">m</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span> <span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">username</span> <span class="o">=</span> <span class="o">?</span><span class="mi">1</span>

<span class="c1">-- ì´ë¦„ ê¸°ë°˜</span>
<span class="k">select</span> <span class="n">m</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span> <span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">username</span> <span class="o">=</span> <span class="p">:</span><span class="n">name</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Query</span><span class="o">(</span><span class="s">"select m from Member m where m.username = :name"</span><span class="o">)</span>
    <span class="nc">Member</span> <span class="nf">findByUsername</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"name"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">username</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1245-ë²Œí¬ì„±-ìˆ˜ì •-ì¿¼ë¦¬">12.4.5 ë²Œí¬ì„± ìˆ˜ì • ì¿¼ë¦¬</h3>
<p>ìŠ¤í”„ë§ ë°ì´í„° JPAë¥¼ ì‚¬ìš©í•œ ë²Œí¬ì„± ìˆ˜ì •, ì‚­ì œ ì¿¼ë¦¬ëŠ” <code class="language-plaintext highlighter-rouge">@Modifying</code> ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Modifying</span>
<span class="nd">@Query</span><span class="o">(</span><span class="s">"update Product p set p.price = price * 1.1 where p.stockAmount &lt; :stockAmount"</span><span class="o">)</span>
<span class="kt">int</span> <span class="nf">bulkPriceUp</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"stockAmount"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">stockAmount</span><span class="o">);</span>
</code></pre></div></div>
<p>ë²Œí¬ì„± ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ê³  ë‚˜ì„œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì´ˆê¸°í™”í•˜ê³  ì‹¶ìœ¼ë©´ <code class="language-plaintext highlighter-rouge">@Modifying(clearAutomatically = true)</code> ì˜µì…˜ì„ ì¤€ë‹¤.
<br />
<br /></p>

<h3 id="1246-ë°˜í™˜-íƒ€ì…">12.4.6 ë°˜í™˜ íƒ€ì…</h3>
<p>ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” ìœ ì—°í•œ ë°˜í™˜ íƒ€ì…ì„ ì§€ì›í•œë‹¤. í•œ ê±´ ì´ìƒì´ë©´ ì»¬ë ‰ì…˜ì„ ì‚¬ìš©í•˜ê³ , ë‹¨ê±´ì´ë©´ ë°˜í™˜ íƒ€ì…ì„ ì§€ì •í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findByName</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">);</span> <span class="c1">// ì»¬ë ‰ì…˜</span>
<span class="nc">Member</span> <span class="nf">findByEmail</span><span class="o">(</span><span class="nc">String</span> <span class="n">email</span><span class="o">);</span>     <span class="c1">// ë‹¨ê±´</span>
</code></pre></div></div>

<p><strong>ì¡°íšŒ ê²°ê³¼ê°€ ì—†ì„ ì‹œ</strong></p>
<ul>
  <li>ì»¬ë ‰ì…˜: ë¹ˆ ì»¬ë ‰ì…˜ ë°˜í™˜</li>
  <li>ë‹¨ê±´: <code class="language-plaintext highlighter-rouge">null</code> ë°˜í™˜</li>
</ul>

<p><strong>ì¡°íšŒ ê²°ê³¼ 1ê±´</strong></p>
<ul>
  <li>ì»¬ë ‰ì…˜: 1ê±´ì˜ ë°ì´í„°ë¥¼ ê°€ì§„ ì»¬ë ‰ì…˜ ë°˜í™˜</li>
  <li>ë‹¨ê±´: ë°ì´í„° ë°˜í™˜</li>
</ul>

<p><strong>ì¡°íšŒ ê²°ê³¼ 2ê±´ ì´ìƒ</strong></p>
<ul>
  <li>ì»¬ë ‰ì…˜: 2ê±´ ì´ìƒ ë°ì´í„°ë¥¼ ê°€ì§„ ì»¬ë ‰ì…˜ ë°˜í™˜</li>
  <li>ë‹¨ê±´: ì˜ˆì™¸ ë°œìƒ</li>
</ul>

<p><br /></p>

<h3 id="1247-í˜ì´ì§•ê³¼-ì •ë ¬">12.4.7 í˜ì´ì§•ê³¼ ì •ë ¬</h3>
<p>ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” ì¿¼ë¦¬ ë©”ì†Œë“œì— í˜ì´ì§•ê³¼ ì •ë ¬ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ 2ê°€ì§€ íŒŒë¼ë¯¸í„°ë¥¼ ì œê³µí•œë‹¤.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">org.springframework.data.domain.Sort</code>: ì •ë ¬ê¸°ëŠ¥</li>
  <li><code class="language-plaintext highlighter-rouge">org.springframework.data.domain.Pageable</code>: í˜ì´ì§• ê¸°ëŠ¥(ë‚´ë¶€ì— Sort í¬í•¨)</li>
</ul>

<p><strong>í˜ì´ì§•ê³¼ ì •ë ¬ ì‚¬ìš© ì˜ˆ</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// count ì¿¼ë¦¬ ì‚¬ìš©</span>
<span class="nc">Page</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findByName</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">Pageable</span> <span class="n">pageable</span><span class="o">);</span>

<span class="c1">// count ì¿¼ë¦¬ ì‚¬ìš© ì•ˆ í•¨</span>
<span class="c1">// totalì„ ì œì™¸í•œ Pageì—ì„œ ì œê³µí•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ ì‚¬ìš© ê°€ëŠ¥</span>
<span class="nc">Slice</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findByName</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">Pageable</span> <span class="n">pageable</span><span class="o">);</span>

<span class="c1">// count ì¿¼ë¦¬ ì‚¬ìš© ì•ˆ í•¨</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findByName</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">Pageable</span> <span class="n">pageable</span><span class="o">);</span>

<span class="c1">// ì •ë ¬</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findByName</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">Sort</span> <span class="n">sort</span><span class="o">);</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì‚¬ìš© ë°©ë²•</span>
<span class="nc">PageRequest</span> <span class="n">pageRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PageRequest</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Sort</span><span class="o">(</span><span class="nc">Direction</span><span class="o">.</span><span class="na">DESC</span><span class="o">,</span> <span class="s">"name"</span><span class="o">));</span>
<span class="nc">Page</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">.</span><span class="na">findByName</span><span class="o">(</span><span class="s">"ê¹€"</span><span class="o">,</span> <span class="n">pageRequest</span><span class="o">);</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>Slice ì¸í„°í˜ì´ìŠ¤</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Slice</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="nc">Streamable</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="nf">getNumber</span><span class="o">();</span> <span class="c1">// í˜„ì¬ í˜ì´ì§€</span>
    <span class="kt">int</span> <span class="nf">getSize</span><span class="o">();</span> <span class="c1">//í˜ì´ì§€ í¬ê¸°</span>
    <span class="kt">int</span> <span class="nf">getNumberOfElements</span><span class="o">();</span> <span class="c1">// í˜„ì¬ í˜ì´ì§€ì— ì¡°íšŒí•œ ë°ì´í„° ê°œìˆ˜</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">getContent</span><span class="o">();</span> <span class="c1">// í˜„ì¬ í˜ì´ì§€ì— ì¡°íšŒí•œ ë°ì´í„° </span>
    <span class="kt">boolean</span> <span class="nf">hasContent</span><span class="o">();</span> <span class="c1">// í˜„ì¬ í˜ì´ì§€ì— ë°ì´í„°ê°€ ìˆëŠ”ì§€ ì—¬ë¶€ </span>
    <span class="nc">Sort</span> <span class="nf">getSort</span><span class="o">();</span> <span class="c1">// ì •ë ¬ ì—¬ë¶€ </span>
    <span class="kt">boolean</span> <span class="nf">isFirst</span><span class="o">();</span> <span class="c1">// ì²« ë²ˆì§¸ í˜ì´ì§€ì¸ì§€ ì—¬ë¶€</span>
    <span class="kt">boolean</span> <span class="nf">isLast</span><span class="o">();</span> <span class="c1">// ë§ˆì§€ë§‰ í˜ì´ì§€ì¸ì§€ ì—¬ë¶€</span>
    <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">();</span> <span class="c1">// ë‹¤ìŒ í˜ì´ì§€ê°€ ìˆëŠ”ì§€ ì—¬ë¶€</span>
    <span class="kt">boolean</span> <span class="nf">hasPrevious</span><span class="o">();</span>  <span class="c1">// ì´ì „ í˜ì´ì§€ê°€ ìˆëŠ”ì§€ ì—¬ë¶€ </span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>Page ì¸í„°í˜ì´ìŠ¤</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Page</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="nc">Slice</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nc">Page</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">empty</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">empty</span><span class="o">(</span><span class="nc">Pageable</span><span class="o">.</span><span class="na">unpaged</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nc">Page</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">empty</span><span class="o">(</span><span class="nc">Pageable</span> <span class="n">pageable</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">PageImpl</span><span class="o">&lt;&gt;(</span><span class="nc">Collections</span><span class="o">.</span><span class="na">emptyList</span><span class="o">(),</span> <span class="n">pageable</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kt">int</span> <span class="nf">getTotalPages</span><span class="o">();</span>     <span class="c1">// ì „ì²´ í˜ì´ì§€ ê°œìˆ˜</span>
    <span class="kt">long</span> <span class="nf">getTotalElements</span><span class="o">();</span> <span class="c1">// ì „ì²´ ë°ì´í„° ê°œìˆ˜</span>
    <span class="o">&lt;</span><span class="no">U</span><span class="o">&gt;</span> <span class="nc">Page</span><span class="o">&lt;</span><span class="no">U</span><span class="o">&gt;</span> <span class="nf">map</span><span class="o">(</span><span class="nc">Function</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="no">T</span><span class="o">,</span> <span class="o">?</span> <span class="kd">extends</span> <span class="no">U</span><span class="o">&gt;</span> <span class="n">converter</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1248-íŒíŠ¸">12.4.8 íŒíŠ¸</h3>
<p><code class="language-plaintext highlighter-rouge">JPA</code> ì¿¼ë¦¬ íŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ <code class="language-plaintext highlighter-rouge">@QueryHint</code>ì–´ë…¸ì—í‹°ì…˜ì„ ì‚¬ìš©í•œë‹¤. ì´ê²ƒì€ <code class="language-plaintext highlighter-rouge">SQL</code> íŒíŠ¸ê°€ ì•„ë‹ˆë¼ <code class="language-plaintext highlighter-rouge">JPA</code>êµ¬í˜„ì²´ì—ê²Œ ì œê³µí•˜ëŠ” íŒíŠ¸ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@QueryHints</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nd">@QueryHint</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"org.hibernate.readOnly"</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="o">})</span>
<span class="nc">Page</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findByName</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">Pageable</span> <span class="n">pageable</span><span class="o">);</span>
</code></pre></div></div>
<p><br />
<br />
<br /></p>

<h2 id="125-ëª…ì„¸">12.5 ëª…ì„¸</h2>
<p>ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” <code class="language-plaintext highlighter-rouge">JPA Criteria</code>ë¡œ ëª…ì„¸(<code class="language-plaintext highlighter-rouge">SPECIFICATION</code>)ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•œë‹¤.
<a href="/etc/books/ë„ë©”ì¸ì£¼ë„ê°œë°œì‹œì‘í•˜ê¸°/#5-ìŠ¤í”„ë§-ë°ì´í„°-jpaë¥¼-ì´ìš©í•œ-ì¡°íšŒ-ê¸°ëŠ¥" target="_blank">ìŠ¤í”„ë§ ë°ì´í„° JPAë¥¼ ì´ìš©í•œ ì¡°íšŒ ê¸°ëŠ¥</a> ì°¸ê³ 
<br />
<br />
<br /></p>

<h2 id="126-ì‚¬ìš©ì-ì •ì˜-ë¦¬í¬ì§€í† ë¦¬-êµ¬í˜„">12.6 ì‚¬ìš©ì ì •ì˜ ë¦¬í¬ì§€í† ë¦¬ êµ¬í˜„</h2>
<p>ìŠ¤í”„ë§ ë°ì´í„° JPAë¡œ ë¦¬í¬ì§€í† ë¦¬ë¥¼ ê°œë°œí•˜ë©´ ì¸í„°í˜ì´ìŠ¤ë§Œ ì •ì˜í•˜ê³  êµ¬í˜„ì²´ëŠ” ë§Œë“¤ì§€ ì•ŠëŠ”ë‹¤. í•˜ì§€ë§Œ ë©”ì†Œë“œë¥¼ ì§ì ‘ êµ¬í˜„í•´ì•¼ í•  ë•Œë„ ìˆë‹¤.</p>

<p><strong>ì‚¬ìš©ì ì •ì˜ ì¸í„°í˜ì´ìŠ¤ ìƒì„±</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì¸í„°í˜ì´ìŠ¤ ì´ë¦„ì€ ììœ ë¡­ê²Œ ì‘ì„± ê°€ëŠ¥</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberRepositoryCustom</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findMemberCustom</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ì‚¬ìš©ì ì •ì˜ êµ¬í˜„ í´ë˜ìŠ¤</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * í´ë˜ìŠ¤ ì´ë¦„ì€ ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„ + Implë¡œ ì§€ì–´ì•¼ í•œë‹¤. 
 * ê·¸ëŸ¬ë©´ ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ ì‚¬ìš©ì ì •ì˜ êµ¬í˜„ í´ë˜ìŠ¤ë¡œ ì¸ì‹í•œë‹¤.
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberRepositoryImpl</span> <span class="kd">implements</span> <span class="n">c</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findMemberCustom</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// ì‚¬ìš©ì ì •ì˜ êµ¬í˜„...</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ì‚¬ìš©ì ì •ì˜ ì¸í„°í˜ì´ìŠ¤ ìƒì†</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberRepository</span>
    <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;,</span> <span class="nc">MemberRepositoryCustom</span> <span class="o">{}</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ì‚¬ìš©ì ì •ì˜ êµ¬í˜„ í´ë˜ìŠ¤ ì´ë¦„ ê·œì¹™ ë³€ê²½</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;jpa:repositories</span> <span class="na">base-package=</span><span class="s">"jpabook.jpashop.repository"</span>
    <span class="na">repository-impl-postfix=</span><span class="s">"Impl"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="nd">@EnableJpaRepositories</span><span class="o">(</span>
    <span class="n">basePackage</span> <span class="o">=</span> <span class="s">"jpabook.jpashop.repository"</span><span class="o">,</span>
    <span class="n">repositoryImplPostfix</span> <span class="o">=</span> <span class="s">"Impl"</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AppConfig</span> <span class="o">{}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h2 id="127-web-í™•ì¥">12.7 Web í™•ì¥</h2>
<p>ìŠ¤í”„ë§ ë°ì´í„° í”„ë¡œì íŠ¸ëŠ” ìŠ¤í”„ë§ MVCì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í¸ë¦¬í•œ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.</p>

<h3 id="1271-ì„¤ì •">12.7.1 ì„¤ì •</h3>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.springframework.data.web.config.SpringDataWebConfiguration"</span><span class="nt">&gt;</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="nd">@EnableWebMvc</span>
<span class="nd">@EnableSpringDataWebSupport</span> <span class="c1">// ì¶”ê°€</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WebAppConfig</span> <span class="o">{...}</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="1272-ë„ë©”ì¸-í´ë˜ìŠ¤-ì»¨ë²„í„°-ê¸°ëŠ¥">12.7.2 ë„ë©”ì¸ í´ë˜ìŠ¤ ì»¨ë²„í„° ê¸°ëŠ¥</h3>
<p>ë„ë©”ì¸ í´ë˜ìŠ¤ ì»¨ë²„í„°ëŠ” HTTP íŒŒë¼ë¯¸í„°ë¡œ ë„˜ì–´ì˜¨ ì—”í‹°í‹°ì˜ ì•„ì´ë””ë¡œ ì—”í‹°í‹° ê°ì²´ë¥¼ ì°¾ì•„ì„œ ë°”ì¸ë”© í•´ì¤€ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// URL: /member/memberUpdateForm?id=1</span>

<span class="nd">@Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberController</span> <span class="o">{</span>
    
    <span class="nd">@RequestMepping</span><span class="o">(</span><span class="s">"member/memberUpdateForm"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">memberUpdateForm</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="s">"id"</span><span class="o">)</span> <span class="nc">Member</span> <span class="n">member</span><span class="o">,</span> <span class="nc">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"member"</span><span class="o">,</span> <span class="n">member</span><span class="o">);</span>
        <span class="k">return</span> <span class="s">"member/memberSaveForm"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p class="notice--warning"><strong>âš ì£¼ì˜</strong><br />
ë„ë©”ì¸ í´ë˜ìŠ¤ ì»¨ë²„í„°ë¥¼ í†µí•´ ë„˜ì–´ì˜¨ ì—”í‹°í‹°ë¥¼ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì§ì ‘ ìˆ˜ì •í•´ë„ ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ì—ëŠ” ë°˜ì˜ë˜ì§€ ì•ŠëŠ”ë‹¤. ì´ê²ƒì€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë™ì‘ ë°©ì‹ê³¼ ê´€ë ¨ì´ ìˆë‹¤. ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë™ì‘ ë°©ì‹ê³¼ OSIVì— ê´€í•œ ë‚´ìš©ì„ ì•Œì•„ì•¼ í•œë‹¤.</p>
<p><br />
<br /></p>

<h3 id="1273-í˜ì´ì§•ê³¼-ì •ë ¬-ê¸°ëŠ¥">12.7.3 í˜ì´ì§•ê³¼ ì •ë ¬ ê¸°ëŠ¥</h3>
<p>ìŠ¤í”„ë§ ë°ì´í„°ê°€ ì œê³µí•˜ëŠ” í˜ì´ì§•ê³¼ ì •ë ¬ ê¸°ëŠ¥ì„ ìŠ¤í”„ë§ MVCì—ì„œ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberController</span> <span class="o">{</span>
    
    <span class="c1">// íŒŒë¼ë¯¸í„°ë¡œ Pageableë¥¼ ë°›ëŠ”ë‹¤</span>
    <span class="nd">@RequestMepping</span><span class="o">(</span><span class="s">"members"</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="nc">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">list</span><span class="o">(</span><span class="nc">Pageable</span> <span class="n">pageable</span><span class="o">,</span> <span class="nc">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">page</span> <span class="o">=</span> <span class="n">memberService</span><span class="o">.</span><span class="na">findMembers</span><span class="o">(</span><span class="n">pageable</span><span class="o">);</span>
        <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"member"</span><span class="o">,</span> <span class="n">page</span><span class="o">.</span><span class="na">getContent</span><span class="o">());</span>
        <span class="k">return</span> <span class="s">"member/memberList"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">// ì˜ˆ) /members?page=0&amp;size=20&amp;sort=name,desc&amp;sort=address.city</span>
</code></pre></div></div>

<div class="notice--info">
<p><strong>ìš”ì²­ íŒŒë¼ë¯¸í„°</strong></p>
<ul>
  <li>page: í˜„ì¬ í˜ì´ì§€, 0ë¶€í„° ì‹œì‘</li>
  <li>size: í•œ í˜ì´ì§€ì— ë…¸ì¶œí•  ë°ì´í„° ê±´ìˆ˜</li>
  <li>sort: ì •ë ¬ ì¡°ê±´ì„ ì •ì˜</li>
</ul>
</div>

<div class="notice--info">
<p><strong>ì°¸ê³ </strong><br />
í˜ì´ì§€ë¥¼ 1ë¶€í„° ì‹œì‘í•˜ê³  ì‹¶ìœ¼ë©´ PageableHandlerMethodArgumentResolverë¥¼ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ì§ì ‘ ë“±ë¡í•˜ê³  setOneIndexedParametersë¥¼ trueë¡œ ì„¤ì •í•˜ë©´ ëœë‹¤.</p>
</div>
<p><br /></p>

<p><strong>ì ‘ë‘ì‚¬</strong><br />
ì‚¬ìš©í•´ì•¼ í•  í˜ì´ì§• ì •ë³´ê°€ ë‘˜ ì´ìƒì´ë©´ ì ‘ë‘ì‚¬ë¥¼ ì‚¬ìš©í•´ì„œ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">String</span> <span class="nf">list</span><span class="o">(</span>
    <span class="nd">@Qualifier</span><span class="o">(</span><span class="s">"member"</span><span class="o">)</span> <span class="n">pageable</span> <span class="n">memberPageable</span><span class="o">,</span>
    <span class="nd">@Qualifier</span><span class="o">(</span><span class="s">"order"</span><span class="o">)</span> <span class="n">pageable</span> <span class="n">orderPageable</span><span class="o">.</span>
    <span class="o">...</span>
<span class="o">)</span>
<span class="c1">// ì˜ˆ) /members?member_page=0&amp;order_page=1</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ê¸°ë³¸ê°’</strong><br />
<code class="language-plaintext highlighter-rouge">Pageable</code>ì˜ ê¸°ë³¸ê°’ì€ <code class="language-plaintext highlighter-rouge">page=0</code>, <code class="language-plaintext highlighter-rouge">size=20</code>ì´ë‹¤. ë§Œì•½ ê¸°ë³¸ê°’ì„ ë³€ê²½í•˜ê³  ì‹¶ìœ¼ë©´ <code class="language-plaintext highlighter-rouge">@PageableDefault</code> ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RequestMepping</span><span class="o">(</span><span class="s">"members_page"</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="nc">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">list</span><span class="o">(</span><span class="nd">@PageableDefault</span><span class="o">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="o">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="s">"name"</span><span class="o">,</span> 
    <span class="n">direction</span> <span class="o">=</span> <span class="nc">Sort</span><span class="o">.</span><span class="na">Direction</span><span class="o">.</span><span class="na">DESC</span><span class="o">)</span> <span class="nc">Pageable</span> <span class="n">pageable</span> <span class="o">{</span>
        <span class="o">...</span>
    <span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h2 id="128-ìŠ¤í”„ë§-ë°ì´í„°-jpaê°€-ì‚¬ìš©í•˜ëŠ”-êµ¬í˜„ì²´">12.8 ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ ì‚¬ìš©í•˜ëŠ” êµ¬í˜„ì²´</h2>
<p><strong>ë‚´ìš© ìƒëµ ğŸ˜…</strong></p>

<h2 id="129-jpa-ìƒµì—-ì ìš©">12.9 JPA ìƒµì— ì ìš©</h2>
<p><strong>ë‚´ìš© ìƒëµ ğŸ˜…</strong></p>

<h2 id="1210-ìŠ¤í”„ë§-ë°ì´í„°-jpaì™€-querydsl-í†µí•©">12.10 ìŠ¤í”„ë§ ë°ì´í„° JPAì™€ QueryDSL í†µí•©</h2>
<p>ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” 2ê°€ì§€ ë°©ë²•ìœ¼ë¡œ QueryDSLì„ ì§€ì›í•œë‹¤.</p>

<h3 id="12101-querydslpredicateexecutor-ì‚¬ìš©">12.10.1 QueryDslPredicateExecutor ì‚¬ìš©</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ë ˆí¬ì§€í† ë¦¬ì—ì„œ QueryDslPredicateExecutor ìƒì†</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ItemRepository</span>
    <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Item</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;,</span> <span class="nc">QueryDslPredicateExecutor</span><span class="o">&lt;</span><span class="nc">Item</span><span class="o">&gt;</span> <span class="o">{...}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì‚¬ìš©</span>
<span class="nc">QItem</span> <span class="n">item</span> <span class="o">=</span> <span class="nc">QItem</span><span class="o">.</span><span class="na">item</span><span class="o">;</span>
<span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">Item</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">itemRepository</span><span class="o">.</span><span class="na">findAll</span><span class="o">(</span>
    <span class="n">item</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"ì¥ë‚œê°"</span><span class="o">).</span><span class="na">and</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">.</span><span class="na">between</span><span class="o">(</span><span class="mi">10000</span><span class="o">,</span> <span class="mi">20000</span><span class="o">))</span>
<span class="o">);</span>
</code></pre></div></div>

<div class="notice--warning">
<p><strong>âš ï¸ê²½ê³ </strong><br />
QueryDslPredicateExecutorëŠ” ê¸°ëŠ¥ì˜ í•œê³„ê°€ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ join, fetchë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.</p>
</div>
<p><br /></p>

<h3 id="12102-querydslrepositorysupport-ì‚¬ìš©">12.10.2 QueryDslRepositorySupport ì‚¬ìš©</h3>
<p><code class="language-plaintext highlighter-rouge">QueryDSL</code>ì˜ ëª¨ë“  ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ <code class="language-plaintext highlighter-rouge">JPAQuery</code> ê°ì²´ë¥¼ ì§ì ‘ ìƒì„±í•´ì„œ ì‚¬ìš©í•˜ë©´ ëœë‹¤. ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ ì œê³µí•˜ëŠ” <code class="language-plaintext highlighter-rouge">QueryDslRepositorySupport</code>ë¥¼ ìƒì† ë°›ì•„ ì‚¬ìš©í•˜ë©´ í¸ë¦¬í•˜ê²Œ <code class="language-plaintext highlighter-rouge">QueryDSL</code>ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì‚¬ìš©ì ì •ì˜ ë ˆí¬ì§€í† ë¦¬</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CustomOrderRepository</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="nf">search</span><span class="o">(</span><span class="nc">OrderSearch</span> <span class="n">orderSearch</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderRepositoryImpl</span> <span class="kd">extends</span> <span class="nc">QueryDslRepositorySupport</span>
        <span class="kd">implements</span> <span class="nc">CustomOrderRepository</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">OrderRepositoryImpl</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="nf">search</span><span class="o">(</span><span class="nc">OrderSearch</span> <span class="n">orderSearch</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">QOrder</span> <span class="n">order</span> <span class="o">=</span> <span class="nc">QOrder</span><span class="o">.</span><span class="na">order</span><span class="o">;</span>
        <span class="nc">QMember</span> <span class="n">member</span> <span class="o">=</span> <span class="nc">QMember</span><span class="o">.</span><span class="na">member</span><span class="o">;</span>

        <span class="nc">JPAQuery</span> <span class="n">query</span> <span class="o">=</span> <span class="n">from</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
        <span class="c1">// ê²€ìƒ‰ ì¡°ê±´ ì¿¼ë¦¬...</span>
        <span class="k">return</span> <span class="n">query</span><span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br />
<br />
<br />
<br /></p>

<h1 id="13-ì›¹-ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼-ì˜ì†ì„±-ê´€ë¦¬">13. ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ì˜ì†ì„± ê´€ë¦¬</h1>
<p>ì»¨í…Œì´ë„ˆ í™˜ê²½ì—ì„œ JPAê°€ ë™ì‘í•˜ëŠ” ë°©ì‹ì„ ì´í•´í•˜ê³ , ì»¨í…Œì´ë„ˆ í™˜ê²½ì—ì„œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•  ë•Œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë¬¸ì œì ê³¼ í•´ê²°ë°©ì•ˆì„ ì•Œì•„ë³¸ë‹¤.<br />
<br /></p>

<h2 id="131-íŠ¸ëœì­ì…˜-ë²”ìœ„ì˜-ì˜ì†ì„±-ì»¨í…ìŠ¤íŠ¸">13.1 íŠ¸ëœì­ì…˜ ë²”ìœ„ì˜ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸</h2>
<p>ìŠ¤í”„ë§ì´ë‚˜ J2EE ì»¨í…Œì´ë„ˆ í™˜ê²½ì—ì„œ JPAë¥¼ ì‚¬ìš©í•˜ë©´ ì»¨í…Œì´ë„ˆê°€ ì œê³µí•˜ëŠ” ì „ëµì„ ë”°ë¼ì•¼ í•œë‹¤.<br />
<br /></p>

<h3 id="1311-ìŠ¤í”„ë§-ì»¨í…Œì´ë„ˆì˜-ê¸°ë³¸-ì „ëµ">13.1.1 ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì˜ ê¸°ë³¸ ì „ëµ</h3>
<p>ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” <strong>íŠ¸ëœì­ì…˜ ë²”ìœ„ì˜ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ì „ëµ</strong>ì„ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.</p>
<center><img src="/assets/images/posts/books/2/13_1_íŠ¸ëœì­ì…˜ë²”ìœ„ì˜ì˜ì†ì„±ì»¨í…ìŠ¤íŠ¸.png" /></center>
<p><br /></p>

<p>ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ë©´ ë³´í†µ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì‹œì‘í•˜ëŠ” ì„œë¹„ìŠ¤ ê³„ì¸µì— <code class="language-plaintext highlighter-rouge">@Transactional</code> ì–´ë…¸í…Œì´ì…˜ì„ ì„ ì–¸í•´ì„œ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•œë‹¤.</p>
<center><img src="/assets/images/posts/books/2/13_1_íŠ¸ëœì­ì…˜ë²”ìœ„ì˜ì˜ì†ì„±ì»¨í…ìŠ¤íŠ¸2.png" /></center>
<p><br /></p>

<p><strong>íŠ¸ë Œì­ì…˜ì´ ê°™ìœ¼ë©´ ê°™ì€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•œë‹¤.</strong></p>
<center><img src="/assets/images/posts/books/2/13_1_íŠ¸ëœì­ì…˜ê³¼ì˜ì†ì„±ì»¨í…ìŠ¤íŠ¸1.png" /></center>
<p><br /></p>

<p><strong>íŠ¸ëœì­ì…˜ì´ ë‹¤ë¥´ë©´ ë‹¤ë¥¸ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•œë‹¤.</strong></p>
<center><img src="/assets/images/posts/books/2/13_1_íŠ¸ëœì­ì…˜ê³¼ì˜ì†ì„±ì»¨í…ìŠ¤íŠ¸2.png" /></center>
<p><br />
<br /></p>

<h2 id="132-ì¤€ì˜ì†-ìƒíƒœì™€-ì§€ì—°-ë¡œë”©">13.2 ì¤€ì˜ì† ìƒíƒœì™€ ì§€ì—° ë¡œë”©</h2>
<p>ì»¨í…Œì´ë„ˆ í™˜ê²½ì˜ ê¸°ë³¸ ì „ëµì¸ íŠ¸ëœì­ì…˜ ë²”ìœ„ì˜ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ì „ëµì„ ì‚¬ìš©í•˜ë©´ íŠ¸ëœì­ì…˜ì´ ì—†ëŠ” <strong>í”„ë¦¬ì  í…Œì´ì…˜ ê³„ì¸µì—ì„œ ì—”í‹°í‹°ëŠ” ì¤€ì˜ì† ìƒíƒœ</strong>ë‹¤. ë”°ë¼ì„œ <strong>ë³€ê²½ ê°ì§€ì™€ ì§€ì—° ë¡œë”©ì´ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.</strong></p>

<p>ì¤€ì˜ì† ìƒíƒœì—ì„œ ì§€ì—°ë¡œë”©ì„ ì‹œë„í•˜ë©´ <code class="language-plaintext highlighter-rouge">org.hibernate.LazyInitializationException</code> ì˜ˆì™¸ê°€ ë°œìƒí•œë‹¤.</p>

<p><strong>ì¤€ì˜ì† ìƒíƒœì˜ ì§€ì—° ë¡œë”© í•´ê²° ë°©ë²•</strong></p>
<ol>
  <li>ë·°ê°€ í•„ìš”í•œ ì—”í‹°í‹°ë¥¼ ë¯¸ë¦¬ ë¡œë”©í•´ë‘ëŠ” ë°©ë²•
    <ul>
      <li>ê¸€ë¡œë²Œ í˜ì¹˜ ì „ëµ ìˆ˜ì •</li>
      <li>JPQL í˜ì¹˜ ì¡°ì¸ (fetch join)</li>
      <li>ê°•ì œë¡œ ì´ˆê¸°í™”</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">OSIV(open session in view)</code>ë¥¼ ì‚¬ìš©í•´ì„œ ì—”í‹°í‹°ë¥¼ ì˜ì† ìƒíƒœë¡œ ìœ ì§€í•˜ëŠ” ë°©ë²•
<br />
<br /></li>
</ol>

<h3 id="1321-ê¸€ë¡œë²Œ-í˜ì¹˜-ì „ëµ-ìˆ˜ì •">13.2.1 ê¸€ë¡œë²Œ í˜ì¹˜ ì „ëµ ìˆ˜ì •</h3>
<p><strong>ì¦‰ì‹œ ë¡œë”© ì„¤ì •</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ManyToOne</span><span class="o">(</span><span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">EAGER</span><span class="o">)</span>
</code></pre></div></div>
<p>í•˜ì§€ë§Œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì—”í‹°í‹°ë¥¼ ë¡œë”©í•˜ëŠ” ë‹¨ì ì´ ìˆë‹¤. ë˜ JPQLì—ì„œ N+1 ë¬¸ì œê°€ ë°œìƒí•œë‹¤.(í˜ì¹˜ ì¡°ì¸ìœ¼ë¡œ í•´ê²° ê°€ëŠ¥)<br />
<br />
<br /></p>

<h3 id="1322-jpql-í˜ì¹˜-ì¡°ì¸">13.2.2 JPQL í˜ì¹˜ ì¡°ì¸</h3>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- JPQL fetch</span>
<span class="k">select</span> <span class="n">o</span> <span class="k">from</span> <span class="k">Order</span> <span class="n">o</span> <span class="k">join</span> <span class="k">fetch</span> <span class="n">o</span><span class="p">.</span><span class="n">member</span>
</code></pre></div></div>
<p>ë¬´ë¶„ë³„í•˜ê²Œ ì‚¬ìš©í•˜ë©´ í™”ë©´ì— ë§ì¶˜ ë¦¬í¬ì§€í† ë¦¬ ë©”ì†Œë“œê°€ ì¦ê°€í•  ìˆ˜ ìˆë‹¤. ê²°êµ­ <strong>í”„ë¦¬ì  í…Œì´ì…˜ ê³„ì¸µì´ ì•Œê²Œ ëª¨ë¥´ê²Œ ë°ì´í„° ì ‘ê·¼ ê³„ì¸µì„ ì¹¨ë²”í•˜ê²Œ ëœë‹¤.</strong>
<br />
<br /></p>

<h3 id="1323-ê°•ì œë¡œ-ì´ˆê¸°í™”">13.2.3 ê°•ì œë¡œ ì´ˆê¸°í™”</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="nc">Order</span> <span class="nf">findOrder</span><span class="o">(</span><span class="n">id</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="n">orderRepository</span><span class="o">.</span><span class="na">findOrder</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="n">order</span><span class="o">.</span><span class="na">getMember</span><span class="o">().</span><span class="na">getName</span><span class="o">();</span> <span class="c1">// í”„ë¡ì‹œ ê°•ì œë¡œ ì´ˆê¸°í™”</span>
    <span class="k">return</span> <span class="n">order</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p>í•˜ì§€ë§Œ í”„ë¡ì‹œë¥¼ ì´ˆê¸°í™”í•˜ëŠ” ì—­í• ì„ ì„œë¹„ìŠ¤ ê³„ì¸µì´ ë‹´ë‹¹í•˜ë©´ ë·°ê°€ í•„ìš”í•œ ì—”í‹°í‹°ì— ë”°ë¼ ì„œë¹„ìŠ¤ ê³„ì¸µì˜ ë¡œì§ì„ ë³€ê²½í•´ì•¼ í•œë‹¤. <strong>í”„ë¦¬ì  í…Œì´ì…˜ ê³„ì¸µì´ ì•Œê²Œ ëª¨ë¥´ê²Œ ì„œë¹„ìŠ¤ ê³„ì¸µì„ ì¹¨ë²”í•˜ê²Œ ëœë‹¤.</strong>
<br />
<br /></p>

<h3 id="1324-facade-ê³„ì¸µ-ì¶”ê°€">13.2.4 FACADE ê³„ì¸µ ì¶”ê°€</h3>
<center><img src="/assets/images/posts/books/2/13_1_facade.png" /></center>

<p><strong>FACADE ê³„ì¸µì˜ ì—­í• ê³¼ íŠ¹ì§•</strong></p>
<ul>
  <li>í”„ë ˆì  í…Œì´ì…˜ ê³„ì¸µê³¼ ë„ë©”ì¸ ëª¨ë¸ ê³„ì¸µ ê°„ì˜ ë…¼ë¦¬ì  ì˜ì¡´ì„±ì„ ë¶„ë¦¬í•´ì¤€ë‹¤.</li>
  <li>í”„ë¦¬ì  í…Œì´ì…˜ ê³„ì¸µì—ì„œ í•„ìš”í•œ í”„ë¡ì‹œ ê°ì²´ë¥¼ ì´ˆê¸°í™”í•œë‹¤.</li>
  <li>ì„œë¹„ìŠ¤ ê³„ì¸µì„ í˜¸ì¶œí•´ì„œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì‹¤í–‰í•œë‹¤.</li>
  <li>ë¦¬í¬ì§€í† ë¦¬ë¥¼ ì§ì ‘ í˜¸ì¶œí•´ì„œ ë·°ê°€ ìš”êµ¬í•˜ëŠ” ì—”í‹°í‹°ë¥¼ ì°¾ëŠ”ë‹¤.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">OrderFacade</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="nc">OrderService</span> <span class="n">orderService</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nc">Order</span> <span class="nf">findOrder</span><span class="o">(</span><span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="n">orderService</span><span class="o">.</span><span class="na">findOrder</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
        <span class="n">order</span><span class="o">.</span><span class="na">getMember</span><span class="o">().</span><span class="na">getName</span><span class="o">();</span> <span class="c1">// í”„ë¡ì‹œ ê°•ì œë¡œ ì´ˆê¸°í™”</span>
        <span class="k">return</span> <span class="n">order</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">OrderService</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nc">Order</span> <span class="nf">findOrder</span><span class="o">(</span><span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">orderRepository</span><span class="o">.</span><span class="na">findOrder</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>í•˜ì§€ë§Œ ì¤‘ê°„ì— ê³„ì¸µì´ í•˜ë‚˜ ë” ë¼ì–´ë“¤ê²Œ ë˜ê³ , <strong>ê²°êµ­ ë” ë§ì€ ì½”ë“œë¥¼ ì‘ì„±</strong>í•´ì•¼ í•œë‹¤. ê·¸ë¦¬ê³  <code class="language-plaintext highlighter-rouge">FACADE</code>ì—ëŠ” ë‹¨ìˆœíˆ ì„œë¹„ìŠ¤ ê³„ì¸µì„ í˜¸ì¶œë§Œ í•˜ëŠ” ìœ„ì„ ì½”ë“œê°€ ìƒë‹¹íˆ ë§ì„ ê²ƒì´ë‹¤.
<br />
<br /></p>

<h3 id="1325-ì¤€ì˜ì†-ìƒíƒœì™€-ì§€ì—°-ë¡œë”©ì˜-ë¬¸ì œì ">13.2.5 ì¤€ì˜ì† ìƒíƒœì™€ ì§€ì—° ë¡œë”©ì˜ ë¬¸ì œì </h3>
<p>ê²°êµ­ ëª¨ë“  ë¬¸ì œëŠ” ì—”í‹°í‹°ê°€ í”„ë¦¬ì  í…Œì´ì…˜ ê³„ì¸µì—ì„œ ì¤€ì˜ì† ìƒíƒœì´ê¸° ë•Œë¬¸ì— ë°œìƒí•œë‹¤.
<br />
<br /></p>

<h2 id="133-osiv">13.3 OSIV</h2>
<p>OSIV(Open Session In View)ëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ë·°ê¹Œì§€ ì—´ì–´ë‘”ë‹¤ëŠ” ëœ»ì´ë‹¤.</p>

<div class="notice--info">
<p><strong>ì°¸ê³ </strong><br />
OSIVëŠ” í•˜ì´ë²„ë„¤ì´íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ìš©ì–´ë‹¤. JPAì—ì„œëŠ” OEIV(Open EntityManager In View)ë¼ê³  í•œë‹¤. í•˜ì§€ë§Œ ê´€ë¡€ìƒ ëª¨ë‘ OSIVë¡œ ë¶€ë¥¸ë‹¤.</p>
</div>
<p><br />
<br /></p>

<h3 id="1331-ê³¼ê±°-osiv-ìš”ì²­-ë‹¹-íŠ¸ëœì­ì…˜">13.3.1 ê³¼ê±° OSIV: ìš”ì²­ ë‹¹ íŠ¸ëœì­ì…˜</h3>
<p>í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì´ ë“¤ì–´ì˜¤ìë§ˆì ì„œë¸”ë¦¿ í•„í„°ë‚˜ ìŠ¤í”„ë§ ì¸í„°ì…‰í„°ì—ì„œ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ê³  ìš”ì²­ì´ ëë‚  ë•Œ íŠ¸ëœì­ì…˜ë„ ëë‚´ëŠ” ê²ƒì„ ìš”ì²­ ë‹¹ íŠ¸ëœì­ì…˜ ë°©ì‹ì˜ OSIVë¼ í•œë‹¤.</p>

<center><img src="/assets/images/posts/books/2/13_3_OSIVìš”ì²­ë‹¹íŠ¸ëœì­ì…˜.png" width="100%" height="100%" /></center>
<p><br /></p>

<p><strong>ìš”ì²­ ë‹¹ íŠ¸ëœì­ì…˜ ë°©ì‹ì˜ OSIV ë¬¸ì œì </strong></p>
<ul>
  <li>í”„ë¦¬ì  í…Œì´ì…˜ ê³„ì¸µì´ ì—”í‹°í‹°ë¥¼ ë³€ê²½í•  ìˆ˜ë„ ìˆë‹¤.</li>
  <li>ì—”í‹°í‹°ë¥¼ ë³€ê²½í•˜ë©´ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë³€ê²½ ê°ì§€ ê¸°ëŠ¥ì´ ì‘ë™í•´ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•´ ë²„ë¦°ë‹¤.</li>
</ul>

<p><strong>í”„ë¦¬ì  í…Œì´ì…˜ ê³„ì¸µì—ì„œ ì—”í‹°í‹°ë¥¼ ìˆ˜ì •í•˜ì§€ ëª»í•˜ê²Œ ë§‰ëŠ” ë°©ë²•</strong></p>
<ul>
  <li>ì—”í‹°í‹°ë¥¼ ì½ê¸° ì „ìš© ì¸í„°í˜ì´ìŠ¤ë¡œ ì œê³µ</li>
  <li>ì½ê¸° ì „ìš© ë©”ì†Œë“œë§Œ ê°€ì§€ê³  ìˆë„ë¡ ì—”í‹°í‹° ë˜í•‘</li>
  <li>DTOë§Œ ë°˜í™˜</li>
</ul>

<p><strong>í•˜ì§€ë§Œ ì½”ë“œëŸ‰ì´ ìƒë‹¹íˆ ì¦ê°€í•˜ëŠ” ë‹¨ì ì´ ìˆë‹¤.</strong><br />
<br />
<br /></p>

<h3 id="1332-ìŠ¤í”„ë§-osiv-ë¹„ì¦ˆë‹ˆìŠ¤-ê³„ì¸µ-íŠ¸ëœì­ì…˜">13.3.2 ìŠ¤í”„ë§ OSIV: ë¹„ì¦ˆë‹ˆìŠ¤ ê³„ì¸µ íŠ¸ëœì­ì…˜</h3>
<p>ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ê°€ ì œê³µí•˜ëŠ” OSIVëŠ” <strong>ë¹„ì¦ˆë‹ˆìŠ¤ ê³„ì¸µì—ì„œ íŠ¸ëœì­ì…˜ì„ ì‚¬ìš©í•˜ëŠ” OSIVë‹¤.</strong></p>

<center><img src="/assets/images/posts/books/2/13_3_OSIVë¹„ì¦ˆë‹ˆìŠ¤íŠ¸ëœì­ì…˜.png" width="100%" height="100%" /></center>
<p><br /></p>

<p><strong>ë¹„ì¦ˆë‹ˆìŠ¤ ê³„ì¸µ íŠ¸ëœì­ì…˜ OSIV íŠ¹ì§•</strong></p>
<ul>
  <li>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ í”„ë¦¬ì  í…Œì´ì…˜ ê³„ì¸µê¹Œì§€ ìœ ì§€í•œë‹¤.</li>
  <li>í”„ë¦¬ì  í…Œì´ì…˜ ê³„ì¸µì—ëŠ” íŠ¸ëœì­ì…˜ì´ ì—†ìœ¼ë¯€ë¡œ ì—”í‹°í‹°ë¥¼ ìˆ˜ì •í•  ìˆ˜ ì—†ë‹¤.</li>
  <li>í”„ë¦¬ì  í…Œì´ì…˜ ê³„ì¸µì—ëŠ” íŠ¸ëœì­ì…˜ì´ ì—†ì§€ë§Œ ì½ì„ ìˆ˜ëŠ” ìˆì–´ì„œ(íŠ¸ëœì­ì…˜ ì—†ì´ ì½ê¸°) ì§€ì—° ë¡œë”©ì„ í•  ìˆ˜ ìˆë‹¤.<br />
<br /></li>
</ul>

<p><strong>ìŠ¤í”„ë§ OSIV ì£¼ì˜ì‚¬í•­</strong><br />
í”„ë¦¬ì  í…Œì´ì…˜ ê³„ì¸µì—ì„œ ì—”í‹°í‹°ë¥¼ ìˆ˜ì •í•œ ì§í›„ì— íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ëŠ” ì„œë¹„ìŠ¤ ê³„ì¸µì„ í˜¸ì¶œí•˜ë©´ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ í”ŒëŸ¬ì‹œí•œë‹¤. ì´ ë•Œ <strong>í”„ë¦¬ì  í…Œì´ì…˜ ê³„ì¸µì—ì„œì˜ ì—”í‹°í‹° ìˆ˜ì • ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•˜ëŠ” ë¬¸ì œê°€ ë°œìƒí•œë‹¤.</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MemberController</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">viewMember</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">memberService</span><span class="o">.</span><span class="na">getMember</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
        <span class="n">member</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">"ë³€ê²½"</span><span class="o">);</span> <span class="c1">// ë³€ê²½</span>

        <span class="n">memberService</span><span class="o">.</span><span class="na">biz</span><span class="o">();</span> <span class="c1">// ë¹„ìŠ¤ë‹ˆìŠ¤ ë¡œì§ í˜¸ì¶œ</span>
        <span class="k">return</span> <span class="s">"view"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">MemberService</span> <span class="o">{</span>
    
    <span class="nd">@Transactional</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">biz</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// ...ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<center><img src="/assets/images/posts/books/2/13_3_OSIVì£¼ì˜ì‚¬í•­.png" width="100%" height="100%" /></center>
<p><br /></p>

<p><strong>í•´ê²°ë°©ë²•</strong><br />
ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ë¨¼ì € ìˆ˜í–‰í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MemberController</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">viewMember</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">memberService</span><span class="o">.</span><span class="na">biz</span><span class="o">();</span> <span class="c1">// ë¹„ìŠ¤ë‹ˆìŠ¤ ë¡œì§ ë¨¼ì € í˜¸ì¶œ</span>

        <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">memberService</span><span class="o">.</span><span class="na">getMember</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
        <span class="n">member</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">"ë³€ê²½"</span><span class="o">);</span> <span class="c1">// ë³€ê²½ì„ ë‚˜ì¤‘ì— ìˆ˜í–‰</span>
        <span class="k">return</span> <span class="s">"view"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1333-osiv-ì •ë¦¬">13.3.3 OSIV ì •ë¦¬</h3>

<p><strong>ìŠ¤í”„ë§ OSIVì˜ íŠ¹ì§•</strong></p>
<ul>
  <li>OSIVëŠ” í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì´ ë“¤ì–´ì˜¬ ë•Œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í•´ì„œ ìš”ì²­ì´ ëë‚  ë•Œê¹Œì§€ ê°™ì€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ìœ ì§€í•œë‹¤.</li>
  <li>ì—”í‹°í‹° ìˆ˜ì •ì€ íŠ¸ëœì­ì…˜ì´ ìˆëŠ” ê³„ì¸µì—ì„œë§Œ ë™ì‘í•œë‹¤.</li>
  <li>íŠ¸ëœì­ì…˜ì´ ì—†ëŠ” í”„ë¦¬ì  í…Œì´ì…˜ ê³„ì¸µì€ ì§€ì—° ë¡œë”©ì„ í¬í•¨í•´ì„œ ì¡°íšŒë§Œ í•  ìˆ˜ ìˆë‹¤.<br />
<br /></li>
</ul>

<p><strong>ìŠ¤í”„ë§ OSIVì˜ ë‹¨ì </strong></p>
<ul>
  <li>OSIVë¥¼ ì ìš©í•˜ë©´ ê°™ì€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì—¬ëŸ¬ íŠ¸ëœì­ì…˜ì´ ê³µìœ í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì„ ì£¼ì˜í•´ì•¼ í•œë‹¤. íŠ¹íˆ ë¡¤ë°± ì£¼ì˜</li>
  <li>í”„ë¦¬ì  í…Œì´ì…˜ ê³„ì¸µì—ì„œ ì—”í‹°í‹°ë¥¼ ìˆ˜ì • í›„ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìˆ˜í–‰í•˜ë©´ ì—”í‹°í‹° ìˆ˜ì •ì‚¬í•­ì´ ë°˜ì˜ë  ìˆ˜ ìˆë‹¤.</li>
  <li>ì§€ì—° ë¡œë”©ì— ì˜í•œ ì„±ëŠ¥ íŠœë‹ì‹œì— í™•ì¸í•´ì•¼ í•  ë¶€ë¶„ì´ ë„“ë‹¤.<br />
<br /></li>
</ul>

<p><strong>OSIV vs FACADE vs DTO</strong><br />
FACADEë“  DTOë“  OSIVë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒê³¼ ë¹„êµí•´ì„œ ì§€ë£¨í•œ ì½”ë“œë¥¼ ë§ì´ ì‘ì„±í•´ì•¼ í•œë‹¤.<br />
<br /></p>

<p><strong>OSIVë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ ë§ŒëŠ¥ì€ ì•„ë‹ˆë‹¤</strong><br />
ë³µì¡í•œ í™”ë©´ì—ì„œëŠ” ì²˜ìŒë¶€í„° í™”ë©´ì— ë§ëŠ” JPQLë¡œ í•„ìš”í•œ ë°ì´í„°ë“¤ë§Œ ì¡°íšŒí•´ì„œ DTOë¡œ ë°˜í™˜í•˜ëŠ” ê²ƒì´ ë” ë‚˜ì€ í•´ê²°ì±…ì¼ ìˆ˜ ìˆë‹¤.<br />
<br /></p>

<p><strong>OSIVëŠ” ê°™ì€ JVMì„ ë²—ì–´ë‚œ ì›ê²© ìƒí™©ì—ì„œëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤</strong><br />
ì›ê²©ì§€ì—ì„œ ì—”í‹°í‹°ë¥¼ ì§€ì—° ë¡œë”©í•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ê·¸ë¦¬ê³  ì—”í‹°í‹°ëŠ” ìƒê°ë³´ë‹¤ ìì£¼ ë³€ê²½ëœë‹¤. ë”°ë¼ì„œ ì™¸ë¶€ APIëŠ” ì—”í‹°í‹°ë¥¼ ì§ì ‘ ë…¸ì¶œí•˜ê¸°ë³´ë‹¤ëŠ” ì™„ì¶© ì—­í• ì„ í•  ìˆ˜ ìˆëŠ” DTOë¡œ ë³€í™˜í•´ì„œ ë…¸ì¶œí•˜ëŠ” ê²ƒì´ ì•ˆì „í•˜ë‹¤.<br />
<br />
<br /></p>

<h2 id="134-ë„ˆë¬´-ì—„ê²©í•œ-ê³„ì¸µ">13.4 ë„ˆë¬´ ì—„ê²©í•œ ê³„ì¸µ</h2>
<p>OSIVë¥¼ ì‚¬ìš©í•˜ë©´ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ í”„ë¦¬ì  í…Œì´ì…˜ ê³„ì¸µê¹Œì§€ ì‚´ì•„ìˆìœ¼ë¯€ë¡œ ë¯¸ë¦¬ ì´ˆê¸°í™”í•  í•„ìš”ê°€ ì—†ë‹¤. ë”°ë¼ì„œ <strong>ë‹¨ìˆœí•œ ì—”í‹°í‹° ì¡°íšŒëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë¦¬í¬ì§€í† ë¦¬ë¥¼ ì§ì ‘ í˜¸ì¶œí•´ë„ ë¬¸ì œê°€ ì—†ë‹¤.</strong></p>
<center><img src="/assets/images/posts/books/2/13_3_OSIVë¦¬íŒŒì§€í† ë¦¬ì§ì ‘í˜¸ì¶œ.png" width="100%" height="100%" /></center>
<p><br />
<br />
<br />
<br />
<br /></p>

<h1 id="14-ì»¬ë ‰ì…˜ê³¼-ë¶€ê°€-ê¸°ëŠ¥">14. ì»¬ë ‰ì…˜ê³¼ ë¶€ê°€ ê¸°ëŠ¥</h1>
<p>ì´ ì¥ì—ì„œ ë‹¤ë£° ë‚´ìš©</p>
<ul>
  <li>ì»¬ë ‰ì…˜: ë‹¤ì–‘í•œ ì»¬ë ‰ì…˜ê³¼ íŠ¹ì§•ì„ ì„¤ëª…í•œë‹¤.</li>
  <li>ì»¨ë²„í„°: ì—”í‹°í‹°ì˜ ë°ì´í„°ë¥¼ ë³€í™˜í•´ì„œ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•œë‹¤.</li>
  <li>ë¦¬ìŠ¤ë„ˆ: ì—”í‹°í‹°ì—ì„œ ë°œìƒí•œ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•œë‹¤.</li>
  <li>ì—”í‹°í‹° ê·¸ë˜í”„: ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•  ë•Œ ì—°ê´€ëœ ì—”í‹°í‹°ë“¤ì„ ì„ íƒí•´ì„œ í•¨ê»˜ ì¡°íšŒí•œë‹¤.</li>
</ul>

<h2 id="14-ì»¬ë ‰ì…˜">14. ì»¬ë ‰ì…˜</h2>
<h3 id="1411-list--ordercolumn">14.1.1 List + @OrderColumn</h3>
<p><code class="language-plaintext highlighter-rouge">List</code> ì¸í„°í˜ì´ìŠ¤ì— <code class="language-plaintext highlighter-rouge">@OrderColumn</code>ì„ ì¶”ê°€í•˜ë©´ ìˆœì„œê°€ ìˆëŠ” íŠ¹ìˆ˜í•œ ì»¬ë ‰ì…˜ìœ¼ë¡œ ì¸ì‹í•œë‹¤. ë°ì´í„°ë² ì´ìŠ¤ì— ìˆœì„œ ê°’ì„ ì €ì¥í•´ì„œ ì¡°íšŒí•  ë•Œ ì‚¬ìš©í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Board</span> <span class="o">{</span>
    <span class="o">...</span>
    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"board"</span><span class="o">)</span>
    <span class="nd">@OrderColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"POSITION"</span><span class="o">)</span> <span class="c1">// ì¶”ê°€</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Comment</span><span class="o">&gt;</span> <span class="n">comments</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Comment</span><span class="o">&gt;();</span>
<span class="o">}</span>


<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Comment</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">comment</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"BOARD_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Board</span> <span class="n">board</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ìˆœì„œê°€ ìˆëŠ” ì»¬ë ‰ì…˜ì€ ë°ì´í„°ë² ì´ìŠ¤ì— ìˆœì„œ ê°’ë„ í•¨ê»˜ ê´€ë¦¬í•œë‹¤.</p>
<center><img src="/assets/images/posts/books/2/14_1_ordercolumnTable.png" width="100%" height="100%" /></center>
<p><br /></p>

<p><strong>@OrderColumnì˜ ë‹¨ì </strong><br />
@OrderColumnì€ ë‹¤ìŒê³¼ ê°™ì€ ë‹¨ì ë“¤ ë•Œë¬¸ì— ì‹¤ë¬´ì—ì„œ ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.</p>
<ul>
  <li>@OrderColumnì„ Board ì—”í‹°í‹°ì— ë§¤í•‘í•˜ë¯€ë¡œ CommentëŠ” POSITIONì˜ ê°’ì„ ì•Œ ìˆ˜ ì—†ë‹¤.</li>
  <li>Commentë¥¼ INSERTí•  ë•Œ Board.commentsì˜ ìœ„ì¹˜ ê°’ì„ ì‚¬ìš©í•´ì„œ POSITIONì˜ ê°’ì„ UPDATE í•˜ëŠ” SQLì´ ì¶”ê°€ë¡œ ë°œìƒí•œë‹¤.</li>
  <li>Listë¥¼ ë³€ê²½í•˜ë©´ ì—°ê´€ëœ ìœ„ì¹˜ ê°’ì„ ë‹¤ ë³€ê²½í•´ì•¼ í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ëŒ“ê¸€ 2ë¥¼ ì‚­ì œí•˜ë©´ ëŒ“ê¸€ 3, ëŒ“ê¸€ 4ì˜ POSITION ê°’ì„ ë³€ê²½í•˜ëŠ” UPDATE SQLì´ 2ë²ˆ ì¶”ê°€ë¡œ ë°œìƒí•œë‹¤.</li>
  <li>ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ê°•ì œë¡œ ì‚­ì œí•˜ê³  ë‹¤ë¥¸ ëŒ“ê¸€ ë“¤ì˜ POSITION ê°’ì„ ìˆ˜ì •í•˜ì§€ ì•Šìœ¼ë©´ ì»¬ë ‰ì…˜ì„ ìˆœíšŒí•  ë•Œ NullPointExceptionì´ ë°œìƒí•œë‹¤.<br />
<br />
<br /></li>
</ul>

<h3 id="1412-orderby">14.1.2 @OrderBy</h3>
<p>@OrderByëŠ” ë°ì´í„°ë² ì´ìŠ¤ì˜ ORDER BYì ˆì„ ì‚¬ìš©í•´ì„œ ì»¬ë ‰ì…˜ì„ ì •ë ¬í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Team</span> <span class="o">{</span>
    <span class="o">...</span>
    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"team"</span><span class="o">)</span>
    <span class="nd">@OrderBy</span><span class="o">(</span><span class="s">"username desc, id asc"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;();</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ì´ˆê¸°í™”í•  ë•Œ ì‹¤í–‰ëœ SQLë¥¼ ë³´ë©´ ORDER BYê°€ ì‚¬ìš©ëœë‹¤.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">M</span><span class="p">.</span><span class="o">*</span> <span class="k">FROM</span> <span class="n">MEMBER</span> <span class="n">M</span>
<span class="k">WHERE</span> <span class="n">M</span><span class="p">.</span><span class="n">TEAM_ID</span> <span class="o">=</span> <span class="o">?</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">M</span><span class="p">.</span><span class="n">MEMBER_NAME</span> <span class="k">DESC</span><span class="p">,</span> <span class="n">M</span><span class="p">.</span><span class="n">ID</span> <span class="k">ASC</span>
</code></pre></div></div>

<div class="notice--info">
<p><strong>ì°¸ê³ </strong><br />
í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” <code class="language-plaintext highlighter-rouge">Set</code>ì— <code class="language-plaintext highlighter-rouge">@OrderBy</code>ë¥¼ ì ìš©í•´ì„œ ê²°ê³¼ë¥¼ ì¡°íšŒí•˜ë©´ ìˆœì„œë¥¼ ìœ ì§€í•˜ê¸° ìœ„í•´ <code class="language-plaintext highlighter-rouge">LinkedHashSet</code>ì„ ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•œë‹¤.</p>
</div>
<p><br />
<br /></p>

<h2 id="142-converter">14.2 @Converter</h2>
<p>ì»¨ë²„í„°ë¥¼ ì‚¬ìš©í•˜ë©´ ì—”í‹°í‹°ì˜ ë°ì´í„°ë¥¼ ë³€í™˜í•´ì„œ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•  ìˆ˜ ìˆë‹¤.</p>

<p><a href="http://localhost:4000/etc/books/ë„ë©”ì¸ì£¼ë„ê°œë°œì‹œì‘í•˜ê¸°/#434-attributeconverterë¥¼-ì´ìš©í•œ-ë°¸ë¥˜-ë§¤í•‘-ì²˜ë¦¬" target="_blank">AttributeConverterë¥¼ ì´ìš©í•œ ë°¸ë¥˜ ë§¤í•‘ ì²˜ë¦¬</a> ì°¸ê³ 
<br />
<br /></p>

<h2 id="143-ë¦¬ìŠ¤ë„ˆ">14.3 ë¦¬ìŠ¤ë„ˆ</h2>
<p>JPA ë¦¬ìŠ¤ë„ˆ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ ì—”í‹°í‹°ì˜ ìƒëª…ì£¼ê¸°ì— ë”°ë¥¸ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.</p>

<p><a href="https://docs.jboss.org/hibernate/stable/entitymanager/reference/en/html/listeners.html" target="_blank">ë¦¬ìŠ¤ë„ˆ ì°¸ê³ </a>
<br />
<br /></p>

<h3 id="1431-ì´ë²¤íŠ¸-ì¢…ë¥˜">14.3.1 ì´ë²¤íŠ¸ ì¢…ë¥˜</h3>
<p>ì´ë²¤íŠ¸ ì¢…ë¥˜ì™€ ë°œìƒ ì‹œì </p>
<center><img src="/assets/images/posts/books/2/14_3_ë¦¬ìŠ¤ë„ˆì‹œì .png" width="100%" height="100%" /></center>
<p><br />
<br /></p>

<h3 id="1432-ì´ë²¤íŠ¸-ì ìš©-ìœ„ì¹˜">14.3.2 ì´ë²¤íŠ¸ ì ìš© ìœ„ì¹˜</h3>
<p>ì´ë²¤íŠ¸ëŠ” ì—”í‹°í‹°ì—ì„œ ì§ì ‘ ë°›ê±°ë‚˜ ë³„ë„ì˜ ë¦¬ìŠ¤ë„ˆë¥¼ ë“±ë¡í•´ì„œ ë°›ì„ ìˆ˜ ìˆë‹¤.</p>

<p><strong>ì—”í‹°í‹°ì— ì§ì ‘ ì ìš©</strong> <br />
<code class="language-plaintext highlighter-rouge">@PrePersist</code>, <code class="language-plaintext highlighter-rouge">@PostLoad</code>â€¦ ë“±ì„ ì´ìš©í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Duck</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@PrePersist</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">prePersist</span><span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"prePersist"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@PostPersist</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">PostPersist</span> <span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"PostPersist"</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="nd">@PostLoad</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">PostLoad</span><span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"PostLoad"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@PreRemove</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">PreRemove</span> <span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"PreRemove"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@PostRemove</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">PostRemove</span><span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"PostRemove"</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="nd">@PreUpdate</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">PreUpdate</span><span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"PreUpdate"</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="nd">@PostUpdate</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">PostUpdate</span> <span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"PostUpdate "</span><span class="o">);</span>
    <span class="o">}</span>    
<span class="o">}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<p><strong>ë³„ë„ì˜ ë¦¬ìŠ¤ë„ˆ ë“±ë¡</strong><br />
<code class="language-plaintext highlighter-rouge">@EntityListeners</code>ë¥¼ ì‚¬ìš©í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@EntityListeners</span><span class="o">(</span><span class="nc">DuckListener</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Duck</span> <span class="o">{...}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DuckListener</span> <span class="o">{</span>

    <span class="nd">@PrePersist</span>
    <span class="c1">// íŠ¹ì • íƒ€ì…ì´ í™•ì‹¤í•˜ë‹¤ë©´ íŠ¹ì • íƒ€ì…ì„ ë°›ì„ ìˆ˜ ìˆë‹¤.</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">prePersist</span><span class="o">(</span><span class="nc">Duck</span> <span class="n">obj</span><span class="o">){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"prePersist"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@PostPersist</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">PostPersist</span> <span class="o">(</span><span class="nc">Duck</span> <span class="n">obj</span><span class="o">){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"PostPersist"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@PreRemove</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">PreRemove</span> <span class="o">(</span><span class="nc">Object</span> <span class="n">obj</span><span class="o">){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"PreRemove"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@PostRemove</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">PostRemove</span><span class="o">(</span><span class="nc">Object</span> <span class="n">obj</span><span class="o">){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"PostRemove"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ë¦¬ìŠ¤ë„ˆëŠ” ëŒ€ìƒ ì—”í‹°í‹°ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì„ ìˆ˜ ìˆë‹¤. ë°˜í™˜ íƒ€ì…ì€ voidë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤.<br />
<br />
<br /></p>

<p><strong>ê¸°ë³¸ ë¦¬ìŠ¤ë„ˆ ì‚¬ìš©</strong><br />
ëª¨ë“  ì—”í‹°í‹°ì—ì„œ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ê¸°ìœ„í•´ ê¸°ë³¸ ë¦¬ìŠ¤ë„ˆë¡œ ë“±ë¡í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>

<span class="nt">&lt;entity-mappings</span> <span class="err">...</span><span class="nt">&gt;</span>
    <span class="nt">&lt;persistence-unit-metadata&gt;</span>
        <span class="nt">&lt;persistence-unit-defaults&gt;</span>
            <span class="nt">&lt;entity-listeners&gt;</span>
                <span class="nt">&lt;entity-listener</span> <span class="na">class=</span><span class="s">"jpabook.jpashop.domain.test.listener.DefaultListener"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;/entity-listener&gt;</span>
            <span class="nt">&lt;/entity-listeners&gt;</span>
        <span class="nt">&lt;/persistence-unit-defaults&gt;</span>
    <span class="nt">&lt;/persistence-unit-metadata&gt;</span>
    
<span class="nt">&lt;/entity-mappings&gt;</span>
</code></pre></div></div>
<p><br />
<br /></p>

<p><strong>ë” ì„¸ë°€í•œ ì„¤ì •</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">javax.persistence.ExcludeDefaultListeners</code>: ê¸°ë³¸ ë¦¬ìŠ¤ë„ˆ ë¬´ì‹œ</li>
  <li><code class="language-plaintext highlighter-rouge">java.persistence.ExcludeSuperclassListners</code>: ìƒìœ„ í´ë˜ìŠ¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë¬´ì‹œ</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@EntityListeners</span><span class="o">(</span><span class="nc">DuckListener</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@ExcludeDefaultListeners</span>
<span class="nd">@ExcludeSuperclassListners</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Duck</span> <span class="kd">extends</span> <span class="nc">BaseEntity</span> <span class="o">{...}</span>
</code></pre></div></div>

<div class="notice--info">
<p><strong>ì—¬ëŸ¬ ë¦¬ìŠ¤ë„ˆë¥¼ ë“±ë¡í–ˆì„ ë•Œ ì´ë²¤íŠ¸ í˜¸ì¶œ ìˆœì„œ</strong></p>
<ol>
  <li>ê¸°ë³¸ ë¦¬ìŠ¤ë„ˆ</li>
  <li>ë¶€ëª¨ í´ë˜ìŠ¤ ë¦¬ìŠ¤ë„ˆ</li>
  <li>ë¦¬ìŠ¤ë„ˆ</li>
  <li>ì—”í‹°í‹°</li>
</ol>
</div>

<p><br />
<br />
<br /></p>

<h2 id="144-ì—”í‹°í‹°-ê·¸ë˜í”„">14.4 ì—”í‹°í‹° ê·¸ë˜í”„</h2>
<p>ì—”í‹°í‹° ê·¸ë˜í”„ ê¸°ëŠ¥ì€ ì—”í‹°í‹° ì¡°íšŒì‹œì ì— ì—°ê´€ëœ ì—”í‹°í‹°ë“¤ì„ í•¨ê»˜ ì¡°íšŒí•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤.</p>
<ul>
  <li>ì •ì ìœ¼ë¡œ ì •ì˜í•˜ëŠ” Named ì—”í‹°í‹° ê·¸ë˜í”„</li>
  <li>ë™ì ìœ¼ë¡œ ì •ì˜í•˜ëŠ” ì—”í‹°í‹° ê·¸ë˜í”„</li>
</ul>

<h3 id="1441-named-ì—”í‹°í‹°-ê·¸ë˜í”„-ì •ì ">14.4.1 Named ì—”í‹°í‹° ê·¸ë˜í”„ (ì •ì )</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì£¼ë¬¸ì„ ì¡°íšŒí•  ë•Œ ì—°ê´€ëœ íšŒì›ë„ í•¨ê»˜ ì¡°íšŒí•˜ëŠ” ì—”í‹°í‹° ê·¸ë˜í”„</span>
<span class="nd">@NamedEntityGraph</span><span class="o">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"Order.withMember"</span><span class="o">,</span>
    <span class="n">attributeNodes</span> <span class="o">=</span> <span class="o">{</span><span class="nd">@NamedAttributeNode</span><span class="o">(</span><span class="s">"member"</span><span class="o">)}</span>
<span class="o">)</span>
<span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ORDERS"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>
 
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ORDER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
 
    <span class="nd">@ManyToOne</span><span class="o">(</span><span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">,</span> <span class="n">optional</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Member</span> <span class="n">member</span><span class="o">;</span>  <span class="c1">// ì£¼ë¬¸ íšŒì›</span>
 
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li><code class="language-plaintext highlighter-rouge">@NamedEntityGraph</code>: Named ì—”í‹°í‹° ê·¸ë˜í”„ ì •ì˜í•œë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">name</code> : ì—”í‹°í‹° ê·¸ë˜í”„ì˜ ì´ë¦„ì„ ì •ì˜í•œë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">attributeNodes</code> : í•¨ê»˜ ì¡°íšŒí•  ì†ì„±ì„ ì„ íƒí•œë‹¤. ì´ë•Œ <code class="language-plaintext highlighter-rouge">@NamedAttributeNode</code>ë¥¼ ì‚¬ìš©í•˜ê³  ê·¸ ê°’ìœ¼ë¡œ í•¨ê»˜ ì¡°íšŒí•  ì†ì„±ì„ ì„ íƒí•˜ë©´ ëœë‹¤.</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">Order.member</code>ê°€ ì§€ì—° ë¡œë”©ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆì§€ë§Œ, ì—”í‹°í‹° ê·¸ë˜í”„ì—ì„œ í•¨ê»˜ ì¡°íšŒí•  ì†ì„±ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">member</code>ë¥¼ ì„ íƒí–ˆìœ¼ë¯€ë¡œ ì´ ì—”í‹°í‹° ê·¸ë˜í”„ë¥¼ ì‚¬ìš©í•˜ë©´ Orderë¥¼ ì¡°íšŒí•  ë•Œ ì—°ê´€ëœ <code class="language-plaintext highlighter-rouge">member</code>ë„ í•¨ê»˜ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.</p>

<p>ì—”í‹°í‹° ê·¸ë˜í”„ë¥¼ ë‘˜ ì´ìƒ ì •ì˜í•  ê²½ìš° <code class="language-plaintext highlighter-rouge">@NamedEntityGraphs</code> ì‚¬ìš©í•œë‹¤.<br />
<br />
<br /></p>

<h3 id="1442-emfindì—ì„œ-ì—”í‹°í‹°-ê·¸ë˜í”„-ì‚¬ìš©">14.4.2 em.find()ì—ì„œ ì—”í‹°í‹° ê·¸ë˜í”„ ì‚¬ìš©</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì •ì˜í•œ ì—”í‹°í‹° ê·¸ë˜í”„ë¥¼ ì°¾ê³ </span>
<span class="nc">EntityGraph</span> <span class="n">graph</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getEntityGraph</span><span class="o">(</span><span class="s">"Order.withMember"</span><span class="o">);</span>

<span class="c1">// ì—”í‹°í‹° ê·¸ë˜í”„ëŠ” JPAì˜ íŒíŠ¸ ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ì„œ ë™ì‘</span>
<span class="c1">// íŒíŠ¸ì˜ ê°’ìœ¼ë¡œ ì°¾ì•„ì˜¨ ì—”í‹°í‹° ê·¸ë˜í”„ ì‚¬ìš©</span>
<span class="nc">Map</span> <span class="n">hints</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">();</span>
<span class="n">hints</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"javax.persistence.fetchgraph"</span><span class="o">,</span> <span class="n">graph</span><span class="o">);</span>

<span class="c1">// ì¡°íšŒí•  ë•Œ íŒíŠ¸ì •ë³´ í¬í•¨</span>
<span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">orderId</span><span class="o">,</span> <span class="n">hints</span><span class="o">);</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1443-subgraph">14.4.3 subgraph</h3>
<p>Order -&gt; OrderItem -&gt; Item ê¹Œì§€ í•¨ê»˜ ì¡°íšŒ</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@NamedEntityGraph</span><span class="o">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"Order.withAll"</span><span class="o">,</span>
    <span class="n">attributeNodes</span> <span class="o">=</span> <span class="o">{</span>
        <span class="nd">@NamedAttributeNode</span><span class="o">(</span><span class="s">"member"</span><span class="o">),</span>
        <span class="nd">@NamedAttributeNode</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"orderItems"</span><span class="o">,</span><span class="n">subgraph</span> <span class="o">=</span> <span class="s">"orderItems"</span><span class="o">)</span>
    <span class="o">},</span>
    <span class="n">subgraphs</span> <span class="o">=</span> <span class="nd">@NamedSubgraph</span><span class="o">(</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">"orderItems"</span><span class="o">,</span>
        <span class="n">attributeNodes</span> <span class="o">=</span> <span class="o">{</span><span class="nd">@NamedAttributeNode</span><span class="o">(</span><span class="s">"item"</span><span class="o">)}</span>
    <span class="o">)</span>
<span class="o">)</span>
<span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ORDERS"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>
 
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ORDER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span><span class="o">(</span><span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">,</span> <span class="n">optional</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Member</span> <span class="n">member</span><span class="o">;</span>  <span class="c1">// ì£¼ë¬¸ íšŒì›</span>

    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"order"</span><span class="o">,</span> <span class="n">cascade</span> <span class="o">=</span> <span class="nc">CascadeType</span><span class="o">.</span><span class="na">ALL</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">OrderItem</span><span class="o">&gt;</span> <span class="n">orderItems</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">OrderItem</span><span class="o">&gt;();</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ORDER_ITEM"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderItem</span> <span class="o">{</span>
 
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ORDER_ITEM_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
 
    <span class="nd">@ManyToOne</span><span class="o">(</span><span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ITEM_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Item</span> <span class="n">item</span><span class="o">;</span>  <span class="c1">// ì£¼ë¬¸ ìƒí’ˆ</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">Order.All</code>ì´ë¼ëŠ” <code class="language-plaintext highlighter-rouge">Named</code> ì—”í‹°í‹° ê·¸ë˜í”„ ì •ì˜í–ˆë‹¤. ì´ ì—”í‹°í‹° ê·¸ë˜í”„ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ê°ì²´ ê·¸ë˜í”„ë¥¼ í•¨ê»˜ ì¡°íšŒí•œë‹¤.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">Order</code> -&gt; <code class="language-plaintext highlighter-rouge">Member</code></li>
  <li><code class="language-plaintext highlighter-rouge">Order</code> -&gt; <code class="language-plaintext highlighter-rouge">OrderItem</code></li>
  <li><code class="language-plaintext highlighter-rouge">OrderItem</code> -&gt; <code class="language-plaintext highlighter-rouge">Item</code> (<code class="language-plaintext highlighter-rouge">Order</code>ì˜ ê°ì²´ ê·¸ë˜í”„ê°€ ì•„ë‹ˆë¯€ë¡œ <code class="language-plaintext highlighter-rouge">subgraphs</code> ì†ì„±ì— ì •ì˜)<br />
<br /></li>
</ul>

<p><strong>JPQLì—ì„œ ì—”í‹°í‹° ê·¸ë˜í”„ ì‚¬ìš©</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">resultList</span> <span class="o">=</span> 
    <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"select o from Order o where o.id = :orderId"</span><span class="o">,</span> <span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="s">"orderId"</span><span class="o">,</span> <span class="n">orderId</span><span class="o">)</span>
    <span class="o">.</span><span class="na">setHint</span><span class="o">(</span><span class="s">"javax.persistence.fetchgraph"</span><span class="o">,</span> <span class="n">em</span><span class="o">.</span><span class="na">getEntityGraph</span><span class="o">(</span><span class="s">"Order.withAll"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1445-ë™ì -ì—”í‹°í‹°-ê·¸ë˜í”„">14.4.5 ë™ì  ì—”í‹°í‹° ê·¸ë˜í”„</h3>
<p>ì—”í‹°í‹° ê·¸ë˜í”„ë¥¼ ë™ì ìœ¼ë¡œ êµ¬ì„±í•˜ë ¤ë©´ <code class="language-plaintext highlighter-rouge">createEntityGraph()</code> ë©”ì†Œë“œ ì‚¬ìš©í•œë‹¤.</p>

<p><strong>ë™ì  ì—”í‹°í‹° ê·¸ë˜í”„</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">EntityGraph</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">graph</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createEntityGraph</span><span class="o">(</span><span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">graph</span><span class="o">.</span><span class="na">addAttributeNodes</span><span class="o">(</span><span class="s">"member"</span><span class="o">);</span>

<span class="nc">Map</span> <span class="n">hints</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">();</span>
<span class="n">hints</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"javax.persistence.fetchgraph"</span><span class="o">,</span> <span class="n">graph</span><span class="o">);</span>

<span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">orderId</span><span class="o">,</span> <span class="n">hints</span><span class="o">);</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ë™ì  ì—”í‹°í‹° ê·¸ë˜í”„ subgraph</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">EntityGraph</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">graph</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createEntityGraph</span><span class="o">(</span><span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">graph</span><span class="o">.</span><span class="na">addAttributeNodes</span><span class="o">(</span><span class="s">"member"</span><span class="o">);</span>
<span class="nc">Subgraph</span><span class="o">&lt;</span><span class="nc">OrderItem</span><span class="o">&gt;</span> <span class="n">orderItems</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="na">addSubgraph</span><span class="o">(</span><span class="s">"orderItems"</span><span class="o">);</span>
<span class="n">orderItems</span><span class="o">.</span><span class="na">addAttributeNodes</span><span class="o">(</span><span class="s">"item"</span><span class="o">);</span>

<span class="nc">Map</span> <span class="n">hints</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">();</span>
<span class="n">hints</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"javax.persistence.fetchgraph"</span><span class="o">,</span> <span class="n">graph</span><span class="o">);</span>

<span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">orderId</span><span class="o">,</span> <span class="n">hints</span><span class="o">);</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1446-ì—”í‹°í‹°-ê·¸ë˜í”„-ì •ë¦¬">14.4.6 ì—”í‹°í‹° ê·¸ë˜í”„ ì •ë¦¬</h3>
<p><strong>ROOTì—ì„œ ì‹œì‘</strong><br />
ì—”í‹°í‹° ê·¸ë˜í”„í‹‘ í•­ìƒ ì¡°íšŒí•˜ëŠ” ì—”í‹°í‹°ì˜ ROOTì—ì„œ ì‹œì‘í•´ì•¼ í•œë‹¤.</p>

<p><strong>ì´ë¯¸ ë¡œë”©ëœ ì—”í‹°í‹°</strong><br />
ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— í•´ë‹¹ ì—”í‹°í‹°ê°€ ì´ë¯¸ ë¡œë”©ë˜ì–´ ìˆìœ¼ë©´ ì—”í‹°í‹° ê·¸ë˜í”„ê°€ ì ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Order</span> <span class="n">order1</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">orderId</span><span class="o">);</span> <span class="c1">// ì´ë¯¸ ì¡°íšŒ</span>
<span class="n">hints</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"javax.persistence.fetchgraph"</span><span class="o">,</span> <span class="n">em</span><span class="o">.</span><span class="na">getEntityGraph</span><span class="o">(</span><span class="s">"Order.withMember"</span><span class="o">));</span>

<span class="c1">// ì—”í‹°í‹° ê·¸ë˜í”„ê°€ ì ìš©ë˜ì§€ ì•Šê³  order1ê³¼ ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜</span>
<span class="nc">Order</span> <span class="n">order2</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">orderId</span><span class="o">);</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>fetchgraph, loadgraph ì°¨ì´</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">javax.persistence.fetchgraph</code>: ì—”í‹°í‹° ê·¸ë˜í”„ì— ì„ íƒí•œ ì†ì„±ë§Œ í•¨ê»˜ ì¡°íšŒ</li>
  <li><code class="language-plaintext highlighter-rouge">javax.persistence.loadgraph</code>: ì—”í‹°í‹° ê·¸ë˜í”„ì— ì„ íƒí•œ ì†ì„± + FetchType.EAGERë¡œ ì„¤ì •ëœ ì—°ê´€ê´€ê³„ ì¡°íšŒ<br />
<br />
<br /></li>
</ul>

<h2 id="145-ì •ë¦¬">14.5 ì •ë¦¬</h2>
<ul>
  <li>JPAê°€ ì§€ì›í•˜ëŠ” ì»¬ë ‰ì…˜ì˜ ì¢…ë¥˜ì™€ íŠ¹ì§•</li>
  <li>ì»¨ë²„í„°ë¥¼ ì‚¬ìš©í•˜ë©´ ì—”í‹°í‹°ì˜ ë°ì´í„°ë¥¼ ë³€í™˜í•´ì„œ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•  ìˆ˜ ìˆë‹¤.</li>
  <li>ë¦¬ìŠ¤ë„ˆë¥¼ ì‚¬ìš©í•˜ë©´ ì—”í‹°í‹°ì—ì„œ ë°œìƒí•œ ì´ë²¤íŠ¸ë¥¼ ë°›ì•„ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.</li>
  <li>í˜ì¹˜ ì¡°ì¸ì€ ê°ì²´ì§€í–¥ ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ì§€ë§Œ ì—”í‹°í‹° ê·¸ë˜í”„ë¥¼ ì‚¬ìš©í•˜ë©´ ê°ì²´ ì§€í–¥ ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ì›í•˜ëŠ” ê°ì²´ ê·¸ë˜í”„ë¥¼ í•œ ë²ˆì— ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.<br />
<br />
<br />
<br />
<br /></li>
</ul>

<h1 id="15-ê³ ê¸‰-ì£¼ì œì™€-ì„±ëŠ¥-ìµœì í™”">15. ê³ ê¸‰ ì£¼ì œì™€ ì„±ëŠ¥ ìµœì í™”</h1>

<h2 id="151-ì˜ˆì™¸-ì²˜ë¦¬">15.1 ì˜ˆì™¸ ì²˜ë¦¬</h2>
<ul>
  <li>íŠ¸ëœì­ì…˜ì„ ë¡¤ë°±í•˜ëŠ” ê²ƒì€ ë°ì´í„°ë² ì´ìŠ¤ì˜ ë°˜ì˜ì‚¬í•­ë§Œ ë¡¤ë°±í•˜ëŠ” ê²ƒì´ì§€ ìˆ˜ì •í•œ ìë°” ê°ì²´ê¹Œì§€ ì›ìƒíƒœë¡œ ë³µêµ¬í•´ì£¼ì§€ ì•ŠëŠ”ë‹¤.</li>
  <li>ì—”í‹°í‹° ìˆ˜ì •ì¤‘ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ì˜ ë°ì´í„°ëŠ” ë¡¤ë°±ë˜ì§€ë§Œ ê°ì²´ëŠ” ìˆ˜ì •ëœ ìƒíƒœë¡œ ì—”í‹°í‹° ì»¨í…ìŠ¤íŠ¸ì— ë‚¨ì•„ìˆë‹¤.</li>
  <li>ë”°ë¼ì„œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì´ˆê¸°í™”í•œ ë‹¤ìŒì— ì‚¬ìš©í•´ì•¼ í•œë‹¤.</li>
  <li>íŠ¸ëœì­ì…˜ë‹¹ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” íŠ¸ëœì­ì…˜ ì¢…ë£Œ ì‹œì ì— ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë„ ì¢…ë£Œë˜ë¯€ë¡œ ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">OSIV</code>ì—ì„œ ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë²”ìœ„ë¥¼ íŠ¸ëœì­ì…˜ì˜ ë²”ìœ„ë³´ë‹¤ ë„“ê²Œ ì„¤ì •í•˜ë©´ íŠ¸ëœì­ì…˜ ë¡¤ë°±ì‹œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì´ˆê¸°í™”í•´ì„œ ë¬¸ì œë¥¼ ì˜ˆë°©í•œë‹¤.<br />
<br />
<br /></li>
</ul>

<h2 id="152-ì—”í‹°í‹°-ë¹„êµ">15.2 ì—”í‹°í‹° ë¹„êµ</h2>
<ul>
  <li>ë™ì¼ì„± ë¹„êµëŠ” ê°™ì€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ê´€ë¦¬ë¥¼ ë°›ëŠ” ì˜ì† ìƒíƒœì˜ ì—”í‹°í‹°ì—ë§Œ ì ìš©í•  ìˆ˜ ìˆë‹¤.</li>
  <li>ê·¸ ì™¸ì—ëŠ” ë™ë“±ì„± ë¹„êµë¥¼ í•´ì•¼í•œë‹¤.</li>
  <li><strong>ì—”í‹°í‹°ë¥¼ ë¹„êµí•  ë•ŒëŠ” <code class="language-plaintext highlighter-rouge">@Id</code>ë“±ê³¼ ê°™ì€ ë¹„ì¦ˆë‹ˆìŠ¤í‚¤ë¥¼ í™œìš©í•œ ë™ë“±ì„± ë¹„êµë¥¼ ê¶Œì¥í•œë‹¤.</strong><br />
<br /><br /></li>
</ul>

<h2 id="153-í”„ë¡ì‹œ-ì‹¬í™”">15.3 í”„ë¡ì‹œ ì‹¬í™”</h2>

<h3 id="1531-ì˜ì†ì„±-ì»¨í…ìŠ¤íŠ¸ì™€-í”„ë¡ì‹œ">15.3.1 ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì™€ í”„ë¡ì‹œ</h3>
<p>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” ìì‹ ì´ ê´€ë¦¬í•˜ëŠ” ì˜ì† ì—”í‹°í‹°ì˜ ë™ì¼ì„±ì„ ë³´ì¥í•œë‹¤. ê·¸ëŸ¼ í”„ë¡ì‹œë¡œ ì¡°íšŒí•œ ì—”í‹°í‹°ì˜ ë™ì¼ì„±ë„ ë³´ì¥í• ê¹Œ?</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// í”„ë¡ì‹œ ì¡°íšŒ</span>
<span class="nc">Member</span> <span class="n">refMember</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getReference</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"member1"</span><span class="o">);</span>
<span class="c1">// find ì¡°íšŒ</span>
<span class="nc">Member</span> <span class="n">findMember</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"member1"</span><span class="o">);</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ì¶œë ¥ ê²°ê³¼

refMember Type = í”„ë¡ì‹œ ì—”í‹°í‹°
findMember  Type = í”„ë¡ì‹œ ì—”í‹°í‹°
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">refMember</code>ëŠ” í”„ë¡ì‹œê³  <code class="language-plaintext highlighter-rouge">findMember</code>ëŠ” ì›ë³¸ ì—”í‹°í‹°ì´ë¯€ë¡œ ë‘˜ì€ ì„œë¡œ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ë¡œ ìƒê°í•  ìˆ˜ ìˆì§€ë§Œ, ì˜ì† ì—”í‹°í‹°ì˜ ë™ì¼ì„± ë³´ì¥ì„ ìœ„í•´ í”„ë¡ì‹œë¡œ ì¡°íšŒëœ ì—”í‹°í‹°ì— ëŒ€í•´ì„œ ê°™ì€ ì—”í‹°í‹°ë¥¼ ì°¾ìœ¼ë©´ í”„ë¡ì‹œë¥¼ ë°˜í™˜í•œë‹¤.</p>

<p><br /></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// find ì¡°íšŒ</span>
<span class="nc">Member</span> <span class="n">findMember</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"member1"</span><span class="o">);</span>
<span class="c1">// í”„ë¡ì‹œ ì¡°íšŒ</span>
<span class="nc">Member</span> <span class="n">refMember</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getReference</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"member1"</span><span class="o">);</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ì¶œë ¥ ê²°ê³¼

findMember  Type = ì›ë³¸ ì—”í‹°í‹°
refMember Type = ì›ë³¸ ì—”í‹°í‹°
</code></pre></div></div>
<p>ë°˜ëŒ€ë¡œ ì›ë³¸ ì—”í‹°í‹°ë¥¼ ë¨¼ì € ì¡°íšŒí•˜ë©´ í”„ë¡ì‹œë¥¼ ë°˜í™˜í•  ì´ìœ ê°€ ì—†ë‹¤. ë”°ë¼ì„œ <code class="language-plaintext highlighter-rouge">refMember</code>ëŠ” ì›ë³¸ì„ ë°˜í™˜í•œë‹¤.<br />
<br /></p>

<h2 id="1532-í”„ë¡ì‹œ-ë¹„êµ-íƒ€ì…">15.3.2 í”„ë¡ì‹œ ë¹„êµ íƒ€ì…</h2>
<p>í”„ë¡ì‹œëŠ” ì›ë³¸ ì—”í‹°í‹°ë¥¼ ìƒì† ë°›ì•„ì„œ ë§Œë“¤ì–´ì§€ë¯€ë¡œ í”„ë¡ì‹œë¡œ ì¡°íšŒí•œ ì—”í‹°í‹°ì˜ íƒ€ì…ì„ ë¹„êµí•  ë•ŒëŠ” == ë¹„êµë¥¼ í•˜ë©´ ì•ˆë˜ê³  ëŒ€ì‹ ì— instanceofë¥¼ ì‚¬ìš©í•´ì•¼í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Member</span> <span class="n">refMember</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getReference</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"member1"</span><span class="o">);</span>

<span class="nc">Assert</span><span class="o">.</span><span class="na">assertFalse</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span> <span class="o">==</span> <span class="n">refMember</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span> <span class="c1">// false</span>
<span class="nc">Assert</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">(</span><span class="n">refMember</span> <span class="k">instanceof</span> <span class="nc">Member</span><span class="o">);</span> <span class="c1">// true</span>
</code></pre></div></div>
<p><br /></p>

<h3 id="1533-í”„ë¡ì‹œ-ë™ë“±ì„±-ë¹„êµ">15.3.3 í”„ë¡ì‹œ ë™ë“±ì„± ë¹„êµ</h3>

<center><img src="/assets/images/posts/books/2/15_3_í”„ë¡ì‹œì ‘ê·¼ìì‚¬ìš©.png" width="100%" height="100%" /></center>

<p><strong>í”„ë¡œì‹œ ë™ë“±ì„± ë¹„êµ ì£¼ì˜ì‚¬í•­</strong></p>
<ul>
  <li>í”„ë¡ì‹œì˜ íƒ€ì… ë¹„êµëŠ” <code class="language-plaintext highlighter-rouge">==</code> ëŒ€ì‹ ì— <code class="language-plaintext highlighter-rouge">instanceof</code>ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</li>
  <li>í”„ë¡ì‹œì˜ ë§´ë²„ë³€ìˆ˜ì— ì§ì ‘ ì ‘ê·¼í•˜ë©´ ì•ˆë˜ê³  ì ‘ê·¼ì ë©”ì†Œë“œ(<code class="language-plaintext highlighter-rouge">Getter</code>)ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.<br />
<br /></li>
</ul>

<h3 id="1534-ìƒì†ê´€ê³„ì™€-í”„ë¡ì‹œ">15.3.4 ìƒì†ê´€ê³„ì™€ í”„ë¡ì‹œ</h3>
<center><img src="/assets/images/posts/books/2/15_3_ìƒì†ê´€ê³„ì™€í”„ë¡ì‹œ.png " width="100%" height="100%" /></center>

<p>í”„ë¡ì‹œë¥¼ ë¶€ëª¨ íƒ€ì…ìœ¼ë¡œ ì¡°íšŒí•˜ë©´ ë¶€ëª¨ íƒ€ì…ì„ ê¸°ë°˜ìœ¼ë¡œ í”„ë¡ì‹œê°€ ìƒì„±ëœë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Item</span> <span class="n">proxyItem</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getReference</span><span class="o">(</span><span class="nc">Item</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">saveBook</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>

<span class="c1">// ì˜ˆì™¸ë°œìƒ java.lang.ClassCastException</span>
<span class="c1">// Book book = (Book) proxyItem;</span>

<span class="c1">// ê²€ì¦</span>
<span class="nc">Assert</span><span class="o">.</span><span class="na">assertFalse</span><span class="o">(</span><span class="n">proxyItem</span><span class="o">.</span><span class="na">getClass</span><span class="o">()</span> <span class="o">==</span> <span class="nc">Book</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="nc">Assert</span><span class="o">.</span><span class="na">assertFalse</span><span class="o">(</span><span class="n">proxyItem</span> <span class="k">instanceof</span> <span class="nc">Book</span><span class="o">);</span>
<span class="nc">Assert</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">(</span><span class="n">proxyItem</span> <span class="k">instanceof</span> <span class="nc">Item</span><span class="o">);</span>
</code></pre></div></div>
<p>ë”°ë¼ì„œ ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œê°€ ìˆë‹¤.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">instanceof</code> ì—°ì‚°ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.</li>
  <li>í•˜ìœ„ íƒ€ì…ìœ¼ë¡œ ë‹¤ìš´ìºìŠ¤íŒ…ì„ í•  ìˆ˜ ì—†ë‹¤.<br />
<br />
<br /></li>
</ul>

<p><strong>ëª‡ ê°€ì§€ í•´ê²°ë°©ë²•</strong><br />
<strong>1. JPQLë¡œ ëŒ€ìƒ ì§ì ‘ ì¡°íšŒ</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Book</span> <span class="n">jpqlBook</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"select b from Book b where b.id=:bookId"</span><span class="o">,</span> <span class="nc">Book</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
            <span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="s">"bookId"</span><span class="o">,</span> <span class="n">item</span><span class="o">.</span><span class="na">getId</span><span class="o">())</span>
            <span class="o">.</span><span class="na">getSingleResult</span><span class="o">();</span>
</code></pre></div></div>
<p>í•˜ì§€ë§Œ ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ë©´ ë‹¤í˜•ì„±ì„ í™œìš©í•  ìˆ˜ ì—†ë‹¤.<br />
<br /></p>

<p><strong>2. ê¸°ëŠ¥ì„ ìœ„í•œ ë³„ë„ì˜ ì¸í„°í˜ì´ìŠ¤ ì œê³µ</strong></p>
<center><img src="/assets/images/posts/books/2/15_3_ìƒì†ê´€ê³„ì™€í”„ë¡ì‹œ3.png" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// íŠ¹ì • ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ ìƒì„±</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">TitleView</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="nf">getTitle</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Inheritance</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">InheritanceType</span><span class="o">.</span><span class="na">SINGLE_TABLE</span><span class="o">)</span>
<span class="nd">@DiscriminatorColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"DTYPE"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Item</span> <span class="kd">implements</span> <span class="nc">TitleView</span> <span class="o">{</span>

    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ITEM_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">price</span><span class="o">;</span>
    
    <span class="o">...</span>
    <span class="c1">// Getter, Setter</span>
<span class="o">}</span>

<span class="nd">@Entity</span>
<span class="nd">@DiscriminatorValue</span><span class="o">(</span><span class="s">"M"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Movie</span> <span class="kd">extends</span> <span class="nc">Item</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">director</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">actor</span><span class="o">;</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getTitle</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"[ì œëª©:"</span> <span class="o">+</span> <span class="n">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">" ê°ë…:"</span> <span class="o">+</span> <span class="n">director</span> <span class="o">+</span> <span class="s">" ë°°ìš°:"</span> <span class="o">+</span> <span class="n">actor</span> <span class="o">+</span> <span class="s">"]"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Entity</span>
<span class="nd">@DiscriminatorValue</span><span class="o">(</span><span class="s">"B"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Book</span> <span class="kd">extends</span> <span class="nc">Item</span> <span class="o">{</span>
    
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">author</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">isbn</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getTitle</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"[ì œëª©:"</span> <span class="o">+</span> <span class="n">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">" ì €ì:"</span> <span class="o">+</span> <span class="n">author</span> <span class="o">+</span> <span class="s">"]"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// í”„ë¡ì‹œ ì¸í„°í˜ì´ìŠ¤ ì œê³µ ì‚¬ìš©</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderItem</span> <span class="o">{</span>
    <span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span><span class="o">(</span><span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span>
    <span class="nd">@JoinColmn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ITEM_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Item</span> <span class="n">item</span><span class="o">;</span>

    <span class="o">...</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">printItem</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"TITLE="</span> <span class="o">+</span> <span class="n">item</span><span class="o">.</span><span class="na">getTitle</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Itemì˜ êµ¬í˜„ì²´ì— ë”°ë¼ ê°ê° ë‹¤ë¥¸ getTitle() ë©”ì†Œë“œê°€ í˜¸ì¶œëœë‹¤.</span>
<span class="nc">OrderItem</span> <span class="n">orderItem</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">OrderItem</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">saveOrderItem</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
<span class="n">orderItem</span><span class="o">.</span><span class="na">printItem</span><span class="o">();</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>3. ë¹„ì§€í„° íŒ¨í„´ ì‚¬ìš©</strong><br />
êµ¬í˜„ ë‚´ìš© ìƒëµ, ì±… ì°¸ê³  ğŸ˜…</p>

<p>ì¥ì </p>
<ul>
  <li>í”„ë¡ì‹œì— ëŒ€í•œ ê±±ì • ì—†ì´ ì•ˆì „í•˜ê²Œ ì›ë³¸ ì—”í‹°í‹°ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">instanceof</code>ì™€ íƒ€ì… ìºìŠ¤íŒ… ì—†ì´ ì½”ë“œë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.</li>
  <li>ì•Œê³ ë¦¬ì¦˜ê³¼ ê°ì²´ êµ¬ì¡°ë¥¼ ë¶„ë¦¬í•´ì„œ êµ¬ì¡°ë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³  ìƒˆë¡œìš´ ë™ì‘ì„ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p>ë‹¨ì </p>
<ul>
  <li>ë„ˆë¬´ ë³µì¡í•˜ê³  ì´í•´í•˜ê¸° ì–´ë µë‹¤.</li>
  <li>ê°ì²´ êµ¬ì¡°ê°€ ë³€ê²½ë˜ë©´ ëª¨ë“  <code class="language-plaintext highlighter-rouge">Visitor</code>ë¥¼ ìˆ˜ì •í•´ì•¼ í•œë‹¤.<br />
<br />
<br /></li>
</ul>

<h2 id="154-ì„±ëŠ¥-ìµœì í™”">15.4 ì„±ëŠ¥ ìµœì í™”</h2>

<h3 id="1541-n1-ë¬¸ì œ">15.4.1 N+1 ë¬¸ì œ</h3>
<ul>
  <li>ì¦‰ì‹œ ë¡œë”©ì€ JPQLì„ ì‹¤í–‰í•  ë•Œ N+1 ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.</li>
  <li>ì§€ì—° ë¡œë”©ì€ ì—°ê´€ëœ ì»¬ë ‰ì…˜ì„ ì‚¬ìš©í•  ë•Œ N+1 ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.<br />
<br /></li>
</ul>

<p><strong>í•´ê²° ë°©ë²•</strong><br />
<strong>1. í˜ì¹˜ ì¡°ì¸ ì‚¬ìš©</strong></p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">distinct</span> <span class="n">m</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span> <span class="k">join</span> <span class="k">fetch</span> <span class="n">m</span><span class="p">.</span><span class="n">orders</span>
</code></pre></div></div>
<p>ì¼ëŒ€ë‹¤ ì¡°ì¸ì„ í•˜ë©´ ê²°ê³¼ê°€ ëŠ˜ì–´ë‚˜ì„œ ì¤‘ë³µëœ ê²°ê³¼ê°€ ë‚˜íƒ€ë‚  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ <code class="language-plaintext highlighter-rouge">distinct</code>ë¥¼ ì‚¬ìš©í•´ì„œ ì¤‘ë³µì„ ì œê±°í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.<br />
<br /></p>

<p><strong>2. í•˜ì´ë²„ë„¤ì´íŠ¸ <code class="language-plaintext highlighter-rouge">@BatchSize</code></strong><br />
í•˜ì´ë²„ë„¤ì´íŠ¸ê°€ ì œê³µí•˜ëŠ” <code class="language-plaintext highlighter-rouge">@BatchSize</code>ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ ì—°ê´€ëœ ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•  ë•Œ ì§€ì •í•œ <code class="language-plaintext highlighter-rouge">size</code>ë§Œí¼ <code class="language-plaintext highlighter-rouge">SQL</code>ì˜ <code class="language-plaintext highlighter-rouge">IN</code>ì ˆì„ ì‚¬ìš©í•´ì„œ ì¡°íšŒí•œë‹¤. ë§Œì•½ ì¡°íšŒí•œ íšŒì›ì´ 10ëª…ì¸ë° <code class="language-plaintext highlighter-rouge">size=5</code>ë¡œ ì§€ì •í•˜ë©´ 2ë²ˆì˜ <code class="language-plaintext highlighter-rouge">SQL</code>ë§Œ ì¶”ê°€ë¡œ ì‹¤í–‰í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@BatchSize</span>
<span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"member"</span><span class="o">,</span> <span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">EAGER</span><span class="o">)</span>
<span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">orders</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;();</span>
</code></pre></div></div>

<div class="notice--info">
<p><strong>ì°¸ê³ </strong>
hibernate.default_batch_fetch_size ì†ì„±ì„ ì‚¬ìš©í•˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ì— ê¸°ë³¸ìœ¼ë¡œ @BatchSizeë¥¼ ì ìš©í•  ìˆ˜ ìˆë‹¤.</p>
</div>
<p><br /></p>

<p><strong>3. í•˜ì´ë²„ë„¤ì´íŠ¸ @Fetch(FetchMode.SUBSELECT)</strong><br />
í•˜ì´ë²„ë„¤ì´íŠ¸ê°€ ì œê³µí•˜ëŠ” <code class="language-plaintext highlighter-rouge">@Fetch</code>ì–´ë…¸í…Œì´ì…˜ì— <code class="language-plaintext highlighter-rouge">FetchMode.SUBSELECT</code>ë¡œ ì‚¬ìš©í•˜ë©´ ì—°ê´€ëœ ë°ì´í„°ë¥¼ ì¡°íšŒí•  ë•Œ ì„œë¸Œ ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•´ì„œ N+1 ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Fetch</span><span class="o">(</span><span class="nc">FetchMode</span><span class="o">.</span><span class="na">SUBSELECT</span><span class="o">)</span>
<span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"member"</span><span class="o">,</span> <span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">EAGER</span><span class="o">)</span>
<span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">orders</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;();</span>
</code></pre></div></div>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- JPQL</span>
<span class="k">select</span> <span class="n">m</span> <span class="k">from</span> <span class="n">Member</span> <span class="n">m</span> <span class="k">where</span> <span class="n">m</span><span class="p">.</span><span class="n">id</span> <span class="o">&gt;</span> <span class="mi">10</span>

<span class="c1">-- ì¦‰ì‹œ ë¡œë”©ìœ¼ë¡œ ì„¤ì •í•˜ë©´ ì¡°íšŒ ì‹œì ì—</span>
<span class="c1">-- ì§€ì—° ë¡œë”©ìœ¼ë¡œ ì„¤ì •í•˜ë©´ ì§€ì—°ë¡œë”©ëœ ì—”í‹°í‹°ë¥¼ ì‚¬ìš©í•˜ëŠ” ì‹œì ì—</span>
<span class="c1">-- SQL</span>
<span class="k">SELECT</span> <span class="n">O</span> <span class="k">FROM</span> <span class="n">ORDERS</span> <span class="n">O</span>
    <span class="k">WHERE</span> <span class="n">O</span><span class="p">.</span><span class="n">MEMBER_ID</span> <span class="k">IN</span> <span class="p">(</span>
        <span class="k">SELECT</span>
            <span class="n">M</span><span class="p">.</span><span class="n">ID</span>
        <span class="k">FROM</span>
            <span class="n">MEMBER</span> <span class="n">M</span>
        <span class="k">WHERE</span> <span class="n">M</span><span class="p">.</span><span class="n">ID</span> <span class="o">&gt;</span> <span class="mi">10</span>
    <span class="p">)</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ì •ë¦¬</strong></p>
<ul>
  <li>ì¦‰ì‹œ ë¡œë”©ì€ ì„±ëŠ¥ ìµœì í™”ê°€ ì–´ë µë‹¤.</li>
  <li>ì¦‰ì‹œ ë¡œë”©ì€ ì‚¬ìš©í•˜ì§€ ë§ê³  ì§€ì—° ë¡œë”©ë§Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•œë‹¤.</li>
  <li>ì„±ëŠ¥ ìµœì í™”ê°€ ê¼­ í•„ìš”í•œ ê³³ì—ì„œë§Œ JPQL í˜ì¹˜ ì¡°ì¸ ì‚¬ìš©í•˜ì.<br />
<br />
<br /></li>
</ul>

<h3 id="1542-ì½ê¸°-ì „ìš©-ì¿¼ë¦¬ì˜-ì„±ëŠ¥-ìµœì í™”">15.4.2 ì½ê¸° ì „ìš© ì¿¼ë¦¬ì˜ ì„±ëŠ¥ ìµœì í™”</h3>
<p>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” ë³€ê²½ ê°ì§€ë¥¼ ìœ„í•´ ìŠ¤ëƒ…ìƒ· ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë³´ê´€í•˜ë¯€ë¡œ ë” ë§ì€ ë©”ëª¨ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ë‹¨ì ì´ ìˆë‹¤. ë‹¨ìˆœíˆ ì¡°íšŒë§Œ í•˜ê³ , ì¡°íšŒí•œ ì—”í‹°í‹°ë¥¼ ë‹¤ì‹œ ì¡°íšŒí•  ì¼ë„ ì—†ê³  ìˆ˜ì •í•  ì¼ë„ ì—†ë‹¤ë©´ ì½ê¸° ì „ìš©ìœ¼ë¡œ ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•˜ë©´ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ìµœì í™”í•  ìˆ˜ ìˆë‹¤.</p>

<p><strong>ìŠ¤ì¹¼ë¼ íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ</strong><br />
ìŠ¤ì¹¼ë¼ íƒ€ì…ì€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ê²°ê³¼ë¥¼ ê´€ë¦¬í•˜ì§€ ì•ŠëŠ”ë‹¤.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">o</span><span class="p">.</span><span class="n">id</span><span class="p">,</span> <span class="n">o</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">o</span><span class="p">.</span><span class="n">price</span> <span class="k">from</span> <span class="k">Order</span> <span class="n">p</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ì½ê¸° ì „ìš© ì¿¼ë¦¬ íŒíŠ¸ ì‚¬ìš©</strong><br />
í•˜ì´ë²„ë„¤ì´íŠ¸ ì „ìš© íŒíŠ¸ì¸ <code class="language-plaintext highlighter-rouge">org.hibernate.readOnly</code>ë¥¼ ì‚¬ìš©í•˜ë©´ <strong>ì—”í‹°í‹°ë¥¼ ì½ê¸° ì „ìš©ìœ¼ë¡œ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤</strong>. ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” ìŠ¤ëƒ…ìƒ·ì„ ë³´ê´€í•˜ì§€ ì•ŠëŠ”ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">TypedQuery</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">query</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"select o from Order o"</span><span class="o">,</span> <span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">query</span><span class="o">.</span><span class="na">setHint</span><span class="o">(</span><span class="s">"org.hibernate.readOnly"</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ì½ê¸° ì „ìš© íŠ¸ëœì­ì…˜ ì‚¬ìš©</strong><br />
ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ë©´ íŠ¸ëœì­ì…˜ì„ ì½ê¸° ì „ìš© ëª¨ë“œë¡œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ì´ ì˜µì…˜ì€ <strong>íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•´ë„ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ í”ŒëŸ¬ì‹œ í•˜ì§€ ì•ŠëŠ”ë‹¤</strong>. ìŠ¤ëƒ…ìƒ· ë¹„êµì™€ ê°™ì€ ë¬´ê±°ìš´ ë¡œì§ë“¤ì„ ìˆ˜í–‰í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì„±ëŠ¥ì´ í–¥ìƒëœë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Transactional</span><span class="o">(</span><span class="n">readOnly</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>ì¶”ì²œ ë°©ë²•</strong></p>
<ul>
  <li>ì½ê¸° ì „ìš© íŠ¸ëœì­ì…˜ ì‚¬ìš©: í”ŒëŸ¬ì‹œë¥¼ ì‘ë™í•˜ì§€ ì•Šë„ë¡ í•´ì„œ ì„±ëŠ¥ í–¥ìƒ</li>
  <li>ì½ê¸° ì „ìš© ì—”í‹°í‹° ì‚¬ìš©: ì—”í‹°í‹°ë¥¼ ì½ê¸° ì „ìš©ìœ¼ë¡œ ì¡°íšŒí•´ì„œ ë©”ëª¨ë¦¬ ì ˆì•½<br />
<br />
<br /></li>
</ul>

<h3 id="1543-ë°°ì¹˜-ì²˜ë¦¬">15.4.3 ë°°ì¹˜ ì²˜ë¦¬</h3>
<ul>
  <li>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ë„ˆë¬´ ë§ì€ ì—”í‹°í‹°ê°€ ì €ì¥ë˜ë©´ ë©”ëª¨ë¦¬ ë¶€ì¡± ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.</li>
  <li>ë”°ë¼ì„œ ì´ëŸ¬í•œ ë°°ì¹˜ ì²˜ë¦¬ë¥¼ ì ì ˆí•œ ë‹¨ìœ„ë¡œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì´ˆê¸°í™”í•´ì•¼ í•œë‹¤.</li>
  <li>2ì°¨ ìºì‹œë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ 2ì°¨ ìºì‹œì— ì—”í‹°í‹°ë¥¼ ë³´ê´€í•˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•´ì•¼ í•œë‹¤.</li>
</ul>

<p><strong>JPA ë“±ë¡ ë°°ì¹˜</strong><br />
ë§ì€ ì–‘ì˜ ì—”í‹°í‹°ë¥¼ í•œ ë²ˆì— ë“±ë¡í•  ë•Œ ì£¼ì˜í•  ì ì€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— <strong>ì—”í‹°í‹°ê°€ ê³„ì† ìŒ“ì´ì§€ ì•Šë„ë¡</strong> ì¼ì • ë‹¨ìœ„ë§ˆë‹¤ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ <strong>ì—”í‹°í‹°ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— í”ŒëŸ¬ì‹œ</strong>í•˜ê³  ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì´ˆê¸°í™”í•´ì•¼ í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">EntityManager</span> <span class="n">em</span> <span class="o">=</span> <span class="n">entityManagerFactory</span><span class="o">.</span><span class="na">createEntityManager</span><span class="o">();</span>
<span class="nc">EntityTransaction</span> <span class="n">tx</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">();</span>
<span class="n">tx</span><span class="o">.</span><span class="na">begin</span><span class="o">();</span>

<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">100000</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">){</span>
    <span class="nc">Product</span> <span class="n">product</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Product</span><span class="o">(</span><span class="s">"item"</span><span class="o">+</span> <span class="n">i</span><span class="o">,</span> <span class="mi">10000</span><span class="o">);</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">product</span><span class="o">);</span>

    <span class="c1">//100ê±´ë§ˆë‹¤ í”ŒëŸ¬ì‹œì™€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ì´ˆê¸°í™”</span>
    <span class="k">if</span><span class="o">(</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">)</span> <span class="o">{</span>
        <span class="n">em</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
        <span class="n">em</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="n">tx</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
<span class="n">em</span><span class="o">.</span><span class="na">close</span><span class="o">();</span><span class="err">â€‹</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>JPA ìˆ˜ì • ë°°ì¹˜</strong><br />
ë°°ì¹˜ ì²˜ë¦¬ëŠ” ì•„ì£¼ ë§ì€ ë°ì´í„°ë¥¼ ì¡°íšŒí•´ì„œ ìˆ˜ì •í•œë‹¤. ì´ë•Œ ìˆ˜ë§ì€ ë°ì´í„°ë“¤ì„ í•œ ë²ˆì— ë©”ëª¨ë¦¬ì— ì˜¬ë ¤ë‘˜ ìˆ˜ ì—†ì–´ì„œ ë‹¤ìŒ ë°©ë²•ì„ ì£¼ë¡œ ì‚¬ìš©í•œë‹¤.</p>

<p><strong>1. JPA í˜ì´ì§• ë°°ì¹˜ ì²˜ë¦¬</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">EntityManager</span> <span class="n">em</span> <span class="o">=</span> <span class="n">entityManagerFactory</span><span class="o">.</span><span class="na">createEntityManager</span><span class="o">();</span>
<span class="nc">EntityTransaction</span> <span class="n">tx</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">();</span>

<span class="n">tx</span><span class="o">.</span><span class="na">begin</span><span class="o">();</span>
<span class="kt">int</span> <span class="n">pageSize</span> <span class="o">=</span> <span class="mi">100</span><span class="o">;</span>

<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// ì¡°íšŒ</span>
    <span class="nc">List</span> <span class="o">&lt;</span> <span class="nc">Product</span> <span class="o">&gt;</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"select p from Product p"</span><span class="o">,</span> <span class="nc">Product</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="o">.</span><span class="na">setFirstResult</span><span class="o">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">pageSize</span><span class="o">)</span>
        <span class="o">.</span><span class="na">setMaxResults</span><span class="o">(</span><span class="n">pageSize</span><span class="o">)</span>
        <span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>

    <span class="c1">//ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰ </span>
    <span class="k">for</span> <span class="o">(</span><span class="nc">Product</span> <span class="nl">product:</span> <span class="n">resultList</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">product</span><span class="o">.</span><span class="na">setPrice</span><span class="o">(</span><span class="n">product</span><span class="o">.</span><span class="na">getPrice</span> <span class="o">+</span> <span class="mi">100</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// í”ŒëŸ¬ì‹œ, ì´ˆê¸°í™”</span>
    <span class="n">em</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
    <span class="n">em</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
<span class="o">}</span>
<span class="n">tx</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
<span class="n">em</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>2. í•˜ì´ë²„ë„¤ì´íŠ¸ scroll ì‚¬ìš©</strong><br />
<code class="language-plaintext highlighter-rouge">JPA</code>ëŠ” <code class="language-plaintext highlighter-rouge">JDBC ì»¤ì„œ(CURSOR)</code>ë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ <code class="language-plaintext highlighter-rouge">ì»¤ì„œ</code>ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ <code class="language-plaintext highlighter-rouge">í•˜ì´ë²„ë„¤ì´íŠ¸ ì„¸ì…˜(SESSION)</code>ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤. í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” <code class="language-plaintext highlighter-rouge">scroll</code>ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">JDBC ì»¤ì„œ</code>ë¥¼ ì§€ì›í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">EntityTransaction</span> <span class="n">tx</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">();</span>
<span class="nc">Session</span> <span class="n">session</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">unwrap</span><span class="o">(</span><span class="nc">Session</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="n">tx</span><span class="o">.</span><span class="na">begin</span><span class="o">();</span>
<span class="nc">ScrollableResults</span> <span class="n">scroll</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"select p from Product p"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">setCacheMode</span><span class="o">(</span><span class="nc">CacheMode</span><span class="o">.</span><span class="na">IGNORE</span><span class="o">)</span> <span class="c1">// 2ì°¨ ìºì‹œ ê¸°ëŠ¥ì„ ëˆë‹¤.</span>
    <span class="o">.</span><span class="na">scroll</span><span class="o">(</span><span class="nc">ScrollMode</span><span class="o">.</span><span class="na">FORWARD_ONLY</span><span class="o">);</span>

<span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
<span class="k">while</span> <span class="o">(</span><span class="n">scroll</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
    <span class="nc">Product</span> <span class="n">p</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Product</span><span class="o">)</span> <span class="n">scroll</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
    <span class="n">p</span><span class="o">.</span><span class="na">setPrice</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">getPrice</span><span class="o">()</span> <span class="o">+</span> <span class="mi">100</span><span class="o">);</span>

    <span class="n">count</span><span class="o">++;</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">count</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">session</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span> <span class="c1">//í”ŒëŸ¬ì‹œ</span>
        <span class="n">session</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span> <span class="c1">//ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ì´ˆê¸°í™”</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="n">tx</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
<span class="n">session</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</code></pre></div></div>
<p><br /></p>

<p><strong>3. í•˜ì´ë²„ë„¤ì´íŠ¸ ë¬´ìƒíƒœ ì„¸ì…˜ ì‚¬ìš©</strong></p>
<ul>
  <li>í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” ë¬´ìƒíƒœ ì„¸ì…˜ì´ë¼ëŠ” íŠ¹ë³„í•œ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.</li>
  <li>ë¬´ìƒíƒœ ì„¸ì…˜ì€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì§€ ì•Šê³  ì‹¬ì§€ì–´ 2ì°¨ ìºì‹œë„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
  <li>ì—”í‹°í‹°ë¥¼ ìˆ˜ì •í•˜ë ¤ë©´ ë¬´ìƒíƒœ ì„¸ì…˜ì´ ì œê³µí•˜ëŠ” <code class="language-plaintext highlighter-rouge">update()</code> ë©”ì†Œë“œë¥¼ ì§ì ‘ í˜¸ì¶œí•´ì•¼ í•œë‹¤.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">SessionFactory</span> <span class="n">sessionFactory</span> <span class="o">=</span> <span class="n">entityManagerFactory</span><span class="o">.</span><span class="na">unwrap</span><span class="o">(</span><span class="nc">SessionFactory</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="nc">StatelessSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">sessionFactory</span><span class="o">.</span><span class="na">openStatelessSession</span><span class="o">();</span>
<span class="nc">Transaction</span> <span class="n">tx</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">beginTransaction</span><span class="o">();</span>
<span class="nc">ScrollableResults</span> <span class="n">scroll</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"select p from Product p"</span><span class="o">).</span><span class="na">scroll</span><span class="o">();</span>

<span class="k">while</span> <span class="o">(</span><span class="n">scroll</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
    <span class="nc">Product</span> <span class="n">p</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Product</span><span class="o">)</span> <span class="n">scroll</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
    <span class="n">p</span><span class="o">.</span><span class="na">setPrice</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">getPrice</span><span class="o">()</span> <span class="o">+</span> <span class="mi">100</span><span class="o">);</span>
    <span class="n">session</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">p</span><span class="o">);</span> <span class="c1">// ì§ì ‘ updateë¥¼ í˜¸ì¶œí•´ì•¼ í•œë‹¤.</span>
<span class="o">}</span>
<span class="n">tx</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
<span class="n">session</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1544-sql-ì¿¼ë¦¬-íŒíŠ¸-ì‚¬ìš©">15.4.4 SQL ì¿¼ë¦¬ íŒíŠ¸ ì‚¬ìš©</h3>
<p>JPAëŠ” ë°ì´í„°ë² ì´ìŠ¤ SQL íŒíŠ¸ ê¸°ëŠ¥ì„ ì œê³µí•˜ì§€ ì•ŠëŠ”ë‹¤. SQL íŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ í•˜ì´ë²„ë„¤ì´íŠ¸ë¥¼ ì§ì ‘ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ì—¬ê¸°ì„œ ë§í•˜ëŠ” SQL íŒíŠ¸ëŠ” JPA êµ¬í˜„ì²´ì—ê²Œ ì œê³µí•˜ëŠ” íŒíŠ¸ê°€ ì•„ë‹ˆë‹¤. ë°ì´í„°ë² ì´ìŠ¤ ë²¤ë”ì—ê²Œ ì œê³µí•˜ëŠ” íŒíŠ¸ë‹¤.</p>

<p><strong>SQL ì¿¼ë¦¬ íŒíŠ¸ ì‚¬ìš©</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Session</span> <span class="n">session</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">unwrap</span><span class="o">(</span><span class="nc">Session</span><span class="o">.</span><span class="na">class</span><span class="o">);</span> <span class="c1">// í•˜ì´ë²„ë„¤ì´íŠ¸ ì§ì ‘ ì‚¬ìš©</span>

<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">creatQuery</span><span class="o">(</span><span class="s">"select m from Member m"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">addQueryHint</span><span class="o">(</span><span class="s">"FULL (MEMBER)"</span><span class="o">)</span> <span class="c1">// SQL íŒíŠ¸ ì¶”ê°€</span>
            <span class="o">.</span><span class="na">list</span><span class="o">();</span>
</code></pre></div></div>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- ì‹¤í–‰ëœ SQLì„ ë³´ë©´ ì¶”ê°€í•œ íŒíŠ¸ê°€ ìˆë‹¤.</span>
<span class="k">select</span>
    <span class="cm">/*+ FULL (MEMBER) */</span> <span class="n">m</span><span class="p">.</span><span class="n">id</span><span class="p">,</span> <span class="n">m</span><span class="p">.</span><span class="n">name</span>
<span class="k">from</span>
    <span class="n">Member</span> <span class="n">m</span>
</code></pre></div></div>
<p><br />
<br /></p>

<h3 id="1545-íŠ¸ëœì­ì…˜ì„-ì§€ì›í•˜ëŠ”-ì“°ê¸°-ì§€ì—°-ì„±ëŠ¥-ìµœì í™”">15.4.5 íŠ¸ëœì­ì…˜ì„ ì§€ì›í•˜ëŠ” ì“°ê¸° ì§€ì—° ì„±ëŠ¥ ìµœì í™”</h3>
<p>ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•´ SQL ë°°ì¹˜ë¥¼ ì´ìš©í•œë‹¤. í•˜ì´ë²„ë„¤ì´íŠ¸ì—ì„œ ë°°ì¹˜ë¥¼ ì„¤ì •í•˜ë©´ ë°ì´í„°ë¥¼ ë“±ë¡, ìˆ˜ì • ì‚­ì œí•  ë•Œ SQL ë°°ì¹˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•œë‹¤</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"hibernate.jdbc.batch_size"</span> <span class="na">value=</span><span class="s">"50"</span><span class="nt">&gt;</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">hibernate.jdbc.batch_size</code> ì†ì„±ì˜ ì†ì„± ê°’ì„ 50ìœ¼ë¡œ ì£¼ë©´ ìµœëŒ€ 50ê±´ì”© ëª¨ì•„ì„œ SQL ë°°ì¹˜ë¥¼ ì‹¤í–‰í•œë‹¤. í•˜ì§€ë§Œ <strong>SQL ë°°ì¹˜ëŠ” ê°™ì€ SQLì¼ ë•Œë§Œ ìœ íš¨í•˜ë‹¤.</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">ner</span> <span class="nf">Member</span><span class="o">());</span> <span class="c1">// 1</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">ner</span> <span class="nf">Member</span><span class="o">());</span> <span class="c1">// 2</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">ner</span> <span class="nf">Member</span><span class="o">());</span> <span class="c1">// 3</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">ner</span> <span class="nf">Member</span><span class="o">());</span> <span class="c1">// 4</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">ner</span> <span class="nf">Child</span><span class="o">());</span>  <span class="c1">// 5, ë‹¤ë¥¸ ì—°ì‚°</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">ner</span> <span class="nf">Member</span><span class="o">());</span> <span class="c1">// 6</span>
<span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">ner</span> <span class="nf">Member</span><span class="o">());</span> <span class="c1">// 7</span>
</code></pre></div></div>
<p>ì´ë ‡ê²Œ í•˜ë©´ 1,2,3,4ë¥¼ ëª¨ì•„ì„œ í•˜ë‚˜ì˜ SQL ë°°ì¹˜ë¥¼ ì‹¤í–‰í•˜ê³  5ë¥¼ í•œ ë²ˆ ì‹¤í–‰í•˜ê³  6,7ì„ ëª¨ì•„ì„œ ì‹¤í–‰í•œë‹¤. ì´ 3ë²ˆì˜ SQL ë°°ì¹˜ë¥¼ ì‹¤í–‰í•œë‹¤.</p>

<p><br />
<br /></p>

<h2 id="155-ì •ë¦¬">15.5 ì •ë¦¬</h2>
<ul>
  <li>JPAì˜ ì˜ˆì™¸ëŠ” íŠ¸ëœì­ì…˜ ë¡¤ë°±ì„ í‘œì‹œí•˜ëŠ” ì˜ˆì™¸ì™€ í‘œì‹œí•˜ì§€ ì•ŠëŠ” ì˜ˆì™¸ë¡œ ë‚˜ëˆˆë‹¤. íŠ¸ëœì­ì…˜ì„ ë¡¤ë°±í•˜ëŠ” ì˜ˆì™¸ëŠ” ì‹¬ê°í•œ ì˜ˆì™¸ì´ë¯€ë¡œ íŠ¸ëœì­ì…˜ì„ ê°•ì œë¡œ ì»¤ë°‹í•´ë„ ì»¤ë°‹ë˜ì§€ ì•Šê³  ë¡¤ë°±ëœë‹¤.</li>
  <li>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ì—”í‹°í‹°ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ í‚¤ë¥¼ ì‚¬ìš©í•œ ë™ë“±ì„± ë¹„êµë¥¼ í•´ì•¼ í•œë‹¤.</li>
  <li>í”„ë¡ì‹œë¥¼ ì‚¬ìš©í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ëŠ” ì¡°íšŒí•œ ì—”í‹°í‹°ê°€ í”„ë¡ì‹œì¸ì§€ ì›ë³¸ ì—”í‹°í‹°ì¸ì§€ êµ¬ë¶„í•˜ì§€ ì•Šê³  ì‚¬ìš©í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤. í•˜ì§€ë§Œ í”„ë¡ì‹œëŠ” ê¸°ìˆ ì ì¸ í•œê³„ê°€ ìˆìœ¼ë¯€ë¡œ í•œê³„ì ì„ ì¸ì‹í•˜ê³  ì‚¬ìš©í•´ì•¼ í•œë‹¤.</li>
  <li>JPAë¥¼ ì‚¬ìš©í•  ë•Œ N+1 ë¬¸ì œë¥¼ ê°€ì¥ ì¡°ì‹¬í•´ì•¼ í•œë‹¤. ì£¼ë¡œ í˜ì¹˜ ì¡°ì¸ìœ¼ë¡œ í•´ê²°í•œë‹¤.</li>
  <li>ì—”í‹°í‹°ë¥¼ ì½ê¸° ì „ìš©ìœ¼ë¡œ ì¡°íšŒí•˜ë©´ ìŠ¤ëƒ…ìƒ·ì„ ìœ ì§€í•  í•„ìš”ê°€ ì—†ê³  ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ í”ŒëŸ¬ì‹œí•˜ì§€ ì•Šì•„ë„ ëœë‹¤.</li>
  <li>ëŒ€ëŸ‰ì˜ ì—”í‹°í‹°ë¥¼ ë°°ì¹˜ ì²˜ë¦¬í•˜ë ¤ë©´ ì ì ˆí•œ ì‹œì ì— ê¼­ í”ŒëŸ¬ì‹œë¥¼ í˜¸ì¶œí•˜ê³  ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë„ ì´ˆê¸°í™”í•´ì•¼ í•œë‹¤.</li>
  <li>JPAëŠ” SQL ì¿¼ë¦¬ íŒíŠ¸ë¥¼ ì§€ì›í•˜ì§€ ì•Šì§€ë§Œ í•˜ì´ë²„ë„¤ì´íŠ¸ êµ¬í˜„ì²´ë¥¼ ì‚¬ìš©í•˜ë©´ SQL ì¿¼ë¦¬ íŒíŠ¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><br />
<br />
<br /></p>

<h1 id="16-íŠ¸ëœì­ì…˜ê³¼-ë½-2ì°¨-ìºì‹œ">16. íŠ¸ëœì­ì…˜ê³¼ ë½, 2ì°¨ ìºì‹œ</h1>
<h2 id="161-íŠ¸ëœì­ì…˜ê³¼-ë½">16.1 íŠ¸ëœì­ì…˜ê³¼ ë½</h2>
<p>íŠ¸ëœì­ì…˜ ê¸°ì´ˆì™€ JPAê°€ ì œê³µí•˜ëŠ” ë‚™ê´€ì  ë½ê³¼ ë¹„ê´€ì  ë½ì— ëŒ€í•´ ì•Œì•„ë³¸ë‹¤.<br />
<br /></p>

<h3 id="1611-íŠ¸ëœì­ì…˜ê³¼-ê²©ë¦¬-ìˆ˜ì¤€">16.1.1 íŠ¸ëœì­ì…˜ê³¼ ê²©ë¦¬ ìˆ˜ì¤€</h3>
<p>íŠ¸ëœì­ì…˜ì€ <code class="language-plaintext highlighter-rouge">ACID</code>ë¼ í•˜ëŠ” ì›ìì„±(<code class="language-plaintext highlighter-rouge">Atomicty</code>), ì¼ê´€ì„±(<code class="language-plaintext highlighter-rouge">Consistency</code>), ê²©ë¦¬ì„±(<code class="language-plaintext highlighter-rouge">Isolation</code>), ì§€ì†ì„±(<code class="language-plaintext highlighter-rouge">Durability</code>)ì„ ë³´ì¥í•´ì•¼ í•œë‹¤.</p>
<ul>
  <li><strong>ì›ìì„±</strong>: íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì‹¤í–‰í•œ ì‘ì—…ë“¤ì€ ë§ˆì¹˜ í•˜ë‚˜ì˜ ì‘ì—…ì¸ ê²ƒì²˜ëŸ¼ ëª¨ë‘ ì„±ê³µ í•˜ë“ ê°€ ëª¨ë‘ ì‹¤íŒ¨í•´ì•¼ í•œë‹¤.</li>
  <li><strong>ì¼ê´€ì„±</strong>: ëª¨ë“  íŠ¸ëœì­ì…˜ì€ ì¼ê´€ì„± ìˆëŠ” ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœë¥¼ ìœ ì§€í•´ì•¼ í•œë‹¤.</li>
  <li><strong>ê²©ë¦¬ì„±</strong>: ë™ì‹œì— ì‹¤í–‰ë˜ëŠ” íŠ¸ëœì­ì…˜ë“¤ì´ ì„œë¡œì—ê²Œ ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šë„ë¡ ê²©ë¦¬í•œë‹¤.</li>
  <li><strong>ì§€ì†ì„±</strong>: íŠ¸ëœì­ì…˜ì„ ì„±ê³µì ìœ¼ë¡œ ëë‚´ë©´ ê·¸ ê²°ê³¼ê°€ í•­ìƒ ê¸°ë¡ë˜ì–´ì•¼ í•œë‹¤.<br />
<br /></li>
</ul>

<p><strong><code class="language-plaintext highlighter-rouge">ANSI</code> í‘œì¤€ íŠ¸ëœì­ì…˜ì˜ ê²©ë¦¬ ìˆ˜ì¤€ 4ë‹¨ê³„</strong></p>
<ul>
  <li><strong>READ UNCOMMITED</strong>
    <ul>
      <li>íŠ¸ëœì­ì…˜ì—ì„œ ë³€ê²½í•˜ëŠ” ë‚´ìš©ì´ commitê³¼ rollbackì—¬ë¶€ì— ê´€ê³„ ì—†ì´ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ê²Œ ë…¸ì¶œëœë‹¤.</li>
    </ul>
  </li>
  <li><strong>READ COMMITTED</strong>
    <ul>
      <li>íŠ¸ëœì­ì…˜ì—ì„œ ë³€ê²½í•œ ë ˆì½”ë“œëŠ” commitì´ ì™„ë£Œëœ ë°ì´í„°ë§Œ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.</li>
      <li>commit ì „ì— ì¡°íšŒë¥¼ ì‹œë„í•œë‹¤ë©´ UNDOì˜ì—­ì— ë°±ì—…ëœ ë ˆì½”ë“œë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.</li>
    </ul>
  </li>
  <li><strong>REPEATABLE READ</strong>
    <ul>
      <li>InnoDB ì—”ì§„ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê¸°ë³¸ ê²©ë¦¬ ìˆ˜ì¤€.</li>
      <li>REPEATABLE READë€ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ ë‚´ë¶€ì—ì„œ ê°™ì€ SELECT ë¬¸ì€ í•­ìƒ ê°™ì€ ê²°ê³¼ë¥¼ ë³´ì—¬ì£¼ëŠ” ê²ƒ.</li>
      <li>MySQL InnoDBì—ì„œëŠ” íŠ¸ëœì­ì…˜ë³„ë¡œ ì‹ë³„ìë¥¼ ì£¼ê³  íŠ¸ëœì­ì…˜ì—ì„œ ë³€ê²½í•˜ëŠ” ë°ì´í„°ë¥¼ UNDOì˜ì—­ì— ë°±ì—…í•œë‹¤.</li>
      <li>ì´ ë°±ì—…ëœ ë°ì´í„°ì™€ íŠ¸ëœì­ì…˜ ì‹ë³„ìë¡œ ë™ì¼ íŠ¸ëœì­ì…˜ì—ì„œ ë™ì¼ ê²°ê³¼ê°’ì„ ë³´ì—¬ì¤„ ìˆ˜ ìˆë„ë¡ ë³´ì¥í•œë‹¤.</li>
    </ul>
  </li>
  <li><strong>SERIALIZABLE</strong>
    <ul>
      <li>ê°€ì¥ ë†’ì€ ê²©ë¦¬ ìˆ˜ì¤€.</li>
      <li>ë ˆì½”ë“œë¥¼ ì¡°íšŒí•  ë•Œ Shared Lockì„ íšë“í•´ì•¼ë§Œ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.</li>
      <li>ë°ì´í„°ë¥¼ ë³€ê²½í•  ë•Œì—ëŠ” Exclusive Lockì„ íšë“í•´ì•¼ë§Œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.</li>
      <li>ì¦‰ í•œ íŠ¸ëœì­ì…˜ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°ì´í„°ëŠ” ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ì—†ê²Œ ë§Œë“ ë‹¤.</li>
      <li>ë°ì´í„° ì •í•©ì„±ì„ ì§€í‚¤ëŠ” ë©´ì€ ê°€ì¥ ìš°ìˆ˜í•˜ì§€ë§Œ ë™ì‹œ ì²˜ë¦¬ ì„±ëŠ¥ì´ ë–¨ì–´ì§„ë‹¤.<br />
<br /></li>
    </ul>
  </li>
</ul>

<p><strong>ê²©ë¦¬ ìˆ˜ì¤€ì— ë”°ë¥¸ ë¬¸ì œì </strong></p>
<ul>
  <li><strong>DIRTY READ</strong>
    <ul>
      <li>íŠ¸ëœì­ì…˜ì—ì„œ ì‘ì—…ì´ ë‹¤ ëë‚˜ì§€ ì•Šì•˜ì§€ë§Œ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ì‘ì—… ë‚´ìš©ì„ ë³¼ ìˆ˜ ìˆëŠ” ê²ƒì„ DIRTY READë¼ê³  í•œë‹¤.</li>
      <li>ë³€ê²½ëœ ë°ì´í„°ê°€ ë¡¤ë°±ë ì§€, ì»¤ë°‹ë ì§€ ëª¨ë¥´ëŠ” ìƒí™©ì—ì„œ ì‘ì—… ë‚´ìš©ì„ ì¡°íšŒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë°ì´í„° ì •í•©ì„±ì— í° ë¬¸ì œë¥¼ ìœ ë°œí•  ìˆ˜ ìˆë‹¤.</li>
    </ul>
  </li>
  <li><strong>NON REPEATABLE READ</strong>
    <ul>
      <li>í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì—ì„œ ê°™ì€ SELECTë¬¸ìœ¼ë¡œ ì¡°íšŒí•  ë•Œ ë§ˆë‹¤ ë‹¤ë¥¸ê²°ê³¼ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤ë©´ ì´ë¥¼ NON REPEATABLE READìƒíƒœë¼ê³  ë¶€ë¥¸ë‹¤.</li>
    </ul>
  </li>
  <li><strong>PHANTOM READ</strong>
    <ul>
      <li>í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì—ì„œ ê°™ì€ SELECTë¬¸ìœ¼ë¡œ ì¡°íšŒí•  ë•Œ ì´ì „ SELECTì—ì„œëŠ” ì¡´ì¬í•˜ì§€ ì•Šë˜ ê°’ì´ ë‹¤ìŒ SELECTì— ì¡°íšŒë˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.<br />
<br /></li>
    </ul>
  </li>
</ul>

<p><strong>íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ê³¼ ë¬¸ì œì  ì •ë¦¬</strong></p>

<table>
  <thead>
    <tr>
      <th><strong>ê²©ë¦¬ ìˆ˜ì¤€</strong></th>
      <th><strong>DIRTY READ</strong></th>
      <th><strong>NON-REPEATABLE READ</strong></th>
      <th><strong>PHANTOM READ</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>READ UNCOMMITED</td>
      <td>O</td>
      <td>O</td>
      <td>O</td>
    </tr>
    <tr>
      <td>READ COMMITTED</td>
      <td>Â </td>
      <td>O</td>
      <td>O</td>
    </tr>
    <tr>
      <td>REPEATABLE READ</td>
      <td>Â </td>
      <td>Â </td>
      <td>O</td>
    </tr>
    <tr>
      <td>SERIALIZABLE</td>
      <td>Â </td>
      <td>Â </td>
      <td>Â </td>
    </tr>
  </tbody>
</table>

<p><br />
<br /></p>

<h3 id="1612-ë‚™ê´€ì -ë½ê³¼-ë¹„ê´€ì -ë½-ê¸°ì´ˆ">16.1.2 ë‚™ê´€ì  ë½ê³¼ ë¹„ê´€ì  ë½ ê¸°ì´ˆ</h3>
<p><code class="language-plaintext highlighter-rouge">JPA</code>ëŠ” ë°ì´í„°ë² ì´ìŠ¤ íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ì„ <code class="language-plaintext highlighter-rouge">READ COMMITED</code> ì •ë„ë¡œ ê°€ì •í•œë‹¤. ë§Œì•½ ì¼ë¶€ ë¡œì§ì— ë” ë†’ì€ ê²©ë¦¬ ìˆ˜ì¤€ì´ í•„ìš”í•˜ë©´ ë‚™ê´€ì  ë½ê³¼ ë¹„ê´€ì  ë½ ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.</p>

<p><strong>ë‚™ê´€ì  ë½</strong><br />
ë°ì´í„°ë² ì´ìŠ¤ê°€ ì œê³µí•˜ëŠ” ë½ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ JPAê°€ ì œê³µí•˜ëŠ” ë²„ì „ ê´€ë¦¬ ê¸°ëŠ¥ì„ ì‚¬ìš©í•œë‹¤. íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•˜ê¸° ì „ê¹Œì§€ëŠ” íŠ¸ëœì­ì…˜ì˜ ì¶©ëŒì„ ì•Œ ìˆ˜ ì—†ë‹¤ëŠ” íŠ¹ì§•ì´ ìˆë‹¤.</p>

<p><strong>ë¹„ê´€ì  ë½</strong><br />
íŠ¸ëœì­ì…˜ì˜ ì¶©ëŒì´ ë°œìƒí•œë‹¤ê³  ê°€ì •í•˜ê³  ìš°ì„  ë½ì„ ê±¸ê³  ë³´ëŠ” ë°©ë²•ì´ë‹¤. ë°ì´í„°ë² ì´ìŠ¤ê°€ ì œê³µí•˜ëŠ” ë½ ê¸°ëŠ¥ì„ ì‚¬ìš©í•œë‹¤. ëŒ€í‘œì ìœ¼ë¡œ select for update êµ¬ë¬¸ì´ ìˆë‹¤.</p>

<p><strong>ë‘ ë²ˆì˜ ê°±ì‹  ë¶„ì‹¤ ë¬¸ì œ</strong><br />
ì‚¬ìš©ì Aê°€ ìˆ˜ì •í•˜ê³  ì‚¬ìš©ì Bê°€ 1ì´ˆ ë’¤ì— ìˆ˜ì • ìš”ì²­ì„ í•˜ê²Œ ë˜ë©´ ì‚¬ìš©ì Bì˜ ìˆ˜ì •ì‚¬í•­ë§Œ ë‚¨ê²Œ ëœë‹¤. ì´ê²ƒì„ ë‘ ë²ˆì˜ ê°±ì‹  ë¶„ì‹¤ ë¬¸ì œë¼ í•œë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ 3ê°€ì§€ ì„ íƒ ë°©ë²•ì´ ìˆë‹¤.</p>

<ul>
  <li>ë§ˆì§€ë§‰ ì»¤ë°‹ë§Œ ì¸ì •í•˜ê¸°: ì‚¬ìš©ì Aì˜ ë‚´ìš©ì€ ë¬´ì‹œí•˜ê³  ë§ˆì§€ë§‰ì— ì»¤ë°‹í•œ ì‚¬ìš©ì Bì˜ ë‚´ìš©ë§Œ ì¸ì •í•œë‹¤.</li>
  <li>ìµœì´ˆ ì»¤ë°‹ë§Œ ì¸ì •í•˜ê¸°: ì‚¬ìš©ì Aê°€ ì´ë¯¸ ìˆ˜ì •ì„ ì™„ë£Œí–ˆìœ¼ë¯€ë¡œ ì‚¬ìš©ì Bê°€ ìˆ˜ì •ì„ ì™„ë£Œí•  ë•Œ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.</li>
  <li>ì¶©ëŒí•˜ëŠ” ê°±ì‹  ë‚´ìš© ë³‘í•©í•˜ê¸°: ì‚¬ìš©ì Aì™€ ì‚¬ìš©ì Bì˜ ìˆ˜ì •ì‚¬í•­ì„ ë³‘í•©í•œë‹¤.</li>
</ul>

<p><br />
<br /></p>

<h3 id="1613-version">16.1.3 @Version</h3>
<p>JPAê°€ ì œê³µí•˜ëŠ” ë‚™ê´€ì  ë½ì„ ì‚¬ìš©í•˜ë ¤ë©´ <code class="language-plaintext highlighter-rouge">@Version</code> ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•´ì„œ ë²„ì „ ê´€ë¦¬ ê¸°ëŠ¥ì„ ì¶”ê°€í•´ì•¼ í•œë‹¤.</p>

<div class="notice--info">
<p><strong>@Version ì ìš© ê°€ëŠ¥ íƒ€ì…</strong></p>
<ul>
  <li>Long (long)</li>
  <li>Integer (int)</li>
  <li>Shoort (short)</li>
  <li>Timestamp</li>
</ul>
</div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Board</span> <span class="o">{</span>

	<span class="nd">@Id</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>

	<span class="nd">@Version</span>
	<span class="kd">private</span> <span class="nc">Integer</span> <span class="n">version</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ì´ì œë¶€í„° ì—”í‹°í‹°ë¥¼ ìˆ˜ì •í•  ë•Œ ë§ˆë‹¤ ë²„ì „ì´ í•˜ë‚˜ì”© ìë™ìœ¼ë¡œ ì¦ê°€í•œë‹¤. ê·¸ë¦¬ê³  ì—”í‹°í‹°ë¥¼ ìˆ˜ì •í•  ë•Œ ì¡°íšŒ ì‹œì ì˜ ë²„ì „ê³¼ ìˆ˜ì • ì‹œì ì˜ ë²„ì „ì´ ë‹¤ë¥´ë©´ ì˜ˆì™¸ê°€ ë°œìƒí•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// íŠ¸ëœì­ì…˜ 1 ì¡°íšŒ title="ì œëª©A", version=1</span>
<span class="nc">Board</span> <span class="n">board</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Board</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>

<span class="c1">// íŠ¸ëœì­ì…˜ 2ì—ì„œ í•´ë‹¹ ê²Œì‹œë¬¼ì„ ìˆ˜ì •í•´ì„œ title="ì œëª©C", version=2ë¡œ ì¦ê°€</span>
<span class="n">board</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">"ì œëª©B"</span><span class="o">);</span> <span class="c1">// íŠ¸ëœì­ì…˜ 1 ë°ì´í„° ìˆ˜ì •</span>

<span class="n">save</span><span class="o">(</span><span class="n">board</span><span class="o">);</span>
<span class="n">tx</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span> <span class="c1">//ì˜ˆì™¸ ë°œìƒ, ë°ì´í„°ë² ì´ìŠ¤ version=2, ì—”í‹°í‹° version=1</span>
</code></pre></div></div>

<center><img src="/assets/images/posts/books/2/16_1_version.png" width="100%" height="100%" /></center>

<p>íŠ¸ëœì­ì…˜ 1ì´ ë°ì´í„°ë¥¼ ì œëª© Bë¡œ ë³€ê²½í•˜ê³  íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•˜ëŠ” ìˆœê°„ ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•  ë•Œ ë²„ì „ê³¼ ë°ì´í„°ë² ì´ìŠ¤ì˜ í˜„ì¬ ë²„ì „ ì •ë³´ê°€ ë‹¤ë¥´ë¯€ë¡œ ì˜ˆì™¸ê°€ ë°œìƒí•œë‹¤. <strong>ë”°ë¼ì„œ ë²„ì „ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ë©´ ìµœì´ˆ ì»¤ë°‹ë§Œ ì¸ì •í•˜ê¸°ê°€ ì ìš©</strong>ëœë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">@Version</code>ìœ¼ë¡œ ì¶”ê°€í•œ <strong>ë²„ì „ ê´€ë¦¬ í•„ë“œëŠ” JPAê°€ ì§ì ‘ ê´€ë¦¬í•˜ë¯€ë¡œ ê°œë°œìê°€ ì„ì˜ë¡œ ìˆ˜ì •í•˜ë©´ ì•ˆ ëœë‹¤(ë²Œí¬ ì—°ì‚° ì œì™¸)</strong> ë§Œì•½ ë²„ì „ ê°’ì„ ê°•ì œë¡œ ì¦ê°€ í•˜ë ¤ë©´ íŠ¹ë³„í•œ ë½ ì˜µì…˜ì„ ì„ íƒí•˜ë©´ ëœë‹¤.</p>

<div class="notice--info">
<p><strong>ì°¸ê³ </strong><br />
ë²Œí¬ ì—°ì‚°ì€ ë²„ì „ì„ ë¬´ì‹œí•œë‹¤. ë²Œí¬ ì—°ì‚°ì—ì„œ ë²„ì „ì„ ì¦ê°€í•˜ë ¤ë©´ ë²„ì „ í•„ë“œë¥¼ ê°•ì œë¡œ ì¦ê°€ì‹œì¼œì•¼ í•œë‹¤.<br />
<code class="language-plaintext highlighter-rouge">update Member m set m.name = 'ë³€ê²½', m.version = m.version + 1</code></p>
</div>
<p><br />
<br /></p>

<h3 id="1614-jpa-ë½-ì‚¬ìš©">16.1.4 JPA ë½ ì‚¬ìš©</h3>

<div class="notice--info">
<p><strong>ì°¸ê³ </strong><br />
JPAë¥¼ ì‚¬ìš©í•  ë•Œ ì¶”ì²œí•˜ëŠ” ì „ëµì€ <code class="language-plaintext highlighter-rouge">READ COMMITTED</code> íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ + ë‚™ê´€ì  ë²„ì „ ê´€ë¦¬ë‹¤. (ë‘ ë²ˆì˜ ê°±ì‹  ë‚´ì—­ ë¶„ì‹¤ ë¬¸ì œ ì˜ˆë°©)</p>
</div>

<p>ë½ì€ ë‹¤ìŒ ìœ„ì¹˜ì— ì ìš©í•  ìˆ˜ ìˆë‹¤.</p>
<ul>
  <li>EntityManager.lock(), EntityManager.find(), EntityManager.refresh()</li>
  <li>Query.setLockMode() (TypeQuery í¬í•¨)</li>
  <li>@NamedQuery</li>
</ul>

<p>JPAê°€ ì œê³µí•˜ëŠ” ë½ ì˜µì…˜ì€ <code class="language-plaintext highlighter-rouge">javax.persistence.LockModeType</code>ì— ì •ì˜ë˜ì–´ ìˆë‹¤.</p>

<table>
  <thead>
    <tr>
      <th><strong>ë½ ëª¨ë“œ</strong></th>
      <th><strong>íƒ€ì…</strong></th>
      <th><strong>ì„¤ëª…</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ë‚™ê´€ì  ë½</td>
      <td>OPTIMISTIC</td>
      <td>ë‚™ê´€ì  ë½ì„ ì‚¬ìš©í•œë‹¤.</td>
    </tr>
    <tr>
      <td>ë‚™ê´€ì  ë½</td>
      <td>OPTIMISTIC_FORCE_INCREMENT</td>
      <td>ë‚™ê´€ì  ë½ + ë²„ì „ì •ë³´ë¥¼ ê°•ì œë¡œ ì¦ê°€í•œë‹¤.</td>
    </tr>
    <tr>
      <td>ë¹„ê´€ì  ë½</td>
      <td>PESSIMISTIC_READ</td>
      <td>ë¹„ê´€ì  ë½, ì½ê¸° ë½ì„ ì‚¬ìš©í•œë‹¤.</td>
    </tr>
    <tr>
      <td>ë¹„ê´€ì  ë½</td>
      <td>PESSIMISTIC_WRITE</td>
      <td>ë¹„ê´€ì  ë½, ì“°ê¸° ë½ì„ ì‚¬ìš©í•œë‹¤.</td>
    </tr>
    <tr>
      <td>ë¹„ê´€ì  ë½</td>
      <td>PESSIMISTIC_FORCE_INCREMENT</td>
      <td>ë¹„ê´€ì  ë½, ë²„ì „ì •ë³´ë¥¼ ê°•ì œë¡œ ì¦ê°€í•œë‹¤.</td>
    </tr>
    <tr>
      <td>ê¸°íƒ€</td>
      <td>NONE</td>
      <td>ë½ì„ ê±¸ì§€ ì•ŠëŠ”ë‹¤.</td>
    </tr>
    <tr>
      <td>ê¸°íƒ€</td>
      <td>READ</td>
      <td>JPA1.0 í˜¸í™˜ ê¸°ëŠ¥ì´ë‹¤. OPTIMISTICê³¼ ê°™ìœ¼ë¯€ë¡œ OPTIMISTICì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤.</td>
    </tr>
    <tr>
      <td>ê¸°íƒ€</td>
      <td>WRITE</td>
      <td>JPA1.0 í˜¸í™˜ ê¸°ëŠ¥ì´ë‹¤. OPTIMISTIC_FORCE_INCREMENTì™€ ê°™ë‹¤</td>
    </tr>
  </tbody>
</table>

<p><br />
<br /></p>

<h3 id="1615-jpa-ë‚™ê´€ì -ë½">16.1.5 JPA ë‚™ê´€ì  ë½</h3>
<p>JPAê°€ ì œê³µí•˜ëŠ” ë‚™ê´€ì  ë½ì€ ë²„ì „ì„ ì‚¬ìš©í•œë‹¤. ë”°ë¼ì„œ ë‚™ê´€ì  ë½ì„ ì‚¬ìš©í•˜ë ¤ë©´ ë²„ì „ì´ ìˆì–´ì•¼ í•œë‹¤. ë‚™ê´€ì  ë½ì€ íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•˜ëŠ” ì‹œì ì— ì¶©ëŒì„ ì•Œ ìˆ˜ ìˆë‹¤ëŠ” íŠ¹ì§•ì´ ìˆë‹¤. ë‚™ê´€ì  ë½ì˜ ì˜µì…˜ì— ë”°ë¥¸ íš¨ê³¼ë¥¼ ì•Œì•„ë³´ì.</p>

<p><strong>NONE</strong><br />
ë½ ì˜µì…˜ì„ ì ìš©í•˜ì§€ ì•Šì•„ë„ ì—”í‹°í‹°ì— <code class="language-plaintext highlighter-rouge">@Version</code>ì´ ì ìš©ëœ í•„ë“œë§Œ ìˆìœ¼ë©´ ë‚™ê´€ì  ë½ì´ ì ìš©ëœë‹¤.</p>
<ul>
  <li>ìš©ë„: ì¡°íšŒí•œ ì—”í‹°í‹°ë¥¼ ìˆ˜ì •í•  ë•Œ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì— ì˜í•´ ë³€ê²½(ì‚­ì œ)ë˜ì§€ ì•Šì•„ì•¼ í•œë‹¤. ì¡°íšŒ ì‹œì ë¶€í„° ìˆ˜ì • ì‹œì ê¹Œì§€ë¥¼ ë³´ì¥í•œë‹¤.</li>
  <li>ë™ì‘: ì—”í‹°í‹°ë¥¼ ìˆ˜ì •í•  ë•Œ ë²„ì „ì„ ì²´í¬í•˜ë©´ì„œ ë²„ì „ì„ ì¦ê°€í•œë‹¤.(UPDATE ì¿¼ë¦¬ ì‚¬ìš©). ì´ë•Œ ë°ì´í„°ë² ì´ìŠ¤ì˜ ë²„ì „ ê°’ì´ í˜„ì¬ ë²„ì „ì´ ì•„ë‹ˆë©´ ì˜ˆì™¸ê°€ ë°œìƒí•œë‹¤.</li>
  <li>ì´ì : ë‘ ë²ˆì˜ ê°±ì‹  ë¶„ì‹¤ ë¬¸ì œë¥¼ ì˜ˆë°©í•œë‹¤.<br />
<br /></li>
</ul>

<p><strong>OPTIMISTIC</strong><br />
<code class="language-plaintext highlighter-rouge">@Version</code>ë§Œ ì ìš©í–ˆì„ ë•ŒëŠ” ì—”í‹°í‹°ë¥¼ ìˆ˜ì •í•´ì•¼ ë²„ì „ì„ ì²´í¬í•˜ì§€ë§Œ ì´ ì˜µì…˜ì„ ì¶”ê°€í•˜ë©´ <strong>ì—”í‹°í‹°ë¥¼ ì¡°íšŒë§Œ í•´ë„ ë²„ì „ì„ ì²´í¬</strong>í•œë‹¤. <strong>í•œ ë²ˆ ì¡°íšŒí•œ ì—”í‹°í‹°ëŠ” íŠ¸ëœì­ì…˜ì„ ì¢…ë£Œí•  ë•Œê¹Œì§€ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ë³€ê²½ë˜ì§€ ì•ŠìŒì„ ë³´ì¥</strong>í•œë‹¤.</p>
<ul>
  <li>ìš©ë„: ì¡°íšŒ ì‹œì ë¶€í„° íŠ¸ëœì­ì…˜ì´ ëë‚  ë•Œê¹Œì§€ ì¡°íšŒí•œ ì—”í‹°í‹°ê°€ ë³€ê²½ë˜ì§€ ì•ŠìŒì„ ë³´ì¥í•œë‹¤.</li>
  <li>ë™ì‘: íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•  ë•Œ ë²„ì „ ì •ë³´ë¥¼ ì¡°íšŒí•´ì„œ í˜„ì¬ ì—”í‹°í‹°ì˜ ë²„ì „ê³¼ ê°™ì€ì§€ ê²€ì¦í•œë‹¤. ë§Œì•½ ê°™ì§€ ì•Šìœ¼ë©´ ì˜ˆì™¸ê°€ ë°œìƒí•œë‹¤.</li>
  <li>ì´ì : <code class="language-plaintext highlighter-rouge">OPTIMISTIC</code> ì˜µì…˜ì€ <code class="language-plaintext highlighter-rouge">DIRTY READ</code>ì™€ <code class="language-plaintext highlighter-rouge">NON-REPEATABLE READ</code>ë¥¼ ë°©ì§€í•œë‹¤.<br />
<br /></li>
</ul>

<p><strong>OPTIMISTIC_FORCE_INCREMENT</strong><br />
íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•  ë•Œ UPDATE ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•´ì„œ ë²„ì „ ì •ë³´ë¥¼ ê°•ì œë¡œ ì¦ê°€ì‹œí‚¨ë‹¤.</p>
<ul>
  <li>ìš©ë„: ë…¼ë¦¬ì ì¸ ë‹¨ìœ„ì˜ ì—”í‹°í‹° ë¬¶ìŒì„ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤. ê²Œì‹œë¬¼ê³¼ ì²¨ë¶€íŒŒì¼ì´ ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ì˜ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ì´ê³  ì²¨ë¶€íŒŒì¼ì´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ë‹¤. ê²Œì‹œë¬¼ì„ ìˆ˜ì •í•˜ëŠ” ë° ë‹¨ìˆœíˆ ì²¨ë¶€íŒŒì¼ë§Œ ì¶”ê°€í•˜ë©´ ê²Œì‹œë¬¼ì˜ ë²„ì „ì€ ì¦ê°€í•˜ì§€ ì•ŠëŠ”ë‹¤. ì´ë•Œ ê²Œì‹œë¬¼ì˜ ë²„ì „ë„ ê°•ì œë¡œ ì¦ê°€í•˜ë ¤ë©´ <code class="language-plaintext highlighter-rouge">OPTIMISTIC_FORCE_INCREMENT</code>ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.</li>
  <li>ë™ì‘: <strong>íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•  ë•Œ UPDATE ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•´ì„œ ë²„ì „ ì •ë³´ë¥¼ ê°•ì œë¡œ ì¦ê°€ì‹œí‚¨ë‹¤.</strong> ì¶”ê°€ë¡œ ì—”í‹°í‹°ë¥¼ ìˆ˜ì •í•˜ë©´ ìˆ˜ì • ì‹œ ë²„ì „ UPDATEê°€ ë°œìƒí•œë‹¤. ë”°ë¼ì„œ ì´ 2ë²ˆì˜ ë²„ì „ ì¦ê°€ê°€ ë‚˜íƒ€ë‚  ìˆ˜ ìˆë‹¤.</li>
  <li>ì´ì : ê°•ì œë¡œ ë²„ì „ì„ ì¦ê°€í•´ì„œ ë…¼ë¦¬ì ì¸ ë‹¨ìœ„ì˜ ì—”í‹°í‹° ë¬¶ìŒì„ ë²„ì „ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.<br />
<br />
<br />
<br /></li>
</ul>

<h3 id="1616-jpa-ë¹„ê´€ì -ë½">16.1.6 JPA ë¹„ê´€ì  ë½</h3>
<p>JPAê°€ ì œê³µí•˜ëŠ” <strong>ë¹„ê´€ì  ë½ì€ ë°ì´í„°ë² ì´ìŠ¤ íŠ¸ëœì­ì…˜ ë½ ë©”ì»¤ë‹ˆì¦˜ì— ì˜ì¡´í•˜ëŠ” ë°©ë²•</strong>ì´ë‹¤. ì£¼ë¡œ SQL ì¿¼ë¦¬ì— <code class="language-plaintext highlighter-rouge">select for update</code> êµ¬ë¬¸ì„ ì‚¬ìš©í•˜ë©´ì„œ ì‹œì‘í•˜ê³  ë²„ì „ ì •ë³´ëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.</p>

<p><strong>ë¹„ê´€ì  ë½ì˜ íŠ¹ì§•</strong></p>
<ul>
  <li>ì—”í‹°í‹°ê°€ ì•„ë‹Œ ìŠ¤ì¹¼ë¼ íƒ€ì…ì„ ì¡°íšŒí•  ë•Œë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
  <li>ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ëŠ” ì¦‰ì‹œ íŠ¸ëœì­ì…˜ ì¶©ëŒì„ ê°ì§€í•  ìˆ˜ ìˆë‹¤.<br />
<br /></li>
</ul>

<p><strong>PESSIMISTIC_WRITE</strong></p>
<ul>
  <li>ìš©ë„: ë°ì´í„°ë² ì´ìŠ¤ì— ì“°ê¸° ë½ì„ ê±´ë‹¤</li>
  <li>ë™ì‘: ë°ì´í„°ë² ì´ìŠ¤ <code class="language-plaintext highlighter-rouge">select for update</code>ë¥¼ ì‚¬ìš©í•´ì„œ ë½ì„ ê±´ë‹¤.</li>
  <li>ì´ì : <code class="language-plaintext highlighter-rouge">NON-REPEATABLE READ</code>ë¥¼ ë°©ì§€í•œë‹¤. ë½ì´ ê±¸ë¦° ë¡œìš°ëŠ” ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì´ ìˆ˜ì •í•  ìˆ˜ ì—†ë‹¤.<br />
<br /></li>
</ul>

<p><strong>PESSIMISTIC_READ</strong><br />
ë°ì´í„°ë¥¼ ë°˜ë³µ ì½ê¸°ë§Œ í•˜ê³  ìˆ˜ì •í•˜ì§€ ì•ŠëŠ” ìš©ë„ë¡œ ë½ì„ ê±¸ ë•Œ ì‚¬ìš©í•œë‹¤. ë°ì´í„°ë² ì´ìŠ¤ ëŒ€ë¶€ë¶„ì€ <code class="language-plaintext highlighter-rouge">PESSIMISTIC_WRITE</code>ë¡œ ë™ì‘í•œë‹¤.</p>
<ul>
  <li>MySQL: lock in share mode</li>
  <li>PostgreSQL: for share<br />
<br /></li>
</ul>

<p><strong>PESSIMISTIC_FORCE_INCREMENT</strong><br />
ë¹„ê´€ì  ë½ì¤‘ ìœ ì¼í•˜ê²Œ ë²„ì „ ì •ë³´ë¥¼ ì‚¬ìš©í•œë‹¤. í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” <code class="language-plaintext highlighter-rouge">nowait</code>ë¥¼ ì§€ì›í•˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— ëŒ€í•´ì„œ <code class="language-plaintext highlighter-rouge">for update nowait</code> ì˜µì…˜ì„ ì ìš©í•œë‹¤.</p>
<ul>
  <li>ì˜¤ë¼í´: for update nowait</li>
  <li>PostreSQL: for update nowait</li>
  <li>nowaitë¥¼ ì§€ì›í•˜ì§€ ì•Šìœ¼ë©´ for updateê°€ ì‚¬ìš©ëœë‹¤.<br />
<br />
<br /></li>
</ul>

<h3 id="1617-ë¹„ê´€ì -ë½ê³¼-íƒ€ì„ì•„ì›ƒ">16.1.7 ë¹„ê´€ì  ë½ê³¼ íƒ€ì„ì•„ì›ƒ</h3>
<p>ë¹„ê´€ì  ë½ì„ ì‚¬ìš©í•˜ë©´ ë½ì„ íšë“í•  ë•Œê¹Œì§€ íŠ¸ëœì­ì…˜ì´ ëŒ€ê¸°í•œë‹¤. ë¬´í•œì • ê¸°ë‹¤ë¦´ ìˆ˜ëŠ” ì—†ìœ¼ë¯€ë¡œ íƒ€ì„ì•„ì›ƒ ì‹œê°„ì„ ì¤„ ìˆ˜ ìˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">properties</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;();</span>

<span class="c1">// íƒ€ì„ì•„ì›ƒ 10ì´ˆê¹Œì§€ ëŒ€ê¸° ì„¤ì •</span>
<span class="n">properties</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"java.persistence.lock.timeout"</span><span class="o">,</span> <span class="mi">10000</span><span class="o">);</span>

<span class="nc">Board</span> <span class="n">board</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Board</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"boardId"</span><span class="o">,</span> <span class="nc">LockModeType</span><span class="o">.</span><span class="na">PESSIMISTIC_WRITE</span><span class="o">,</span> <span class="n">properties</span><span class="o">);</span>
</code></pre></div></div>
<p><br />
<br />
<br /></p>

<h2 id="162-2ì°¨-ìºì‹œ">16.2 2ì°¨ ìºì‹œ</h2>
<p>JPAê°€ ì œê³µí•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ë²”ìœ„ì˜ ìºì‹œì— ëŒ€í•´ ì•Œì•„ë³´ê³  í•˜ì´ë²„ë„¤ì´íŠ¸ì™€ EHCACHEë¥¼ ì‚¬ìš©í•´ì„œ ì‹¤ì œ ìºì‹œë¥¼ ì ìš©í•´ë³´ì.</p>

<h3 id="1621-1ì°¨-ìºì‹œì™€-2ì°¨-ìºì‹œ">16.2.1 1ì°¨ ìºì‹œì™€ 2ì°¨ ìºì‹œ</h3>
<p>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¡œ ì–»ì„ ìˆ˜ ìˆëŠ” ì´ì ì´ ë§ì§€ë§Œ, ì¼ë°˜ì ì¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ í™˜ê²½ì€ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ê³  ì¢…ë£Œí•  ë•Œê¹Œì§€ë§Œ 1ì°¨ ìºì‹œê°€ ìœ íš¨í•˜ë‹¤. OSIVë¥¼ ì‚¬ìš©í•´ë„ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì´ ë“¤ì–´ì˜¬ ë•Œë¶€í„° ëë‚  ë•Œê¹Œì§€ë§Œ 1ì°¨ ìºì‹œê°€ ìœ íš¨í•˜ë‹¤. ë”°ë¼ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ë¡œ ë³´ë©´ ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼ íšŸìˆ˜ë¥¼ íšê¸°ì ìœ¼ë¡œ ì¤„ì´ì§€ëŠ” ëª»í•œë‹¤. í•˜ì´ë²„ë„¤ì´íŠ¸ë¥¼ í¬í•¨í•œ ëŒ€ë¶€ë¶„ì˜ JPA êµ¬í˜„ì²´ë“¤ì€ <strong>ì• í”Œë¦¬ì¼€ì´ì…˜ ë²”ìœ„ì˜ ìºì‹œë¥¼ ì§€ì›í•˜ëŠ”ë° ì´ê²ƒì„ ê³µìœ  ìºì‹œ ë˜ëŠ” 2ì°¨ ìºì‹œë¼ í•œë‹¤.</strong></p>

<center><img src="/assets/images/posts/books/2/16_2_2ì°¨ìºì‹œì ìš©.png" width="90%" height="90%" /></center>
<p><br /></p>

<p><strong>1ì°¨ ìºì‹œ</strong><br />
1ì°¨ ìºì‹œëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ë‚´ë¶€ì— ìˆë‹¤. ì—”í‹°í‹° ë§¤ë‹ˆì €ë¡œ ì¡°íšŒí•˜ê±°ë‚˜ ë³€ê²½í•˜ëŠ” ëª¨ë“  ì—”í‹°í‹°ëŠ” 1ì°¨ ìºì‹œì— ì €ì¥ëœë‹¤. íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•˜ê±°ë‚˜ í”ŒëŸ¬ì‹œë¥¼ í˜¸ì¶œí•˜ë©´ 1ì°¨ ìºì‹œì— ìˆëŠ” ì—”í‹°í‹°ì˜ ë³€ê²½ ë‚´ì—­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë™ê¸°í™” í•œë‹¤.</p>
<center><img src="/assets/images/posts/books/2/16_2_1ì°¨ìºì‹œë™ì‘ë°©ì‹.png" width="90%" height="90%" /></center>
<p><br /></p>

<p><strong>2ì°¨ ìºì‹œ</strong><br />
2ì°¨ ìºì‹œëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ë²”ìœ„ì˜ ìºì‹œë‹¤. ë”°ë¼ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¢…ë£Œí•  ë•Œê¹Œì§€ ìºì‹œê°€ ìœ ì§€ëœë‹¤. ë¶„ì‚° ìºì‹œë‚˜ í´ëŸ¬ìŠ¤í„°ë§ í™˜ê²½ì˜ ìºì‹œëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ë³´ë‹¤ ë” ì˜¤ë˜ ìœ ì§€ë  ìˆ˜ë„ ìˆë‹¤. 2ì°¨ ìºì‹œë¥¼ ì ì ˆíˆ í™œìš©í•˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒ íšŸìˆ˜ë¥¼ íšê¸°ì ìœ¼ë¡œ ì¤„ì¼ ìˆ˜ ìˆë‹¤.</p>
<center><img src="/assets/images/posts/books/2/16_2_2ì°¨ìºì‹œë™ì‘ë°©ì‹.png" width="90%" height="90%" /></center>
<p><br /></p>

<p><strong>2ì°¨ ìºì‹œì˜ íŠ¹ì§•</strong></p>
<ul>
  <li>2ì°¨ ìºì‹œëŠ” ì˜ì†ì„± ìœ ë‹› ë²”ìœ„ì˜ ìºì‹œë‹¤</li>
  <li>2ì°¨ ìºì‹œëŠ” ì¡°íšŒí•œ ê°ì²´ë¥¼ ê·¸ëŒ€ë¡œ ë°˜í™˜í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë³µì‚¬ë³¸ì„ ë§Œë“¤ì–´ì„œ ë°˜í™˜í•œë‹¤.</li>
  <li>2ì°¨ ìºì‹œëŠ” ë°ì´í„°ë² ì´ìŠ¤ ê¸°ë³¸ í‚¤ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìºì‹œí•˜ì§€ë§Œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ë‹¤ë¥´ë©´ ê°ì²´ <code class="language-plaintext highlighter-rouge">ë™ì¼ì„±(a==b)</code>ì„ ë³´ì¥í•˜ì§€ ì•ŠëŠ”ë‹¤.<br />
<br />
<br /></li>
</ul>

<h3 id="1622-jpa-2ì°¨-ìºì‹œ-ê¸°ëŠ¥">16.2.2 JPA 2ì°¨ ìºì‹œ ê¸°ëŠ¥</h3>

<p><strong>ìºì‹œ ëª¨ë“œ ì„¤ì •</strong><br />
2ì°¨ ìºì‹œë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ <code class="language-plaintext highlighter-rouge">javax.persistence.Cacheable</code> ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤. <code class="language-plaintext highlighter-rouge">@Cacheable</code>ì€ <code class="language-plaintext highlighter-rouge">@Cacheable(true)</code>, <code class="language-plaintext highlighter-rouge">@Cacheable(false)</code>ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆëŠ”ë° ê¸°ë³¸ê°’ì€ <code class="language-plaintext highlighter-rouge">true</code>ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Cacheable</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>

	<span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
	<span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">shared-cache-mode</code>ë¥¼ ì„¤ì •í•´ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´(ì •í™•íˆëŠ” ì˜ì†ì„± ìœ ë‹› ë‹¨ìœ„)ì— ìºì‹œë¥¼ ì–´ë–»ê²Œ ì ìš©í• ì§€ ì˜µì…˜ì„ ì„¤ì •í•´ì•¼ í•œë‹¤.</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ ìºì‹œ ëª¨ë“œ ì„¤ì • --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"entityManagerFactory"</span> <span class="na">class=</span><span class="s">"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"sharedCacheMode"</span> <span class="na">value=</span><span class="s">"ENABLE_SELECTIVE"</span><span class="nt">&gt;</span>
    ...
</code></pre></div></div>
<p>ìºì‹œ ëª¨ë“œëŠ” <code class="language-plaintext highlighter-rouge">javax.persistence.SharedCacheMode</code>ì— ì •ì˜ë˜ì–´ ìˆë‹¤.</p>

<table>
  <thead>
    <tr>
      <th><strong>ìºì‹œ ëª¨ë“œ</strong></th>
      <th><strong>ì„¤ëª…</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ALL</td>
      <td>ëª¨ë“  ì—”í‹°í‹°ë¥¼ ìºì‹œí•œë‹¤.</td>
    </tr>
    <tr>
      <td>NONE</td>
      <td>ìºì‹œë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.</td>
    </tr>
    <tr>
      <td>ENABLE_SELECTIVE</td>
      <td>Cacheable(true)ë¡œ ì„¤ì •ëœ ì—”í‹°í‹°ë§Œ ìºì‹œë¥¼ ì ìš©í•œë‹¤.</td>
    </tr>
    <tr>
      <td>DISABLE_SELECTIVE</td>
      <td>ëª¨ë“  ì—”í‹°í‹°ë¥¼ ìºì‹œí•˜ëŠ”ë° Cacheable(false)ë¡œ ëª…ì‹œëœ ì—”í‹°í‹°ëŠ” ìºì‹œí•˜ì§€ ì•ŠëŠ”ë‹¤.</td>
    </tr>
    <tr>
      <td>UNSPECIFIED</td>
      <td>JPA êµ¬í˜„ì²´ê°€ ì •ì˜í•œ ì„¤ì •ì„ ë”°ë¥¸ë‹¤.</td>
    </tr>
  </tbody>
</table>

<p><br />
<br /></p>

<h3 id="1623-í•˜ì´ë²„ë„¤ì´íŠ¸ì™€-ehcache-ì ìš©">16.2.3 í•˜ì´ë²„ë„¤ì´íŠ¸ì™€ EHCACHE ì ìš©</h3>
<p>í•˜ì´ë²„ë„¤ì´íŠ¸ê°€ ì§€ì›í•˜ëŠ” ìºì‹œëŠ” í¬ê²Œ 3ê°€ì§€ê°€ ìˆë‹¤.</p>
<ul>
  <li>ì—”í‹°í‹° ìºì‹œ: ì—”í‹°í‹° ë‹¨ìœ„ë¡œ ìºì‹œí•œë‹¤. ì‹ë³„ìë¡œ ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•˜ê±°ë‚˜ ì»¬ë ‰ì…˜ì´ ì•„ë‹Œ ì—°ê´€ëœ ì—”í‹°í‹°ë¥¼ ë¡œë”©í•  ë•Œ ì‚¬ìš©í•œë‹¤.</li>
  <li>ì»¬ë ‰ì…˜ ìºì‹œ: ì—”í‹°í‹°ì™€ ì—°ê´€ëœ ì»¬ë ‰ì…˜ì„ ìºì‹œí•œë‹¤. ì»¬ë ‰ì…˜ì´ ì—”í‹°í‹°ë¥¼ ë‹´ê³  ìˆìœ¼ë©´ ì‹ë³„ì ê°’ë§Œ ìºì‹œí•œë‹¤(í•˜ì´ë²„ë„¤ì´íŠ¸ ê¸°ëŠ¥)</li>
  <li>ì¿¼ë¦¬ ìºì‹œ: ì¿¼ë¦¬ì™€ íŒŒë¼ë¯¸í„° ì •ë³´ë¥¼ í‚¤ë¡œ ì‚¬ìš©í•´ì„œ ìºì‹œí•œë‹¤. ê²°ê³¼ê°€ ì—”í‹°í‹°ë©´ ì‹ë³„ì ê°’ë§Œ ìºì‹œí•œë‹¤.(í•˜ì´ë²„ë„¤ì´íŠ¸ ê¸°ëŠ¥)<br />
<br /></li>
</ul>

<p><strong>í™˜ê²½ì„¤ì •</strong><br />
ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.hibernate<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>hibernate-ehcache<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>4.3.10.Final<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>
<p><br /></p>

<p>ìºì‹œ ì •ì±… ì„¤ì •</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- src/main/resources/ehcache.xml --&gt;</span>
<span class="nt">&lt;ehcache&gt;</span>
    <span class="nt">&lt;defaultCache</span>
        <span class="na">maxElementsInMemory=</span><span class="s">"10000"</span>
        <span class="na">eternal=</span><span class="s">"false"</span>
        <span class="na">timeToIdleSeconds=</span><span class="s">"1200"</span>
        <span class="na">timeToLiveSeconds=</span><span class="s">"1200"</span>
        <span class="na">diskExpiryThreadIntervalSeconds=</span><span class="s">"1200"</span>
        <span class="na">memoryStoreEvictionPolicy=</span><span class="s">"LRU"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ehcache&gt;</span>
</code></pre></div></div>
<p><br /></p>

<p>í•˜ì´ë²„ë„¤ì´íŠ¸ ìºì‹œ ì‚¬ìš© ì •ë³´ë¥¼ ì •ì˜</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># application.yml</span>
<span class="na">spring</span><span class="pi">:</span>
  <span class="na">jpa</span><span class="pi">:</span>
    <span class="na">properties</span><span class="pi">:</span>
      <span class="na">hibernate</span><span class="pi">:</span>
        <span class="na">generate_statistics</span><span class="pi">:</span> <span class="no">true</span>
        <span class="na">format_sql</span><span class="pi">:</span> <span class="no">true</span>

        <span class="na">cache</span><span class="pi">:</span>
          <span class="na">use_second_level_cache</span><span class="pi">:</span> <span class="no">true</span>
          <span class="na">region</span><span class="pi">:</span>
            <span class="na">factory_class</span><span class="pi">:</span> <span class="s">org.hibernate.cache.ehcache.EhCacheRegionFactory // EHCACHE</span>

      <span class="na">javax</span><span class="pi">:</span>
        <span class="na">persistence</span><span class="pi">:</span>
          <span class="na">sharedCache</span><span class="pi">:</span>
            <span class="na">mode</span><span class="pi">:</span> <span class="s">ENABLE_SELECTIVE</span>
</code></pre></div></div>
<ul>
  <li>hibernate.cache.use_second_level_cache: 2ì°¨ ìºì‹œë¥¼ í™œì„±í™” í•œë‹¤. ì—”í‹°í‹° ìºì‹œì™€ ì»¬ë ‰ì…˜ ìºì‹œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
  <li>hibernate.cache.use_query_cach: ì¿¼ë¦¬ ìºì‹œë¥¼ í™œì„±í™” í•œë‹¤.</li>
  <li>hibernate.cache.region.factory_class: 2ì°¨ ìºì‹œë¥¼ ì²˜ë¦¬í•  í´ë˜ìŠ¤ë¥¼ ì§€ì •í•œë‹¤.</li>
  <li>hibernate.generate_statistics: ì´ ì†ì„±ì„ trueë¡œ ì„¤ì •í•˜ë©´ í•˜ì´ë²„ë„¤ì´íŠ¸ê°€ ì—¬ëŸ¬ í†µê³„ì •ë³´ë¥¼ ì¶œë ¥í•´ì£¼ëŠ”ë° ìºì‹œ ì ìš© ì—¬ë¶€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.(ì„±ëŠ¥ì— ì˜í–¥ì„ ì£¼ë¯€ë¡œ ê°œë°œ í™˜ê²½ì—ì„œë§Œ ì ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤)<br />
<br />
<br /></li>
</ul>

<p><strong>@Cache</strong><br />
í•˜ì´ë²„ë„¤ì´íŠ¸ ì „ìš©ì¸ <code class="language-plaintext highlighter-rouge">@Cache</code> ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ ì„¸ë°€í•œ ìºì‹œ ì„¤ì •ì´ ê°€ëŠ¥í•˜ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Cacheable</span> <span class="c1">// ì—”í‹°í‹° ìºì‹œ</span>
<span class="nd">@Cache</span><span class="o">(</span><span class="n">usage</span> <span class="o">=</span> <span class="nc">CacheConcurrencyStrategy</span><span class="o">.</span><span class="na">READ_WRITE</span><span class="o">)</span> <span class="c1">// í•˜ì´ë²„ë„¤ì´íŠ¸ ì „ìš©, ìºì‹œì™€ ê´€ë ¨ëœ ë” ì„¸ë°€í•  ì„¤ì • ê°€ëŠ¥</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ParentMember</span> <span class="o">{</span>

	<span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
	<span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

	<span class="nd">@Cache</span><span class="o">(</span><span class="n">usage</span> <span class="o">=</span> <span class="nc">CacheConcurrencyStrategy</span><span class="o">.</span><span class="na">READ_WRITE</span><span class="o">)</span> <span class="c1">// ì»¬ë ‰ì…˜ë„ ìºì‹œ ì ìš© ê°€ëŠ¥</span>
	<span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"parentMember"</span><span class="o">,</span> <span class="n">cascade</span> <span class="o">=</span> <span class="nc">CascadeType</span><span class="o">.</span><span class="na">ALL</span><span class="o">)</span>
	<span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">ChildMember</span><span class="o">&gt;</span> <span class="n">childMembers</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>í•˜ì´ë²„ë„¤ì´íŠ¸ <code class="language-plaintext highlighter-rouge">@Cache</code> ì†ì„±</p>

<table>
  <thead>
    <tr>
      <th><strong>ì†ì„±</strong></th>
      <th><strong>ì„¤ëª…</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>usage</td>
      <td>CacheConcurrencyStrategyë¥¼ ì‚¬ìš©í•´ì„œ ìºì‹œ ë™ì‹œì„± ì „ëµì„ ì„¤ì •í•œë‹¤.</td>
    </tr>
    <tr>
      <td>region</td>
      <td>ìºì‹œ ì§€ì—­ ì„¤ì •</td>
    </tr>
    <tr>
      <td>include</td>
      <td>ì—°ê´€ ê°ì²´ë¥¼ ìºì‹œì— í¬í•¨í• ì§€ ì„ íƒí•œë‹¤. all, non-laze ì˜µì…˜ì„ ì„ íƒí•  ìˆ˜ ìˆë‹¤.(ê¸°ë³¸ê°’ all)</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p><code class="language-plaintext highlighter-rouge">CacheConcurrencyStrategy</code> ì†ì„±</p>

<table>
  <thead>
    <tr>
      <th><strong>ì†ì„±</strong></th>
      <th><strong>ì„¤ëª…</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>NONE</td>
      <td>ìºì‹œë¥¼ ì„¤ì •í•˜ì§€ ì•ŠëŠ”ë‹¤.</td>
    </tr>
    <tr>
      <td>READ_ONLY</td>
      <td>ì½ê¸° ì „ìš©ìœ¼ë¡œ ì„¤ì •í•œë‹¤. ë“±ë¡, ì‚­ì œëŠ” ê°€ëŠ¥í•˜ì§€ë§Œ ìˆ˜ì •ì€ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ì°¸ê³ ë¡œ ì½ê¸° ì „ìš©ì¸ ë¶ˆë³€ ê°ì²´ëŠ” ìˆ˜ì •ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” 2ì°¨ ìºì‹œë¥¼ ì¡°íšŒí•  ë•Œ ê°ì²´ë¥¼ ë³µì‚¬í•˜ì§€ ì•Šê³  ì›ë³¸ ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.</td>
    </tr>
    <tr>
      <td>NONSTRICT_READ_WRITE</td>
      <td>ì—„ê²©í•˜ì§€ ì•Šì€ ì½ê³  ì“°ê¸° ì „ëµì´ë‹¤. ë™ì‹œì— ê°™ì€ ì—”í‹°í‹°ë¥¼ ìˆ˜ì •í•˜ë©´ ë°ì´í„° ì¼ê´€ì„±ì´ ê¹¨ì§ˆ ìˆ˜ ìˆë‹¤. EHCACHEëŠ” ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ë©´ ìºì‹œ ë°ì´í„°ë¥¼ ë¬´íš¨í™”í•œë‹¤.</td>
    </tr>
    <tr>
      <td>READ_WRITE</td>
      <td>ì½ê¸° ì“°ê¸°ê°€ ê°€ëŠ¥í•˜ê³  READ COMMITTED ì •ë„ì˜ ê²©ë¦¬ ìˆ˜ì¤€ì„ ë³´ì¥í•œë‹¤.</td>
    </tr>
    <tr>
      <td>TRANSACTIONAL</td>
      <td>ì»¨í…Œì´ë„ˆ ê´€ë¦¬ í™˜ê²½ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì„¤ì •ì— ë”°ë¼ REPEATABLE READ ì •ë„ì˜ ê²©ë¦¬ ìˆ˜ì¤€ì„ ë³´ì¥ë°›ì„ ìˆ˜ ìˆë‹¤.</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p>ìºì‹œ ë™ì‹œì„± ì „ëµ ì§€ì› ì—¬ë¶€</p>

<table>
  <thead>
    <tr>
      <th><strong>Cache</strong></th>
      <th><strong>read-only</strong></th>
      <th><strong>nonstrict-read-write</strong></th>
      <th><strong>nonstrict-read-write</strong></th>
      <th><strong>transactional</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ConcurrentHashMap</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>Â </td>
    </tr>
    <tr>
      <td>EHCache</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
    </tr>
    <tr>
      <td>Infinispan</td>
      <td>yes</td>
      <td>Â </td>
      <td>Â </td>
      <td>yes</td>
    </tr>
  </tbody>
</table>

<p><br />
<br /></p>

<p><strong>ìºì‹œ ì˜ì—­</strong><br />
ìœ„ì—ì„œ ìºì‹œë¥¼ ì ìš©í•œ ì½”ë“œ(ì—”í‹°í‹° ì½”ë“œ)ëŠ” ë‹¤ìŒ ìºì‹œ ì˜ì—­ì— ì €ì¥ëœë‹¤.</p>
<ul>
  <li>ì—”í‹°í‹° ìºì‹œ ì˜ì—­
    <ul>
      <li><code class="language-plaintext highlighter-rouge">jpabook.jpashop.domain.test.cache.ParentMember</code></li>
      <li>ê¸°ë³¸ê°’ìœ¼ë¡œ [íŒ¨í‚¤ì§€ ëª… + í´ë˜ìŠ¤ ëª…]ì„ ì‚¬ìš©</li>
    </ul>
  </li>
  <li>ì»¬ë ‰ì…˜ ìºì‹œ ì˜ì—­
    <ul>
      <li><code class="language-plaintext highlighter-rouge">jpabook.jpashop.domain.test.cache.ParentMember.childMembers</code></li>
      <li>ì—”í‹°í‹° ìºì‹œ ì˜ì—­ ì´ë¦„ + ìºì‹œí•œ ì»¬ë ‰ì…˜ì˜ í•„ë“œ ëª…</li>
    </ul>
  </li>
</ul>

<p>í•„ìš”í•˜ë‹¤ë©´ <code class="language-plaintext highlighter-rouge">@Cache(region = "customRegion", ...)</code> ì²˜ëŸ¼ <code class="language-plaintext highlighter-rouge">region</code> ì†ì„±ì„ ì‚¬ìš©í•´ì„œ ìºì‹œ ì˜ì—­ì„ ì§ì ‘ ì§€ì •í•  ìˆ˜ ìˆë‹¤.<br />
<br /></p>

<p>ìºì‹œ ì˜ì—­ì´ ì •í•´ì ¸ ìˆìœ¼ë©´ ì˜ì—­ë³„ë¡œ ì„¸ë¶€ ì„¤ì •ì„ í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;ehcache&gt;</span>
    <span class="nt">&lt;defaultCache</span>
        <span class="na">maxElementsInMemory=</span><span class="s">"10000"</span>
        <span class="na">eternal=</span><span class="s">"false"</span>
        <span class="na">timeToIdleSeconds=</span><span class="s">"1200"</span>
        <span class="na">timeToLiveSeconds=</span><span class="s">"1200"</span>
        <span class="na">diskExpiryThreadIntervalSeconds=</span><span class="s">"1200"</span>
        <span class="na">memoryStoreEvictionPolicy=</span><span class="s">"LRU"</span> <span class="nt">/&gt;</span>
    
    <span class="c">&lt;!-- ParentMemberë¥¼ 600ì´ˆ ë§ˆë‹¤ ìºì‹œì—ì„œ ì œê±° --&gt;</span>
    <span class="nt">&lt;cache</span>
        <span class="na">name=</span><span class="s">"jpabook.jpashop.domain.test.cache.ParentMember"</span>
        <span class="na">maxElementsInMemory=</span><span class="s">"10000"</span>
        <span class="na">eternal=</span><span class="s">"false"</span>
        <span class="na">timeToIdleSeconds=</span><span class="s">"600"</span>
        <span class="na">timeToLiveSeconds=</span><span class="s">"600"</span>
        <span class="na">overflowToDisk=</span><span class="s">"false"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/ehcache&gt;</span>
</code></pre></div></div>
<p><br />
<br /></p>

<p><strong>ì¿¼ë¦¬ ìºì‹œ</strong></p>
<ul>
  <li>ì¿¼ë¦¬ ìºì‹œëŠ” ì¿¼ë¦¬ì™€ íŒŒë¼ë¯¸í„° ì •ë³´ë¥¼ í‚¤ë¡œ ì‚¬ìš©í•´ì„œ ì¿¼ë¦¬ ê²°ê³¼ë¥¼ ìºì‹œí•˜ëŠ” ë°©ë²•ì´ë‹¤.</li>
  <li>ì¿¼ë¦¬ ìºì‹œë¥¼ ì ìš©í•˜ë ¤ë©´ ì˜ì†ì„± ìœ ë‹› ì„¤ì •ì— <code class="language-plaintext highlighter-rouge">hibernate.cache.use_query_cache</code> ì˜µì…˜ì„ ê¼­ <code class="language-plaintext highlighter-rouge">true</code>ë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤.</li>
  <li>ê·¸ë¦¬ê³  ì¿¼ë¦¬ ìºì‹œë¥¼ ì ìš©í•˜ë ¤ëŠ” ì¿¼ë¦¬ë§ˆë‹¤ <code class="language-plaintext highlighter-rouge">org.hibernate.cacheable</code>ì„ <code class="language-plaintext highlighter-rouge">true</code>ë¡œ ì„¤ì •í•˜ëŠ” íŒíŠ¸ë¥¼ ì£¼ë©´ ëœë‹¤</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì¿¼ë¦¬ ìºì‹œ ì‚¬ìš©</span>
<span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="s">"select i from Item i"</span><span class="o">,</span> <span class="nc">Item</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="o">.</span><span class="na">setHint</span><span class="o">(</span><span class="s">"org.hibernate.cacheable"</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span>
    <span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
 
<span class="c1">// @NamedQueryì— ì¿¼ë¦¬ ìºì‹œ ì ìš©</span>
<span class="nd">@Entity</span>
<span class="nd">@NamedQuery</span><span class="o">(</span>
    <span class="n">hints</span> <span class="o">=</span> <span class="nd">@QueryHint</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"org.hibernate.cacheable"</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s">"true"</span><span class="o">),</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"Member.findByUsername"</span><span class="o">,</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s">"select m.address from Member m where m.name = :username"</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{...}</span>
</code></pre></div></div>
<p><br />
<br /></p>

<p><strong>ì¿¼ë¦¬ ìºì‹œ ì˜ì—­</strong><br />
<code class="language-plaintext highlighter-rouge">hibernate.cache.use_query_cache</code> ì˜µì…˜ì„ <code class="language-plaintext highlighter-rouge">true</code>ë¡œ ì„¤ì •í•´ì„œ ì¿¼ë¦¬ ìºì‹œë¥¼ í™œì„±í™” í•˜ë©´ ë‹¤ìŒ ë‘ ìºì‹œ ì˜ì—­ì´ ì¶”ê°€ëœë‹¤.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">org.hibernate.cache.internal.StandardQueryCache</code>: ì¿¼ë¦¬ ìºì‹œë¥¼ ì €ì¥í•˜ëŠ” ì˜ì—­ì´ë‹¤. ì´ê³³ì—ëŠ” ì¿¼ë¦¬, ì¿¼ë¦¬ ê²°ê³¼ ì§‘í•©, ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•œ ì‹œì ì˜ íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ë³´ê´€í•œë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">org.hibernate.cache.spi.UpdateTimestampsCache</code>: ì¿¼ë¦¬ ìºì‹œê°€ ìœ íš¨í•œì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ì¿¼ë¦¬ ëŒ€ìƒ í…Œì´ë¸”ì˜ ê°€ì¥ ìµœê·¼ ë³€ê²½(ë“±ë¡, ìˆ˜ì •, ì‚­ì œ) ì‹œê°„ì„ ì €ì¥í•˜ëŠ” ì˜ì—­ì´ë‹¤. ì´ê³³ì—ëŠ” í…Œì´ë¸” ëª…ê³¼ í•´ë‹¹ í…Œì´ë¸”ì˜ ìµœê·¼ ë³€ê²½ëœ íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ë³´ê´€í•œë‹¤.</li>
</ul>

<p>ì¿¼ë¦¬ ìºì‹œëŠ” ìºì‹œí•œ ë°ì´í„° ì§‘í•©ì„ ìµœì‹  ë°ì´í„°ë¡œ ìœ ì§€í•˜ë ¤ê³  ì¿¼ë¦¬ ìºì‹œë¥¼ ì‹¤í–‰í•˜ëŠ” ì‹œê°„ê³¼ ì¿¼ë¦¬ ìºì‹œê°€ ì‚¬ìš©í•˜ëŠ” í…Œì´ë¸”ë“¤ì´ ê°€ì¥ ìµœê·¼ì— ë³€ê²½ëœ ì‹œê°„ì„ ë¹„êµí•œë‹¤. <strong>ì¿¼ë¦¬ ìºì‹œë¥¼ ì ìš©í•˜ê³  ë‚œ í›„ì— ì¿¼ë¦¬ ìºì‹œê°€ ì‚¬ìš©í•˜ëŠ” í…Œì´ë¸”ì— ì¡°ê¸ˆì´ë¼ë„ ë³€ê²½ì´ ìˆìœ¼ë©´ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ì½ì–´ì™€ì„œ ì¿¼ë¦¬ ê²°ê³¼ë¥¼ ë‹¤ì‹œ ìºì‹œí•œë‹¤.</strong></p>

<p><strong>ì¿¼ë¦¬ ìºì‹œë¥¼ ì˜ í™œìš©í•˜ë©´ ê·¹ì ì¸ ì„±ëŠ¥ í–¥ìƒì´ ìˆì§€ë§Œ ë¹ˆë²ˆí•˜ê²Œ ë³€ê²½ì´ ìˆëŠ” í…Œì´ë¸”ì— ì‚¬ìš©í•˜ë©´ ì˜¤íˆë ¤ ì„±ëŠ¥ì´ ë” ì €í•˜ëœë‹¤.</strong> ë”°ë¼ì„œ ìˆ˜ì •ì´ ê±°ì˜ ì¼ì–´ë‚˜ì§€ ì•ŠëŠ” í…Œì´ë¸”ì— ì‚¬ìš©í•´ì•¼ íš¨ê³¼ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<div class="notice--warning">
<p><strong>ì£¼ì˜</strong><br />
<code class="language-plaintext highlighter-rouge">org.hibernate.cache.spi.UpdateTimestampsCache</code> ì¿¼ë¦¬ ìºì‹œ ì˜ì—­ì€ ë§Œë£Œë˜ì§€ ì•Šë„ë¡ ì„¤ì •í•´ì•¼ í•œë‹¤. í•´ë‹¹ ì˜ì—­ì´ ë§Œë£Œë˜ë©´ ëª¨ë“  ì¿¼ë¦¬ ìºì‹œê°€ ë¬´íš¨í™”ëœë‹¤. <code class="language-plaintext highlighter-rouge">EHCACHE</code>ì˜ <code class="language-plaintext highlighter-rouge">eternal="true"</code> ì˜µì…˜ì„ ì‚¬ìš©í•˜ë©´ ìºì‹œì—ì„œ ì‚­ì œë˜ì§€ ì•ŠëŠ”ë‹¤.</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;cache</span>
    <span class="na">name=</span><span class="s">"org.hibernate.cache.spi.UpdateTimestampsCache"</span>
    <span class="na">maxElementsInMemory=</span><span class="s">"10000"</span>
    <span class="na">eternal=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>
</div>
<p><br /></p>

<p><strong>ì¿¼ë¦¬ ìºì‹œì™€ ì»¬ë ‰ì…˜ ìºì‹œì˜ ì£¼ì˜ì </strong><br />
ì—”í‹°í‹° ìºì‹œë¥¼ ì‚¬ìš©í•´ì„œ ì—”í‹°í‹°ë¥¼ ìºì‹œí•˜ë©´ ì—”í‹°í‹° ì •ë³´ë¥¼ ëª¨ë‘ ìºì‹œí•˜ì§€ë§Œ <strong>ì¿¼ë¦¬ ìºì‹œì™€ ì»¬ë ‰ì…˜ ìºì‹œëŠ” ê²°ê³¼ ì§‘í•©ì˜ ì‹ë³„ì ê°’ë§Œ ìºì‹œí•œë‹¤.</strong> ê·¸ë¦¬ê³  ì´ ì‹ë³„ì ê°’ì„ í•œë‚˜ì”© ì—”í‹°í‹° ìºì‹œì— ì¡°íšŒí•´ì„œ ì‹¤ì œ ì—”í‹°í‹°ë¥¼ ì°¾ëŠ”ë‹¤.</p>

<p><strong>ë¬¸ì œëŠ” ì¿¼ë¦¬ ìºì‹œë‚˜ ì»¬ë ‰ì…˜ ìºì‹œë§Œ ì‚¬ìš©í•˜ê³  ëŒ€ìƒ ì—”í‹°í‹°ì— ì—”í‹°í‹° ìºì‹œë¥¼ ì ìš©í•˜ì§€ ì•Šìœ¼ë©´ ì„±ëŠ¥ìƒ ì‹¬ê°í•œ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.</strong></p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">select m from Member m</code> ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í–ˆëŠ”ë° ì¿¼ë¦¬ ìºì‹œê°€ ì ìš©ë˜ì–´ ìˆë‹¤. ì¡°íšŒ ê²°ê³¼ëŠ” 100ê±´ì´ë‹¤.</li>
  <li>ê²°ê³¼ ì§‘í•©ì—ëŠ” ì‹ë³„ìë§Œ ìˆë¥´ë¯€ë¡œ í•œ ê±´ì”© ì—”í‹°í‹° ìºì‹œ ì˜ì—­ì—ì„œ ì¡°íšŒí•œë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">Member</code> ì—”í‹°í‹°ëŠ” ì—”í‹°í‹° ìºì‹œë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ í•œ ê±´ì”© ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¡°íšŒí•œë‹¤.</li>
  <li>100ê±´ì˜ SQLì´ ì‹¤í–‰ëœë‹¤.</li>
</ol>

<p>ë”°ë¼ì„œ <strong>ì¿¼ë¦¬ ìºì‹œë‚˜ ì»¬ë ‰ì…˜ ìºì‹œë¥¼ ì‚¬ìš©í•˜ë©´ ê²°ê³¼ ëŒ€ìƒ ì—”í‹°í‹°ì—ëŠ” ê¼­ ì—”í‹°í‹° ìºì‹œë¥¼ ì ìš©í•´ì•¼ í•œë‹¤.</strong></p>

<p><br />
<br /></p>

<h2 id="163-ì •ë¦¬">16.3 ì •ë¦¬</h2>
<ul>
  <li>íŠ¸ëœì­ì…˜ì˜ ê²©ë¦¬ ìˆ˜ì¤€ì€ 4ë‹¨ê³„ê°€ ìˆë‹¤. ê²©ë¦¬ ìˆ˜ì¤€ì´ ë‚®ì„ìˆ˜ë¡ ë™ì‹œì„±ì€ ì¦ê°€í•˜ì§€ë§Œ ê²©ë¦¬ ìˆ˜ì¤€ì— ë”°ë¥¸ ë‹¤ì–‘í•œ ë¬¸ì œê°€ ë°œìƒí•œë‹¤.</li>
  <li>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” ë°ì´í„°ë² ì´ìŠ¤ íŠ¸ëœì­ì…˜ì´ <code class="language-plaintext highlighter-rouge">READ COMMITTED</code> ê²©ë¦¬ ìˆ˜ì¤€ì´ì–´ë„ ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ì—ì„œ ë°˜ë³µ ê°€ëŠ¥í•œ ì½ê¸°(<code class="language-plaintext highlighter-rouge">REPEATABLE READ</code>)ë¥¼ ì œê³µí•œë‹¤.</li>
  <li>JPAëŠ” ë‚™ê´€ì  ë½ê³¼ ë¹„ê´€ì  ë½ì„ ì§€ì›í•œë‹¤. ë‚™ê´€ì  ë½ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì§€ì›í•˜ëŠ” ë½ì´ê³ , ë¹„ê´€ì  ë½ì€ ë°ì´í„°ë² ì´ìŠ¤ íŠ¸ëœì­ì…˜ ë½ ë©”ì»¤ë‹ˆì¦˜ì— ì˜ì¡´í•œë‹¤.</li>
  <li>2ì°¨ ìºì‹œë¥¼ ì‚¬ìš©í•˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì¡°íšŒ ì„±ëŠ¥ ê·¹ì ìœ¼ë¡œ ëŒì–´ì˜¬ë¦´ ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><br />
<br />
<br />
<br /></p>

<p><strong>ê°ì‚¬í•©ë‹ˆë‹¤</strong> ğŸ™‡ğŸ»â€â™‚ï¸</p>

<p><a href="https://product.kyobobook.co.kr/detail/S000000935744" target="_blank">ìë°” ORM í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë°</a></p>]]></content><author><name>Sangjae Oh</name></author><category term="Books" /><category term="Books" /><category term="JPA" /><category term="ORM" /><summary type="html"><![CDATA[ìë°” ORM í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë° ì±…ì„ ì½ê³  ë‚´ìš©ì„ ì•„ì£¼ ê°„ë‹¨í•˜ê²Œ ì •ë¦¬í•œ ê¸€ì…ë‹ˆë‹¤. ì±…ì—ëŠ” ìì„¸í•œ ì„¤ëª…ê³¼ ì˜ˆì œê°€ ë§ìœ¼ë‹ˆ ê¼­ êµ¬ì…í•´ì„œ ì½ëŠ”ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤~ğŸ‘]]></summary></entry><entry><title type="html">ğŸ“– ë„ë©”ì¸ ì£¼ë„ ê°œë°œ ì‹œì‘í•˜ê¸°: DDD í•µì‹¬ ê°œë… ì •ë¦¬ë¶€í„° êµ¬í˜„ê¹Œì§€</title><link href="http://localhost:4000/books/%EB%8F%84%EB%A9%94%EC%9D%B8%EC%A3%BC%EB%8F%84%EA%B0%9C%EB%B0%9C%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0/" rel="alternate" type="text/html" title="ğŸ“– ë„ë©”ì¸ ì£¼ë„ ê°œë°œ ì‹œì‘í•˜ê¸°: DDD í•µì‹¬ ê°œë… ì •ë¦¬ë¶€í„° êµ¬í˜„ê¹Œì§€" /><published>2023-01-09T00:00:00+09:00</published><updated>2023-01-09T00:00:00+09:00</updated><id>http://localhost:4000/books/%EB%8F%84%EB%A9%94%EC%9D%B8%EC%A3%BC%EB%8F%84%EA%B0%9C%EB%B0%9C%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0</id><content type="html" xml:base="http://localhost:4000/books/%EB%8F%84%EB%A9%94%EC%9D%B8%EC%A3%BC%EB%8F%84%EA%B0%9C%EB%B0%9C%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0/"><![CDATA[<p><a href="https://product.kyobobook.co.kr/detail/S000001810495" target="_blank">ë„ë©”ì¸ ì£¼ë„ ê°œë°œ ì‹œì‘í•˜ê¸°: DDD í•µì‹¬ ê°œë… ì •ë¦¬ë¶€í„° êµ¬í˜„ê¹Œì§€</a> ì±…ì„ ì½ê³  ë‚´ìš©ì„ ì•„ì£¼ ê°„ë‹¨í•˜ê²Œ ì •ë¦¬í•œ ê¸€ì…ë‹ˆë‹¤. ì±…ì—ëŠ” ìì„¸í•œ ì„¤ëª…ê³¼ ì˜ˆì œê°€ ë§ìœ¼ë‹ˆ <strong>ê¼­ êµ¬ì…í•´ì„œ ì½ëŠ”ê²ƒì„ ì¶”ì²œ</strong>í•©ë‹ˆë‹¤~ğŸ‘</p>

<hr />

<h1 id="1-ë„ë©”ì¸-ëª¨ë¸-ì‹œì‘í•˜ê¸°">1. ë„ë©”ì¸ ëª¨ë¸ ì‹œì‘í•˜ê¸°</h1>
<h2 id="11-ë„ë©”ì¸ì´ë€">1.1 ë„ë©”ì¸ì´ë€?</h2>
<p>ì†Œí”„íŠ¸ì›¨ì–´ë¡œ í•´ê²°í•˜ê³ ì í•˜ëŠ” ë¬¸ì œ ì˜ì—­ì„ ë„ë©”ì¸ì´ë¼ í•œë‹¤.</p>

<h2 id="12-ë„ë©”ì¸-ì „ë¬¸ê°€ì™€-ê°œë°œì-ê°„-ì§€ì‹ê³µìœ ">1.2 ë„ë©”ì¸ ì „ë¬¸ê°€ì™€ ê°œë°œì ê°„ ì§€ì‹ê³µìœ </h2>
<p>ì „ë¬¸ê°€ë‚˜ ê´€ë ¨ìê°€ ìš”êµ¬í•œ ë‚´ìš©ì´ í•­ìƒ ì˜¬ë°”ë¥¸ ê²ƒì€ ì•„ë‹ˆë‹¤. ê·¸ë˜ì„œ ê°œë°œìëŠ” ìš”êµ¬ì‚¬í•­ì„ ì´í•´í•  ë•Œ ì™œ ì´ëŸ° ê¸°ëŠ¥ì„ ìš”êµ¬í•˜ëŠ”ì§€ ë˜ëŠ” ì‹¤ì œë¡œ ì›í•˜ëŠ”ê²Œ ë¬´ì—‡ì¸ì§€ ìƒê°í•˜ê³  ì „ë¬¸ê°€ì™€ ëŒ€í™”ë¥¼ í†µí•´ ì§„ì§œë¡œ ì›í•˜ëŠ” ê²ƒì„ ì°¾ì•„ì•¼ í•œë‹¤.</p>

<h2 id="13-ë„ë©”ì¸-ëª¨ë¸">1.3 ë„ë©”ì¸ ëª¨ë¸</h2>
<p>ë„ë©”ì¸ ëª¨ë¸ì€ íŠ¹ì • ë„ë©”ì¸ì„ ê°œë…ì ìœ¼ë¡œ í‘œí˜„í•œ ê²ƒì´ë‹¤. ë„ë©”ì¸ ëª¨ë¸ì„ ì‚¬ìš©í•˜ë©´ ì—¬ëŸ¬ ê´€ê³„ìë“¤ì´ ë™ì¼í•œ ëª¨ìŠµìœ¼ë¡œ ë„ë©”ì¸ì„ ì´í•´í•˜ê³  ë„ë©”ì¸ ì§€ì‹ì„ ê³µìœ í•˜ëŠ”ë° ë„ì›€ì´ ëœë‹¤. ë„ë©”ì¸ ëª¨ë¸ì„ ì´í•´í•˜ëŠ” ë° ë„ì›€ì´ ëœë‹¤ë©´ ê°ì²´ê¸°ë°˜ í‘œí˜„ì´ë“ , í•¨ìˆ˜ í‘œí˜„ì´ë“  í‘œí˜„ ë°©ì‹ì´ ë¬´ì—‡ì¸ì§€ëŠ” ì¤‘ìš”í•˜ì§€ ì•Šë‹¤.</p>
<center><img src="/assets/images/posts/books/1/1_3_ê°ì²´ê¸°ë°˜ë„ë©”ì¸ëª¨ë¸.png" alt="ê°ì²´ê¸°ë°˜ë„ë©”ì¸ëª¨ë¸" width="100%" height="100%" /></center>
<center><img src="/assets/images/posts/books/1/1_3_ìƒíƒœë‹¤ì´ì–´ê·¸ë¨ë„ë©”ì¸ëª¨ë¸.png" alt="ìƒíƒœë‹¤ì´ì–´ê·¸ë¨ë„ë©”ì¸ëª¨ë¸" width="100%" height="100%" /></center>

<h2 id="14-ë„ë©”ì¸-ëª¨ë¸-íŒ¨í„´">1.4 ë„ë©”ì¸ ëª¨ë¸ íŒ¨í„´</h2>
<center><img src="/assets/images/posts/books/1/1_4_ì•„í‚¤í…ì²˜êµ¬ì„±.png" alt="ì•„í‚¤í…ì²˜êµ¬ì„±" width="70%" height="70%" /></center>

<table>
  <thead>
    <tr>
      <th>ì˜ì—­</th>
      <th>ì„¤ëª…</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤(UI) ë˜ëŠ” í‘œí˜„(Presentation)</td>
      <td>ì‚¬ìš©ìì˜ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê³  ì‚¬ìš©ìì—ê²Œ ì •ë³´ë¥¼ ë³´ì—¬ì¤€ë‹¤. ì—¬ê¸°ì„œ ì‚¬ìš©ìëŠ” ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì‚¬ìš©í•˜ëŠ” ì‚¬ëŒë¿ë§Œ ì•„ë‹ˆë¼ ì™¸ë¶€ ì‹œìŠ¤í…œì¼ ìˆ˜ë„ ìˆë‹¤.</td>
    </tr>
    <tr>
      <td>ì‘ìš©(Application)</td>
      <td>ì‚¬ìš©ìê°€ ìš”ì²­í•œ ê¸°ëŠ¥ì„ ì‹¤í–‰í•œë‹¤. ì—…ë¬´ ë¡œì§ì„ ì§ì ‘ êµ¬í˜„í•˜ì§€ ì•Šìœ¼ë©° ë„ë©”ì¸ ê³„ì¸µì„ ì¡°í•©í•´ì„œ ê¸°ëŠ¥ì„ ì‹¤í–‰í•œë‹¤.</td>
    </tr>
    <tr>
      <td>ë„ë©”ì¸(Domain)</td>
      <td>ì‹œìŠ¤í…œì´ ì œê³µí•  ë„ë©”ì¸ ê·œì¹™ì„ êµ¬í˜„í•œë‹¤.</td>
    </tr>
    <tr>
      <td>ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜(Infrastructure)</td>
      <td>ë°ì´í„°ë² ì´ìŠ¤ë‚˜ ë©”ì‹œì§• ì‹œìŠ¤í…œê³¼ ê°™ì€ ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ì˜ ì—°ë™ì„ ì²˜ë¦¬í•œë‹¤.</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p><strong>ê°œë… ëª¨ë¸ê³¼ êµ¬í˜„ ëª¨ë¸</strong><br />
<strong>ê°œë… ëª¨ë¸ì€ ìˆœìˆ˜í•˜ê²Œ ë¬¸ì œë¥¼ ë¶„ì„í•œ ê²°ê³¼ë¬¼</strong>ì´ë‹¤. ê°œë… ëª¨ë¸ì€ ë°ì´í„°ë² ì´ìŠ¤, íŠ¸ëœì­ì…˜ ì²˜ë¦¬, ì„±ëŠ¥, êµ¬í˜„ ê¸°ìˆ ê³¼ ê°™ì€ ê²ƒì„ ê³ ë ¤í•˜ê³  ìˆì§€ ì•Šê¸° ë•Œë¬¸ì— ì‹¤ì œ ì½”ë“œë¥¼ ì‘ì„±í•  ë•Œ ê°œë… ëª¨ë¸ì„ ìˆëŠ” ê·¸ëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. ê·¸ë˜ì„œ ê°œë… ëª¨ë¸ì„ êµ¬í˜„ ê°€ëŠ¥í•œ í˜•íƒœì˜ ëª¨ë¸ë¡œ ì „í™˜í•˜ëŠ” ê³¼ì •ì„ ê±°ì¹˜ê²Œ ëœë‹¤.</p>

<p><strong>ì²˜ìŒë¶€í„° ì™„ë²½í•œ ê°œë… ëª¨ë¸ì„ ë§Œë“¤ê¸°ë³´ë‹¤ëŠ” ì „ë°˜ì ì¸ ê°œìš”ë¥¼ ì•Œ ìˆ˜ ìˆëŠ” ìˆ˜ì¤€ìœ¼ë¡œ ê°œë… ëª¨ë¸ì„ ì‘ì„±</strong>í•´ì•¼í•œë‹¤. í”„ë¡œì íŠ¸ ì´ˆê¸°ì—ëŠ” ê°œìš” ìˆ˜ì¤€ì˜ ê°œë… ëª¨ë¸ë¡œ ë„ë©”ì¸ì— ëŒ€í•œ ì „ì²´ ìœ¤ê³½ì„ ì´í•´í•˜ëŠ” ë° ì§‘ì¤‘í•˜ê³ , <strong>êµ¬í˜„í•˜ëŠ” ê³¼ì •ì—ì„œ ê°œë… ëª¨ë¸ì„ êµ¬í˜„ ëª¨ë¸ë¡œ ì ì§„ì ìœ¼ë¡œ ë°œì „</strong>ì‹œì¼œ ë‚˜ê°€ì•¼ í•œë‹¤.</p>

<h2 id="15-ë„ë©”ì¸-ëª¨ë¸-ë„ì¶œ">1.5 ë„ë©”ì¸ ëª¨ë¸ ë„ì¶œ</h2>
<p>ë„ë©”ì¸ì„ ëª¨ë¸ë§í•  ë•Œ ê¸°ë³¸ì´ ë˜ëŠ” ì‘ì—…ì€ <strong>ëª¨ë¸ì„ êµ¬ì„±í•˜ëŠ” í•µì‹¬ êµ¬ì„±ìš”ì†Œ, ê·œì¹™, ê¸°ëŠ¥ì„ ì°¾ëŠ” ê²ƒ</strong>ì´ë‹¤. ì´ ê³¼ì •ì€ ìš”êµ¬ì‚¬í•­ì—ì„œ ì¶œë°œí•œë‹¤. <strong>ìš”êµ¬ì‚¬í•­ì„ í†µí•´ ë„ë©”ì¸ ëª¨ë¸ì„ ì ì§„ì ìœ¼ë¡œ ë§Œë“¤ì–´ ë‚˜ê°„ë‹¤</strong>. ì´ë ‡ê²Œ ë§Œë“  ëª¨ë¸ì€ ìš”êµ¬ì‚¬í•­ ì •ë ¨ì„ ìœ„í•´ ë„ë©”ì¸ ì „ë¬¸ê°€ë‚˜ ë‹¤ë¥¸ ê°œë°œìì™€ ë…¼ì˜í•˜ëŠ” ê³¼ì •ì—ì„œ ê³µìœ ë˜ê¸°ë„ í•œë‹¤. ëª¨ë¸ì„ ê³µìœ í•  ë•ŒëŠ” í™”ì´íŠ¸ë³´ë“œë‚˜ ìœ„í‚¤ ê°™ì€ ë„êµ¬ë¥¼ ì‚¬ìš©í•´ì„œ ëˆ„êµ¬ë‚˜ ì‰½ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í•˜ë©´ ì¢‹ë‹¤.</p>

<h2 id="16-ì—”í‹°í‹°ì™€-ë²¨ë¥˜">1.6 ì—”í‹°í‹°ì™€ ë²¨ë¥˜</h2>
<h3 id="161-ì—”í‹°í‹°">1.6.1 ì—”í‹°í‹°</h3>
<ul>
  <li>ì‹ë³„ìë¥¼ ê°€ì§„ë‹¤.</li>
  <li>ì‹ë³„ìëŠ” ì—”í‹°í‹° ê°ì²´ë§ˆë‹¤ ê³ ìœ í•˜ë‹¤.</li>
</ul>

<h3 id="162-ì—”í‹°í‹°ì˜-ì‹ë³„ì-ìƒì„±">1.6.2 ì—”í‹°í‹°ì˜ ì‹ë³„ì ìƒì„±</h3>
<ul>
  <li>íŠ¹ì • ê·œì¹™ì— ë”°ë¼ ìƒì„±.</li>
  <li>UUIDë‚˜ Nano IDì™€ ê°™ì€ ê³ ìœ  ì‹ë³„ì ìƒì„±ê¸° ì‚¬ìš©.</li>
  <li>ê°’ì„ ì§ì ‘ ì…ë ¥.</li>
  <li>ì¼ë ¨ë²ˆí˜¸ ì‚¬ìš©(ì‹œí€€ìŠ¤ë‚˜ DBì˜ ìë™ ì¦ê°€ ì»¬ëŸ¼ ì‚¬ìš©).</li>
</ul>

<h3 id="163-ë°¸ë¥˜-íƒ€ì…">1.6.3 ë°¸ë¥˜ íƒ€ì…</h3>
<ul>
  <li>ë°¸ë¥˜ íƒ€ì…ì€ ê°œë…ì ìœ¼ë¡œ ì™„ì „í•œ í•˜ë‚˜ë¥¼ í‘œí˜„í•  ë•Œ ì‚¬ìš©í•œë‹¤.</li>
  <li>ì˜ë¯¸ë¥¼ ëª…í™•í•˜ê²Œ í‘œí˜„í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ê¸°ë„ í•œë‹¤.</li>
  <li>ë°¸ë¥˜ íƒ€ì…ì„ ìœ„í•œ ê¸°ëŠ¥ì„ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.</li>
  <li>ë¶ˆë³€ìœ¼ë¡œ êµ¬í˜„í•œë‹¤.</li>
</ul>

<h3 id="164-ì—”í‹°í‹°-ì‹ë³„ìì™€-ë°¸ë¥˜-íƒ€ì…">1.6.4 ì—”í‹°í‹° ì‹ë³„ìì™€ ë°¸ë¥˜ íƒ€ì…</h3>
<ul>
  <li>ì‹ë³„ìë¥¼ ìœ„í•œ ë°¸ë¥˜ íƒ€ì…ì„ ì‚¬ìš©í•´ì„œ ì˜ë¯¸ê°€ ì˜ ë“œëŸ¬ë‚˜ë„ë¡ í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<h3 id="165-ë„ë©”ì¸-ëª¨ë¸ì—-set-ë„£ì§€-ì•Šê¸°">1.6.5 ë„ë©”ì¸ ëª¨ë¸ì— set ë„£ì§€ ì•Šê¸°</h3>
<ul>
  <li>ìƒíƒœ ë³€ê²½ì„ ìœ„í•œ set ì‚¬ìš©ì‹œ ë„ë©”ì¸ ì§€ì‹ì´ ì½”ë“œì—ì„œ ì‚¬ë¼ì§„ë‹¤.</li>
  <li>ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ì˜¨ì „í•˜ì§€ ì•Šì€ ìƒíƒœê°€ ë  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><strong>DTOë„ ìµœëŒ€í•œ ë¶ˆë³€ ê°ì²´ë¡œ ì‚¬ìš©í•˜ë„ë¡ í•˜ì</strong></p>

<h2 id="17-ë„ë©”ì¸-ìš©ì–´ì™€-ìœ ë¹„ì¿¼í„°ìŠ¤-ì–¸ì–´">1.7 ë„ë©”ì¸ ìš©ì–´ì™€ ìœ ë¹„ì¿¼í„°ìŠ¤ ì–¸ì–´</h2>
<p><strong>ë„ë©”ì¸ ìš©ì–´</strong><br />
STEP1, STEP2 ê°™ì€ê²ƒì´ ì•„ë‹Œ PAYMENT_WAITING, PREPARING ê°™ì€ ë„ë©”ì¸ ìš©ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤.</p>

<p><strong>ìœ ë¹„ì¿¼í„°ìŠ¤ ì–¸ì–´</strong><br />
ì „ë¬¸ê°€, ê´€ê³„ì ê°œë°œìê°€ ë„ë©”ì¸ê³¼ ê´€ë ¨ëœ ê³µí†µì˜ ì–¸ì–´ë¥¼ ë§Œë“¤ê³  ì´ë¥¼ ëŒ€í™”, ë¬¸ì„œ, ë„ë©”ì¸ ëª¨ë¸, ì½”ë“œ í…ŒìŠ¤íŠ¸ ë“± ëª¨ë“  ê³³ì—ì„œ ê°™ì€ ìš©ì–´ë¥¼ ì‚¬ìš©í•œë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ì†Œí†µ ê³¼ì •ì—ì„œ ë°œìƒí•˜ëŠ” ìš©ì–´ì˜ ëª¨í˜¸í•¨ì„ ì¤„ì¼ ìˆ˜ ìˆê³  ê°œë°œìëŠ” ë„ë©”ì¸ê³¼ ì½”ë“œ ì‚¬ì´ì—ì„œ ë¶ˆí•„ìš”í•œ í•´ì„ ê³¼ì •ì„ ì¤„ì¼ ìˆ˜ ìˆë‹¤.</p>

<p><br />
<br />
<br /></p>

<h1 id="2-ì•„í‚¤íƒì²˜-ê°œìš”">2. ì•„í‚¤íƒì²˜ ê°œìš”</h1>
<h2 id="21-ë„¤-ê°œì˜-ì˜ì—­">2.1 ë„¤ ê°œì˜ ì˜ì—­</h2>
<p><strong>í‘œí˜„ ì˜ì—­</strong><br />
ì‚¬ìš©ìì˜ ìš”ì²­ì„ ë°›ì•„ ì‘ìš© ì˜ì—­ì— ì „ë‹¬í•˜ê³  ì‘ìš© ì˜ì—­ì˜ ì²˜ë¦¬ ê²°ê³¼ë¥¼ ë‹¤ì‹œ ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì£¼ëŠ” ì—­í• </p>
<center><img src="/assets/images/posts/books/1/2_1_í‘œí˜„ì˜ì—­.png" alt="í‘œí˜„ì˜ì—­" width="80%" height="80%" /></center>

<p><br /></p>

<p><strong>ì‘ìš© ì˜ì—­</strong><br />
í‘œí˜„ ì˜ì—­ì„ í†µí•´ ìš”ì²­ì„ ì „ë‹¬ë°›ì•„ ì‹œìŠ¤í…œì´ ì‚¬ìš©ìì—ê²Œ ì œê³µí•´ì•¼ í•  ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ëŠ” ì—­í• . ë¡œì§ì„ ì§ì ‘ ìˆ˜í–‰í•˜ê¸°ë³´ë‹¤ëŠ” ë„ë©”ì¸ ëª¨ë¸ì— ë¡œì§ ìˆ˜í–‰ì„ ìœ„ì„í•œë‹¤.</p>
<center><img src="/assets/images/posts/books/1/2_1_ì‘ìš©ì˜ì—­.png" alt="ì‘ìš©ì˜ì—­" width="80%" height="80%" /></center>

<p><br /></p>

<p><strong>ë„ë©”ì¸ ì˜ì—­</strong><br />
ë„ë©”ì¸ ëª¨ë¸ì„ êµ¬í˜„. ë„ë©”ì¸ ëª¨ë¸ì€ ë„ë©”ì¸ì˜ í•µì‹¬ ë¡œì§ì„ êµ¬í˜„í•œë‹¤.</p>

<p><br /></p>

<p><strong>ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ì˜ì—­</strong><br />
êµ¬í˜„ ê¸°ìˆ ì— ëŒ€í•œ ê²ƒì„ ë‹¤ë£¬ë‹¤. ì´ ì˜ì—­ì€ ë…¼ë¦¬ì ì¸ ê°œë…ì„ í‘œí˜„í•˜ê¸°ë³´ë‹¤ëŠ” ì‹¤ì œ êµ¬í˜„ì„ ë‹¤ë£¬ë‹¤.</p>
<center><img src="/assets/images/posts/books/1/2_1_ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ì˜ì—­.png" alt="ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ì˜ì—­" width="60%" height="60%" /></center>

<h2 id="22-ê³„ì¸µ-êµ¬ì¡°-ì•„í‚¤í…ì²˜">2.2 ê³„ì¸µ êµ¬ì¡° ì•„í‚¤í…ì²˜</h2>
<center><img src="/assets/images/posts/books/1/2_2_ê³„ì¸µêµ¬ì¡°.png" alt="ê³„ì¸µêµ¬ì¡°" width="60%" height="60%" /></center>
<center><img src="/assets/images/posts/books/1/2_2_ê³„ì¸µêµ¬ì¡°ìƒì˜ì¡´ê´€ê³„.png" alt="ê³„ì¸µêµ¬ì¡°ìƒì˜ì¡´ê´€ê³„" width="60%" height="60%" /></center>
<ul>
  <li>ìƒìœ„ ê³„ì¸µì—ì„œ í•˜ìœ„ ê³„ì¸µìœ¼ë¡œ ì˜ì¡´ë§Œ ì¡´ì¬í•˜ê³  í•˜ìœ„ ê³„ì¸µì—ì„œ ìƒìœ„ ê³„ì¸µì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
</ul>

<h2 id="23-dip">2.3 DIP</h2>
<p>DIP(Dependency Inversion Principle) ì˜ì¡´ì„± ì—­ì „ ì›ì¹™</p>

<center><img src="/assets/images/posts/books/1/2_3_ê³ ìˆ˜ì¤€ì €ìˆ˜ì¤€.png" alt="ê³ ìˆ˜ì¤€ì €ìˆ˜ì¤€" width="60%" height="60%" /></center>
<center><img src="/assets/images/posts/books/1/2_3_ê³ ìˆ˜ì¤€ì €ìˆ˜ì¤€2.png" alt="ê³ ìˆ˜ì¤€ì €ìˆ˜ì¤€2" width="60%" height="60%" /></center>
<center><img src="/assets/images/posts/books/1/2_3_ê³ ìˆ˜ì¤€ì €ìˆ˜ì¤€3.png" alt="ê³ ìˆ˜ì¤€ì €ìˆ˜ì¤€3" width="60%" height="60%" /></center>
<center><img src="/assets/images/posts/books/1/2_3_DIP.png" alt="DIP" width="70%" height="70%" /></center>

<h2 id="24-ë„ë©”ì¸-ì˜ì—­ì˜-ì£¼ìš”-êµ¬ì„±ìš”ì†Œ">2.4 ë„ë©”ì¸ ì˜ì—­ì˜ ì£¼ìš” êµ¬ì„±ìš”ì†Œ</h2>

<table>
  <thead>
    <tr>
      <th><strong>ìš”ì†Œ</strong></th>
      <th><strong>ì„¤ëª…</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ì—”í‹°í‹° ENTITY</td>
      <td>ê³ ìœ ì˜ ì‹ë³„ìë¥¼ ê°–ëŠ” ê°ì²´ë¡œ ìì‹ ì˜ ë¼ì´í”„ ì‚¬ì´í´ì„ ê°–ëŠ”ë‹¤. ì£¼ë¬¸, íšŒì›, ìƒí’ˆê³¼ ê°™ì´ ë„ë©”ì¸ì˜ ê³ ìœ í•œ ê°œë…ì„ í‘œí˜„í•œë‹¤. ë„ë©”ì¸ ëª¨ë¸ì˜ ë°ì´í„°ë¥¼ í¬í•¨í•˜ë©° í•´ë‹¹ ë°ì´í„°ì™€ ê´€ë ¨ëœ ê¸°ëŠ¥ì„ í•¨ê»˜ ì œê³µí•œë‹¤.</td>
    </tr>
    <tr>
      <td>ë°¸ë¥˜ VALUE</td>
      <td>ê³ ìœ ì˜ ì‹ë³„ìë¥¼ ê°–ì§€ ì•ŠëŠ” ê°ì²´ë¡œ ì£¼ë¡œ ê°œë…ì ìœ¼ë¡œ í•˜ë‚˜ì¸ ê°’ì„ í‘œí˜„í•œë‹¤. ì—”í‹°í‹°ì˜ ì†ì„±ìœ¼ë¡œ ì‚¬ìš©í•  ë¿ë§Œ ì•„ë‹ˆë¼ ë‹¤ë¥¸ ë°¸ë¥˜ íƒ€ì…ì˜ ì†ì„±ìœ¼ë¡œë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</td>
    </tr>
    <tr>
      <td>ì• ê·¸ë¦¬ê±°íŠ¸ AGGREGATE</td>
      <td>ì—°ê´€ëœ ì—”í‹°í‹°ì™€ ë°¸ë¥˜ ê°ì²´ë¥¼ ê°œë…ì ìœ¼ë¡œ í•˜ë‚˜ë¡œ ë¬¶ì€ ê²ƒì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì£¼ë¬¸ê³¼ ê´€ë ¨ëœ Order ì—”í‹°í‹°, OrderLine ë°¸ë¥˜, Orderer ë°¸ë¥˜ ê°ì²´ë¥¼ â€˜ì£¼ë¬¸â€™ ì• ê·¸ë¦¬ê±°íŠ¸ë¡œ ë¬¶ì„ ìˆ˜ ìˆë‹¤.</td>
    </tr>
    <tr>
      <td>ë¦¬í¬ì§€í„°ë¦¬ REPOSITORY</td>
      <td>ë„ë©”ì¸ ëª¨ë¸ì˜ ì˜ì†ì„±ì„ ì²˜ë¦¬í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ DBMS í…Œì´ë¸”ì—ì„œ ì—”í‹°í‹° ê°ì²´ë¥¼ ë¡œë”©í•˜ê±°ë‚˜ ì €ì¥í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.</td>
    </tr>
    <tr>
      <td>ë„ë©”ì¸ ì„œë¹„ìŠ¤ DOMAIN SERVICE</td>
      <td>íŠ¹ì • ì—”í‹°í‹°ì— ì†í•˜ì§€ ì•Šì€ ë„ë©”ì¸ ë¡œì§ì„ ì œê³µí•œë‹¤. ë„ë©”ì¸ ë¡œì§ì´ ì—¬ëŸ¬ ì—”í‹°í‹°ì™€ ë°¸ë¥˜ë¥¼ í•„ìš”ë¡œ í•˜ë©´ ë„ë©”ì¸ ì„œë¹„ìŠ¤ì—ì„œ ë¡œì§ì„ êµ¬í˜„í•œë‹¤.</td>
    </tr>
  </tbody>
</table>

<h2 id="25-ìš”ì²­-ì²˜ë¦¬-íë¦„">2.5 ìš”ì²­ ì²˜ë¦¬ íë¦„</h2>
<center><img src="/assets/images/posts/books/1/2_5_ìš”ì²­ì²˜ë¦¬íë¦„.png" alt="ìš”ì²­ì²˜ë¦¬íë¦„" width="80%" height="80%" /></center>

<h2 id="26-ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜-ê°œìš”">2.6 ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ê°œìš”</h2>
<ul>
  <li>ë„ë©”ì¸ ê°ì²´ì˜ ì˜ì†ì„± ì²˜ë¦¬, íŠ¸ëœì ì…˜, REST í´ë¼ì´ì–¸íŠ¸ ë“± ë‹¤ë¥¸ì˜ì—­ì—ì„œ í•„ìš”ë¡œ í•˜ëŠ” í”„ë ˆì„ì›Œí¬, êµ¬í˜„ ê¸°ìˆ , ë³´ì¡° ê¸°ëŠ¥ì„ ì§€ì›í•œë‹¤.</li>
  <li>ë³´í†µ ì˜ì¡´ì„±ì—­ì „ ì‚¬ìš©</li>
  <li>@Transactional ê°™ì€ DIPë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì˜ˆì™¸ë„ í¸ì˜ë¥¼ ìœ„í•´ í—ˆìš©</li>
</ul>

<h2 id="27-ëª¨ë“ˆ-êµ¬ì„±">2.7 ëª¨ë“ˆ êµ¬ì„±</h2>
<center><img src="/assets/images/posts/books/1/2_7_ëª¨ë“ˆêµ¬ì„±1.png" alt="ëª¨ë“ˆêµ¬ì„±1" width="80%" height="80%" /></center>
<center><img src="/assets/images/posts/books/1/2_7_ëª¨ë“ˆêµ¬ì„±2.png" alt="ëª¨ë“ˆêµ¬ì„±2" width="80%" height="80%" /></center>
<center><img src="/assets/images/posts/books/1/2_7_ëª¨ë“ˆêµ¬ì„±3.png" alt="ëª¨ë“ˆêµ¬ì„±3" width="80%" height="80%" /></center>

<p><br />
<br />
<br /></p>

<h1 id="3-ì• ê·¸ë¦¬ê±°íŠ¸">3. ì• ê·¸ë¦¬ê±°íŠ¸</h1>
<h2 id="31-ì• ê·¸ë¦¬ê±°íŠ¸">3.1 ì• ê·¸ë¦¬ê±°íŠ¸</h2>
<p>ë³µì¡í•œ ë„ë©”ì¸ì„ ì´í•´í•˜ê³  ê´€ë¦¬í•˜ê¸° ì‰¬ìš´ ë‹¨ìœ„ë¡œ ë§Œë“œë ¤ë©´ ìƒìœ„ ìˆ˜ì¤€ì—ì„œ ëª¨ë¸ì„ ì¡°ë§í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ í•„ìš”í•œë°, ê·¸ ë°©ë²•ì´ ë°”ë¡œ ì• ê·¸ë¦¬ê±°íŠ¸ë‹¤. ì• ê·¸ë¦¬ê±°íŠ¸ëŠ” ê´€ë ¨ëœ ê°ì²´ë¥¼ í•˜ë‚˜ì˜ êµ°ìœ¼ë¡œ ë¬¶ì–´ ì¤€ë‹¤.</p>
<center><img src="/assets/images/posts/books/1/3_1_ì• ê±°ë¦¬ê±°íŠ¸ëª¨ë¸.png" alt="ì• ê±°ë¦¬ê±°íŠ¸ëª¨ë¸" width="80%" height="80%" /></center>

<p>ì• ê·¸ë¦¬ê±°íŠ¸ëŠ” ê²½ê³„ë¥¼ ê°–ëŠ”ë‹¤. í•œ ì• ê·¸ë¦¬ê±°íŠ¸ì— ì†í•œ ê°ì²´ëŠ” ë‹¤ë¥¸ ì• ê·¸ë¦¬ê±°íŠ¸ì— ì†í•˜ì§€ ì•ŠëŠ”ë‹¤. ì• ê·¸ë¦¬ê±°íŠ¸ëŠ” ë…ë¦½ëœ ê°ì²´ êµ°ì´ë©° ê° ì• ê·¸ë¦¬ê±°íŠ¸ëŠ” ìê¸° ìì‹ ì„ ê´€ë¦¬í•  ë¿ ë‹¤ë¥¸ ì• ê·¸ë¦¬ê±°íŠ¸ë¥¼ ê´€ë¦¬í•˜ì§€ ì•ŠëŠ”ë‹¤. ê²½ê³„ë¥¼ ì„¤ì •í•  ë•Œ ê¸°ë³¸ì´ ë˜ëŠ” ê²ƒì€ ë„ë©”ì¸ ê·œì¹™ê³¼ ìš”êµ¬ì‚¬í•­ì´ë‹¤. ë„ë©”ì¸ ê·œì¹™ì— ë”°ë¼ í•¨ê»˜ ìƒì„±ë˜ëŠ” êµ¬ì„±ìš”ì†ŒëŠ” í•œ ì• ê·¸ë¦¬ê±°íŠ¸ì— ì†í•  ê°€ëŠ¥ì„±ì´ ë†’ë‹¤.</p>

<h2 id="32-ì• ê·¸ë¦¬ê±°íŠ¸-ë£¨íŠ¸">3.2 ì• ê·¸ë¦¬ê±°íŠ¸ ë£¨íŠ¸</h2>
<p>ì• ê·¸ë¦¬ê±°íŠ¸ì— ì†í•œ ëª¨ë“  ê°ì²´ê°€ ì¼ê´€ëœ ìƒíƒœë¥¼ ìœ ì§€í•˜ë ¤ë©´ ì• ê·¸ë¦¬ê±°íŠ¸ ì „ì²´ë¥¼ ê´€ë¦¬í•  ì£¼ì²´ê°€ í•„ìš”í•œë°, ì´ ì±…ì„ì„ ì§€ëŠ” ê²ƒì´ ë°”ë¡œ ì• ê·¸ë¦¬ê±°íŠ¸ ë£¨íŠ¸ ì—”í‹°í‹°ì´ë‹¤. ì• ê·¸ë¦¬ê±°íŠ¸ì— ì†í•œ ê°ì²´ëŠ” ì• ê·¸ë¦¬ê±°íŠ¸ ë£¨íŠ¸ ì—”í‹°í‹°ì— ì§ì ‘ ë˜ëŠ” ê°„ì ‘ì ìœ¼ë¡œ ì†í•˜ê²Œ ëœë‹¤.</p>
<center><img src="/assets/images/posts/books/1/3_2_ì• ê·¸ë¦¬ê±°íŠ¸ë£¨íŠ¸.png" alt="ì• ê·¸ë¦¬ê±°íŠ¸ë£¨íŠ¸" width="80%" height="80%" /></center>

<h3 id="321-ë„ë©”ì¸-ê·œì¹™ê³¼-ì¼ê´€ì„±">3.2.1 ë„ë©”ì¸ ê·œì¹™ê³¼ ì¼ê´€ì„±</h3>
<ul>
  <li>ì• ê·¸ë¦¬ê±°íŠ¸ ë£¨íŠ¸ì˜ í•µì‹¬ ì—­í• ì€ ì• ê·¸ë¦¬ê±°íŠ¸ì˜ ì¼ê´€ì„±ì´ ê¹¨ì§€ì§€ ì•Šë„ë¡ í•˜ëŠ” ê²ƒì´ë‹¤. ì´ë¥¼ ìœ„í•´ ì• ê·¸ë¦¬ê±°íŠ¸ ë£¨íŠ¸ëŠ” ì• ê·¸ë¦¬ê±°íŠ¸ê°€ ì œê³µí•´ì•¼ í•  ë„ë©”ì¸ ê¸°ëŠ¥ì„ êµ¬í˜„í•œë‹¤.</li>
  <li>ì• ê·¸ë¦¬ê±°íŠ¸ ì™¸ë¶€ì—ì„œ ì• ê·¸ë¦¬ê±°íŠ¸ì— ì†í•œ ê°ì²´ë¥¼ ì§ì ‘ ë³€ê²½í•˜ë©´ ì•ˆëœë‹¤. ì´ê²ƒì€ ëª¨ë¸ì˜ ì¼ê´€ì„±ì„ ê¹¨ëŠ” ì›ì¸ì´ ëœë‹¤.</li>
  <li>ë‹¨ìˆœíˆ í•„ë“œë¥¼ ë³€ê²½í•˜ëŠ” set ë©”ì„œë“œë¥¼ ê³µê°œ(public) ë²”ìœ„ë¡œ ë§Œë“¤ì§€ ì•ŠëŠ”ë‹¤.</li>
  <li>ë°¸ë¥˜ íƒ€ì…ì€ ë¶ˆë³€ìœ¼ë¡œ êµ¬í˜„í•œë‹¤.</li>
</ul>

<h3 id="322-ì• ê·¸ë¦¬ê±°íŠ¸-ë£¨íŠ¸ì˜-ê¸°ëŠ¥-êµ¬í˜„">3.2.2 ì• ê·¸ë¦¬ê±°íŠ¸ ë£¨íŠ¸ì˜ ê¸°ëŠ¥ êµ¬í˜„</h3>
<ul>
  <li>ì• ê·¸ë¦¬ê±°íŠ¸ ë£¨íŠ¸ëŠ” ì• ê·¸ë¦¬ê±°íŠ¸ ë‚´ë¶€ì˜ ë‹¤ë¥¸ ê°ì²´ë¥¼ ì¡°í•©í•´ ê¸°ëŠ¥ì„ ì™„ì„±í•œë‹¤.</li>
  <li>ì• ê·¸ë¦¬ê±°íŠ¸ ë£¨íŠ¸ê°€ êµ¬ì„±ìš”ì†Œì˜ ìƒíƒœë§Œ ì°¸ì¡°í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤. ê¸°ëŠ¥ ì‹¤í–‰ì„ ìœ„ì„í•˜ê¸°ë„ í•œë‹¤.</li>
</ul>

<h3 id="323-íŠ¸ëœì ì…˜-ë²”ìœ„">3.2.3 íŠ¸ëœì ì…˜ ë²”ìœ„</h3>
<ul>
  <li>ì‘ì„ìˆ˜ë¡ ì¢‹ë‹¤</li>
  <li>í•œ íŠ¸ëœì ì…˜ì—ì„œëŠ” í•œ ê°œì˜ ì• ê·¸ë¦¬ê±°íŠ¸ë§Œ ìˆ˜ì •í•œë‹¤.</li>
  <li>ë¶€ë“ì´í•˜ê²Œ í•œ íŠ¸ëœì ì…˜ìœ¼ë¡œ ë‘ ê°œ ì´ìƒì˜ ì• ê·¸ë¦¬ê±°íŠ¸ë¥¼ ìˆ˜ì •í•´ì•¼ í•œë‹¤ë©´ ì• ê·¸ë¦¬ê±°íŠ¸ì—ì„œ ë‹¤ë¥¸ ì• ê·¸ë¦¬ê±°íŠ¸ë¥¼ ìˆ˜ì •í•˜ì§€ ë§ê³ , ì‘ìš© ì„œë¹„ìŠ¤ì—ì„œ ì• ê·¸ë¦¬ê±°íŠ¸ë¥¼ ìˆ˜ì •í•˜ë„ë¡ êµ¬í˜„í•œë‹¤.</li>
  <li>ë‘ ê°œ ì´ìƒì˜ ì• ê·¸ë¦¬ê±°íŠ¸ë¥¼ ìˆ˜ì •í•´ì•¼ í•œë‹¤ë©´, ë„ë©”ì¸ ì´ë²¤íŠ¸ë¥¼ ì‚¬ìš©í•œë‹¤.</li>
</ul>

<h2 id="33-ë¦¬í¬ì§€í„°ë¦¬ì™€-ì• ê·¸ë¦¬ê±°íŠ¸">3.3 ë¦¬í¬ì§€í„°ë¦¬ì™€ ì• ê·¸ë¦¬ê±°íŠ¸</h2>
<ul>
  <li>ì• ê·¸ë¦¬ê±°íŠ¸: ê°œë…ìƒ ì™„ì „í•œ í•˜ë‚˜ì˜ ë„ë©”ì¸ ëª¨ë¸</li>
  <li>ë¦¬í¬ì§€í„°ë¦¬: ì• ê·¸ë¦¬ê±°íŠ¸ ì˜ì†ì„±ì„ ì²˜ë¦¬
    <ul>
      <li>save: ì• ê·¸ë¦¬ê±°íŠ¸ ì €ì¥</li>
      <li>findById: IDë¡œ ì• ê·¸ë¦¬ê±°íŠ¸ë¥¼ êµ¬í•¨</li>
    </ul>
  </li>
</ul>

<h2 id="34-idë¥¼-ì´ìš©í•œ-ì• ê·¸ë¦¬ê±°íŠ¸-ì°¸ì¡°">3.4 IDë¥¼ ì´ìš©í•œ ì• ê·¸ë¦¬ê±°íŠ¸ ì°¸ì¡°</h2>
<ul>
  <li>ì• ê·¸ë¦¬ê±°íŠ¸ë„ ë‹¤ë¥¸ ì• ê·¸ë¦¬ê±°íŠ¸ë¥¼ ì°¸ì¡°í•œë‹¤.</li>
  <li>ì• ê·¸ë¦¬ê±°íŠ¸ ì°¸ì¡°ëŠ” ì• ê·¸ë¦¬ê±°íŠ¸ ë£¨íŠ¸ê°€ ë‹¤ë¥¸ ì• ê·¸ë¦¬ê±°íŠ¸ ë£¨íŠ¸ë¥¼ ì°¸ì¡°í•œë‹¤ëŠ” ëœ»ì´ë‹¤.</li>
</ul>

<p><br /></p>

<p><strong>í•„ë“œ ì°¸ì¡°</strong></p>
<center><img src="/assets/images/posts/books/1/3_4_í•„ë“œì°¸ì¡°.png" alt="í•„ë“œì°¸ì¡°" width="80%" height="80%" /></center>

<p><strong>í•„ë“œ ì°¸ì¡° ë¬¸ì œì </strong></p>
<ul>
  <li>í¸í•œ íƒìƒ‰ ì˜¤ìš©</li>
  <li>ê²°í•©ë„ ì¦ê°€</li>
  <li>ì„±ëŠ¥ì— ëŒ€í•œ ê³ ë¯¼</li>
  <li>í™•ì¥ ì–´ë ¤ì›€</li>
</ul>

<p><br /></p>

<p><strong>IDë¥¼ ì´ìš©í•œ ì°¸ì¡°</strong></p>
<center><img src="/assets/images/posts/books/1/3_4_IDì°¸ì¡°.png" alt="IDì°¸ì¡°" width="80%" height="80%" /></center>

<p><strong>ID ì°¸ì¡° ì¥ì </strong></p>
<ul>
  <li>ëª¨ë¸ì˜ ë³µì¡ë„ë¥¼ ë‚®ì¶˜ë‹¤</li>
  <li>ì‘ì§‘ë„ ì¦ê°€</li>
  <li>êµ¬í˜„ ë‚œì´ë„ ê°ì†Œ</li>
  <li>í™•ì¥ ìš©ì´</li>
</ul>

<h3 id="341-idë¥¼-ì´ìš©í•œ-ì°¸ì¡°ì™€-ì¡°íšŒ-ì„±ëŠ¥">3.4.1 IDë¥¼ ì´ìš©í•œ ì°¸ì¡°ì™€ ì¡°íšŒ ì„±ëŠ¥</h3>

<p>IDë¥¼ ì´ìš©í•œ ì¡°íšŒëŠ” <strong>N + 1 ë¬¸ì œê°€ ë°œìƒ</strong>í•œë‹¤.<br />
í•´ê²°ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ë‹¤.</p>
<ul>
  <li>ì¡°íšŒ ì „ìš© ì¿¼ë¦¬ë¥¼ ë§Œë“¤ì–´ ì‚¬ìš©í•œë‹¤.</li>
  <li>ì¿¼ë¦¬ê°€ ë³µì¡í•˜ê±°ë‚˜ íŠ¹í™”ëœ ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤ë©´ ë§ˆì´ë°”í‹°ìŠ¤ì™€ ê°™ì€ ê¸°ìˆ ë¡œ êµ¬í˜„í•˜ëŠ”ê±¸ ê³ ë ¤í•œë‹¤.</li>
</ul>

<h2 id="35-ì• ê·¸ë¦¬ê±°íŠ¸-ê°„-ì§‘í•©-ì—°ê´€">3.5 ì• ê·¸ë¦¬ê±°íŠ¸ ê°„ ì§‘í•© ì—°ê´€</h2>
<p>1-N, M-N ì—°ê´€ì— ëŒ€í•´ ì‚´í´ë³¸ë‹¤.</p>

<p><strong>1-N</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Category</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Product</span><span class="o">&gt;</span> <span class="n">products</span><span class="o">;</span> <span class="c1">//ë‹¤ë¥¸ ì• ê·¸ë¦¬ê±°íŠ¸ì— ëŒ€í•œ 1-N ì—°ê´€</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ì¡°íšŒì‹œ ê°œë…ì ìœ¼ë¡œ ì• ê±°ë¦¬ê±°íŠ¸ ê°„ì— 1-N ì—°ê´€ì´ ìˆë”ë¼ë„ ì„±ëŠ¥ ë¬¸ì œ ë•Œë¬¸ì— ì‹¤ì œ êµ¬í˜„ì— ë°˜ì˜í•˜ì§€ ì•ŠëŠ”ë‹¤. N-1ë¡œ ì—°ê´€ì§€ì–´ êµ¬í˜„í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Product</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">CategoryId</span> <span class="n">categoryId</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProductListService</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">Product</span><span class="o">&gt;</span> <span class="nf">getProductOfCategory</span><span class="o">(</span><span class="nc">Long</span> <span class="n">categoryId</span><span class="o">,</span> <span class="kt">int</span> <span class="n">page</span><span class="o">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Category</span> <span class="n">category</span> <span class="o">=</span> <span class="n">categoryRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">categoryId</span><span class="o">);</span>
        <span class="n">checkCategory</span><span class="o">(</span><span class="n">category</span><span class="o">);</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Product</span><span class="o">&gt;</span> <span class="n">products</span> <span class="o">=</span> <span class="n">productRepository</span><span class="o">.</span><span class="na">findByCategoryId</span><span class="o">(</span><span class="n">category</span><span class="o">.</span><span class="na">getId</span><span class="o">(),</span> <span class="n">page</span><span class="o">,</span> <span class="n">size</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">totalCount</span> <span class="o">=</span> <span class="n">productRepository</span><span class="o">.</span><span class="na">countByCategoryId</span><span class="o">(</span><span class="n">category</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Page</span><span class="o">(</span><span class="n">page</span><span class="o">,</span> <span class="n">size</span><span class="o">,</span> <span class="n">totalCount</span><span class="o">,</span> <span class="n">products</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<p><strong>M-N</strong><br />
M-N ì—°ê´€ì€ ê°œë…ì ìœ¼ë¡œ ì–‘ìª½ ì• ê·¸ë¦¬ê±°íŠ¸ì— ì»¬ë ‰ì…˜ìœ¼ë¡œ ì—°ê´€ì„ ë§Œë“ ë‹¤. í•˜ì§€ë§Œ êµ¬í˜„ì€ ìš”êµ¬ì‚¬í•­ì„ ê³ ë ¤í•´ì„œ ê²°ì •í•œë‹¤. ê°œë…ì ìœ¼ë¡œëŠ” ìƒí’ˆê³¼ ì¹´í…Œê³ ë¦¬ì˜ ì–‘ë°©í–¥ M-N ì—°ê´€ì´ ì¡´ì¬í•˜ì§€ë§Œ ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ìƒí’ˆì—ì„œ ì¹´í…Œê³ ë¦¬ë¡œì˜ ë‹¨ë°©í–¥ M-N ì—°ê´€ë§Œ ì ìš©í•˜ë©´ ë˜ëŠ” ê²ƒì´ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Product</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">CategoryId</span><span class="o">&gt;</span> <span class="n">categoryIds</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<p><strong>RDBMSì—ì„œ M-N ì—°ê´€ êµ¬í˜„</strong></p>
<center><img src="/assets/images/posts/books/1/3_5_RDBMS_M-Nì—°ê´€.png" alt="RDBMS_M-Nì—°ê´€" width="80%" height="80%" /></center>

<p><br /></p>

<p><strong>JPAë¥¼ ì´ìš©í•˜ì—¬ ID ì°¸ì¡°ë¥¼ ì´ìš©í•œ M-N ë‹¨ë°©í–¥ ì—°ê´€ êµ¬í˜„</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"product"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Product</span> <span class="o">{</span>
    <span class="nd">@EmbeddedId</span>
    <span class="kd">private</span> <span class="nc">ProductId</span> <span class="n">id</span><span class="o">;</span>
    
    <span class="nd">@ElementCollection</span>
    <span class="nd">@CollectionTable</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"product_category"</span><span class="o">,</span>
        <span class="n">joinColumns</span> <span class="o">=</span> <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"product_id"</span><span class="o">))</span>
    <span class="kd">private</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">CategoryId</span><span class="o">&gt;</span> <span class="n">categoryIds</span><span class="o">;</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="36-ì• ê·¸ë¦¬ê±°íŠ¸ë¥¼-íŒ©í† ë¦¬ë¡œ-ì‚¬ìš©í•˜ê¸°">3.6 ì• ê·¸ë¦¬ê±°íŠ¸ë¥¼ íŒ©í† ë¦¬ë¡œ ì‚¬ìš©í•˜ê¸°</h2>
<ul>
  <li>ì• ê·¸ë¦¬ê±°íŠ¸ê°€ ê°–ê³  ìˆëŠ” ë°ì´í„°ë¥¼ ì´ìš©í•´ì„œ ë‹¤ë¥¸ ì• ê·¸ë¦¬ê±°íŠ¸ë¥¼ ìƒì„±í•´ì•¼ í•œë‹¤ë©´ ì• ê·¸ë¦¬ê±°íŠ¸ì— íŒ©í† ë¦¬ ë©”ì„œë“œë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒì„ ê³ ë ¤í•œë‹¤.</li>
  <li>ë³„ë„ì˜ ë„ë©”ì¸ ì„œë¹„ìŠ¤ë‚˜, íŒ©í† ë¦¬ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ ìˆ˜ë„ ìˆë‹¤.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Store</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nc">Product</span> <span class="nf">createProduct</span> <span class="o">(</span><span class="nc">ProductId</span> <span class="n">newProductId</span><span class="o">,</span> <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">isBlocked</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">StoreBlockedException</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Product</span><span class="o">(</span><span class="n">newProductId</span><span class="o">,</span> <span class="n">getId</span><span class="o">(),</span> <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p><br />
<br />
<br /></p>

<h1 id="4-ë¦¬í¬ì§€í„°ë¦¬ì™€-ëª¨ë¸-êµ¬í˜„">4. ë¦¬í¬ì§€í„°ë¦¬ì™€ ëª¨ë¸ êµ¬í˜„</h1>
<p>ìì„¸í•œ ì„¤ëª…ì€ ì•„ë˜ì˜ ë¬¸ì„œì™€ ì±…ì„ ì½ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤. ğŸ‘</p>
<ul>
  <li><a href="https://product.kyobobook.co.kr/detail/S000001810495" target="_blank">ë„ë©”ì¸ ì£¼ë„ ê°œë°œ ì‹œì‘í•˜ê¸°: DDD í•µì‹¬ ê°œë… ì •ë¦¬ë¶€í„° êµ¬í˜„ê¹Œì§€</a></li>
  <li><a href="http://www.yes24.com/Product/Goods/19040233" target="_blank">ìë°” ORM í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë°</a></li>
  <li><a href="https://spring.io/projects/spring-data-jpa" target="_blank">Spring Data JPA</a></li>
</ul>

<h2 id="41-jpaë¥¼-ì´ìš©í•œ-ë¦¬í¬ì§€í„°ë¦¬-êµ¬í˜„">4.1 JPAë¥¼ ì´ìš©í•œ ë¦¬í¬ì§€í„°ë¦¬ êµ¬í˜„</h2>
<h3 id="411-ëª¨ë“ˆ-ìœ„ì¹˜">4.1.1 ëª¨ë“ˆ ìœ„ì¹˜</h3>
<center><img src="/assets/images/posts/books/1/4_1_ëª¨ë“ˆìœ„ì¹˜.png" alt="ëª¨ë“ˆìœ„ì¹˜" width="80%" height="80%" /></center>

<h3 id="412-ë¦¬í¬ì§€í„°ë¦¬-ê¸°ë³¸-ê¸°ëŠ¥-êµ¬í˜„">4.1.2 ë¦¬í¬ì§€í„°ë¦¬ ê¸°ë³¸ ê¸°ëŠ¥ êµ¬í˜„</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">OrderRepository</span> <span class="o">{</span>
    <span class="nc">Order</span> <span class="nf">findById</span><span class="o">(</span><span class="nc">OrderNo</span> <span class="n">no</span><span class="o">);</span>
    <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="nc">Order</span> <span class="n">order</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JpaOrderRepository</span> <span class="kd">implements</span> <span class="nc">OrderRepository</span> <span class="o">{</span>
    <span class="nd">@PersistenceContext</span>
    <span class="kd">private</span> <span class="nc">EntityManager</span> <span class="n">entityManager</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Order</span> <span class="nf">findById</span><span class="o">(</span><span class="nc">OrderNo</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="nc">Order</span> <span class="n">order</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">entityManager</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="42-ìŠ¤í”„ë§-ë°ì´í„°-jpaë¥¼-ì´ìš©í•œ-ë¦¬í¬ì§€í„°ë¦¬-êµ¬í˜„">4.2 ìŠ¤í”„ë§ ë°ì´í„° JPAë¥¼ ì´ìš©í•œ ë¦¬í¬ì§€í„°ë¦¬ êµ¬í˜„</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"purchase_order"</span><span class="o">)</span>
<span class="nd">@Access</span><span class="o">(</span><span class="nc">AccessType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>
    <span class="nd">@EmbeddedId</span>
    <span class="kd">private</span> <span class="nc">OrderNo</span> <span class="n">number</span><span class="o">;</span>

    <span class="nd">@Version</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">version</span><span class="o">;</span>

    <span class="nd">@Embedded</span>
    <span class="kd">private</span> <span class="nc">Orderer</span> <span class="n">orderer</span><span class="o">;</span>

    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">OrderRepository</span> <span class="kd">extends</span> <span class="nc">Repository</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">,</span> <span class="nc">OrderNo</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="nf">findById</span><span class="o">(</span><span class="nc">OrderNo</span> <span class="n">id</span><span class="o">);</span>

    <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="nc">Order</span> <span class="n">order</span><span class="o">);</span>

    <span class="k">default</span> <span class="nc">OrderNo</span> <span class="nf">nextOrderNo</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">randomNo</span> <span class="o">=</span> <span class="nc">ThreadLocalRandom</span><span class="o">.</span><span class="na">current</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">900000</span><span class="o">)</span> <span class="o">+</span> <span class="mi">100000</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">number</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%tY%&lt;tm%&lt;td%&lt;tH-%d"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Date</span><span class="o">(),</span> <span class="n">randomNo</span><span class="o">);</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">OrderNo</span><span class="o">(</span><span class="n">number</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CancelOrderService</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">OrderRepository</span> <span class="n">orderRepository</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">CancelPolicy</span> <span class="n">cancelPolicy</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">CancelOrderService</span><span class="o">(</span><span class="nc">OrderRepository</span> <span class="n">orderRepository</span><span class="o">,</span> <span class="nc">CancelPolicy</span> <span class="n">cancelPolicy</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">orderRepository</span> <span class="o">=</span> <span class="n">orderRepository</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">cancelPolicy</span> <span class="o">=</span> <span class="n">cancelPolicy</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Transactional</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">cancel</span><span class="o">(</span><span class="nc">OrderNo</span> <span class="n">orderNo</span><span class="o">,</span> <span class="nc">Canceller</span> <span class="n">canceller</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="n">orderRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">orderNo</span><span class="o">)</span>
                <span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">NoOrderException</span><span class="o">());</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">cancelPolicy</span><span class="o">.</span><span class="na">hasCancellationPermission</span><span class="o">(</span><span class="n">order</span><span class="o">,</span> <span class="n">canceller</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">NoCancellablePermission</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">order</span><span class="o">.</span><span class="na">cancel</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="43-ë§¤í•‘-êµ¬í˜„">4.3 ë§¤í•‘ êµ¬í˜„</h2>
<h3 id="431-ì—”í‹°í‹°ì™€-ë°¸ë¥˜-ê¸°ë³¸-ë§¤í•‘-êµ¬í˜„">4.3.1 ì—”í‹°í‹°ì™€ ë°¸ë¥˜ ê¸°ë³¸ ë§¤í•‘ êµ¬í˜„</h3>
<p>ì• ê·¸ë¦¬ê±°íŠ¸ì™€ JPA ë§¤í•‘ì„ ìœ„í•œ ê¸°ë³¸ ê·œì¹™</p>
<ul>
  <li>ì• ê·¸ë¦¬ê±°íŠ¸ ë£¨íŠ¸ëŠ” ì—”í‹°í‹°ì´ë¯€ë¡œ <code class="language-plaintext highlighter-rouge">@Entity</code>ë¡œ ë§¤í•‘ ì„¤ì •í•œë‹¤.</li>
</ul>

<p>í•œ í…Œì´ë¸”ì— ì—”í‹°í‹°ì™€ ë°¸ë¥˜ ë°ì´í„°ê°€ ê°™ì´ ìˆë‹¤ë©´</p>
<ul>
  <li>ë°¸ë¥˜ëŠ” <code class="language-plaintext highlighter-rouge">@Embeddable</code>ë¡œ ë§¤í•‘ ì„¤ì •í•œë‹¤.</li>
  <li>ë°¸ë¥˜ íƒ€ì… í”„ë¡œí¼í‹°ëŠ” <code class="language-plaintext highlighter-rouge">@Embedded</code>ë¡œ ë§¤í•‘ ì„¤ì •í•œë‹¤.</li>
  <li>ë§¤í•‘í•  ì»¬ëŸ¼ëª… ë³€ê²½ì€ <code class="language-plaintext highlighter-rouge">@AttributeOverrides</code> ë¥¼ ì´ìš©í•œë‹¤</li>
</ul>

<center><img src="/assets/images/posts/books/1/4_3_ë§¤í•‘êµ¬í˜„.png" alt="ë§¤í•‘êµ¬í˜„" width="80%" height="80%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Embeddable</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ShippingInfo</span> <span class="o">{</span>
    <span class="nd">@Embedded</span>
    <span class="nd">@AttributeOverrides</span><span class="o">({</span>
            <span class="nd">@AttributeOverride</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"zipCode"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"shipping_zip_code"</span><span class="o">)),</span>
            <span class="nd">@AttributeOverride</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"address1"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"shipping_addr1"</span><span class="o">)),</span>
            <span class="nd">@AttributeOverride</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"address2"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"shipping_addr2"</span><span class="o">))</span>
    <span class="o">})</span>
    <span class="kd">private</span> <span class="nc">Address</span> <span class="n">address</span><span class="o">;</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"shipping_message"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">message</span><span class="o">;</span>
    <span class="nd">@Embedded</span>
    <span class="kd">private</span> <span class="nc">Receiver</span> <span class="n">receiver</span><span class="o">;</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"purchase_order"</span><span class="o">)</span>
<span class="nd">@Access</span><span class="o">(</span><span class="nc">AccessType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>
    <span class="o">...</span>
    <span class="nd">@Embedded</span>
    <span class="kd">private</span> <span class="nc">Orderer</span> <span class="n">orderer</span><span class="o">;</span>

    <span class="nd">@Embedded</span>
    <span class="kd">private</span> <span class="nc">ShippingInfo</span> <span class="n">shippingInfo</span><span class="o">;</span>
    <span class="o">...</span>
</code></pre></div></div>

<h3 id="432-ê¸°ë³¸-ìƒì„±ì">4.3.2 ê¸°ë³¸ ìƒì„±ì</h3>
<p>ì—”í‹°í‹°ëŠ” ê¸°ë³¸ ìƒì„±ìê°€ í•„ìš”í•˜ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">protected</span> <span class="nf">Receiver</span><span class="o">(){}</span>
</code></pre></div></div>

<h3 id="432-í•„ë“œ-ì ‘ê·¼-ë°©ì‹-ì‚¬ìš©">4.3.2 í•„ë“œ ì ‘ê·¼ ë°©ì‹ ì‚¬ìš©</h3>
<p><code class="language-plaintext highlighter-rouge">@Access</code>ë¥¼ ì´ìš©í•´ì„œ ëª…ì‹œì ìœ¼ë¡œ ì ‘ê·¼ ë°©ì‹ì„ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ <code class="language-plaintext highlighter-rouge">@Id</code>ë‚˜ <code class="language-plaintext highlighter-rouge">@EmbeddedId</code>ì˜ ìœ„ì¹˜ì— ë”°ë¼ ì ‘ê·¼ ë°©ì‹ì„ ê²°ì •í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"purchase_order"</span><span class="o">)</span>
<span class="nd">@Access</span><span class="o">(</span><span class="nc">AccessType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="434-attributeconverterë¥¼-ì´ìš©í•œ-ë°¸ë¥˜-ë§¤í•‘-ì²˜ë¦¬">4.3.4 AttributeConverterë¥¼ ì´ìš©í•œ ë°¸ë¥˜ ë§¤í•‘ ì²˜ë¦¬</h3>
<p><strong>ë‘ ê°œ ì´ìƒì˜ í”„ë¡œí¼í‹°ë¥¼ ê°€ì§„ ë°¸ë¥˜ íƒ€ì…ì„ í•œ ê°œ ì»¬ëŸ¼ì— ë§¤í•‘</strong>í•˜ë ¤ë©´ <code class="language-plaintext highlighter-rouge">@Embeddable</code> ì• ë„ˆí…Œì´ì…˜ìœ¼ë¡œëŠ” ì²˜ë¦¬í•  ìˆ˜ ì—†ë‹¤. ì´ëŸ´ ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²ƒì´ <code class="language-plaintext highlighter-rouge">AttributeConverter</code>ì´ë‹¤.</p>

<center><img src="/assets/images/posts/books/1/4_3_ë‘ê°œí”„ëŸ¬í¼ì»¬ëŸ¼ë§¤í•‘.png" alt="ë‘ê°œí”„ëŸ¬í¼ì»¬ëŸ¼ë§¤í•‘" width="100%" height="100%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Converter</span><span class="o">(</span><span class="n">autoApply</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MoneyConverter</span> <span class="kd">implements</span> <span class="nc">AttributeConverter</span><span class="o">&lt;</span><span class="nc">Money</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;</span> <span class="o">{</span> 
    <span class="c1">// MoneyëŠ” ë°¸ë¥˜ íƒ€ì…, IntegerëŠ” DB íƒ€ì…</span>

    <span class="c1">// ë°¸ë¥˜ íƒ€ì…ì„ DB ì¹¼ëŸ¼ ê°’ìœ¼ë¡œ ë³€í™˜</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Integer</span> <span class="nf">convertToDatabaseColumn</span><span class="o">(</span><span class="nc">Money</span> <span class="n">money</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">money</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">money</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="c1">// DB ì¹¼ëŸ¼ ê°’ì„ ë°¸ë¥˜ë¡œ ë³€í™˜</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Money</span> <span class="nf">convertToEntityAttribute</span><span class="o">(</span><span class="nc">Integer</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">value</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="k">new</span> <span class="nc">Money</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// @Converter(autoApply = true) ì‘ì„±í•œ íƒ€ì…ì— ëŒ€í•´ ìë™ ì ìš©</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"total_amounts"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Money</span> <span class="n">totalAmounts</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// @Converter(autoApply = false) ê¸°ë³¸ê°’, ì§ì ‘ ì§€ì •í•´ì•¼í•¨</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>

    <span class="nd">@Convert</span><span class="o">(</span><span class="n">converter</span> <span class="o">=</span> <span class="nc">MoneyConverter</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"total_amounts"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Money</span> <span class="n">totalAmounts</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="435-ë°¸ë¥˜-ì»¬ë ‰ì…˜-ë³„ë„-í…Œì´ë¸”-ë§¤í•‘">4.3.5 ë°¸ë¥˜ ì»¬ë ‰ì…˜: ë³„ë„ í…Œì´ë¸” ë§¤í•‘</h3>
<p>ë°¸ë¥˜ ì»¬ë ‰ì…˜ì„ ë³„ë„ í…Œì´ë¸”ë¡œ ë§¤í•‘í• ë•ŒëŠ” <code class="language-plaintext highlighter-rouge">@ElementCollection</code>ê³¼ <code class="language-plaintext highlighter-rouge">@CollectionTable</code>ì„ í•¨ê»˜ ì‚¬ìš©í•œë‹¤.</p>

<center><img src="/assets/images/posts/books/1/4_3_ë°¸ë¥˜ì»¬ë ‰ì…˜í…Œì´ë¸”ë§¤í•‘.png" alt="ë°¸ë¥˜ì»¬ë ‰ì…˜í…Œì´ë¸”ë§¤í•‘" width="70%" height="70%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"purchase_order"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>
    <span class="nd">@EmbeddedId</span>
    <span class="kd">private</span> <span class="nc">OrderNo</span> <span class="n">number</span><span class="o">;</span>

    <span class="nd">@ElementCollection</span><span class="o">(</span><span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span>
    <span class="nd">@CollectionTable</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"order_line"</span><span class="o">,</span> <span class="n">joinColumns</span> <span class="o">=</span> <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"order_number"</span><span class="o">))</span>
    <span class="nd">@OrderColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"line_idx"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">OrderLine</span><span class="o">&gt;</span> <span class="n">orderLines</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Embeddable</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderLine</span> <span class="o">{</span>
    <span class="nd">@Embedded</span>
    <span class="kd">private</span> <span class="nc">ProductId</span> <span class="n">productId</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"price"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Money</span> <span class="n">price</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"quantity"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">quantity</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"amounts"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Money</span> <span class="n">amounts</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="436-ë°¸ë¥˜-ì»¬ë ‰ì…˜-í•œ-ê°œ-ì»¬ëŸ¼-ë§¤í•‘">4.3.6 ë°¸ë¥˜ ì»¬ë ‰ì…˜: í•œ ê°œ ì»¬ëŸ¼ ë§¤í•‘</h3>
<p>í•œ ê°œ ì»¬ëŸ¼ì— ì½¤ë§ˆë¡œ êµ¬ë¶„í•´ì„œ ì €ì¥í•  ë•Œ ì‚¬ìš©. <code class="language-plaintext highlighter-rouge">AttributeConverter</code>ë¥¼ ì´ìš©í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmailSet</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Email</span><span class="o">&gt;</span> <span class="n">emails</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;&gt;();</span>

    <span class="kd">public</span> <span class="nf">EmailSet</span><span class="o">(</span><span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Email</span><span class="o">&gt;</span> <span class="n">emails</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">emails</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">emails</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Email</span><span class="o">&gt;</span> <span class="nf">getEmails</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Collections</span><span class="o">.</span><span class="na">unmodifiableSet</span><span class="o">(</span><span class="n">emails</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmailSetConverter</span> <span class="kd">implements</span> <span class="nc">AttributeConverter</span><span class="o">&lt;</span><span class="nc">EmailSet</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">convertToDatabaseColumn</span><span class="o">(</span><span class="nc">EmailSet</span> <span class="n">attribute</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">attribute</span><span class="o">.</span><span class="na">getEmails</span><span class="o">().</span><span class="na">stream</span><span class="o">()</span>
                <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">email</span> <span class="o">-&gt;</span> <span class="n">email</span><span class="o">.</span><span class="na">getAddress</span><span class="o">())</span>
                <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">joining</span><span class="o">(</span><span class="s">","</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">EmailSet</span> <span class="nf">convertToEntityAttribute</span><span class="o">(</span><span class="nc">String</span> <span class="n">dbData</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">dbData</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="nc">String</span><span class="o">[]</span> <span class="n">emails</span> <span class="o">=</span> <span class="n">dbData</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">","</span><span class="o">);</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Email</span><span class="o">&gt;</span> <span class="n">emailSet</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">emails</span><span class="o">)</span>
                <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">value</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">Email</span><span class="o">(</span><span class="n">value</span><span class="o">))</span>
                <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">toSet</span><span class="o">());</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">EmailSet</span><span class="o">(</span><span class="n">emailSet</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="437-ë°¸ë¥˜ë¥¼-ì´ìš©í•œ-id-ë§¤í•‘">4.3.7 ë°¸ë¥˜ë¥¼ ì´ìš©í•œ ID ë§¤í•‘</h3>
<p>JPAì—ì„œ ì‹ë³„ì íƒ€ì…ì€ <code class="language-plaintext highlighter-rouge">Serializable</code> íƒ€ì…ì´ì–´ì•¼ í•˜ë¯€ë¡œ <code class="language-plaintext highlighter-rouge">Serializable</code> ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì†ë°›ì•„ì•¼ í•œë‹¤. ë°¸ë¥˜ íƒ€ì…ìœ¼ë¡œ ì‹ë³„ìë¥¼ êµ¬í˜„í•  ë•Œ ì–»ì„ ìˆ˜ ìˆëŠ” ì¥ì ì€ ì‹ë³„ìì— ê¸°ëŠ¥ì„ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì´ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"purchase_order"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>
    <span class="nd">@EmbeddedId</span>
    <span class="kd">private</span> <span class="nc">OrderNo</span> <span class="n">number</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Embeddable</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderNo</span> <span class="kd">implements</span> <span class="nc">Serializable</span> <span class="o">{</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"order_number"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">number</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="438-ë³„ë„-í…Œì´ë¸”ì—-ì €ì¥í•˜ëŠ”-ë°¸ë¥˜-ë§¤í•‘">4.3.8 ë³„ë„ í…Œì´ë¸”ì— ì €ì¥í•˜ëŠ” ë°¸ë¥˜ ë§¤í•‘</h3>
<p>ë£¨íŠ¸ ì—”í‹°í‹° ì™¸ì— ë˜ ë‹¤ë¥¸ ì—”í‹°í‹°ê°€ ìˆë‹¤ë©´ ì§„ì§œ ì—”í‹°í‹°ì¸ì§€ ì˜ì‹¬í•´ ë´ì•¼í•œë‹¤. ë‹¨ì§€ ë³„ë„ í…Œì´ë¸”ì— ë°ì´í„°ë¥¼ ì €ì¥ í•œë‹¤ê³  í•´ì„œ ì—”í‹°í‹°ì¸ ê²ƒì€ ì•„ë‹ˆë‹¤.</p>

<p>ì˜ˆë¥¼ ë“¤ì–´ ê²Œì‹œê¸€ ë°ì´í„°ë¥¼ <code class="language-plaintext highlighter-rouge">ARTICLE</code> í…Œì´ë¸”ê³¼ <code class="language-plaintext highlighter-rouge">ARTICLE_CONTENT</code> í…Œì´ë¸”ë¡œ ë‚˜ëˆ ì„œ ì €ì¥í•œë‹¤ê³  í•˜ì.</p>

<p><strong>ì—”í‹°í‹°ë¡œ ë§¤í•‘ ì˜ˆ (ì˜ëª» ë¨)</strong></p>
<center><img src="/assets/images/posts/books/1/4_3_ë°¸ë¥˜ë§¤í•‘ì˜ëª».png" alt="ë°¸ë¥˜ë§¤í•‘ì˜ëª»" width="80%" height="80%" /></center>
<p><code class="language-plaintext highlighter-rouge">ARTICLE_CONTENT</code>ì— IDëŠ” ì‹ë³„ìì´ê¸´ í•˜ì§€ë§Œ ì´ëŠ” <code class="language-plaintext highlighter-rouge">ARTICLE</code> í…Œì´ë¸”ê³¼ ì—°ê²°ì„ ìœ„í•¨ì´ì§€ <code class="language-plaintext highlighter-rouge">ARTICLE_CONTENT</code>ë¥¼ ìœ„í•œ ë³„ë„ ì‹ë³„ìê°€ í•„ìš”í•´ì„œê°€ ì•„ë‹ˆë‹¤.</p>

<p><br /></p>

<p><strong>ë³„ë„ í…Œì´ë¸”ë¡œ ë§¤í•‘</strong></p>
<center><img src="/assets/images/posts/books/1/4_3_ë°¸ë¥˜ë§¤í•‘ë³„ë„í…Œì´ë¸”.png" alt="ë°¸ë¥˜ë§¤í•‘ë³„ë„í…Œì´ë¸”" width="80%" height="80%" /></center>
<p><code class="language-plaintext highlighter-rouge">ARTICLE_CONTENT</code>ì„ ë°¸ë¥˜ë¡œ ë§Œë“¤ê³  @Embeddableë¡œ ë§¤í•‘í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"article"</span><span class="o">)</span>
<span class="nd">@SecondaryTable</span><span class="o">(</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">"article_content"</span><span class="o">,</span>
        <span class="n">pkJoinColumns</span> <span class="o">=</span> <span class="nd">@PrimaryKeyJoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"id"</span><span class="o">)</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Article</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>

    <span class="nd">@AttributeOverrides</span><span class="o">({</span>
            <span class="nd">@AttributeOverride</span><span class="o">(</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="s">"content"</span><span class="o">,</span>
                    <span class="n">column</span> <span class="o">=</span> <span class="nd">@Column</span><span class="o">(</span><span class="n">table</span> <span class="o">=</span> <span class="s">"article_content"</span><span class="o">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"content"</span><span class="o">)),</span>
            <span class="nd">@AttributeOverride</span><span class="o">(</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="s">"contentType"</span><span class="o">,</span>
                    <span class="n">column</span> <span class="o">=</span> <span class="nd">@Column</span><span class="o">(</span><span class="n">table</span> <span class="o">=</span> <span class="s">"article_content"</span><span class="o">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"content_type"</span><span class="o">))</span>
    <span class="o">})</span>
    <span class="nd">@Embedded</span>
    <span class="kd">private</span> <span class="nc">ArticleContent</span> <span class="n">content</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ë°¸ë¥˜ ë§¤í•‘ì„ ë³„ë„ í…Œì´ë¸”ë¡œ ì €ì¥ í•˜ë ¤ë©´ <code class="language-plaintext highlighter-rouge">@SecondaryTable</code>ê³¼ <code class="language-plaintext highlighter-rouge">@AttributeOverride</code>ì„ ì‚¬ìš©í•œë‹¤.
í•˜ì§€ë§Œ <code class="language-plaintext highlighter-rouge">@SecondaryTable</code>ì€ <code class="language-plaintext highlighter-rouge">jpa.find("id");</code>(ì¡°íšŒ)ë¥¼ ì‹¤í–‰í•  ë•Œ ë‘ í…Œì´ë¸”ì„ ì¡°ì¸í•´ì„œ ê°€ì ¸ì˜¨ë‹¤. ê²Œì‹œê¸€ ëª©ë¡ ê°™ì€ í™”ë©´ì€ <code class="language-plaintext highlighter-rouge">ARTICLE</code>ì˜ ë°ì´í„°ë§Œ í•„ìš”í•˜ì§€ <code class="language-plaintext highlighter-rouge">ARTICLE_CONTENT</code>ëŠ” í•„ìš”ì—†ë‹¤.</p>

<p>ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ <code class="language-plaintext highlighter-rouge">ARTICLE_CONTENT</code>ì„ ì—”í‹°í‹°ë¡œ ë§¤í•‘í•˜ê³  <code class="language-plaintext highlighter-rouge">ARTICLE</code>ì—ì„œ <code class="language-plaintext highlighter-rouge">ARTICLE_CONTENT</code>ì„ ì§€ì—°ë¡œë”© í•  ìˆ˜ë„ ìˆë‹¤. í•˜ì§€ë§Œ ì´ëŠ” ë°¸ë¥˜ ëª¨ë¸ì„ ì—”í‹°í‹°ë¡œ ë§Œë“œëŠ” ê²ƒì´ë¯€ë¡œ ì¢‹ì€ ë°©ë²•ì€ ì•„ë‹ˆë‹¤. ëŒ€ì‹  ì¡°íšŒ ì „ìš© ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.</p>

<h3 id="439-ë°¸ë¥˜-ì»¬ë ‰ì…˜ì„-entityë¡œ-ë§¤í•‘í•˜ê¸°">4.3.9 ë°¸ë¥˜ ì»¬ë ‰ì…˜ì„ @Entityë¡œ ë§¤í•‘í•˜ê¸°</h3>
<p><code class="language-plaintext highlighter-rouge">@OneToMany</code> ì‚¬ìš©í•˜ì—¬ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"product"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Product</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">cascade</span> <span class="o">=</span> <span class="o">{</span><span class="nc">CascadeType</span><span class="o">.</span><span class="na">PERSIST</span><span class="o">,</span> <span class="nc">CascadeType</span><span class="o">.</span><span class="na">REMOVE</span><span class="o">},</span>
            <span class="n">orphanRemoval</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"product_id"</span><span class="o">)</span>
    <span class="nd">@OrderColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"list_idx"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Image</span><span class="o">&gt;</span> <span class="n">images</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
</code></pre></div></div>

<p><br /></p>

<p><code class="language-plaintext highlighter-rouge">@Inheritance</code>ë¥¼ ì´ìš©í•˜ì—¬ ì—”í‹°í‹° ìƒì†ë„ ê°€ëŠ¥í•˜ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Inheritance</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">InheritanceType</span><span class="o">.</span><span class="na">SINGLE_TABLE</span><span class="o">)</span>
<span class="nd">@DiscriminatorColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"image_type"</span><span class="o">)</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"image"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@DiscriminatorValue</span><span class="o">(</span><span class="s">"II"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">InternalImage</span> <span class="kd">extends</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
<span class="nd">@Entity</span>
<span class="nd">@DiscriminatorValue</span><span class="o">(</span><span class="s">"EI"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExternalImage</span> <span class="kd">extends</span> <span class="nc">Image</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
</code></pre></div></div>

<h3 id="4310-id-ì°¸ì¡°ì™€-ì¡°ì¸-í…Œì´ë¸”ì„-ì´ìš©í•œ-ë‹¨ë°©í–¥-m-n-ë§¤í•‘">4.3.10 ID ì°¸ì¡°ì™€ ì¡°ì¸ í…Œì´ë¸”ì„ ì´ìš©í•œ ë‹¨ë°©í–¥ M-N ë§¤í•‘</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"product"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Product</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="nd">@ElementCollection</span><span class="o">(</span><span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span>
    <span class="nd">@CollectionTable</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"product_category"</span><span class="o">,</span>
            <span class="n">joinColumns</span> <span class="o">=</span> <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"product_id"</span><span class="o">))</span>
    <span class="kd">private</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">CategoryId</span><span class="o">&gt;</span> <span class="n">categoryIds</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="44-ì• ê·¸ë¦¬ê±°íŠ¸-ë¡œë”©-ì „ëµ">4.4 ì• ê·¸ë¦¬ê±°íŠ¸ ë¡œë”© ì „ëµ</h2>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// @Embeddable ì»¬ë ‰ì…˜ì— ëŒ€í•œ ì¦‰ì‹œ ë¡œë”© ì„¤ì •</span>
<span class="nd">@ElementCollection</span><span class="o">(</span><span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">EAGER</span><span class="o">)</span>

<span class="c1">// @Entity ì»¬ë ‰ì…˜ì— ëŒ€í•œ ì§€ì—° ë¡œë”© ì„¤ì •</span>
<span class="nd">@OneToMany</span><span class="o">(</span><span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span>
</code></pre></div></div>
<ul>
  <li>ì¦‰ì‹œ ë¡œë”©: ì—ê·¸ë¦¬ê±°íŠ¸ ë£¨íŠ¸ë¥¼ êµ¬í•  ë•Œ ì—°ê´€ëœ êµ¬ì„± ìš”ì†Œë¥¼ DBì—ì„œ í•¨ê»˜ ì½ì–´ì˜¨ë‹¤.</li>
  <li>ì§€ì—° ë¡œë”©: ì‹¤ì œ ì»¬ë ‰ì…˜ì— ì ‘ê·¼í•  ë•Œ DBì—ì„œ ì¡°íšŒí•œë‹¤.</li>
</ul>

<h2 id="45-ì• ê·¸ë¦¬ê±°íŠ¸-ì˜ì†ì„±-ì „íŒŒ">4.5 ì• ê·¸ë¦¬ê±°íŠ¸ ì˜ì†ì„± ì „íŒŒ</h2>
<p>ì• ê·¸ë¦¬ê±°íŠ¸ê°€ ì™„ì „í•œ ìƒíƒœì—¬ì•¼ í•œë‹¤ëŠ” ê²ƒì€ <strong>ì• ê·¸ë¦¬ê±°íŠ¸ ë£¨íŠ¸ë¥¼ ì¡°íšŒí•  ë•Œë¿ë§Œ ì•„ë‹ˆë¼ ì €ì¥í•˜ê³  ì‚­ì œí•  ë•Œë„ í•˜ë‚˜ë¡œ ì²˜ë¦¬í•´ì•¼ í•¨ì„ ì˜ë¯¸</strong>í•œë‹¤.</p>
<ul>
  <li><strong>ì €ì¥ ë©”ì„œë“œ</strong>ëŠ” ì• ê·¸ë¦¬ê±°íŠ¸ ë£¨íŠ¸ë§Œ ì €ì¥í•˜ë©´ ì•ˆë˜ê³  <strong>ì• ê·¸ë¦¬ê±°íŠ¸ì— ì†í•œ ëª¨ë“  ê°ì²´ë¥¼ ì €ì¥</strong>í•´ì•¼ í•œë‹¤.</li>
  <li><strong>ì‚­ì œ ë©”ì„œë“œ</strong>ëŠ” ì• ê·¸ë¦¬ê±°íŠ¸ ë£¨íŠ¸ë¿Œë§Œ ì•„ë‹ˆë¼ <strong>ì• ê·¸ë¦¬ê±°íŠ¸ì— ì†í•œ ëª¨ë“  ê°ì²´ë¥¼ ì‚­ì œ</strong>í•´ì•¼ í•œë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">@Embeddable</code> ë§¤í•‘ íƒ€ì…ì€ í•¨ê»˜ ì €ì¥ë˜ê³  ì‚­ì œ ë˜ë¯€ë¡œ ì¶”ê°€ ì„¤ì •ì´ í•„ìš”ì—†ë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">@Entity</code> íƒ€ì…ì— ëŒ€í•œ ë§¤í•‘ì€ <code class="language-plaintext highlighter-rouge">cascade</code> ì†ì„±ì„ ì‚¬ìš©í•œë‹¤.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@OneToMany</span><span class="o">(</span><span class="n">cascade</span> <span class="o">=</span> <span class="o">{</span><span class="nc">CascadeType</span><span class="o">.</span><span class="na">PERSIST</span><span class="o">,</span> <span class="nc">CascadeType</span><span class="o">.</span><span class="na">REMOVE</span><span class="o">})</span>
</code></pre></div></div>

<h2 id="46-ì‹ë³„ì-ìƒì„±-ê¸°ëŠ¥">4.6 ì‹ë³„ì ìƒì„± ê¸°ëŠ¥</h2>
<p>ì‹ë³„ìëŠ” í¬ê²Œ ì„¸ ê°€ì§€ ë°©ì‹ ì¤‘ í•˜ë‚˜ë¡œ ìƒì„±í•œë‹¤.</p>
<ul>
  <li>ì‚¬ìš©ìê°€ ì§ì ‘ ìƒì„±</li>
  <li>ë„ë©”ì¸ ë¡œì§ìœ¼ë¡œ ìƒì„±</li>
  <li>DBë¥¼ ì´ìš©í•œ ì¼ë ¨ë²ˆí˜¸ ì‚¬ìš©</li>
</ul>

<h2 id="47-ë„ë©”ì¸-êµ¬í˜„ê³¼-dip">4.7 ë„ë©”ì¸ êµ¬í˜„ê³¼ DIP</h2>
<p>JPAì˜ @Entityë‚˜ @Table, extends Repository ì¸í„°í˜ì´ìŠ¤ëŠ” DIP ì›ì¹™ì„ ì–´ê¸°ê³  ìˆì§€ë§Œ ê°œë°œ í¸ì˜ì„±ê³¼ ì‹¤ìš©ì„±ì„ ê°€ì§€ê³ , ë³µì¡ë„ë¥¼ ë†’ì´ì§€ ì•Šìœ¼ë©´ì„œ ê¸°ìˆ ì— ë”°ë¥¸ êµ¬í˜„ ì œì•½ì´ ë‚®ë‹¤ë©´ í•©ë¦¬ì ìœ¼ë¡œ ì„ íƒí•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<p><br />
<br />
<br /></p>

<h1 id="5-ìŠ¤í”„ë§-ë°ì´í„°-jpaë¥¼-ì´ìš©í•œ-ì¡°íšŒ-ê¸°ëŠ¥">5. ìŠ¤í”„ë§ ë°ì´í„° JPAë¥¼ ì´ìš©í•œ ì¡°íšŒ ê¸°ëŠ¥</h1>

<h2 id="51-ì‹œì‘ì—-ì•ì„œ">5.1 ì‹œì‘ì— ì•ì„œ</h2>
<h2 id="52-ê²€ìƒ‰ì„-ìœ„í•œ-ìŠ¤í™">5.2 ê²€ìƒ‰ì„ ìœ„í•œ ìŠ¤í™</h2>
<p>ì¡°íšŒë¥¼ ìœ„í•´ ë‹¤ì–‘í•œ ê²€ìƒ‰ ì¡°ê±´ì„ ì¡°í•©í•´ì•¼ í•  ë•Œê°€ ìˆë‹¤. ì´ ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²ƒì´ ìŠ¤í™(<a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#specifications" target="_blank">Specification</a>)ì´ë‹¤.</p>

<h2 id="53-ìŠ¤í”„ë§-ë°ì´í„°-jpaë¥¼-ì´ìš©í•œ-ìŠ¤í™-êµ¬í˜„">5.3 ìŠ¤í”„ë§ ë°ì´í„° JPAë¥¼ ì´ìš©í•œ ìŠ¤í™ êµ¬í˜„</h2>

<p><strong>ìŠ¤í”„ë§ ë°ì´í„° JPAê°€ ì œê³µí•˜ëŠ” Specification ì¸í„°í˜ì´ìŠ¤</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Specification</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="nc">Predicate</span> <span class="nf">toPredicate</span><span class="o">(</span><span class="nc">Root</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">root</span><span class="o">,</span> <span class="nc">CriteriaQuery</span><span class="o">&lt;?&gt;</span> <span class="n">query</span><span class="o">,</span> <span class="nc">CriteriaBuilder</span> <span class="n">builder</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<p><strong>ë ˆí¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤ ìƒì†</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CustomerRepository</span> <span class="kd">extends</span> <span class="nc">CrudRepository</span><span class="o">&lt;</span><span class="nc">Customer</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;,</span> <span class="nc">JpaSpecificationExecutor</span><span class="o">&lt;</span><span class="nc">Customer</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Customer</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">(</span><span class="nc">Specification</span><span class="o">&lt;</span><span class="nc">Customer</span><span class="o">&gt;</span> <span class="n">spec</span><span class="o">);</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Customer</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">(</span><span class="nc">Specification</span><span class="o">&lt;</span><span class="nc">Customer</span><span class="o">&gt;</span> <span class="n">spec</span><span class="o">,</span> <span class="nc">Sort</span> <span class="n">sort</span><span class="o">);</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Customer</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">(</span><span class="nc">Specification</span><span class="o">&lt;</span><span class="nc">Customer</span><span class="o">&gt;</span> <span class="n">spec</span><span class="o">,</span> <span class="nc">Pageable</span> <span class="n">pageable</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<p><strong>ìŠ¤í™ ìƒì„± ê¸°ëŠ¥ì„ ë³„ë„ í´ë˜ìŠ¤ë¡œ êµ¬í˜„</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomerSpecs</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Specification</span><span class="o">&lt;</span><span class="nc">Customer</span><span class="o">&gt;</span> <span class="nf">isLongTermCustomer</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="o">(</span><span class="n">root</span><span class="o">,</span> <span class="n">query</span><span class="o">,</span> <span class="n">builder</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
      <span class="nc">LocalDate</span> <span class="n">date</span> <span class="o">=</span> <span class="nc">LocalDate</span><span class="o">.</span><span class="na">now</span><span class="o">().</span><span class="na">minusYears</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
      <span class="k">return</span> <span class="n">builder</span><span class="o">.</span><span class="na">lessThan</span><span class="o">(</span><span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Customer_</span><span class="o">.</span><span class="na">createdAt</span><span class="o">),</span> <span class="n">date</span><span class="o">);</span>
    <span class="o">};</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Specification</span><span class="o">&lt;</span><span class="nc">Customer</span><span class="o">&gt;</span> <span class="nf">hasSalesOfMoreThan</span><span class="o">(</span><span class="nc">MonetaryAmount</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="o">(</span><span class="n">root</span><span class="o">,</span> <span class="n">query</span><span class="o">,</span> <span class="n">builder</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
      <span class="c1">// build query here</span>
    <span class="o">};</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="54-ë¦¬í¬ì§€í„°ë¦¬daoì—ì„œ-ìŠ¤í™-ì‚¬ìš©í•˜ê¸°">5.4 ë¦¬í¬ì§€í„°ë¦¬/DAOì—ì„œ ìŠ¤í™ ì‚¬ìš©í•˜ê¸°</h2>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Customer</span><span class="o">&gt;</span> <span class="n">customers</span> <span class="o">=</span> <span class="n">customerRepository</span><span class="o">.</span><span class="na">findAll</span><span class="o">(</span><span class="n">isLongTermCustomer</span><span class="o">());</span>
</code></pre></div></div>

<h2 id="55-ìŠ¤í™-ì¡°í•©">5.5 ìŠ¤í™ ì¡°í•©</h2>
<p>ìŠ¤í™ ì¸í„°í˜ì´ìŠ¤ëŠ” <code class="language-plaintext highlighter-rouge">and</code>ì™€ <code class="language-plaintext highlighter-rouge">or</code> ë“± ì¡°í•© ë©”ì„œë“œë¥¼ ì œê³µí•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">MonetaryAmount</span> <span class="n">amount</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MonetaryAmount</span><span class="o">(</span><span class="mf">200.0</span><span class="o">,</span> <span class="nc">Currencies</span><span class="o">.</span><span class="na">DOLLAR</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Customer</span><span class="o">&gt;</span> <span class="n">customers</span> <span class="o">=</span> <span class="n">customerRepository</span><span class="o">.</span><span class="na">findAll</span><span class="o">(</span>
  <span class="n">isLongTermCustomer</span><span class="o">().</span><span class="na">or</span><span class="o">(</span><span class="n">hasSalesOfMoreThan</span><span class="o">(</span><span class="n">amount</span><span class="o">)));</span>
</code></pre></div></div>

<p><br /></p>

<p><code class="language-plaintext highlighter-rouge">null</code> ê°€ëŠ¥ì„±ì´ ìˆëŠ” ìŠ¤í™ ê°ì²´ì˜ ì¡°í•©ì€ <code class="language-plaintext highlighter-rouge">where</code>ë¥¼ ì‚¬ìš©í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Specification</span><span class="o">&lt;</span><span class="nc">Customer</span><span class="o">&gt;</span> <span class="n">spec</span> <span class="o">=</span> <span class="nc">Specification</span><span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">createNullableSpec</span><span class="o">()).</span><span class="na">and</span><span class="o">(</span><span class="n">createOtherSpec</span><span class="o">());</span>
</code></pre></div></div>

<h2 id="56-ì •ë ¬-ì§€ì •í•˜ê¸°">5.6 ì •ë ¬ ì§€ì •í•˜ê¸°</h2>
<p>ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” ë‘ ê°€ì§€ ë°©ë²•ì„ ì‚¬ìš©í•´ì„œ ì •ë ¬ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤.</p>
<ul>
  <li>ë©”ì„œë“œ ì´ë¦„ì— OrderByë¥¼ ì‚¬ìš©í•´ì„œ ì •ë ¬ ê¸°ì¤€ ì§€ì •</li>
  <li>Sortë¥¼ ì¸ìë¡œ ì „ë‹¬</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">OrderSummaryDao</span> <span class="kd">extends</span> <span class="nc">Repository</span><span class="o">&lt;</span><span class="nc">OrderSummary</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="c1">// OrderBy</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">OrderSummary</span><span class="o">&gt;</span> <span class="nf">findByOrdererIdOrderByNumberDesc</span><span class="o">(</span><span class="nc">String</span> <span class="n">ordererId</span><span class="o">);</span>

    <span class="c1">// Sort</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">OrderSummary</span><span class="o">&gt;</span> <span class="nf">findByOrdererId</span><span class="o">(</span><span class="nc">String</span> <span class="n">ordererId</span><span class="o">,</span> <span class="nc">Sort</span> <span class="n">sort</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Sort</span> <span class="n">sort</span> <span class="o">=</span> <span class="nc">Sort</span><span class="o">.</span><span class="na">by</span><span class="o">(</span><span class="nc">Sort</span><span class="o">.</span><span class="na">Direction</span><span class="o">.</span><span class="na">DESC</span><span class="o">,</span> <span class="s">"number"</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">OrderSummary</span><span class="o">&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">orderSummaryDao</span><span class="o">.</span><span class="na">findByOrdererId</span><span class="o">(</span><span class="s">"id"</span><span class="o">,</span> <span class="n">sort</span><span class="o">);</span>
</code></pre></div></div>

<h2 id="57-í˜ì´ì§•-ì²˜ë¦¬í•˜ê¸°">5.7 í˜ì´ì§• ì²˜ë¦¬í•˜ê¸°</h2>
<p>ìŠ¤í”„ë§ ë°ì´í„° JPAëŠ” í˜ì´ì§• ì²˜ë¦¬ë¥¼ ìœ„í•´ <code class="language-plaintext highlighter-rouge">Pageable</code> íƒ€ì…ì„ ì´ìš©í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberDataDao</span> <span class="kd">extends</span> <span class="nc">Repository</span><span class="o">&lt;</span><span class="nc">MemberData</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberData</span><span class="o">&gt;</span> <span class="nf">findByNameLike</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">Pageable</span> <span class="n">pageable</span><span class="o">);</span>
    <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">MemberData</span><span class="o">&gt;</span> <span class="nf">findByBlocked</span><span class="o">(</span><span class="kt">boolean</span> <span class="n">blocked</span><span class="o">,</span> <span class="nc">Pageable</span> <span class="n">pageable</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1ì€ í˜ì´ì§€ ë²ˆí˜¸, 0ë¶€í„° ì‹œì‘í•œë‹¤.  10ì€ ê°œìˆ˜</span>
<span class="c1">// Sort ì‚¬ìš© ê°€ëŠ¥</span>
<span class="nc">Sort</span> <span class="n">sort</span> <span class="o">=</span> <span class="nc">Sort</span><span class="o">.</span><span class="na">by</span><span class="o">(</span><span class="nc">Sort</span><span class="o">.</span><span class="na">Direction</span><span class="o">.</span><span class="na">DESC</span><span class="o">,</span> <span class="s">"name"</span><span class="o">);</span>
<span class="nc">PageRequest</span> <span class="n">pageReq</span> <span class="o">=</span> <span class="nc">PageRequest</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="n">sort</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberData</span><span class="o">&gt;</span> <span class="n">user</span> <span class="o">=</span> <span class="n">memberDataDao</span><span class="o">.</span><span class="na">findByNameLike</span><span class="o">(</span><span class="s">"ì´ë¦„%"</span><span class="o">,</span> <span class="n">pageReq</span><span class="o">);</span>
</code></pre></div></div>

<p><br /></p>

<p><strong>Page ë¦¬í„´ íƒ€ì…</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">PageRequest</span> <span class="n">pageReq</span> <span class="o">=</span> <span class="nc">PageRequest</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">5</span><span class="o">);</span>
<span class="nc">Page</span><span class="o">&lt;</span><span class="nc">MemberData</span><span class="o">&gt;</span> <span class="n">page</span> <span class="o">=</span> <span class="n">memberDataDao</span><span class="o">.</span><span class="na">findByBlocked</span><span class="o">(</span><span class="kc">false</span><span class="o">,</span> <span class="n">pageReq</span><span class="o">);</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberData</span><span class="o">&gt;</span> <span class="n">content</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="na">getContent</span><span class="o">();</span> <span class="c1">// ì¡°íšŒ ê²°ê³¼ ëª©ë¡</span>
<span class="kt">long</span> <span class="n">totalElements</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="na">getTotalElements</span><span class="o">();</span> <span class="c1">// ì¡°ê±´ì— í•´ë‹¹í•˜ëŠ” ì „ì²´ ê°œìˆ˜</span>
<span class="kt">int</span> <span class="n">totalPages</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="na">getTotalPages</span><span class="o">();</span> <span class="c1">// ì „ì²´ í˜ì´ì§€ ë²ˆí˜¸</span>
<span class="kt">int</span> <span class="n">number</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="na">getNumber</span><span class="o">();</span> <span class="c1">// í˜„ì¬ í˜ì´ì§€ ë²ˆí˜¸</span>
<span class="kt">int</span> <span class="n">numberOfElements</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="na">getNumberOfElements</span><span class="o">()</span> <span class="c1">// ì¡°íšŒ ê²°ê³¼ ê°œìˆ˜</span>
<span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="na">getSize</span><span class="o">();</span> <span class="c1">// í˜ì´ì§€ í¬ê¸°</span>
</code></pre></div></div>

<p>Page ë¦¬í„´ íƒ€ì…ì€ COUNT ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ë¯€ë¡œ Listë§Œ í•„ìš”í•œ ê²½ìš° ë¦¬í„´ íƒ€ì…ì„ Listë¡œ í•œë‹¤.</p>

<h2 id="58-ìŠ¤í™-ì¡°í•©ì„-ìœ„í•œ-ìŠ¤í™-ë¹Œë”-í´ë˜ìŠ¤">5.8 ìŠ¤í™ ì¡°í•©ì„ ìœ„í•œ ìŠ¤í™ ë¹Œë” í´ë˜ìŠ¤</h2>
<p>ìŠ¤í™ì„ ì¡°í•©í•  ë•Œ ìŠ¤í™ ë¹Œë”ë¥¼ ë§Œë“¤ì–´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Specification</span><span class="o">&lt;</span><span class="nc">MemberData</span><span class="o">&gt;</span> <span class="n">spec</span> <span class="o">=</span> <span class="nc">SpecBuilder</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="nc">MemberData</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
                <span class="o">.</span><span class="na">ifTrue</span><span class="o">(</span><span class="n">searchRequest</span><span class="o">.</span><span class="na">isOnlyNotBlocked</span><span class="o">(),</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="nc">MemberDataSpecs</span><span class="o">.</span><span class="na">nonBlocked</span><span class="o">())</span>
                <span class="o">.</span><span class="na">ifHasText</span><span class="o">(</span><span class="n">searchRequest</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span> <span class="n">name</span> <span class="o">-&gt;</span> <span class="nc">MemberDataSpecs</span><span class="o">.</span><span class="na">nameLike</span><span class="o">(</span><span class="n">searchRequest</span><span class="o">.</span><span class="na">getName</span><span class="o">()))</span>
                <span class="o">.</span><span class="na">toSpec</span><span class="o">();</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberData</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">memberDataDao</span><span class="o">.</span><span class="na">findAll</span><span class="o">(</span><span class="n">spec</span><span class="o">,</span> <span class="nc">PageRequest</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">5</span><span class="o">));</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SpecBuilder</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nc">Builder</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">builder</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">Builder</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Builder</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Specification</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;&gt;</span> <span class="n">specs</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

        <span class="kd">public</span> <span class="nc">Builder</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">and</span><span class="o">(</span><span class="nc">Specification</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">spec</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">specs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">spec</span><span class="o">);</span>
            <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="nc">Builder</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">ifHasText</span><span class="o">(</span><span class="nc">String</span> <span class="n">str</span><span class="o">,</span>
                                    <span class="nc">Function</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Specification</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;&gt;</span> <span class="n">specSupplier</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="nc">StringUtils</span><span class="o">.</span><span class="na">hasText</span><span class="o">(</span><span class="n">str</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">specs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">specSupplier</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">str</span><span class="o">));</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="nc">Builder</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">ifTrue</span><span class="o">(</span><span class="nc">Boolean</span> <span class="n">cond</span><span class="o">,</span>
                                 <span class="nc">Supplier</span><span class="o">&lt;</span><span class="nc">Specification</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;&gt;</span> <span class="n">specSupplier</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">cond</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">cond</span><span class="o">.</span><span class="na">booleanValue</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">specs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">specSupplier</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="nc">Specification</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">toSpec</span><span class="o">()</span> <span class="o">{</span>
            <span class="nc">Specification</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">spec</span> <span class="o">=</span> <span class="nc">Specification</span><span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">Specification</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">s</span> <span class="o">:</span> <span class="n">specs</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">spec</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="n">spec</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="59-ë™ì -ì¸ìŠ¤í„´ìŠ¤-ìƒì„±">5.9 ë™ì  ì¸ìŠ¤í„´ìŠ¤ ìƒì„±</h2>
<p>JPQLì˜ new í‚¤ì›Œë“œë¥¼ í†µí•´ ê°ì²´ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">OrderSummaryDao</span> <span class="kd">extends</span> <span class="nc">Repository</span><span class="o">&lt;</span><span class="nc">OrderSummary</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nd">@Query</span><span class="o">(</span><span class="s">"""    
            select new com.myshop.order.query.dto.OrderView(
                o.number, o.state, m.name, m.id, p.name
            )
            from Order o join o.orderLines ol, Member m, Product p
            where o.orderer.memberId.id = :ordererId
            and o.orderer.memberId.id = m.id
            and index(ol) = 0
            and ol.productId.id = p.id
            order by o.number.number desc
            """</span><span class="o">)</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">OrderView</span><span class="o">&gt;</span> <span class="nf">findOrderView</span><span class="o">(</span><span class="nc">String</span> <span class="n">ordererId</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="510-í•˜ì´ë²„ë„¤ì´íŠ¸-subselect-ì‚¬ìš©">5.10 í•˜ì´ë²„ë„¤ì´íŠ¸ @Subselect ì‚¬ìš©</h2>
<ul>
  <li><code class="language-plaintext highlighter-rouge">@Subselect</code>ëŠ” ì¿¼ë¦¬ ê²°ê³¼ë¥¼ <code class="language-plaintext highlighter-rouge">@Entity</code>ë¡œ ë§¤í•‘í•  ìˆ˜ ìˆë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">@Immutable</code>, <code class="language-plaintext highlighter-rouge">@Subselect</code>, <code class="language-plaintext highlighter-rouge">@Synchronize</code> ì™€ ê°™ì´ ì‚¬ìš©í•œë‹¤.</li>
  <li>ë·°ë¥¼ ìˆ˜ì •í•  ìˆ˜ ì—†ë“¯ <code class="language-plaintext highlighter-rouge">@Subselect</code>ë¡œ ì¡°íšŒí•œ <code class="language-plaintext highlighter-rouge">@Entity</code> ì—­ì‹œ ìˆ˜ì •í•  ìˆ˜ ì—†ë‹¤.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Immutable</span>
<span class="nd">@Subselect</span><span class="o">(</span>
        <span class="s">"""
        select o.order_number as number,
        o.version,
        o.orderer_id,
        o.orderer_name,
        o.total_amounts,
        o.receiver_name,
        o.state,
        o.order_date,
        p.product_id,
        p.name as product_name
        from purchase_order o inner join order_line ol
            on o.order_number = ol.order_number
            cross join product p
        where
        ol.line_idx = 0
        and ol.product_id = p.product_id"""</span>
<span class="o">)</span>
<span class="nd">@Synchronize</span><span class="o">({</span><span class="s">"purchase_order"</span><span class="o">,</span> <span class="s">"order_line"</span><span class="o">,</span> <span class="s">"product"</span><span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderSummary</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">number</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">version</span><span class="o">;</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"orderer_id"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">ordererId</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="kd">protected</span> <span class="nf">OrderSummary</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br />
<br />
<br /></p>

<h1 id="6-ì‘ìš©-ì„œë¹„ìŠ¤ì™€-í‘œí˜„-ì˜ì—­">6. ì‘ìš© ì„œë¹„ìŠ¤ì™€ í‘œí˜„ ì˜ì—­</h1>

<h2 id="61-í‘œí˜„-ì˜ì—­ê³¼-ì‘ìš©-ì˜ì—­">6.1 í‘œí˜„ ì˜ì—­ê³¼ ì‘ìš© ì˜ì—­</h2>
<center><img src="/assets/images/posts/books/1/6_1_í‘œí˜„ì˜ì—­ê³¼ì‘ìš©ì˜ì—­.png" alt="í‘œí˜„ì˜ì—­ê³¼ì‘ìš©ì˜ì—­.png" width="80%" height="80%" /></center>

<p><strong>í‘œí˜„ ì˜ì—­</strong></p>
<ul>
  <li>í‘œí˜„ ì˜ì—­ì€ ì‚¬ìš©ìì˜ ìš”ì²­ì„ í•´ì„í•œë‹¤.</li>
  <li>ì‚¬ìš©ìê°€ ì‹¤í–‰í•˜ê³  ì‹¶ì€ ê¸°ëŠ¥ì„ íŒë³„í•˜ê³  ê·¸ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ì‘ìš© ì„œë¹„ìŠ¤ë¥¼ ì‹¤í–‰í•œë‹¤.</li>
  <li>ì‘ìš© ì„œë¹„ìŠ¤ê°€ ìš”êµ¬í•˜ëŠ” í˜•ì‹ìœ¼ë¡œ ì‚¬ìš©ì ìš”ì²­ì„ ë³€í™˜í•œë‹¤.</li>
  <li>ì‘ìš© ì„œë¹„ìŠ¤ì˜ ì‹¤í–‰ ê²°ê³¼ë¥¼ ì‚¬ìš©ìì—ê²Œ ì•Œë§ì€ í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•œë‹¤.</li>
</ul>

<p><strong>ì‘ìš© ì˜ì—­</strong></p>
<ul>
  <li>ì‹¤ì œ ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.</li>
  <li>ì‘ìš© ì„œë¹„ìŠ¤ëŠ” í‘œí˜„ ì˜ì—­ì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
</ul>

<h2 id="62-ì‘ìš©-ì„œë¹„ìŠ¤ì˜-ì—­í• ">6.2 ì‘ìš© ì„œë¹„ìŠ¤ì˜ ì—­í• </h2>
<ul>
  <li>ì‚¬ìš©ì(í‘œí˜„ ì˜ì—­)ê°€ ìš”ì²­í•œ ê¸°ëŠ¥ì„ ì‹¤í–‰í•œë‹¤.</li>
  <li>ë„ë©”ì¸ ê°ì²´ë¥¼ ì‚¬ìš©í•´ì„œ ìš”ì²­ì„ ì²˜ë¦¬í•œë‹¤.</li>
  <li>ë„ë©”ì¸ ê°ì²´ ê°„ì˜ íë¦„ì„ ì œì–´í•œë‹¤.</li>
  <li>íŠ¸ëœì­ì…˜ ì²˜ë¦¬ë¥¼ ë‹´ë‹¹í•œë‹¤.</li>
  <li>ì ‘ê·¼ ì œì–´ì™€ ì´ë²¤íŠ¸ ì²˜ë¦¬ë¥¼ í•œë‹¤.</li>
</ul>

<h3 id="621-ë„ë©”ì¸-ë¡œì§-ë„£ì§€-ì•Šê¸°">6.2.1 ë„ë©”ì¸ ë¡œì§ ë„£ì§€ ì•Šê¸°</h3>
<p>ë„ë©”ì¸ ë¡œì§ì€ ë„ë©”ì¸ ì˜ì—­ì— ìœ„ì¹˜í•˜ê³ , ì‘ìš© ì„œë¹„ìŠ¤ëŠ” ë„ë©”ì¸ ë¡œì§ì„ êµ¬í˜„í•˜ì§€ ì•ŠëŠ”ë‹¤.</p>

<p><strong>ì´ìœ </strong></p>
<ul>
  <li>ì½”ë“œì˜ ì‘ì§‘ì„±ì´ ë–¨ì–´ì§„ë‹¤.</li>
  <li>ì—¬ëŸ¬ ì‘ìš© ì„œë¹„ìŠ¤ì—ì„œ ë™ì¼í•œ ë„ë©”ì¸ ë¡œì§ì„ êµ¬í˜„í•  ê°€ëŠ¥ì„±ì´ ë†’ì•„ì§„ë‹¤.</li>
  <li>ê²°ê³¼ì ìœ¼ë¡œ ì½”ë“œ ë³€ê²½ì„ ì–´ë µê²Œ ë§Œë“ ë‹¤.</li>
</ul>

<h2 id="63-ì‘ìš©-ì„œë¹„ìŠ¤ì˜-êµ¬í˜„">6.3 ì‘ìš© ì„œë¹„ìŠ¤ì˜ êµ¬í˜„</h2>
<p>ì‘ìš© ì„œë¹„ìŠ¤ëŠ” í‘œí˜„ ì˜ì—­ê³¼ ë„ë©”ì¸ ì˜ì—­ì„ ì—°ê²°í•˜ëŠ” ë§¤ê°œì²´ ì—­í• ì„ í•œë‹¤.(íŒŒì‚¬ë“œ facade)</p>

<h3 id="631-ì‘ìš©-ì„œë¹„ìŠ¤ì˜-í¬ê¸°">6.3.1 ì‘ìš© ì„œë¹„ìŠ¤ì˜ í¬ê¸°</h3>
<p>ì‘ìš© ì„œë¹„ìŠ¤ì˜ êµ¬í˜„ ë°©ë²•ì€ í¬ê²Œ ë‘ ê°€ì§€ê°€ ìˆë‹¤.</p>
<ul>
  <li>í•œ ì‘ìš© ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ì— íšŒì› ë„ë©”ì¸ ëª¨ë“  ê¸°ëŠ¥ êµ¬í˜„í•˜ê¸°</li>
  <li><strong>êµ¬ë¶„ë˜ëŠ” ê¸°ëŠ¥ë³„ë¡œ ì‘ìš© ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ë¥¼ ë”°ë¡œ êµ¬í˜„í•˜ê¸°</strong>(ì¶”ì²œ) ğŸ‘</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ê° ì‘ìš© ì„œë¹„ìŠ¤ì—ì„œ ê³µí†µë˜ëŠ” ë¡œì§ì„ ë³„ë„ í´ë˜ìŠ¤ë¡œ êµ¬í˜„</span>
<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">MemberServiceHelper</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Member</span> <span class="nf">findExistingMember</span><span class="o">(</span><span class="nc">MemberRepository</span> <span class="n">repo</span><span class="o">,</span> <span class="nc">String</span> <span class="n">memberId</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">memberId</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">member</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">NoMemberException</span><span class="o">(</span><span class="n">memberId</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">member</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ê³µí†µ ë¡œì§ì„ ì œê³µí•˜ëŠ” ë©”ì„œë“œë¥¼ ì‘ìš© ì„œë¹„ìŠ¤ì—ì„œ ì‚¬ìš©</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">com</span><span class="o">.</span><span class="na">myshop</span><span class="o">.</span><span class="na">member</span><span class="o">.</span><span class="na">application</span><span class="o">.</span><span class="na">MemberServiceHelper</span><span class="o">.*;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ChangePasswordService</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">MemberRepository</span> <span class="n">memberRepository</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">changePassword</span><span class="o">(</span><span class="nc">String</span> <span class="n">memberId</span><span class="o">,</span> <span class="nc">String</span> <span class="n">curPw</span><span class="o">,</span> <span class="nc">String</span> <span class="n">newPw</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">findExistingMember</span><span class="o">(</span><span class="n">memberRepository</span><span class="o">,</span> <span class="n">memberId</span><span class="o">);</span>
        <span class="n">member</span><span class="o">.</span><span class="na">changePassword</span><span class="o">(</span><span class="n">curPw</span><span class="o">,</span> <span class="n">newPw</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="632-ì‘ìš©-ì„œë¹„ìŠ¤ì˜-ì¸í„°í˜ì´ìŠ¤ì™€-í´ë˜ìŠ¤">6.3.2 ì‘ìš© ì„œë¹„ìŠ¤ì˜ ì¸í„°í˜ì´ìŠ¤ì™€ í´ë˜ìŠ¤</h3>
<p>ì¸í„°í˜ì´ìŠ¤ê°€ ëª…í™•í•˜ê²Œ í•„ìš”í•˜ì§€ ì•Šë‹¤ë©´ ì‘ìš© ì„œë¹„ìŠ¤ì˜ ì¸í„°í˜ì´ìŠ¤ ì‘ì„±ì€ ì¢‹ì€ ì„ íƒì´ ì•„ë‹ˆë‹¤. ì†ŒìŠ¤ íŒŒì¼ë§Œ ë§ì•„ì§€ê³  ê°„ì ‘ ì°¸ì¡°ê°€ ì¦ê°€í•´ì„œ ì „ì²´ êµ¬ì¡°ê°€ ë³µì¡í•´ì§„ë‹¤.</p>

<p><strong>ì¸í„°í˜ì´ìŠ¤ê°€ í•„ìš”í•œ ìƒí™©</strong></p>
<ul>
  <li>êµ¬í˜„ í´ë˜ìŠ¤ê°€ ì—¬ëŸ¬ê°œì¸ ê²½ìš°</li>
</ul>

<h3 id="633-ë©”ì„œë“œ-íŒŒë¼ë¯¸í„°ì™€-ê°’-ë¦¬í„´">6.3.3 ë©”ì„œë“œ íŒŒë¼ë¯¸í„°ì™€ ê°’ ë¦¬í„´</h3>
<ul>
  <li>ë„ë©”ì¸ì„ ì´ìš©í•´ ê¸°ëŠ¥ì„ ì‹¤í–‰í•˜ëŠ” ë° í•„ìš”í•œ ê°’ì„ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë°›ì•„ì•¼ í•œë‹¤.</li>
  <li>ê° ê°’ì„ ê°œë³„ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë°›ì„ ìˆ˜ë„ ìˆê³  <strong>DTOë¥¼ ë§Œë“¤ì–´ ì „ë‹¬</strong>ë°›ì„ ìˆ˜ë„ ìˆë‹¤.</li>
  <li>ì‘ìš© ì„œë¹„ìŠ¤ì˜ ê²°ê³¼ë¥¼ í‘œí˜„ ì˜ì—­ì—ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤ë©´, ì‘ìš© ì„œë¹„ìŠ¤ì˜ ê²°ê³¼ë¡œ í•„ìš”í•œ ë°ì´í„°ë¥¼ ë¦¬í„´í•œë‹¤.</li>
  <li><strong>ì• ê·¸ë¦¬ê±°íŠ¸ ìì²´ë¥¼ ë¦¬í„´í•˜ëŠ” ê²ƒì€ ì‘ì§‘ë„ë¥¼ ë‚®ì¶”ì–´ ë¹„ì¶”ì²œ</strong>í•œë‹¤.</li>
</ul>

<h3 id="634-í‘œí˜„-ì˜ì—­ì—-ì˜ì¡´í•˜ì§€-ì•Šê¸°">6.3.4 í‘œí˜„ ì˜ì—­ì— ì˜ì¡´í•˜ì§€ ì•Šê¸°</h3>
<p>í‘œí˜„ ì˜ì—­ì— í•´ë‹¹í•˜ëŠ” HttpServletRequest, HttpSession ë“±ì„ ì‘ìš© ì„œë¹„ìŠ¤ì—ì— íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬í•˜ë©´ ì•ˆ ëœë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="nc">ChangePasswordService</span> <span class="n">changePasswordService</span><span class="o">;</span>

<span class="nd">@PostMapping</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">sumbit</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// ì‘ìš© ì„œë¹„ìŠ¤ê°€ í‘œí˜„ ì˜ì—­ì„ ì˜ì¡´í•˜ë©´ ì•ˆëœë‹¤.</span>
    <span class="n">changePasswordService</span><span class="o">.</span><span class="na">changePassword</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="635-íŠ¸ëœì­ì…˜-ì²˜ë¦¬">6.3.5 íŠ¸ëœì­ì…˜ ì²˜ë¦¬</h3>
<p>ìŠ¤í”„ë§ê³¼ ê°™ì€ í”„ë ˆì„ì›Œí¬ê°€ ì œê³µí•˜ëŠ” íŠ¸ëœì­ì…˜ ê´€ë¦¬ ê¸°ëŠ¥ì„ ì´ìš©í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Transactional</span>
</code></pre></div></div>

<h2 id="64-í‘œí˜„-ì˜ì—­">6.4 í‘œí˜„ ì˜ì—­</h2>
<ul>
  <li>ì‚¬ìš©ìê°€ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” íë¦„(í™”ë©´)ì„ ì œê³µí•˜ê³  ì œì–´í•œë‹¤.</li>
  <li>ì‚¬ìš©ìì˜ ìš”ì²­ì„ ì•Œë§ì€ ì‘ìš© ì„œë¹„ìŠ¤ì— ì „ë‹¬í•˜ê³  ê²°ê³¼ë¥¼ ì‚¬ìš©ìì—ê²Œ ì œê³µí•œë‹¤.</li>
  <li>ì‚¬ìš©ìì˜ ì„¸ì…˜ì„ ê´€ë¦¬í•œë‹¤.</li>
</ul>
<center><img src="/assets/images/posts/books/1/6_2_í‘œí˜„ì˜ì—­ì‚¬ìš©ìíë¦„.png" alt="í‘œí˜„ì˜ì—­ì‚¬ìš©ìíë¦„" width="60%" height="60%" /></center>

<h2 id="65-ê°’-ê²€ì¦">6.5 ê°’ ê²€ì¦</h2>
<p>ê°’ ê²€ì¦ì€ í‘œí˜„ ì˜ì—­ê³¼ ì‘ìš© ì„œë¹„ìŠ¤ ë‘ ê³³ì—ì„œ ëª¨ë‘ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. <strong>ì›ì¹™ì ìœ¼ë¡œëŠ” ì‘ìš© ì„œë¹„ìŠ¤ì—ì„œ ì²˜ë¦¬</strong>í•œë‹¤.</p>

<p>ì‘ìš© ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” í‘œí˜„ ì˜ì—­ì˜ ì½”ë“œê°€ í•œ ê³³ì´ë©´ êµ¬í˜„ì˜ í¸ë¦¬í•¨ì„ ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì´ ì—­í• ì„ ë‚˜ëˆ„ì–´ ê²€ì¦ì„ ìˆ˜í–‰í•  ìˆ˜ë„ ìˆë‹¤.</p>
<ul>
  <li>í‘œí˜„ ì˜ì—­: í•„ìˆ˜ ê°’, ê°’ì˜ í˜•ì‹, ë²”ìœ„ ë“±ì„ ê²€ì¦í•œë‹¤.</li>
  <li>ì‘ìš© ì„œë¹„ìŠ¤: ë°ì´í„°ì˜ ì¡´ì¬ ìœ ë¬´ì™€ ê°™ì€ ë…¼ë¦¬ì  ì˜¤ë¥˜ë¥¼ ê²€ì¦í•œë‹¤.</li>
</ul>

<h2 id="66-ê¶Œí•œ-ê²€ì‚¬">6.6 ê¶Œí•œ ê²€ì‚¬</h2>
<p>ë‹¤ìŒ ì„¸ ê³³ì—ì„œ ê¶Œí•œ ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.</p>
<ul>
  <li>í‘œí˜„ ì˜ì—­
    <ul>
      <li>ì„œë¸”ë¦¿ í•„í„°</li>
    </ul>
  </li>
  <li>ì‘ìš© ì„œë¹„ìŠ¤
    <ul>
      <li>AOP</li>
    </ul>
  </li>
  <li>ë„ë©”ì¸
    <ul>
      <li>ì§ì ‘ ë¡œì§ êµ¬í˜„</li>
    </ul>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ìŠ¤í”„ë§ ì‹œíë¦¬í‹° í™œìš©</span>
<span class="nd">@PreAuthorize</span><span class="o">(</span><span class="s">"hasRole('ADMIN')"</span><span class="o">)</span>
</code></pre></div></div>

<h2 id="67-ì¡°íšŒ-ì „ìš©-ê¸°ëŠ¥ê³¼-ì‘ìš©-ì„œë¹„ìŠ¤">6.7 ì¡°íšŒ ì „ìš© ê¸°ëŠ¥ê³¼ ì‘ìš© ì„œë¹„ìŠ¤</h2>
<p>ì‘ìš© ì„œë¹„ìŠ¤ê°€ ì‚¬ìš©ì ìš”ì²­ ê¸°ëŠ¥ì„ ì‹¤í–‰í•˜ëŠ” ë° ë³„ë‹¤ë¥¸ ê¸°ì—¬ë¥¼ í•˜ì§€ ëª»í•œë‹¤ë©´ êµ³ì´ ì„œë¹„ìŠ¤ë¥¼ ë§Œë“¤ì§€ ì•Šì•„ë„ ëœë‹¤.</p>

<p><img src="/assets/images/posts/books/1/6_4_ì‘ìš©ì„œë¹„ìŠ¤ìƒëµ.png" alt="ì‘ìš©ì„œë¹„ìŠ¤ìƒëµ" width="80%" height="80%" /></p>

<p><br />
<br />
<br /></p>

<h1 id="7-ë„ë©”ì¸-ì„œë¹„ìŠ¤">7. ë„ë©”ì¸ ì„œë¹„ìŠ¤</h1>
<h2 id="71-ì—¬ëŸ¬-ì• ê·¸ë¦¬ê±°íŠ¸ê°€-í•„ìš”í•œ-ê¸°ëŠ¥">7.1 ì—¬ëŸ¬ ì• ê·¸ë¦¬ê±°íŠ¸ê°€ í•„ìš”í•œ ê¸°ëŠ¥</h2>
<p>í•œ ì• ê·¸ë¦¬ê±°íŠ¸ì— ë„£ê¸° ì• ë§¤í•œ, ì—¬ëŸ¬ ì• ê·¸ë¦¬ê±°íŠ¸ê°€ í•„ìš”í•œ ê¸°ëŠ¥ì´ë¼ë©´ ë³„ë„ ë„ë©”ì¸ ì„œë¹„ìŠ¤ë¡œ êµ¬í˜„í•œë‹¤.</p>

<h2 id="72-ë„ë©”ì¸-ì„œë¹„ìŠ¤">7.2 ë„ë©”ì¸ ì„œë¹„ìŠ¤</h2>
<p>ë„ë©”ì¸ ì„œë¹„ìŠ¤ëŠ” ë„ë©”ì¸ ì˜ì—­ì— ìœ„ì¹˜í•œ ë„ë©”ì¸ ë¡œì§ì„ í‘œí˜„í•  ë•Œ ì‚¬ìš©í•œë‹¤. ì£¼ë¡œ ë‹¤ìŒ ìƒí™©ì—ì„œ ë„ë©”ì¸ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•œë‹¤.</p>
<ul>
  <li>ê³„ì‚° ë¡œì§: ì—¬ëŸ¬ ì• ê·¸ë¦¬ê±°íŠ¸ê°€ í•„ìš”í•œ ê³„ì‚°ë¡œì§ì´ë‚˜, í•œ ì• ê·¸ë¦¬ê±°íŠ¸ì— ë„£ê¸°ì—ëŠ” ë‹¤ì†Œ ë³µì¡í•œ ê³„ì‚° ë¡œì§</li>
  <li>ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™ì´ í•„ìš”í•œ ë„ë©”ì¸ ë¡œì§: êµ¬í˜„í•˜ê¸° ìœ„í•´ íƒ€ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ë„ë©”ì¸ ë¡œì§</li>
</ul>

<h3 id="721-ê³„ì‚°-ë¡œì§ê³¼-ë„ë©”ì¸-ì„œë¹„ìŠ¤">7.2.1 ê³„ì‚° ë¡œì§ê³¼ ë„ë©”ì¸ ì„œë¹„ìŠ¤</h3>

<p><strong>ë„ë©”ì¸ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ì£¼ì²´</strong></p>
<ul>
  <li>ì• ê·¸ë¦¬ê±°íŠ¸</li>
  <li>ì‘ìš© ì„œë¹„ìŠ¤</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì• ê·¸ë¦¬ê±°íŠ¸ê°€ ì‚¬ìš©</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderService</span> <span class="o">{</span>
    <span class="c1">// ë„ë©”ì¸ ì„œë¹„ìŠ¤</span>
    <span class="kd">private</span> <span class="nc">DiscountCalculationService</span> <span class="n">discountCalculationService</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">Order</span> <span class="nf">createOrder</span><span class="o">(</span><span class="nc">OrderNo</span> <span class="n">orderNo</span><span class="o">,</span> <span class="nc">OrderRequest</span> <span class="n">orderReq</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">findMember</span><span class="o">(</span><span class="n">orderReq</span><span class="o">.</span><span class="na">getOrdererId</span><span class="o">());</span>
        <span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Order</span><span class="o">(</span><span class="n">orderNo</span><span class="o">,</span> <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">);</span>
        <span class="c1">// ì• ê·¸ë¦¬ê±°íŠ¸ ê°ì²´ì— ë„ë©”ì¸ ì„œë¹„ìŠ¤ ì „ë‹¬</span>
        <span class="n">order</span><span class="o">.</span><span class="na">calculateAmounts</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">discountCalculationService</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">getGrade</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì‘ìš© ì„œë¹„ìŠ¤ê°€ ì‚¬ìš©</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TransferService</span> <span class="o">{</span> <span class="c1">// ë„ë©”ì¸ ì„œë¹„ìŠ¤</span>

    <span class="c1">// ë„ë©”ì¸ ì„œë¹„ìŠ¤ì˜ ê¸°ëŠ¥ì„ ì‹¤í–‰í•  ë•Œ ì• ê·¸ë¦¬ê±°íŠ¸ë¥¼ ì „ë‹¬</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">transfer</span><span class="o">(</span><span class="nc">Account</span> <span class="n">fromAcc</span><span class="o">,</span> <span class="nc">Account</span> <span class="n">toAcc</span><span class="o">,</span> <span class="nc">Money</span> <span class="n">amounts</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">fromAcc</span><span class="o">.</span><span class="na">withdraw</span><span class="o">(</span><span class="n">amounts</span><span class="o">);</span>
        <span class="n">toAcc</span><span class="o">.</span><span class="na">credit</span><span class="o">(</span><span class="n">amounts</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<p><strong>íŠ¹ì • ê¸°ëŠ¥ì´ ì‘ìš© ì„œë¹„ìŠ¤ì¸ì§€ ë„ë©”ì¸ ì„œë¹„ìŠ¤ì¸ì§€ í™•ì¸í•˜ëŠ” ë°©ë²•</strong></p>

<p>ì•„ë˜ì˜ í–‰ìœ„ê°€ ì¼ì–´ë‚˜ë©´ ë„ë©”ì¸ ì„œë¹„ìŠ¤</p>
<ul>
  <li>ì• ê·¸ë¦¬ê±°íŠ¸ì˜ ìƒíƒœë¥¼ ë³€ê²½</li>
  <li>ì• ê·¸ë¦¬ê±°íŠ¸ì˜ ìƒíƒœ ê°’ì„ ê³„ì‚°</li>
</ul>

<h3 id="722-ì™¸ë¶€-ì‹œìŠ¤í…œ-ì—°ë™ê³¼-ë„ë©”ì¸-ì„œë¹„ìŠ¤">7.2.2 ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™ê³¼ ë„ë©”ì¸ ì„œë¹„ìŠ¤</h3>
<p>ì‹œìŠ¤í…œ ê°„ ì—°ë™ì€ HTTP API í˜¸ì¶œë¡œ ì´ë£¨ì–´ì§ˆ ìˆ˜ ìˆì§€ë§Œ, ë„ë©”ì¸ ì…ì¥ì—ì„œëŠ” ë„ë©”ì¸ ë¡œì§ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆë‹¤. <strong>ë„ë©”ì¸ ê´€ì ì—ì„œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‘ì„±</strong>í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ë„ë©”ì¸ ì„œë¹„ìŠ¤</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">SurveyPermissionChecker</span> <span class="o">{</span>
    <span class="kt">boolean</span> <span class="nf">hasUserCreationPermission</span><span class="o">(</span><span class="nc">String</span> <span class="n">userId</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//ì‘ìš© ì„œë¹„ìŠ¤ëŠ” ë„ë©”ì¸ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CreateSurveyService</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">SurveyPermissionChecker</span> <span class="n">surveyPermissionChecker</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nc">Long</span> <span class="nf">createSurvey</span><span class="o">(</span><span class="nc">CreateSurveyRequest</span> <span class="n">req</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">validate</span><span class="o">(</span><span class="n">req</span><span class="o">);</span>

        <span class="c1">// ë„ë©”ì¸ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•´ì„œ ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™ì„ í‘œí˜„</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">surveyPermissionChecker</span><span class="o">.</span><span class="na">hasUserCreationPermission</span><span class="o">(</span><span class="n">req</span><span class="o">.</span><span class="na">getRequestorId</span><span class="o">()))</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">NoPermissionException</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">SurveyPermissionChecker</code> ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ëŠ” ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ì˜ì—­ì— ìœ„ì¹˜í•œë‹¤.</p>

<h3 id="723-ë„ë©”ì¸-ì„œë¹„ìŠ¤ì˜-íŒ¨í‚¤ì§€-ìœ„ì¹˜">7.2.3 ë„ë©”ì¸ ì„œë¹„ìŠ¤ì˜ íŒ¨í‚¤ì§€ ìœ„ì¹˜</h3>
<center><img src="/assets/images/posts/books/1/7_2_ë„ë©”ì¸ì„œë¹„ìŠ¤ìœ„ì¹˜.png" alt="ë„ë©”ì¸ì„œë¹„ìŠ¤ìœ„ì¹˜" width="80%" height="80%" /></center>

<p><br /></p>

<p>ë„ë©”ì¸ ì„œë¹„ìŠ¤ì˜ ê°œìˆ˜ê°€ ë§ê±°ë‚˜ ëª…ì‹œì ìœ¼ë¡œ êµ¬ë¶„í•˜ê³  ì‹¶ë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ í•˜ìœ„ íŒ¨í‚¤ì§€ë¡œ êµ¬ë¶„í•œë‹¤.</p>
<ul>
  <li>domain
    <ul>
      <li>domain.model</li>
      <li>domain.service</li>
      <li>domain.repository</li>
    </ul>
  </li>
</ul>

<h3 id="724-ë„ë©”ì¸-ì„œë¹„ìŠ¤ì˜-ì¸í„°í˜ì´ìŠ¤ì™€-í´ë˜ìŠ¤">7.2.4 ë„ë©”ì¸ ì„œë¹„ìŠ¤ì˜ ì¸í„°í˜ì´ìŠ¤ì™€ í´ë˜ìŠ¤</h3>
<p>ë„ë©”ì¸ ì„œë¹„ìŠ¤ì˜ ë¡œì§ì´ ê³ ì •ë˜ì–´ ìˆì§€ ì•Šì€ ê²½ìš° <strong>ë„ë©”ì¸ ì„œë¹„ìŠ¤ ìì²´ë¥¼ ì¸í„°í˜ì´ìŠ¤ë¡œ êµ¬í˜„</strong>í•˜ê³  ì´ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ë¥¼ ë‘˜ ìˆ˜ë„ ìˆë‹¤.</p>

<center><img src="/assets/images/posts/books/1/7_2_ë„ë©”ì¸ì„œë¹„ìŠ¤ì¸í„°í˜ì´ìŠ¤.png" alt="ë„ë©”ì¸ì„œë¹„ìŠ¤ì¸í„°í˜ì´ìŠ¤" width="80%" height="80%" /></center>

<p><br />
<br />
<br /></p>

<h1 id="8-ì• ê·¸ë¦¬ê±°íŠ¸-íŠ¸ëœì­ì…˜-ê´€ë¦¬">8. ì• ê·¸ë¦¬ê±°íŠ¸ íŠ¸ëœì­ì…˜ ê´€ë¦¬</h1>

<h2 id="81-ì• ê·¸ë¦¬ê±°íŠ¸ì™€-íŠ¸ëœì­ì…˜">8.1 ì• ê·¸ë¦¬ê±°íŠ¸ì™€ íŠ¸ëœì­ì…˜</h2>
<center><img src="/assets/images/posts/books/1/8_1_íŠ¸ëœì­ì…˜.png" alt="íŠ¸ëœì­ì…˜" width="60%" height="60%" /></center>

<p>íŠ¸ëœì­ì…˜ ì²˜ë¦¬ ë°©ì‹</p>
<ul>
  <li>ì„ ì  ì ê¸ˆ (Pessimistic Lock, ë¹„ê´€ì  ì ê¸ˆ)</li>
  <li>ë¹„ì„ ì  ì ê¸ˆ (Optimistic Lock, ë‚™ê´€ì  ì ê¸ˆ)</li>
</ul>

<h2 id="82-ì„ ì -ì ê¸ˆ">8.2 ì„ ì  ì ê¸ˆ</h2>
<center><img src="/assets/images/posts/books/1/8_2_ì„ ì ì ê¸ˆ.png" alt="ì„ ì ì ê¸ˆ" width="60%" height="60%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// JPA</span>
<span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">orderNo</span><span class="o">,</span> <span class="nc">LockModeType</span><span class="o">.</span><span class="na">PESSIMISTIC_WRITE</span><span class="o">);</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ìŠ¤í”„ë§ ë°ì´í„° JPA</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberREpository</span> <span class="kd">extends</span> <span class="nc">Repository</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">,</span> <span class="nc">MemberId</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Lock</span><span class="o">(</span><span class="nc">LockModeType</span><span class="o">.</span><span class="na">PESSIMISTIC_WRITE</span><span class="o">)</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findById</span><span class="o">(</span><span class="nc">MemberId</span> <span class="n">memberId</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="821-ì„ ì -ì ê¸ˆê³¼-êµì°©-ìƒíƒœ">8.2.1 ì„ ì  ì ê¸ˆê³¼ êµì°© ìƒíƒœ</h3>
<p>ë‹¤ìŒ ìƒí™©ì€ êµì°© ìƒíƒœì— ë¹ ì§„ë‹¤.</p>
<ol>
  <li>ìŠ¤ë ˆë“œ 1: ğŸ³ ì• ê·¸ë¦¬ê±°íŠ¸ì— ëŒ€í•œ ì„ ì  ì ê¸ˆ êµ¬í•¨</li>
  <li>ìŠ¤ë ˆë“œ 2: ğŸ¦ ì• ê·¸ë¦¬ê±°íŠ¸ì— ëŒ€í•œ ì„ ì  ì ê¸ˆ êµ¬í•¨</li>
  <li>ìŠ¤ë ˆë“œ 1: ğŸ¦ ì• ê·¸ë¦¬ê±°íŠ¸ì— ëŒ€í•œ ì„ ì  ì ê¸ˆ ì‹œë„</li>
  <li>ìŠ¤ë ˆë“œ 2: ğŸ³ ì• ê·¸ë¦¬ê±°íŠ¸ì— ëŒ€í•œ ì„ ì  ì ê¸ˆ ì‹œë„</li>
</ol>

<p><br /></p>

<p><strong>í•´ê²° ë°©ë²•</strong><br />
íŒíŠ¸ë¥¼ ì œê³µí•´ ìµœëŒ€ ëŒ€ê¸°ì‹œê°„ì„ ì§€ì •í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// JPA</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">hints</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
<span class="n">hints</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"javax.persistence.lock.timeout"</span><span class="o">,</span> <span class="mi">2000</span><span class="o">);</span>
<span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">orderNo</span><span class="o">,</span> <span class="nc">LockModeType</span><span class="o">.</span><span class="na">PESSIMISTIC_WRITE</span><span class="o">,</span> <span class="n">hints</span><span class="o">);</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ìŠ¤í”„ë§ ë°ì´í„° JPA</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberREpository</span> <span class="kd">extends</span> <span class="nc">Repository</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">,</span> <span class="nc">MemberId</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Lock</span><span class="o">(</span><span class="nc">LockModeType</span><span class="o">.</span><span class="na">PESSIMISTIC_WRITE</span><span class="o">)</span>
    <span class="nd">@QueryHints</span><span class="o">({</span>
        <span class="nd">@QueryHint</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"javax.persistence.lock.timeout"</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s">"2000"</span><span class="o">)</span>
    <span class="o">})</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findById</span><span class="o">(</span><span class="nc">MemberId</span> <span class="n">memberId</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p>DBMSì— ë”°ë¼ êµì°© ìƒíƒœì— ë¹ ì§„ ì»¤ë„¥ì…˜ì„ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ì´ ë‹¤ë¥´ë‹¤. ì‚¬ìš©í•˜ëŠ” DBMSì— ëŒ€í•´ JPAê°€ ì–´ë–¤ ì‹ìœ¼ë¡œ ëŒ€ê¸°ì‹œê°„ì„ ì²˜ë¦¬í•˜ëŠ”ì§€ ë°˜ë“œì‹œ í™•ì¸í•´ì•¼ í•œë‹¤.</p>

<h2 id="83-ë¹„ì„ ì -ì ê¸ˆ">8.3 ë¹„ì„ ì  ì ê¸ˆ</h2>
<p>ì„ ì  ì ê¸ˆìœ¼ë¡œ ëª¨ë“  íŠ¸ëœì­ì…˜ ì¶©ëŒ ë¬¸ì œê°€ í•´ê²°ë˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤</p>
<center><img src="/assets/images/posts/books/1/8_3_ë¹„ì„ ì ì ê¸ˆ.png" alt="ë¹„ì„ ì ì ê¸ˆ" width="60%" height="60%" /></center>

<p>ë¹„ì„ ì  ì ê¸ˆì€ ë™ì‹œì— ì ‘ê·¼í•˜ëŠ” ê²ƒì„ ë§‰ëŠ” ëŒ€ì‹  ë³€ê²½í•œ ë°ì´í„°ë¥¼ ì‹¤ì œ DBMSì— ë°˜ì˜í•˜ëŠ” ì‹œì ì— ë³€ê²½ ê°€ëŠ¥ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ëŠ” ë°©ì‹ì´ë‹¤.</p>

<p>ë¹„ì„ ì  ì ê¸ˆì„ êµ¬í˜„í•˜ë ¤ë©´ ì• ê·¸ë¦¬ê±°íŠ¸ì— ë²„ì „ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ«ì íƒ€ì… í”„ë¡œí¼í‹°ë¥¼ ì¶”ê°€í•´ì•¼ í•œë‹¤. ì• ê·¸ë¦¬ê±°íŠ¸ë¥¼ ìˆ˜ì •í•  ë•Œë§ˆë‹¤ ë²„ì „ìœ¼ë¡œ ì‚¬ìš©í•  í”„ë¡œí¼í‹° ê°’ì´ 1ì”© ì¦ê°€í•œë‹¤.</p>

<center><img src="/assets/images/posts/books/1/8_3_ë¹„ì„ ì ì ê¸ˆíŠ¸ëœì­ì…˜.png" alt="ë¹„ì„ ì ì ê¸ˆíŠ¸ëœì­ì…˜" width="60%" height="60%" /></center>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// JPA</span>
<span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"purchase_order"</span><span class="o">)</span>
<span class="nd">@Access</span><span class="o">(</span><span class="nc">AccessType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="nd">@Version</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">version</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p>JPA ì—”í‹°í‹°ê°€ ë³€ê²½ë˜ì–´ UPDATE ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•  ë•Œ <code class="language-plaintext highlighter-rouge">@Version</code>ì— ëª…ì‹œí•œ í•„ë“œë¥¼ ì´ìš©í•´ì„œ ë¹„ì„ ì  ì ê¸ˆ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•œë‹¤. ì‘ìš© ì„œë¹„ìŠ¤ëŠ” ë²„ì „ì— ëŒ€í•´ ì•Œ í•„ìš”ê°€ ì—†ë‹¤.</p>

<p>íŠ¸ëœì­ì…˜ ì¶©ëŒì´ ë°œìƒí•˜ë©´ <code class="language-plaintext highlighter-rouge">OptimisticLockingFailureException</code>ì´ ë°œìƒí•œë‹¤.</p>

<p><br /></p>

<p><strong>ë¹„ì„ ì  ì ê¸ˆ í™•ì¥</strong></p>
<center><img src="/assets/images/posts/books/1/8_3_ë¹„ì„ ì ì ê¸ˆíŠ¸ëœì­ì…˜í™•ì¥.png" alt="ë¹„ì„ ì ì ê¸ˆíŠ¸ëœì­ì…˜í™•ì¥" width="60%" height="60%" /></center>

<p><br /></p>

<p>ë¹„ì„ ì  ì ê¸ˆ ë°©ì‹ì„ ì—¬ëŸ¬ íŠ¸ëœì­ì…˜ìœ¼ë¡œ í™•ì¥í•˜ë ¤ë©´ ì• ê·¸ë¦¬ê±°íŠ¸ ë²„ì „ ì •ë³´ë¥¼ ì‘ìš© ì„œë¹„ìŠ¤ì— ì „ë‹¬í•œë‹¤. ì‘ìš© ì„œë¹„ìŠ¤ëŠ” ì „ë‹¬ë°›ì€ ë²„ì „ ê°’ì„ ì´ìš©í•´ì„œ ì• ê·¸ë¦¬ê±°íŠ¸ ë²„ì „ê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•˜ê³ , ì¼ì¹˜í•˜ëŠ” ê²½ìš°ì—ë§Œ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">StartShippingRequest</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">orderNumber</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">version</span><span class="o">;</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì‘ìš© ì„œë¹„ìŠ¤</span>
<span class="kd">public</span> <span class="nc">StartShippingService</span> <span class="o">{</span>

    <span class="nd">@PreAuthorize</span><span class="o">(</span><span class="s">"hasRole('ADMIN')"</span><span class="o">)</span>
    <span class="nd">@Transactional</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">startShipping</span><span class="o">(</span><span class="nc">StartShippingRequest</span> <span class="n">req</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="n">orderRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="k">new</span> <span class="nc">OrderNo</span><span class="o">(</span><span class="n">req</span><span class="o">.</span><span class="na">getOrderNumber</span><span class="o">()));</span>
        <span class="c1">// version í™•ì¸</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">order</span><span class="o">.</span><span class="na">matchVersion</span><span class="o">(</span><span class="n">req</span><span class="o">.</span><span class="na">getVersion</span><span class="o">()))</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">VersionConflictException</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="831-ê°•ì œ-ë²„ì „-ì¦ê°€">8.3.1 ê°•ì œ ë²„ì „ ì¦ê°€</h3>
<p>ê¸°ëŠ¥ ì‹¤í–‰ ë„ì¤‘ ë£¨íŠ¸ê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì—”í‹°í‹°ì˜ ê°’ë§Œ ë³€ê²½ëœë‹¤ë©´, JPAëŠ” ë£¨íŠ¸ ì—”í‹°í‹° ë²„ì „ ê°’ì„ ì¦ê°€ì‹œí‚¤ì§€ ì•ŠëŠ”ë‹¤.</p>

<p>JPAëŠ” ì´ëŸ° ë¬¸ì œë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ EntityManager#find() ë©”ì„œë“œë¡œ ì—”í‹°í‹°ë¥¼ êµ¬í•  ë•Œ ê°•ì œë¡œ ë²„ì „ ê°’ì„ ì¦ê°€ì‹œí‚¤ëŠ” ì ê¸ˆ ëª¨ë“œë¥¼ ì§€ì›í•œë‹¤. <code class="language-plaintext highlighter-rouge">LockModeType.OPTIMISTIC_FORCE_INCREMENT</code>ë¥¼ ì‚¬ìš©í•˜ë©´ í•´ë‹¹ ì—”í‹°í‹°ì˜ ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆëŠ”ì§€ì— ìƒê´€ì—†ì´ íŠ¸ëœì­ì…˜ ì¢…ë£Œ ì‹œì ì— ë²„ì „ ê°’ ì¦ê°€ ì²˜ë¦¬ë¥¼ í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// JPA</span>
<span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">orderNo</span><span class="o">,</span> <span class="nc">LockModeType</span><span class="o">.</span><span class="na">OPTIMISTIC_FORCE_INCREMENT</span><span class="o">);</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ìŠ¤í”„ë§ ë°ì´í„° JPA</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberREpository</span> <span class="kd">extends</span> <span class="nc">Repository</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">,</span> <span class="nc">MemberId</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Lock</span><span class="o">(</span><span class="nc">LockModeType</span><span class="o">.</span><span class="na">OPTIMISTIC_FORCE_INCREMENT</span><span class="o">)</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findById</span><span class="o">(</span><span class="nc">MemberId</span> <span class="n">memberId</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="84-ì˜¤í”„ë¼ì¸-ì„ ì -ì ê¸ˆ">8.4 ì˜¤í”„ë¼ì¸ ì„ ì  ì ê¸ˆ</h2>
<p>ëˆ„êµ°ê°€ ìˆ˜ì • í™”ë©´ì„ ë³´ê³  ìˆì„ ë•Œ ìˆ˜ì • í™”ë©´ ìì²´ë¥¼ ì‹¤í–‰í•˜ì§€ ëª»í•˜ê²Œ í•˜ëŠ” ê²ƒì´ ì˜¤í”„ë¼ì¸ ì„ ì  ì ê¸ˆ ë°©ì‹ì´ë‹¤.</p>
<center><img src="/assets/images/posts/books/1/8_4_ì˜¤í”„ë¼ì¸ì„ ì ì ê¸ˆë°©ì‹.png" alt="ì˜¤í”„ë¼ì¸ì„ ì ì ê¸ˆë°©ì‹" width="60%" height="60%" /></center>

<h3 id="841-ì˜¤í”„ë¼ì¸-ì„ ì -ì ê¸ˆì„-ìœ„í•œ-lockmanager-ì¸í„°í˜ì´ìŠ¤ì™€-ê´€ë ¨-í´ë˜ìŠ¤">8.4.1 ì˜¤í”„ë¼ì¸ ì„ ì  ì ê¸ˆì„ ìœ„í•œ LockManager ì¸í„°í˜ì´ìŠ¤ì™€ ê´€ë ¨ í´ë˜ìŠ¤</h3>
<p>í•„ìš” ê¸°ëŠ¥</p>
<ul>
  <li>ì ê¸ˆ ì„ ì  ì‹œë„</li>
  <li>ì ê¸ˆ í™•ì¸</li>
  <li>ì ê¸ˆ í•´ì œ</li>
  <li>ì ê¸ˆ ìœ íš¨ì‹œê°„</li>
</ul>

<p>êµ¬í˜„ ì½”ë“œëŠ” <a href="https://product.kyobobook.co.kr/detail/S000001810495" target="_blank">ì±…</a>ì—ì„œ í™•ì¸í•´ì£¼ì„¸ìš”. ğŸ”</p>

<h3 id="842-dbë¥¼-ì´ìš©í•œ-lockmanager-êµ¬í˜„">8.4.2 DBë¥¼ ì´ìš©í•œ LockManager êµ¬í˜„</h3>
<p>êµ¬í˜„ ì½”ë“œëŠ” <a href="https://product.kyobobook.co.kr/detail/S000001810495" target="_blank">ì±…</a>ì—ì„œ í™•ì¸í•´ì£¼ì„¸ìš”. ğŸ”</p>

<p><br />
<br />
<br /></p>

<h1 id="9-ë„ë©”ì¸-ëª¨ë¸ê³¼-ë°”ìš´ë””ë“œ-ì»¨í…ìŠ¤íŠ¸">9. ë„ë©”ì¸ ëª¨ë¸ê³¼ ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸</h1>
<h2 id="91-ë„ë©”ì¸-ëª¨ë¸ê³¼-ê²½ê³„">9.1 ë„ë©”ì¸ ëª¨ë¸ê³¼ ê²½ê³„</h2>
<p>ë…¼ë¦¬ì ìœ¼ë¡œ ê°™ì€ ì¡´ì¬ì²˜ëŸ¼ ë³´ì´ì§€ë§Œ í•˜ìœ„ ë„ë©”ì¸ì— ë”°ë¼ ë‹¤ë¥¸ ìš©ì–´ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ë„ ìˆë‹¤.</p>
<center><img src="/assets/images/posts/books/1/9_1_í•˜ìœ„ë„ë©”ì¸ë³„ìš©ì–´.png" alt="í•˜ìœ„ë„ë©”ì¸ë³„ìš©ì–´" width="80%" height="80%" /></center>

<p>ì´ë ‡ê²Œ í•˜ìœ„ ë„ë©”ì¸ë§ˆë‹¤ ê°™ì€ ìš©ì–´ë¼ë„ ì˜ë¯¸ê°€ ë‹¤ë¥´ê³  ê°™ì€ ëŒ€ìƒì´ë¼ë„ ì§€ì¹­í•˜ëŠ” ìš©ì–´ê°€ ë‹¤ë¥¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— í•œê°œì˜ ëª¨ë¸ë¡œ ëª¨ë“  í•˜ìœ„ ë„ë©”ì¸ì„ í‘œí˜„í•˜ë ¤ëŠ” ì‹œë„ëŠ” ì˜¬ë°”ë¥¸ ë°©ë²•ì´ ì•„ë‹ˆë©° í‘œí˜„í•  ìˆ˜ë„ ì—†ë‹¤.</p>

<p><strong>ëª¨ë¸ì€ íŠ¹ì •í•œ ì»¨í…ìŠ¤íŠ¸(ë¬¸ë§¥) í•˜ì—ì„œ ì™„ì „í•œ ì˜ë¯¸ë¥¼ ê°–ëŠ”ë‹¤</strong>. ê°™ì€ ì œí’ˆì´ë¼ë„ ì¹´íƒˆë¡œê·¸ ì»¨í…ìŠ¤íŠ¸ì™€ ì¬ê³  ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì˜ë¯¸ê°€ ì„œë¡œ ë‹¤ë¥´ë‹¤. ì´ë ‡ê²Œ <strong>êµ¬ë¶„ë˜ëŠ” ê²½ê³„ë¥¼ ê°–ëŠ” ì»¨í…ìŠ¤íŠ¸ë¥¼ DDDì—ì„œëŠ” ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸(Bounded Context)ë¼ê³  ë¶€ë¥¸ë‹¤</strong>.</p>

<h2 id="92-ë°”ìš´ë””ë“œ-ì»¨í…ìŠ¤íŠ¸">9.2 ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸</h2>
<ul>
  <li>ë„ë©”ì¸ ëª¨ë¸ì˜ ê²½ê³„ë¥¼ ê²°ì •í•œë‹¤.</li>
  <li>ìš©ì–´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ êµ¬ë¶„í•œë‹¤.</li>
  <li>í•œ ê°œì˜ ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ëŠ” ë…¼ë¦¬ì ìœ¼ë¡œ í•œ ê°œì˜ ëª¨ë¸ì„ ê°–ëŠ”ë‹¤.</li>
  <li>í•œ ê°œì˜ ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ê°€ ì—¬ëŸ¬ í•˜ìœ„ ë„ë©”ì¸ì„ í¬í•¨í•˜ë”ë¼ë„, í•˜ìœ„ ë„ë©”ì¸ë§ˆë‹¤ êµ¬ë¶„ë˜ëŠ” íŒ¨í‚¤ì§€ë¥¼ ê°–ë„ë¡ êµ¬í˜„í•´ì•¼ í•œë‹¤.</li>
</ul>

<p><br /></p>

<p><strong>ì•„ì§ ëª…í™•í•˜ê²Œ êµ¬ë¶„ë˜ì§€ ì•Šì€ ê²½ìš° ë‘ í•˜ìœ„ ë„ë©”ì¸ì„ í•˜ë‚˜ì˜ ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ì—ì„œ êµ¬í˜„í•˜ê¸°ë„ í•œë‹¤.</strong><br />
<img src="/assets/images/posts/books/1/9_2_ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸.png" alt="ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸" width="70%" height="70%" /></p>

<p><br /></p>

<p><strong>í•œ ê°œì˜ ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ê°€ ì—¬ëŸ¬ í•˜ìœ„ ë„ë©”ì¸ì„ í¬í•¨í•˜ë”ë¼ë„, í•˜ìœ„ ë„ë©”ì¸ë§ˆë‹¤ êµ¬ë¶„ë˜ëŠ” íŒ¨í‚¤ì§€ë¥¼ ê°–ë„ë¡ êµ¬í˜„í•´ì•¼ í•œë‹¤.</strong><br />
<img src="/assets/images/posts/books/1/9_2_ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸2.png" alt="ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸" width="70%" height="70%" /></p>

<p><br /></p>

<p><strong>ê°™ì€ ìƒí’ˆì´ë¼ë„ ê°ì êµ¬í˜„í•˜ëŠ” í•˜ìœ„ ë„ë©”ì¸ì— ë§ëŠ” ëª¨ë¸ì„ ê°–ëŠ”ë‹¤.</strong><br />
<img src="/assets/images/posts/books/1/9_2_ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸3.png" alt="ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸" width="70%" height="70%" /></p>

<h2 id="93-ë°”ìš´ë””ë“œ-ì»¨í…ìŠ¤íŠ¸-êµ¬í˜„">9.3 ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ êµ¬í˜„</h2>
<p>ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ëŠ” ë„ë©”ì¸ ê¸°ëŠ¥ì„ ì‚¬ìš©ìì—ê²Œ ì œê³µí•˜ëŠ” ë° í•„ìš”í•œ í‘œí˜„ ì˜ì—­, ì‘ìš© ì„œë¹„ìŠ¤, ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜, í…Œì´ë¸” ì˜ì—­ì„ í¬í•¨í•œë‹¤.</p>
<center><img src="/assets/images/posts/books/1/9_3_ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸ì˜ì—­.png" alt="ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸ì˜ì—­" width="70%" height="70%" /></center>

<p><br />
<br /></p>

<p>CQRS (Command Query Responsibility Segregation, ëª…ë ¹ ì¡°íšŒ ì±…ì„ ë¶„ë¦¬) íŒ¨í„´ì„ ì‚¬ìš©í•  ìˆ˜ë„ ìˆë‹¤.</p>
<center><img src="/assets/images/posts/books/1/9_3_ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸CQRS.png" alt="ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸CQRS" width="60%" height="60%" /></center>

<p><br />
<br /></p>

<p>ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ëŠ” UIë¥¼ ê°–ì§€ ì•Šì„ ìˆ˜ë„ ìˆë‹¤.</p>
<center><img src="/assets/images/posts/books/1/9_3_ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸UIë¯¸í¬í•¨.png" alt="ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸UIë¯¸í¬í•¨" width="60%" height="60%" /></center>

<p><br />
<br /></p>

<p>ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ëŠ” UIì„œë²„ë¥¼ í†µí•´ ê°„ì ‘ì ìœ¼ë¡œ ë¸Œë¼ìš°ì €ì™€ í†µì‹ í•  ìˆ˜ë„ ìˆë‹¤. ì—¬ê¸°ì„œ UIì„œë²„ëŠ” íŒŒì‚¬ë“œ ì—­í• ì„ ìˆ˜í–‰í•œë‹¤.</p>
<center><img src="/assets/images/posts/books/1/9_3_ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸UIì„œë²„.png" alt="ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸UIì„œë²„" width="60%" height="60%" /></center>

<h2 id="94-ë°”ìš´ë””ë“œ-ì»¨í…ìŠ¤íŠ¸-ê°„-í†µí•©">9.4 ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ ê°„ í†µí•©</h2>
<p>ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ ê°„ í†µí•©ì´ í•„ìš”í•  ë•Œë„ ìˆë‹¤.</p>

<p><strong>REST APIë¥¼ ì´ìš©í•œ ì§ì ‘ í†µí•©</strong></p>
<ul>
  <li>í†µì‹ </li>
</ul>

<p><img src="/assets/images/posts/books/1/9_4_ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸ê°„í†µí•©.png" alt="ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸ê°„í†µí•©" width="80%" height="80%" /></p>

<p><br /></p>

<ul>
  <li>ë„ë©”ì¸ì— ë§ëŠ” ëª¨ë¸ë¡œ ë³€í™˜</li>
</ul>

<p><img src="/assets/images/posts/books/1/9_4_ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸ê°„í†µí•©2.png" alt="ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸ê°„í†µí•©" width="80%" height="80%" /></p>

<p><br />
<br /></p>

<p><strong>ë©”ì‹œì§€ íë¥¼ ì‚¬ìš©í•˜ì—¬ í†µí•©</strong>
<img src="/assets/images/posts/books/1/9_4_ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸ê°„í†µí•©3.png" alt="ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸ê°„í†µí•©" width="80%" height="80%" /></p>

<p><img src="/assets/images/posts/books/1/9_4_ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸ê°„í†µí•©4.png" alt="ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸ê°„í†µí•©" width="80%" height="80%" /></p>

<p><br />
<br /></p>

<p><strong>ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì™€ ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸</strong><br />
ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‘ì€ ì„œë¹„ìŠ¤ë¡œ ë‚˜ëˆ„ì–´ ê°œë°œí•˜ëŠ” ì•„í‚¤í…ì²˜ ìŠ¤íƒ€ì¼ì´ë‹¤. ê°œë³„ ì„œë¹„ìŠ¤ë¥¼ ë…ë¦½ëœ í”„ë¡œì„¸ìŠ¤ë¡œ ì‹¤í–‰í•˜ê³  ê° ì„œë¹„ìŠ¤ê°€ REST APIë‚˜ ë©”ì‹œì§•ì„ ì´ìš©í•´ì„œ í†µì‹ í•˜ëŠ” êµ¬ì¡°ë¥¼ ê°–ëŠ”ë‹¤.</p>

<p>ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¡œ êµ¬í˜„í•˜ë©´ ìì—°ìŠ¤ëŸ½ê²Œ ì»¨í…ìŠ¤íŠ¸ë³„ë¡œ ëª¨ë¸ì´ ë¶„ë¦¬ëœë‹¤. ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë§ˆë‹¤ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ë¯€ë¡œ <strong>ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ë§ˆë‹¤ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ê²Œ ëœë‹¤</strong>. ì´ê²ƒì€ ì½”ë“œ ìˆ˜ì¤€ì—ì„œ ëª¨ë¸ì„ ë¶„ë¦¬í•˜ì—¬ ë‘ ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ì˜ ëª¨ë¸ì´ ì„ì´ì§€ ì•Šë„ë¡ í•´ì¤€ë‹¤.</p>

<h2 id="95-ë°”ìš´ë””ë“œ-ì»¨í…ìŠ¤íŠ¸-ê°„-ê´€ê³„">9.5 ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ ê°„ ê´€ê³„</h2>
<p>ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ëŠ” ì–´ë–¤ ì‹ìœ¼ë¡œë“  ì—°ê²°ë˜ê¸° ë•Œë¬¸ì— ë‘ ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ëŠ” ë‹¤ì–‘í•œ ë°©ì‹ìœ¼ë¡œ ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.</p>

<p><strong>REST API</strong><br />
<img src="/assets/images/posts/books/1/9_5_ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸ê´€ê³„.png" alt="ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸ê°„í†µí•©" width="80%" height="80%" /></p>

<p><br />
<br /></p>

<p><strong>ë‹¨ì¼ API</strong><br />
<img src="/assets/images/posts/books/1/9_5_ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸ê´€ê³„2.png" alt="ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸ê°„í†µí•©" width="80%" height="80%" /></p>

<p><br />
<br /></p>

<p><strong>ë…ë¦½ ë°©ì‹</strong><br />
ê·¸ëƒ¥ ì„œë¡œ í†µí•©í•˜ì§€ ì•ŠëŠ” ë°©ì‹ì´ë‹¤. ì„œë¡œ ë…ë¦½ì ìœ¼ë¡œ ëª¨ë¸ì„ ë°œì „ ì‹œí‚¨ë‹¤. í•˜ì§€ë§Œ ê·œëª¨ê°€ ì»¤ì§ˆìˆ˜ë¡ í•œê³„ê°€ ìˆìœ¼ë¯€ë¡œ ê·¸ ì „ì— ë‘ ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ë¥¼ í†µí•©í•´ì•¼ í•œë‹¤.</p>

<p><img src="/assets/images/posts/books/1/9_5_ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸ê´€ê³„3.png" alt="ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸ê°„í†µí•©" width="80%" height="80%" /></p>

<p><img src="/assets/images/posts/books/1/9_5_ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸ê´€ê³„4.png" alt="ë°”ìš´ë””ë“œì»¨í…ìŠ¤íŠ¸ê°„í†µí•©" width="80%" height="80%" /></p>

<h2 id="96-ì»¨í…ìŠ¤íŠ¸-ë§µ">9.6 ì»¨í…ìŠ¤íŠ¸ ë§µ</h2>
<p>ê°œë³„ ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ì— ë§¤ëª°ë˜ë©´ ì „ì²´ë¥¼ ë³´ì§€ ëª»í•  ë•Œê°€ ìˆë‹¤. ì „ì²´ ë°”ìš´ë””ë“œ ì»¨í…ìŠ¤íŠ¸ ê°„ ê´€ê³„ë¥¼ ë³¼ ìˆ˜ ìˆëŠ” ì§€ë„ê°€ í•„ìš”í•œë° ê·¸ê²ƒì´ ë°”ë¡œ ì»¨í…ìŠ¤íŠ¸ ë§µì´ë‹¤.</p>

<p><img src="/assets/images/posts/books/1/9_6_ì»¨í…ìŠ¤íŠ¸ë§µ.png" alt="ì»¨í…ìŠ¤íŠ¸ë§µ" width="80%" height="80%" /></p>

<p><br />
<br />
<br /></p>

<h1 id="10-ì´ë²¤íŠ¸">10. ì´ë²¤íŠ¸</h1>
<h2 id="101-ì‹œìŠ¤í…œ-ê°„-ê°•ê²°í•©-ë¬¸ì œ">10.1 ì‹œìŠ¤í…œ ê°„ ê°•ê²°í•© ë¬¸ì œ</h2>
<ul>
  <li>íŠ¸ë Œì ì…˜ ë¬¸ì œ</li>
  <li>ì™¸ë¶€ ì„œë¹„ìŠ¤ì˜ ì„±ëŠ¥ì— ì˜í–¥ì„ ë°›ìŒ</li>
  <li>ì„¤ê³„ìƒ ë¬¸ì œ (ë¡œì§ì´ ì„ì„)</li>
  <li>ê¸°ëŠ¥ ì¶”ê°€ì˜ ì–´ë ¤ì›€</li>
</ul>

<h2 id="102-ì´ë²¤íŠ¸-ê°œìš”">10.2 ì´ë²¤íŠ¸ ê°œìš”</h2>
<p>ì—¬ê¸°ì„œ ì‚¬ìš©ë˜ëŠ” ì´ë²¤íŠ¸ë¼ëŠ” ìš©ì–´ëŠ” â€˜ê³¼ê±°ì— ë²Œì–´ì§„ ì–´ë–¤ ê²ƒâ€™ì„ ì˜ë¯¸í•œë‹¤.</p>
<ul>
  <li>ì´ë²¤íŠ¸ ë°œìƒ</li>
  <li>ì´ë²¤íŠ¸ì— ë°˜ì‘í•˜ì—¬ ë™ì‘ ìˆ˜í–‰</li>
</ul>

<h3 id="1021-ì´ë²¤íŠ¸-ê´€ë ¨-êµ¬ì„±ìš”ì†Œ">10.2.1 ì´ë²¤íŠ¸ ê´€ë ¨ êµ¬ì„±ìš”ì†Œ</h3>
<ul>
  <li>ì´ë²¤íŠ¸</li>
  <li>ì´ë²¤íŠ¸ ìƒì„± ì£¼ì²´</li>
  <li>ì´ë²¤íŠ¸ ë””ìŠ¤íŒ¨ì²˜ (í¼ë¸”ë¦¬ì…”)</li>
  <li>ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ (êµ¬ë…ì)</li>
</ul>

<p><img src="/assets/images/posts/books/1/10_2_ì´ë²¤íŠ¸êµ¬ì„±ìš”ì†Œ.png" alt="ì´ë²¤íŠ¸êµ¬ì„±ìš”ì†Œ" width="80%" height="80%" /></p>

<p>ë„ë©”ì¸ ëª¨ë¸ì—ì„œ ì´ë²¤íŠ¸ ìƒì„± ì£¼ì²´ëŠ” ì—”í‹°í‹°, ë°¸ë¥˜, ë„ë©”ì¸ ì„œë¹„ìŠ¤ì™€ ê°™ì€ ë„ë©”ì¸ ê°ì²´ì´ë‹¤. ë„ë©”ì¸ ê°ì²´ëŠ” ë„ë©”ì¸ ë¡œì§ì„ ì‹¤í–‰í•´ì„œ ìƒíƒœê°€ ë°”ë€Œë©´ ê´€ë ¨ ì´ë²¤íŠ¸ë¥¼ ë°œìƒì‹œí‚¨ë‹¤.</p>

<h3 id="1022-ì´ë²¤íŠ¸ì˜-êµ¬ì„±">10.2.2 ì´ë²¤íŠ¸ì˜ êµ¬ì„±</h3>
<p>ì´ë²¤íŠ¸ëŠ” ë°œìƒí•œ ì´ë²¤íŠ¸ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‹´ëŠ”ë‹¤.</p>
<ul>
  <li>ì´ë²¤íŠ¸ ì¢…ë¥˜: í´ë˜ìŠ¤ ì´ë¦„ìœ¼ë¡œ ì´ë²¤íŠ¸ ì¢…ë¥˜ë¥¼ í‘œí˜„</li>
  <li>ì´ë²¤íŠ¸ ë°œìƒ ì‹œê°„</li>
  <li>ì¶”ê°€ ë°ì´í„°: ì£¼ë¬¸ë²ˆí˜¸, ì‹œê·œë°°ì†¡ì§€ ì •ë³´ ë“± ì´ë²¤íŠ¸ì™€ ê´€ë ¨ëœ ì •ë³´</li>
</ul>

<h3 id="1023-ì´ë²¤íŠ¸-ìš©ë„">10.2.3 ì´ë²¤íŠ¸ ìš©ë„</h3>
<ul>
  <li>í›„ì²˜ë¦¬ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•œ íŠ¸ë¦¬ê±°</li>
  <li>ì„œë¡œ ë‹¤ë¥¸ ì‹œìŠ¤í…œ ê°„ì˜ ë°ì´í„° ë™ê¸°í™”</li>
</ul>

<p><img src="/assets/images/posts/books/1/10_2_ì´ë²¤íŠ¸ìš©ë„.png" alt="ì´ë²¤íŠ¸ìš©ë„" width="80%" height="80%" /></p>

<h3 id="1024-ì´ë²¤íŠ¸-ì¥ì ">10.2.4 ì´ë²¤íŠ¸ ì¥ì </h3>
<ul>
  <li>ì„œë¡œ ë‹¤ë¥¸ ë„ë©”ì¸ ë¡œì§ì´ ì„ì´ëŠ” ê²ƒì„ ë°©ì§€</li>
  <li>ë„ë©”ì¸ ë¡œì§ì— ì˜í–¥ ì—†ì´ ê¸°ëŠ¥ í™•ì¥</li>
</ul>

<p><img src="/assets/images/posts/books/1/10_2_ì´ë²¤íŠ¸ì¥ì .png" alt="ì´ë²¤íŠ¸ì¥ì " width="80%" height="80%" /></p>

<h2 id="103-ì´ë²¤íŠ¸-í•¸ë“¤ëŸ¬-ë””ìŠ¤íŒ¨ì²˜-êµ¬í˜„">10.3 ì´ë²¤íŠ¸, í•¸ë“¤ëŸ¬, ë””ìŠ¤íŒ¨ì²˜ êµ¬í˜„</h2>
<p>ì´ë²¤íŠ¸ì™€ ê´€ë ¨ëœ ì½”ë“œ</p>
<ul>
  <li>ì´ë²¤íŠ¸ í´ë˜ìŠ¤: ì´ë²¤íŠ¸ë¥¼ í‘œí˜„í•œë‹¤.</li>
  <li>ë””ìŠ¤íŒ¨ì²˜: ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ApplicationEventPublisherë¥¼ ì´ìš©í•œë‹¤.</li>
  <li>Events: ì´ë²¤íŠ¸ë¥¼ ë°œí–‰í•œë‹¤. ì´ë²¤íŠ¸ ë°œí–‰ì„ ìœ„í•´ ApplicationEventPublisherë¥¼ ì‚¬ìš©í•œë‹¤.</li>
  <li>ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬: ì´ë²¤íŠ¸ë¥¼ ìˆ˜ì‹ í•´ì„œ ì²˜ë¦¬í•œë‹¤. ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì„ ì‚¬ìš©í•œë‹¤.</li>
</ul>

<h3 id="1031-ì´ë²¤íŠ¸-í´ë˜ìŠ¤">10.3.1 ì´ë²¤íŠ¸ í´ë˜ìŠ¤</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ê³µí†µ ì¶”ìƒ í´ë˜ìŠ¤</span>
<span class="kn">package</span> <span class="nn">com.myshop.common.event</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Event</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">timestamp</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Event</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">timestamp</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderCanceledEvent</span> <span class="kd">extends</span> <span class="nc">Event</span> <span class="o">{</span>

    <span class="c1">// ì´ë²¤íŠ¸ëŠ” í•¸ë“¤ëŸ¬ì—ì„œ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë° í•„ìš”í•œ ë°ì´í„°ë¥¼ í¬í•¨</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">orderNumber</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">OrderCanceledEvent</span><span class="o">(</span><span class="nc">String</span> <span class="n">number</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>
        <span class="k">this</span><span class="o">.</span><span class="na">orderNumber</span> <span class="o">=</span> <span class="n">number</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="1032-events-í´ë˜ìŠ¤ì™€-applicationeventpublisher">10.3.2 Events í´ë˜ìŠ¤ì™€ ApplicationEventPublisher</h3>
<p>ì´ë²¤íŠ¸ ë°œìƒê³¼ ì¶œíŒì„ ìœ„í•´ ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” <code class="language-plaintext highlighter-rouge">ApplicationEventPublisher</code>ë¥¼ ì‚¬ìš©í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì„¤ì •</span>
<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EventsConfiguration</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">ApplicationContext</span> <span class="n">applicationContext</span><span class="o">;</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">InitializingBean</span> <span class="nf">eventsInitializer</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="nc">Events</span><span class="o">.</span><span class="na">setPublisher</span><span class="o">(</span><span class="n">applicationContext</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// EventsëŠ” ApplicationEventPublisherë¥¼ ì‚¬ìš©í•´ì„œ ì´ë²¤íŠ¸ë¥¼ ë°œìƒ</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Events</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">ApplicationEventPublisher</span> <span class="n">publisher</span><span class="o">;</span>

    <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setPublisher</span><span class="o">(</span><span class="nc">ApplicationEventPublisher</span> <span class="n">publisher</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Events</span><span class="o">.</span><span class="na">publisher</span> <span class="o">=</span> <span class="n">publisher</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">raise</span><span class="o">(</span><span class="nc">Object</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">publisher</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">publisher</span><span class="o">.</span><span class="na">publishEvent</span><span class="o">(</span><span class="n">event</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="1033-ì´ë²¤íŠ¸-ë°œìƒê³¼-ì´ë²¤íŠ¸-í•¸ë“¤ëŸ¬">10.3.3 ì´ë²¤íŠ¸ ë°œìƒê³¼ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì´ë²¤íŠ¸ ë°œìƒ</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">cancel</span><span class="o">()</span> <span class="o">{</span>
        <span class="o">...</span><span class="na">ìƒëµ</span><span class="o">...</span>
        <span class="nc">Events</span><span class="o">.</span><span class="na">raise</span><span class="o">(</span><span class="k">new</span> <span class="nc">OrderCanceledEvent</span><span class="o">(</span><span class="n">number</span><span class="o">.</span><span class="na">getNumber</span><span class="o">()));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬</span>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderCanceledEventHandler</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">RefundService</span> <span class="n">refundService</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">OrderCanceledEventHandler</span><span class="o">(</span><span class="nc">RefundService</span> <span class="n">refundService</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">refundService</span> <span class="o">=</span> <span class="n">refundService</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@EventListener</span><span class="o">(</span><span class="nc">OrderCanceledEvent</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="nc">OrderCanceledEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">refundService</span><span class="o">.</span><span class="na">refund</span><span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">getOrderNumber</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="1034-íë¦„-ì •ë¦¬">10.3.4 íë¦„ ì •ë¦¬</h3>
<p><img src="/assets/images/posts/books/1/10_3_ì´ë²¤íŠ¸íë¦„.png" alt="ì´ë²¤íŠ¸íë¦„" width="80%" height="80%" /></p>

<h2 id="104-ë™ê¸°-ì´ë²¤íŠ¸-ì²˜ë¦¬-ë¬¸ì œ">10.4 ë™ê¸° ì´ë²¤íŠ¸ ì²˜ë¦¬ ë¬¸ì œ</h2>
<p>ë™ê¸° ì´ë²¤íŠ¸ ì²˜ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œê°€ ë°œìƒí•œë‹¤.</p>
<ul>
  <li>ì™¸ë¶€ ì—°ë™ ê³¼ì •ì—ì„œ ìµì…‰ì…˜ì´ ë°œìƒí•˜ë©´ íŠ¸ëœì­ì…˜ ì²˜ë¦¬ëŠ”?</li>
  <li>ì´ë²¤íŠ¸ ì²˜ë¦¬í•˜ëŠ” ì½”ë“œê°€ ëŠë ¤ì§€ê±°ë‚˜ ìµì…‰ì…˜ì´ ë°œìƒí•˜ë©´?</li>
</ul>

<h2 id="105-ë¹„ë™ê¸°-ì´ë²¤íŠ¸-ì²˜ë¦¬">10.5 ë¹„ë™ê¸° ì´ë²¤íŠ¸ ì²˜ë¦¬</h2>
<p>ë¹„ë™ê¸° ì´ë²¤íŠ¸ ì²˜ë¦¬ë¡œ í•´ê²°í•œë‹¤.</p>
<ul>
  <li>ë¡œì»¬ í•¸ë“¤ëŸ¬ë¥¼ ë¹„ë™ê¸°ë¡œ ì‹¤í–‰í•˜ê¸°</li>
  <li>ë©”ì‹œì§€ íë¥¼ ì‚¬ìš©í•˜ê¸°</li>
  <li>ì´ë²¤íŠ¸ ì €ì¥ì†Œì™€ ì´ë²¤íŠ¸ í¬ì›Œë” ì‚¬ìš©í•˜ê¸°</li>
  <li>ì´ë²¤íŠ¸ ì €ì¥ì†Œì™€ ì´ë²¤íŠ¸ ì œê³µ API ì‚¬ìš©í•˜ê¸°</li>
</ul>

<h3 id="1051-ë¡œì»¬-í•¸ë“¤ëŸ¬-ë¹„ë™ê¸°-ì‹¤í–‰">10.5.1 ë¡œì»¬ í•¸ë“¤ëŸ¬ ë¹„ë™ê¸° ì‹¤í–‰</h3>
<p>ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ë³„ë„ ìŠ¤ë ˆë“œë¡œ ì‹¤í–‰í•œë‹¤. ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” <code class="language-plaintext highlighter-rouge">@Async</code> ì—ë„ˆí…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ ì†ì‰½ê²Œ ë¹„ë™ê¸°ë¡œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@SpringBootApplication</span>
<span class="nd">@EnableAsync</span>  <span class="c1">// ê¸°ëŠ¥ í™œì„±í™”</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ShopApplication</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">ShopApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// í•¸ë“¤ëŸ¬</span>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderCanceledEventHandler</span> <span class="o">{</span>

    <span class="nd">@Async</span> <span class="c1">// @Async ì—ë„ˆí…Œì´ì…˜ ì‚¬ìš©</span>
    <span class="nd">@EventListener</span><span class="o">(</span><span class="nc">OrderCanceledEvent</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="nc">OrderCanceledEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">refundService</span><span class="o">.</span><span class="na">refund</span><span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">getOrderNumber</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="1052-ë©”ì‹œì§•-ì‹œìŠ¤í…œì„-ì´ìš©í•œ-ë¹„ë™ê¸°-êµ¬í˜„">10.5.2 ë©”ì‹œì§• ì‹œìŠ¤í…œì„ ì´ìš©í•œ ë¹„ë™ê¸° êµ¬í˜„</h3>
<p>Kafkaë‚˜ RabbitMQì™€ ê°™ì€ ë©”ì‹œì§• ì‹œìŠ¤í…œì„ ì‚¬ìš©</p>
<ul>
  <li>RabbitMQ
    <ul>
      <li>ê¸€ë¡œë²Œ íŠ¸ëœì­ì…˜ ì§€ì›</li>
    </ul>
  </li>
  <li>Kafka
    <ul>
      <li>ê¸€ë¡œë²Œ íŠ¸ëœì­ì…˜ ì§€ì› X</li>
      <li>ë‹¤ë¥¸ ë©”ì‹œì§• ì‹œìŠ¤í…œì— ë¹„í•´ <strong>ë†’ì€ ì„±ëŠ¥</strong></li>
    </ul>
  </li>
</ul>

<p><img src="/assets/images/posts/books/1/10_5_ì´ë²¤íŠ¸ë©”ì‹œì§€í.png" alt="ì´ë²¤íŠ¸ë©”ì‹œì§€í" width="80%" height="80%" /></p>

<h3 id="1053-ì´ë²¤íŠ¸-ì €ì¥ì†Œë¥¼-ì´ìš©í•œ-ë¹„ë™ê¸°-ì²˜ë¦¬">10.5.3 ì´ë²¤íŠ¸ ì €ì¥ì†Œë¥¼ ì´ìš©í•œ ë¹„ë™ê¸° ì²˜ë¦¬</h3>
<p>ì´ë²¤íŠ¸ë¥¼ ì¼ë‹¨ DBì— ì €ì¥í•œ ë’¤ì— ë³„ë„ í”„ë¡œê·¸ë¨ì„ ì´ìš©í•´ì„œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì— ì „ë‹¬</p>

<p><img src="/assets/images/posts/books/1/10_5_ì´ë²¤íŠ¸ì €ì¥ì†Œì´ìš©í¬ì›Œë”.png" alt="ì´ë²¤íŠ¸ì €ì¥ì†Œì´ìš©í¬ì›Œë”" width="80%" height="80%" /></p>

<p><img src="/assets/images/posts/books/1/10_5_ì´ë²¤íŠ¸ì €ì¥ì†Œì´ìš©API.png" alt="ì´ë²¤íŠ¸ì €ì¥ì†Œì´ìš©API" width="80%" height="80%" /></p>

<p><br /></p>

<p>APIë°©ì‹ê³¼ í¬ì›Œë” ë°©ì‹ì˜ ì°¨ì´ì ì€ ì´ë²¤íŠ¸ë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ì‹ì— ìˆë‹¤.</p>
<ul>
  <li>í¬ì›Œë”
    <ul>
      <li>í¬ì›Œë”ë¥¼ ì´ìš©í•´ì„œ ì´ë²¤íŠ¸ë¥¼ ì™¸ë¶€ì— ì „ë‹¬.</li>
      <li>ì´ë²¤íŠ¸ë¥¼ ì–´ë””ê¹Œì§€ ì²˜ë¦¬í–ˆëŠ”ì§€ ì¶”ì í•˜ëŠ” ì—­í• ì´ í¬ì›Œë”ì— ìˆë‹¤.</li>
    </ul>
  </li>
  <li>API
    <ul>
      <li>ì™¸ë¶€ í•¸ë“¤ëŸ¬ê°€ API ì„œë²„ë¥¼ í†µí•´ ì´ë²¤íŠ¸ ëª©ë¡ì„ ê°€ì ¸ê°.</li>
      <li>ì´ë²¤íŠ¸ë¥¼ ì–´ë””ê¹Œì§€ ì²˜ë¦¬í–ˆëŠ”ì§€ ì¶”ì í•˜ëŠ” ì—­í• ì´ ì™¸ë¶€ í•¸ë“¤ëŸ¬ì— ìˆë‹¤.</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<p><strong>êµ¬í˜„ ë°©ë²•ì€ ì±… ì°¸ê³ </strong><br />
â€¦ìƒëµâ€¦ğŸ˜…</p>

<p><br /></p>

<p><strong>ìë™ ì¦ê°€ ì¹¼ëŸ¼ ì£¼ì˜ ì‚¬í•­</strong><br />
íŠ¸ëœì­ì…˜ ì»¤ë°‹ ì‹œì ì— ë”°ë¥¸ ìë™ ì¦ê°€ ì¹¼ëŸ¼ ë¬¸ì œ<br />
<a href="https://javacan.tistory.com/entry/MySQL-auto-inc-col-gotcha" target="_blank">ìë™ ì¦ê°€ ì¹¼ëŸ¼ ì£¼ì˜ ì‚¬í•­ ë§í¬</a></p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// íŠ¸ëœì­ì…˜ ì»¤ë°‹ ì‹œì ì— ë”°ë¥¸ ID ê°’
ì‹œê°„ íë¦„ ---&gt;  
íŠ¸ëœì­ì…˜ 1: 1, 2       5, 6
íŠ¸ëœì­ì…˜ 2:       3, 4      7, 8
</code></pre></div></div>

<h2 id="106-ì´ë²¤íŠ¸-ì ìš©-ì‹œ-ì¶”ê°€-ê³ ë ¤-ì‚¬í•­">10.6 ì´ë²¤íŠ¸ ì ìš© ì‹œ ì¶”ê°€ ê³ ë ¤ ì‚¬í•­</h2>
<p>ì´ë²¤íŠ¸ ì ìš© ì‹œ ë‹¤ìŒ ê³ ë ¤ì‚¬í•­ì„ ìƒê°í•´ë³¸ë‹¤.</p>
<ul>
  <li><strong>ì´ë²¤íŠ¸ ì†ŒìŠ¤ë¥¼ EventEntryì— ì¶”ê°€í• ì§€?</strong>
    <ul>
      <li>EventEntryëŠ” ì´ë²¤íŠ¸ ë°œìƒ ì£¼ì²´ì— ëŒ€í•œ ì •ë³´ë¥¼ ê°–ì§€ ì•ŠëŠ”ë‹¤.</li>
      <li>íŠ¹ì • ì£¼ì²´ê°€ ë°œìƒì‹œí‚¨ ì´ë²¤íŠ¸ë§Œ ì¡°íšŒí•˜ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•  ìˆ˜ ì—†ë‹¤.</li>
      <li>ì´ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ë ¤ë©´ ì´ë²¤íŠ¸ì— ë°œìƒ ì£¼ì²´ ì •ë³´ë¥¼ ì¶”ê°€í•´ì•¼ í•œë‹¤.</li>
    </ul>
  </li>
  <li><strong>í¬ì›Œë”ì—ì„œ ì „ì†¡ ì‹¤íŒ¨ë¥¼ ì–¼ë§ˆë‚˜ í—ˆìš©í• ì§€?</strong>
    <ul>
      <li>í¬ì›Œë”ëŠ” ì´ë²¤íŠ¸ ì „ì†¡ì— ì‹¤íŒ¨í•˜ë©´ ì‹¤íŒ¨í•œ ì´ë²¤íŠ¸ë¶€í„° ë‹¤ì‹œ ì½ì–´ì™€ ì „ì†¡ì„ ì‹œë„í•œë‹¤.</li>
      <li>íŠ¹ì • ì´ë²¤íŠ¸ê°€ ê³„ì† ì‹¤íŒ¨í•œë‹¤ë©´?</li>
      <li>ì‹¤íŒ¨í•œ ì´ë²¤íŠ¸ì˜ ì¬ì „ì†¡ íšŸìˆ˜ ì œí•œì„ ë‘ì–´ì•¼ í•œë‹¤.</li>
      <li>ì‹¤íŒ¨í•œ ì´ë²¤íŠ¸ëŠ” ì‹¤íŒ¨ìš© DBë‚˜ ë©”ì‹œì§€ íì— ì €ì¥í•œë‹¤.</li>
    </ul>
  </li>
  <li><strong>ì´ë²¤íŠ¸ ì†ì‹¤ì€?</strong>
    <ul>
      <li>ì´ë²¤íŠ¸ ì €ì¥ì†Œë¥¼ ì‚¬ìš©í•˜ë©´ ì´ë²¤íŠ¸ ë°œìƒê³¼ ì´ë²¤íŠ¸ ì €ì¥ì„ í•œ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— íŠ¸ëœì­ì…˜ì— ì„±ê³µí•˜ë©´ ì´ë²¤íŠ¸ê°€ ì €ì¥ì†Œì— ë³´ê´€ëœë‹¤ëŠ” ê²ƒì„ ë³´ì¥í•  ìˆ˜ ìˆë‹¤.</li>
      <li>ì´ë²¤íŠ¸ë¥¼ ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬í•  ê²½ìš° ì´ë²¤íŠ¸ ì²˜ë¦¬ì— ì‹¤íŒ¨í•˜ë©´ ì´ë²¤íŠ¸ë¥¼ ìœ ì‹¤í•˜ê²Œ ëœë‹¤.</li>
    </ul>
  </li>
  <li><strong>ì´ë²¤íŠ¸ ìˆœì„œëŠ”?</strong>
    <ul>
      <li>ì´ë²¤íŠ¸ ë°œìƒ ìˆœì„œëŒ€ë¡œ ì™¸ë¶€ ì‹œìŠ¤í…œì— ì „ë‹¬í•´ì•¼ í•  ê²½ìš°ëŠ” ì´ë²¤íŠ¸ ì €ì¥ì†Œë¥¼ ì‚¬ìš©í•œë‹¤.</li>
      <li>ë©”ì‹œì§• ì‹œìŠ¤í…œì€ ì‚¬ìš© ê¸°ìˆ ì— ë”°ë¼ ì´ë²¤íŠ¸ ë°œìƒ ìˆœì„œì™€ ë©”ì‹œì§€ ìˆœì„œê°€ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤.</li>
    </ul>
  </li>
  <li><strong>ì´ë²¤íŠ¸ ì¬ì²˜ë¦¬ëŠ”?</strong>
    <ul>
      <li>ì´ë²¤íŠ¸ì˜ ìˆœë²ˆì„ ê¸°ì–µí•œë‹¤.</li>
      <li>ì´ë²¤íŠ¸ ë©±ë“±ì„±ìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤</li>
    </ul>
  </li>
</ul>

<p><strong>ë©±ë“±ì„±ì´ë€?</strong><br />
ì—°ì‚°ì„ ì—¬ëŸ¬ë²ˆ ì ìš©í•´ë„ ê²°ê³¼ê°€ ë‹¬ë¼ì§€ì§€ ì•ŠëŠ” ì„±ì§ˆì„ ë©±ë“±ì„±ì´ë¼ê³  í•œë‹¤.</p>

<h3 id="1061-ì´ë²¤íŠ¸-ì²˜ë¦¬ì™€-db-íŠ¸ëœì­ì…˜-ê³ ë ¤">10.6.1 ì´ë²¤íŠ¸ ì²˜ë¦¬ì™€ DB íŠ¸ëœì­ì…˜ ê³ ë ¤</h3>
<p>ì´ë²¤íŠ¸ ì²˜ë¦¬ë¥¼ ë™ê¸°ë¡œ í•˜ë“  ë¹„ë™ê¸°ë¡œ í•˜ë“  ì´ë²¤íŠ¸ ì²˜ë¦¬ ì‹¤íŒ¨ì™€ <strong>íŠ¸ëœì­ì…˜ ì‹¤íŒ¨ë¥¼ í•¨ê»˜ ê³ ë ¤</strong>í•´ì•¼ í•œë‹¤. íŠ¸ëœì­ì…˜ ì‹¤íŒ¨ì™€ ì´ë²¤íŠ¸ ì²˜ë¦¬ ì‹¤íŒ¨ ëª¨ë‘ ê³ ë ¤í•˜ë©´ ë³µì¡í•´ì§€ë¯€ë¡œ ê²½ìš°ì˜ ìˆ˜ë¥¼ ì¤„ì´ë©´ ë„ì›€ì´ ëœë‹¤. ê²½ìš°ì˜ ìˆ˜ë¥¼ ì¤„ì´ëŠ” ë°©ë²•ì€ <strong>íŠ¸ëœì­ì…˜ì´ ì„±ê³µí•  ë•Œë§Œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì‹¤í–‰í•˜ëŠ” ê²ƒì´ë‹¤.</strong></p>

<p>ìŠ¤í”„ë§ì€ <code class="language-plaintext highlighter-rouge">@TransactionalEventListener</code> ì—ë„ˆí…Œì´ì…˜ì„ ì§€ì›í•œë‹¤. ì´ ì• ë„ˆí…Œì´ì…˜ì€ íŠ¸ëœì­ì…˜ ìƒíƒœì— ë”°ë¼ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@TransactionalEventListener</span><span class="o">(</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="nc">OrderCanceledEvent</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="nc">TransactionPhase</span><span class="o">.</span><span class="na">AFTER_COMMIT</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="nc">OrderCanceledEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">refundService</span><span class="o">.</span><span class="na">refund</span><span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">getOrderNumber</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br />
<br />
<br /></p>

<h1 id="11-cqrs">11. CQRS</h1>
<h2 id="111-ë‹¨ì¼-ëª¨ë¸ì˜-ë‹¨ì ">11.1 ë‹¨ì¼ ëª¨ë¸ì˜ ë‹¨ì </h2>
<p>ì¡°íšŒ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ë ¤ë©´ ì—¬ëŸ¬ ì• ê·¸ë¦¬ê±°íŠ¸ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ì•¼ í•  ê²½ìš°ê°€ ë§ë‹¤. ì´ ë•Œ ì‹ë³„ìë¥¼ ì´ìš©í•œ ì°¸ì¡° ë°©ì‹ì´ë“ , ì§ì ‘ ì°¸ì¡°í•˜ëŠ” ë°©ì‹ì´ë“  ê³ ë¯¼í•´ì•¼ í•  ê²ƒë“¤ì´ ë§ë‹¤. ì´ëŠ” êµ¬í˜„ ë³µì¡ë„ë¥¼ ë†’ì¸ë‹¤.</p>

<p>ì´ëŸ° êµ¬í˜„ ë³µì¡ë„ë¥¼ ë‚®ì¶”ëŠ” ê°„ë‹¨í•œ ë°©ë²•ì´ ë°”ë¡œ CQRS (Command Query Responsibility Segregation, ëª…ë ¹ ì¡°íšŒ ì±…ì„ ë¶„ë¦¬)ë‹¤.</p>

<h2 id="112-cqrs">11.2 CQRS</h2>

<p><img src="/assets/images/posts/books/1/11_2_CQRSíŒ¨í„´.png" alt="CQRSíŒ¨í„´" width="80%" height="80%" /></p>

<p><br /></p>

<p><strong>CQRSë¥¼ ì‚¬ìš©í•˜ë©´ ê° ëª¨ë¸ì— ë§ëŠ” êµ¬í˜„ ê¸°ìˆ ì„ ì„ íƒí•  ìˆ˜ ìˆë‹¤.</strong></p>

<p><img src="/assets/images/posts/books/1/11_2_CQRS_3.png" alt="CQRS" width="70%" height="70%" /></p>

<p><img src="/assets/images/posts/books/1/11_2_CQRS_2.png" alt="CQRS_2" width="70%" height="70%" /></p>

<p>ë‹¨ìˆœíˆ ë°ì´í„°ë¥¼ ì½ì–´ì™€ ì¡°íšŒí•˜ëŠ” ê¸°ëŠ¥ì€ ì‘ìš© ì„œë¹„ìŠ¤ë¥¼ ì œì™¸í•  ìˆ˜ë„ ìˆë‹¤.</p>

<p><br /></p>

<p><strong>CQRSë¥¼ ì‚¬ìš©í•˜ë©´ ê° ëª¨ë¸ì— ë§ëŠ” ë°ì´í„° ì €ì¥ì†Œë¥¼ ì„ íƒí•  ìˆ˜ ìˆë‹¤.</strong></p>

<p><img src="/assets/images/posts/books/1/11_2_CQRS_4.png" alt="CQRS" width="70%" height="70%" /></p>

<p>ëª…ë ¹ ëª¨ë¸ì€ íŠ¸ëœì­ì…˜ì„ ì§€ì›í•˜ëŠ” RDBMSë¥¼ ì‚¬ìš©í•˜ê³ , ì¡°íšŒ ëª¨ë¸ì€ ì¡°íšŒ ì„±ëŠ¥ì´ ì¢‹ì€ ë©”ëª¨ë¦¬ ê¸°ë°˜ NoSQLì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<h3 id="1121-ì›¹ê³¼-cqrs">11.2.1 ì›¹ê³¼ CQRS</h3>
<p>ì¼ë°˜ì ì¸ ì›¹ ì„œë¹„ìŠ¤ëŠ” <strong>ìƒíƒœë¥¼ ë³€ê²½í•˜ëŠ” ìš”ì²­ë³´ë‹¤ ìƒíƒœë¥¼ ì¡°íšŒí•˜ëŠ” ìš”ì²­ì´ ë§ë‹¤</strong>. ëŒ€ê·œëª¨ íŠ¸ë˜í”½ì´ ë°œìƒí•˜ëŠ” ì›¹ ì„œë¹„ìŠ¤ëŠ” ì•Œê²Œ ëª¨ë¥´ê²Œ CQRSë¥¼ ì ìš©í•˜ê²Œ ëœë‹¤. <strong>ì¡°íšŒ ì†ë„ë¥¼ ë†’ì´ê¸° ìœ„í•´ ë³„ë„ ì²˜ë¦¬ë¥¼ í•˜ê³  ìˆë‹¤ë©´ CQRSë¥¼ ì ìš©í•˜ì</strong>. ì´ë¥¼ í†µí•´ <strong>ì¡°íšŒ ê¸°ëŠ¥ ë•Œë¬¸ì— ëª…ë ¹ ëª¨ë¸ì´ ë³µì¡í•´ì§€ëŠ” ê²ƒì„ ë§‰ì„ ìˆ˜ ìˆê³ , ëª…ë ¹ ëª¨ë¸ì— ê´€ê³„ì—†ì´ ì¡°íšŒ ê¸°ëŠ¥ì— íŠ¹í™”ëœ êµ¬í˜„ ê¸°ë²•ì„ ë³´ë‹¤ ì‰½ê²Œ ì ìš©í•  ìˆ˜ ìˆë‹¤</strong>.</p>

<h3 id="1122-cqrs-ì¥ë‹¨ì ">11.2.2 CQRS ì¥ë‹¨ì </h3>
<ul>
  <li>ì¥ì 
    <ul>
      <li>ëª…ë ¹ ëª¨ë¸ì„ êµ¬í˜„í•  ë•Œ ë„ë©”ì¸ ìì²´ì— ì§‘ì¤‘í•  ìˆ˜ ìˆë‹¤.</li>
      <li>ì¡°íšŒ ì„±ëŠ¥ í–¥ìƒì— ìœ ë¦¬</li>
    </ul>
  </li>
  <li>ë‹¨ì 
    <ul>
      <li>êµ¬í˜„í•´ì•¼ í•  ì½”ë“œê°€ ë” ë§ë‹¤.</li>
      <li>ë” ë§ì€ êµ¬í˜„ ê¸°ìˆ ì´ í•„ìš”í•˜ë‹¤.</li>
    </ul>
  </li>
</ul>

<p>ì¥ë‹¨ì ì„ ê³ ë ¤í•´ CQRS íŒ¨í„´ ë„ì… ì—¬ë¶€ë¥¼ ê²°ì •í•œë‹¤. ë„ë©”ì¸ì´ ë³µì¡í•˜ì§€ ì•Šì€ë° CQRSë¥¼ ë„ì…í•˜ë©´ ìœ ì§€ ë¹„ìš©ë§Œ ë†’ì•„ì§„ë‹¤. ë°˜ë©´ íŠ¸ë˜í”½ì´ ë†’ì€ ì„œë¹„ìŠ¤ì¸ë° ë‹¨ì¼ ëª¨ë¸ì„ ê³ ì§‘í•˜ë©´ ìœ ì§€ ë³´ìˆ˜ ë¹„ìš©ì´ ì˜¤íˆë ¤ ë†’ì•„ì§ˆ ìˆ˜ ìˆìœ¼ë¯€ë¡œ CQRS ë„ì…ì„ ê³ ë ¤í•˜ì.</p>

<p><br />
<br />
<br />
<br /></p>

<p><strong>ê°ì‚¬í•©ë‹ˆë‹¤</strong> ğŸ™‡ğŸ»â€â™‚ï¸</p>

<ul>
  <li><a href="https://product.kyobobook.co.kr/detail/S000001810495" target="_blank">ë„ë©”ì¸ ì£¼ë„ ê°œë°œ ì‹œì‘í•˜ê¸°: DDD í•µì‹¬ ê°œë… ì •ë¦¬ë¶€í„° êµ¬í˜„ê¹Œì§€</a></li>
  <li><a href="https://github.com/madvirus/ddd-start2" target="_blank">ì˜ˆì œ ì½”ë“œ</a></li>
</ul>]]></content><author><name>Sangjae Oh</name></author><category term="Books" /><category term="Books" /><category term="DDD" /><summary type="html"><![CDATA[ë„ë©”ì¸ ì£¼ë„ ê°œë°œ ì‹œì‘í•˜ê¸°: DDD í•µì‹¬ ê°œë… ì •ë¦¬ë¶€í„° êµ¬í˜„ê¹Œì§€ ì±…ì„ ì½ê³  ë‚´ìš©ì„ ì•„ì£¼ ê°„ë‹¨í•˜ê²Œ ì •ë¦¬í•œ ê¸€ì…ë‹ˆë‹¤. ì±…ì—ëŠ” ìì„¸í•œ ì„¤ëª…ê³¼ ì˜ˆì œê°€ ë§ìœ¼ë‹ˆ ê¼­ êµ¬ì…í•´ì„œ ì½ëŠ”ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤~ğŸ‘]]></summary></entry><entry><title type="html">ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸° - 8ì£¼ì°¨ (ì•ˆì •ì ì¸ ì„œë¹„ìŠ¤ ë§Œë“¤ê¸°)</title><link href="http://localhost:4000/%ED%9A%8C%EA%B3%A0/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BA%A0%ED%94%84pro5%EA%B8%B0-8%EC%A3%BC%EC%B0%A8/" rel="alternate" type="text/html" title="ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸° - 8ì£¼ì°¨ (ì•ˆì •ì ì¸ ì„œë¹„ìŠ¤ ë§Œë“¤ê¸°)" /><published>2023-01-08T00:00:00+09:00</published><updated>2023-01-08T00:00:00+09:00</updated><id>http://localhost:4000/%ED%9A%8C%EA%B3%A0/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BA%A0%ED%94%84pro5%EA%B8%B0-8%EC%A3%BC%EC%B0%A8</id><content type="html" xml:base="http://localhost:4000/%ED%9A%8C%EA%B3%A0/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BA%A0%ED%94%84pro5%EA%B8%B0-8%EC%A3%BC%EC%B0%A8/"><![CDATA[<p><em>2022ë…„ 10ì›” 24ì¼ ~ 2022ë…„ 12ì›” 23ì¼</em><br />
ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸°ë¥¼ ê²½í—˜í•œ ë‚´ìš© ê¸°ë¡ì…ë‹ˆë‹¤.</p>

<h2 id="ï¸-ë¯¸ì…˜-ì„¤ëª…">ğŸ™‡ğŸ»â€â™‚ï¸ ë¯¸ì…˜ ì„¤ëª…</h2>
<p>ì•ˆì •ì ì¸ ì„œë¹„ìŠ¤ë¥¼ ìœ„í•œ ì„±ëŠ¥ê°œì„ , ìŠ¤ì¼€ì¼ ì•„ì›ƒ, ì¿¼ë¦¬ ìµœì í™” ë“±ì„ ì§ì ‘ í•´ë³´ëŠ” ë¯¸ì…˜</p>

<h2 id="-í•™ìŠµ-ëª©í‘œ">ğŸ¯ í•™ìŠµ ëª©í‘œ</h2>
<ul>
  <li>HTTP ê°œì„ ì— ë”°ë¥¸ ì°¨ì´ë¥¼ ì´í•´í•˜ê³  Reverse Proxy ì„±ëŠ¥ ê°œì„ </li>
  <li>HTTP Cache ì „ëµì„ ì´í•´í•˜ì—¬ ì ì ˆí•œ ì •ì±…ì„ ì„¤ì •</li>
  <li>ì¿¼ë¦¬ë¥¼ ìµœì í™”í•˜ì—¬ ì¡°íšŒ ì„±ëŠ¥ì„ ê°œì„ </li>
  <li>ì¸ë±ìŠ¤ë¥¼ ì„¤ì •í•˜ì—¬ ì¡°íšŒ ì„±ëŠ¥ì„ ê°œì„ </li>
</ul>

<h2 id="-ê°•ì˜-ë‚´ìš©">ğŸ“– ê°•ì˜ ë‚´ìš©</h2>
<p>í™”ë©´ ì‘ë‹µ ê°œì„ ì„ ìœ„í•œ Nginx ì„¤ì •, AWS Auto Scaling Groupë¥¼ ì´ìš©í•œ ìŠ¤ì¼€ì¼ì•„ì›ƒ, MySql ì¿¼ë¦¬ ìµœì í™” ë° ì¸ë±ìŠ¤ ì„¤ê³„ ì„¤ëª…</p>

<h2 id="-ë¯¸ì…˜-í›„ê¸°">ğŸ“ ë¯¸ì…˜ í›„ê¸°</h2>
<p>ì´ë²ˆ ë¯¸ì…˜ì€ ì‹œê°„ ë¶€ì¡±ìœ¼ë¡œ 7ì£¼ì°¨ ë¯¸ì…˜ê³¼ ë³‘í–‰í•˜ë©´ ì§„í–‰í•˜ì˜€ë‹¤ ğŸ˜­</p>

<p>ê°•ì˜ë¥¼ í†µí•´ì„œ ë°°ìš´ Nginx ì„¤ì •, AWS Auto Scaling Groupë¥¼ ì´ìš©í•œ ìŠ¤ì¼€ì¼ì•„ì›ƒ ë“±ì€ ì§ì ‘ í•˜ë‚˜í•˜ë‚˜ ê²€ìƒ‰í•´ë³´ë©´ì„œ ì ìš© í•´ë³´ë ¤ë©´ ì—„ì²­ í˜ë“¤ê³  ì˜¤ë˜ëŠ” ì‘ì—…ì¸ë° ê°•ì˜ë¥¼ í†µí•´ ë°”ë¡œ ë°°ìš¸ ìˆ˜ ìˆì–´ì„œ ì¢‹ì•˜ê³ , MySql ì¿¼ë¦¬ ìµœì í™” ë° ì¸ë±ìŠ¤ ì„¤ê³„ëŠ” ì•ìœ¼ë¡œ DBì¡°íšŒë¥¼ í•  ë•Œ ì–´ë–¤ì ì„ ì£¼ì˜í•˜ë©´ì„œ queryë¥¼ ë§Œë“¤ì–´ì•¼ í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆì–´ì„œ ì¢‹ì•˜ë‹¤.</p>

<p>Auto Scaling Groupì„ ì„¤ì •í•  ë•Œ ì¸ìŠ¤í„´ìŠ¤ì˜ Health Checkê°€ ì•ˆë˜ì„œ ì™œ ì•ˆë˜ì§€ í•˜ë©° ëª‡ ì‹œê°„ì„ ê³ ë¯¼í–ˆëŠ”ë° ê°•ì˜ ì„¤ëª…ì— í•¨ì •ì¹´ë“œê°€ ì¡´ì¬ í–ˆì—ˆë‹¤. ê·¸ ì´ìœ ëŠ” Health Checkê°€ ë˜ê²Œ í•˜ë ¤ë©´ ì¸ìŠ¤í„´ìŠ¤ì— í¼ë¸”ë¦­ IPë¥¼ í• ë‹¹í•´ì£¼ì–´ì•¼ í•˜ëŠ”ë° ê°•ì˜ ì„¤ëª…ì—ëŠ” ê·¸ ë‚´ìš©ì´ ì—†ì—ˆë‹¤. ğŸ˜±<br />
<strong>ì•„ë˜ ì„¤ì •ë“¤ì€ ìì‹ ì˜ ìƒí™©ì— ë§ê²Œ ì„¸íŒ…í•©ë‹ˆë‹¤. ì´ë¯¸ì§€ì˜ ì •ë³´ëŠ” ë‹¨ìˆœ ì˜ˆì‹œì…ë‹ˆë‹¤.</strong> ë¼ëŠ” ê°•ì˜ ì„¤ëª… ë¬¸êµ¬ì˜ ì˜ë¯¸ë¥¼ ì˜ í™•ì¸ í–ˆì–´ì•¼ í–ˆë‹¤. 
ì•„ë§ˆ ë‚˜ê°™ì´ ë¬´ì‘ì • ë”°ë¼í•˜ëŠ” êµìœ¡ìƒë“¤ì€ ê½¤ë‚˜ ê³ ìƒí–ˆì„ê±° ê°™ë‹¤ ğŸ¤£</p>

<p>MySql ì¿¼ë¦¬ ìµœì í™” ë° ì¸ë±ìŠ¤ ì„¤ê³„ì˜ ê²½ìš° ì–´ë–»ê²Œ í•˜ë©´ ì¢€ ë” ì¡°íšŒê°€ ë¹¨ë¼ì§ˆê¹Œ í•˜ë©´ì„œ ID, ì°¸ì¡° ì»¬ëŸ¼ì™¸ì˜ ì»¬ëŸ¼ì—ë„ ì¸ë±ì‹± í•´ ë³´ì•˜ë‹¤. ê·¸ëŸ°ë° ì˜¤íˆë ¤ ì¡°íšŒ ì†ë„ê°€ ëŠë ¤ì§€ëŠ” ê²½ìš°ë„ ë°œìƒí•˜ì˜€ë‹¤.ğŸ˜±  ì¸ë±ìŠ¤ê°€ ë§ì€ ê²½ìš° ì˜¤íˆë ¤ ì¿¼ë¦¬ ì„±ëŠ¥ì´ ë–¨ì–´ì§„ë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.</p>

<p>ì´ë²ˆ ê°•ì˜ë¥¼ í†µí•´ ëŠë‚€ ì ì€ ì¸í”„ë¼ ì„¤ì •ì€ ì •ë§ ë§ì€ ë¶€ë¶„ì€ ì‹ ê²½ì¨ì•¼ í•˜ë©´ì„œ êµ¬ì„±í•˜ê¸°ë„ í˜ë“¤ë‹¤ëŠ” ì ê³¼ í…Œì´ë¸” ì¸ë±ìŠ¤ ì„¤ì •ê°™ì€ ê²½ìš° íŠ¹ìˆ˜í•œ ê²½ìš°ê°€ ì•„ë‹ˆë¼ë©´ ID, ì°¸ì¡° ì»¬ëŸ¼ì—ë§Œ ì¸ë±ì‹± í•˜ë©´ ì¢‹ì„ê±°ê°™ë‹¤ëŠ” ì ì´ë‹¤.</p>

<h2 id="-ì €ì¥ì†Œ">ğŸ’¾ ì €ì¥ì†Œ</h2>
<p><a href="https://github.com/sangjaeoh/infra-subway-performance/tree/step4" target="_blank">ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œ ë§í¬</a></p>]]></content><author><name>Sangjae Oh</name></author><category term="íšŒê³ " /><category term="íšŒê³ " /><category term="êµìœ¡" /><category term="ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸°" /><summary type="html"><![CDATA[2022ë…„ 10ì›” 24ì¼ ~ 2022ë…„ 12ì›” 23ì¼ ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸°ë¥¼ ê²½í—˜í•œ ë‚´ìš© ê¸°ë¡ì…ë‹ˆë‹¤.]]></summary></entry><entry><title type="html">ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸° - 7ì£¼ì°¨ (ë ˆê±°ì‹œ ì½”ë“œ ë¦¬íŒ©í„°ë§)</title><link href="http://localhost:4000/%ED%9A%8C%EA%B3%A0/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BA%A0%ED%94%84pro5%EA%B8%B0-7%EC%A3%BC%EC%B0%A8/" rel="alternate" type="text/html" title="ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸° - 7ì£¼ì°¨ (ë ˆê±°ì‹œ ì½”ë“œ ë¦¬íŒ©í„°ë§)" /><published>2023-01-08T00:00:00+09:00</published><updated>2023-01-08T00:00:00+09:00</updated><id>http://localhost:4000/%ED%9A%8C%EA%B3%A0/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BA%A0%ED%94%84pro5%EA%B8%B0-7%EC%A3%BC%EC%B0%A8</id><content type="html" xml:base="http://localhost:4000/%ED%9A%8C%EA%B3%A0/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BA%A0%ED%94%84pro5%EA%B8%B0-7%EC%A3%BC%EC%B0%A8/"><![CDATA[<p><em>2022ë…„ 10ì›” 24ì¼ ~ 2022ë…„ 12ì›” 23ì¼</em><br />
ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸°ë¥¼ ê²½í—˜í•œ ë‚´ìš© ê¸°ë¡ì…ë‹ˆë‹¤.</p>

<h2 id="ï¸-ë¯¸ì…˜-ì„¤ëª…">ğŸ™‡ğŸ»â€â™‚ï¸ ë¯¸ì…˜ ì„¤ëª…</h2>
<p>ë ˆê±°ì‹œ í”„ë¡œì íŠ¸ë¥¼ ë¦¬íŒ©í„°ë§í•˜ëŠ” ë¯¸ì…˜</p>

<h2 id="-í•™ìŠµ-ëª©í‘œ">ğŸ¯ í•™ìŠµ ëª©í‘œ</h2>
<ul>
  <li>ë ˆê±°ì‹œ í”„ë¡œì íŠ¸ë¥¼ ë¦¬íŒ©í„°ë§í•˜ëŠ” ê²½í—˜ì„ í†µí•´ ì„œë¹„ìŠ¤ë¥¼ ì•ˆì •ì ìœ¼ë¡œ ìš´ì˜í•˜ë©´ì„œ ë ˆê±°ì‹œ ì½”ë“œë¥¼ ë¦¬íŒ©í„°ë§í•  ìˆ˜ ìˆëŠ” ì—­ëŸ‰ì„ í‚¤ìš´ë‹¤.</li>
  <li>í”„ë¡œì íŠ¸ë¥¼ ë§Œë“œëŠ” ë‹¨ê³„ì—ì„œ ëë‚˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ í”„ë¡œì íŠ¸ë¥¼ ì™„ë£Œí•œ í›„ ì¼ì • ê¸°ê°„ ìœ ì§€ë³´ìˆ˜ë¥¼ í•¨ìœ¼ë¡œì¨ ë ˆê±°ì‹œ ì½”ë“œë¥¼ ë¦¬íŒ©í„°ë§í•˜ëŠ” ê²½í—˜ì„ ìŒ“ëŠ”ë‹¤.</li>
</ul>

<h2 id="-ê°•ì˜-ë‚´ìš©">ğŸ“– ê°•ì˜ ë‚´ìš©</h2>
<p>ë„ë©”ì¸ ì£¼ë„ ì„¤ê³„ ë° ì•„í‚¤í…ì²˜ì— ëŒ€í•´ ì„¤ëª…í•©ë‹ˆë‹¤.</p>

<p><strong>ì±… ì¶”ì²œ</strong></p>
<ul>
  <li><a href="https://product.kyobobook.co.kr/detail/S000001810495" target="_blank">ë„ë©”ì¸ ì£¼ë„ ê°œë°œ ì‹œì‘í•˜ê¸°: DDD í•µì‹¬ ê°œë… ì •ë¦¬ë¶€í„° êµ¬í˜„ê¹Œì§€</a></li>
  <li><a href="https://product.kyobobook.co.kr/detail/S000001766367" target="_blank">ì˜¤ë¸Œì íŠ¸</a></li>
</ul>

<h2 id="-ë¯¸ì…˜-í›„ê¸°">ğŸ“ ë¯¸ì…˜ í›„ê¸°</h2>
<p>ìš°í…Œìº  Pro ê³¼ì •ì˜ ì‚¬ì‹¤ìƒ ìµœì¢… ë³´ìŠ¤â€¦ ì§€ê¸ˆê¹Œì§€ì˜ ë¯¸ì…˜ë“¤ì€ ì‚¬ì‹¤ìƒ ì´ë²ˆ ë¯¸ì…˜ì„ í•˜ê¸° ìœ„í•œ ì¤€ë¹„ë‹¨ê³„ë¼ ì—¬ê²¨ë„ ë¬´ë°©í•˜ë‹¤ê³  ìƒê°ëœë‹¤.</p>

<p>ì´ë²ˆ ë¯¸ì…˜ì€ JDBC ì‚¬ìš©ê³¼ ì„œë¹„ìŠ¤ì—ì„œ ëª¨ë“  ë¹„ì¦ˆë‹ˆìŠ¤ êµ¬í˜„ì´ë¼ëŠ” ìš°ë¦¬ê°€ í”íˆ ì•„ëŠ” ë ˆê±°ì‹œ í”„ë¡œì íŠ¸ë¥¼ ì§€ê¸ˆê¹Œì§€ ë°°ìš´ ATDD, DDD, JPA, ê°ì²´ì§€í–¥ ìƒí™œ ì²´ì¡° ì›ì¹™, ì˜ì¡´ê´€ê³„ ì›ì¹™ ë“±ì„ í™œìš©í•˜ì—¬ ë¦¬íŒ©í„°ë§í•˜ëŠ” ë¯¸ì…˜ì´ì—ˆë‹¤.</p>

<p>ì²˜ìŒ ë”± ë ˆê±°ì‹œ í”„ë¡œì íŠ¸ë¥¼ ì—´ì—ˆì„ ë•Œ ë‚˜ë¦„ ì •ë¦¬ê°€ ì˜ ë˜ì–´ìˆì–´ì„œ ê¸ˆë°© ë¦¬íŒ©í„°ë§ í•  ìˆ˜ë„ ìˆì§€ ì•Šì„ê¹Œâ€¦? ë€ ì“°ë ˆê¸°ê°™ì€ ìƒê°ë„ í–ˆì—ˆë‹¤ ğŸ˜‚</p>

<p>1 ë‹¨ê³„. í…ŒìŠ¤íŠ¸ë¥¼ í†µí•œ ì½”ë“œ ë³´í˜¸ë¥¼ ìœ„í•´ ìš°ì„  ê¸°ì¡´ ë ˆê±°ì‹œ ì½”ë“œì˜ ëª¨ë“  ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ì— ëŒ€í•´ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ì˜€ë‹¤. ë­â€¦ ì—¬ê¸°ê¹Œì§€ëŠ” ìˆ˜ì›”í–ˆë‹¤.</p>

<p>2 ë‹¨ê³„. ì„œë¹„ìŠ¤ ë¦¬íŒ©í„°ë§ì„ ì‹œì‘í•˜ê³  ì§€ì˜¥ì´ ì‹œì‘ë˜ì—ˆë‹¤â€¦<br />
ìš°ì„ ì€ ë„ë©”ì¸ ë¶„ë¦¬ë¥¼ ì–´ë–»ê²Œ í• ê¹Œ ìƒê°ì„ í–ˆë‹¤. ì²˜ìŒë¶€í„° ì™„ë²½í•˜ê²Œ ë¶„ë¦¬í•  ìˆ˜ ìˆìœ¼ë©´ ì¢‹ê² ì§€ë§Œ ê·¸ëŸ¬ê¸°ëŠ” í˜ë“¤ì—ˆê³ , ì¼ë‹¨ ë ˆê±°ì‹œ í”„ë¡œì íŠ¸ì—ì„œ ë‚˜ë‰˜ì–´ì ¸ìˆë˜ íŒ¨í‚¤ì§€ êµ¬ì¡°ëŒ€ë¡œ ë¶„ë¦¬í•˜ê¸°ë¡œ í•˜ì˜€ë‹¤. í”„ë¡œì íŠ¸ë¥¼ ë¶„ì„í–ˆì„ ë•Œ ê°€ì¥ ì˜ì¡´ê´€ê³„ê°€ ì ì€ íŒ¨í‚¤ì§€ë¶€í„° ì°¨ê·¼ì°¨ê·¼ ë¦¬íŒ©í„°ë§ì„ í•˜ê¸° ì‹œì‘í•˜ì˜€ë‹¤. Entityë¡œ ë§¤í•‘í•˜ê³ , í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±í•˜ê³ , ë¹„ì§€ë‹ˆìŠ¤ë¡œì§ì„ ì„œë¹„ìŠ¤ì—ì„œ ë„ë©”ì¸ì„ ì˜®ê¸°ê³ , ì—ëŸ¬ ìˆ˜ì •í•˜ê³ , ë¦¬íŒ©í„°ë§í•˜ê³ â€¦ ê³„ì† ë°˜ë³µí•˜ì˜€ë‹¤.</p>

<p>ì²˜ìŒì—ëŠ” ë‹¤ë¥¸ íŒ¨í‚¤ì§€ì™€ì˜ ì˜ì¡´ê´€ê³„ê°€ ë³„ë¡œ ì—†ì–´ì„œ ê¸ˆë°© ë¦¬íŒ©í„°ë§ ë˜ì—ˆì§€ë§Œ ì§„í–‰ í•˜ë©´ í• ìˆ˜ë¡ ë‹¤ë¥¸ íŒ¨í‚¤ì§€ì™€ì˜ ì˜ì¡´ê´€ê³„ê°€ ëŠ˜ì–´ë‚˜ê³  ë¦¬íŒ©í„°ë§ í•  ë•Œ ë§ˆë‹¤ ì—ëŸ¬ê°€ ë¹µë¹µ í„°ì§€ê¸° ì‹œì‘í•˜ì˜€ë‹¤. <del>ë‚´ ë©˜íƒˆë„ ê°™ì´ í„°ì§â€¦</del></p>

<p>ì´ ë•Œ ê°€ì¥ í¬ê²Œ ì™€ ë‹¿ì•˜ë˜ ì ì€ í…ŒìŠ¤íŠ¸ ì½”ë“œì˜ ì¤‘ìš”ì„±ì´ì—ˆë‹¤. í…ŒìŠ¤íŠ¸ë¥¼ í†µí•œ ì½”ë“œ ë³´í˜¸ ë•ë¶„ì— ë¦¬íŒ©í„°ë§ì„ í•  ë•Œ ë‚´ê°€ ì œëŒ€ë¡œ ìˆ˜ì •í•˜ê³  ìˆëŠ”ì§€, ê¸°ëŠ¥ì— ì˜¤ë¥˜ê°€ ì—†ëŠ”ì§€ ë°”ë¡œë°”ë¡œ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤. ë˜ ë¦¬íŒ©í„°ë§ì„ ì§„í–‰í•˜ë‹¤ ë³´ë©´ ì´ì „ ë©”ì†Œë“œì˜ ê¸°ëŠ¥ì´ ë¬´ì—ˆì´ì—ˆëŠ”ì§€ í–‡ê°ˆë¦´ ê²½ìš°ê°€ ìˆëŠ”ë° ì´ ë•Œ í…ŒìŠ¤íŠ¸ ì½”íŠ¸ë¥¼ ë´„ìœ¼ë¡œì¨ ê¸°ëŠ¥ë“¤ì„ íŒŒì•…í•˜ê¸° ìˆ˜ì›”í•˜ë‹¤ëŠ” ì¥ì ë„ ìˆì—ˆë‹¤.</p>

<p>3 ë‹¨ê³„. ì˜ì¡´ì„± ë¦¬íŒ©í„°ë§
ì˜ì¡´ì„± ë¦¬íŒ©í„°ë§ì„ ì§„í–‰í•˜ë©´ì„œ <a href="https://www.youtube.com/watch?v=dJ5C4qRqAgA" target="_blank">[ìš°ì•„í•œí…Œí¬ì„¸ë¯¸ë‚˜] ìš°ì•„í•œê°ì²´ì§€í–¥</a> ì˜ìƒì„ ì¶œí‡´ê·¼ ì‹œê°„ì— ê³„ì† ëŒë ¤ë´¤ë‹¤. ê°ì²´ì§€í–¥ ì˜ì¡´ì„±ì— ëŒ€í•´ ì •ë§ ì•Œê¸° ì‰½ê²Œ ì„¤ëª…í•´ ì£¼ì–´ì„œ ì˜ì¡´ì„± ë¦¬íŒ©í„°ë§ì„ í•˜ë©° ì •ë§ ë§ì€ ë„ì›€ì´ ë˜ì—ˆë‹¤. 
ì‰½ê²Œ ìˆ ìˆ  í’€ë¦¬ë©´ ì¢‹ì•˜ê² ì§€ë§Œâ€¦ ì˜ì¡´ì„± ë¦¬íŒ©í„°ë§ì„ í•˜ë©° ì¢€ ì• ë§¤í•œ ë¶€ë¶„ë„ ìˆì—ˆë‹¤.</p>

<p>ì˜ˆë¥¼ ë“¤ìë©´ Product, Menu, MenuGroup ê°™ì€ ê²½ìš° ê°ê° ìƒì„±ë˜ëŠ” ì‹œê¸°ê°€ ë‹¤ë¥´ë‹¤. Product, MenuGroupì€ ë…ë¦½ì ìœ¼ë¡œ ìƒì„±ë  ìˆ˜ ìˆì§€ë§Œ MenuëŠ” ìƒì„±í•  ë•Œ Productì™€ MenuGroupê°€ í•„ìš”í•˜ë‹¤. ì¡°íšŒë„ Product, MenuGroupëŠ” ë…ë¦½ì ì´ì§€ë§Œ MenuëŠ” Product, MenuGroupê°€ ê°™ì´ í•„ìš”í•˜ë‹¤. ì´ëŸ´ ë•ŒëŠ” Product, Menu, MenuGroupë¥¼ í•œ íŒ¨í‚¤ì§€ë¡œ ë¬¶ëŠ”ê²Œ ë§ëŠ”ê°€? ë–¼ëŠ”ê²Œ ë§ëŠ”ê°€?</p>

<p>ë‹¤ë¥¸ ì˜ˆë¡œëŠ” OrderTableê³¼ TableGroupê³¼ì˜ ê´€ê³„ë„ ì´ì™€ ë¹„ìŠ·í–ˆë‹¤. OrderTableì€ ë…ë¦½ì ìœ¼ë¡œ ìƒì„±ë˜ì§€ë§Œ, TableGroupì€ ìƒì„±í•  ë•Œ OrderTableê°€ í•„ìš”í•˜ë‹¤. ê·¸ë ‡ë‹¤ê³  OrderTableì´ ì™„ì „íˆ ë…ë¦½ì ì´ì§€ë„ ì•Šê³  ì •ì±…ìƒ TableGroup ì—¬ë¶€ë¥¼ í™•ì¸í•´ì•¼ í•œë‹¤. ì´ëŸ´ ë•ŒëŠ” OrderTable, TableGroupë¥¼ í•œ íŒ¨í‚¤ì§€ë¡œ ë¬¶ëŠ”ê²Œ ë§ëŠ”ê°€? ë–¼ëŠ”ê²Œ ë§ëŠ”ê°€?</p>

<p>ë„ë©”ì¸ì„ ë¶„ë¦¬í•  ë•Œ íŠ¸ë Œì ì…˜ ë‹¨ìœ„ë¡œ ë¶„ë¦¬í•œë‹¤ê³  í•œë‹¤ë©´ ì „ë¶€ ë–¼ëŠ”ê²Œ ë§ëŠ”ê±° ê°™ê¸°ë„ í•˜ë©´ì„œ, ê·¸ë ‡ê²Œ ë˜ë©´ ë„ˆë¬´ ì„¸ì„¸í•˜ê²Œ ë¶„ë¦¬í•˜ê²Œ ë˜ì–´ ì˜¤íˆë ¤ ë…ì´ ë˜ëŠ”ê±° ê°™ê³ â€¦ ì •í•˜ê¸° ì–´ë ¤ì› ë‹¤. ğŸ˜±</p>

<p>ë‚˜ì˜ ê²½ìš°ì—ëŠ” í¬ê²Œ product, menu, order, tableë¡œ íŒ¨í‚¤ì§€ë¥¼ ë‚˜ëˆ„ê³  ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ ì˜ì¡´ ê´€ê³„ë¥¼ ë§ºì—ˆë‹¤.
<img src="/assets/images/posts/jwp_refactoring_step3_ì˜ì¡´ì„±.png" alt="jwp_refactoring_step3_ì˜ì¡´ì„±" /></p>

<p>4 ë‹¨ê³„. ë©€í‹° ëª¨ë“ˆ ì ìš©
ì´ë²ˆ ë‹¨ê³„ëŠ” Gradleì˜ ë©€í‹° ëª¨ë“ˆì„ ì´ìš©í•´ 3ë‹¨ê³„ì—ì„œ ë¶„ë¦¬í–ˆë˜ íŒ¨í‚¤ì§€ë“¤ì„ ëª¨ë“ˆë¡œ ë¶„ë¦¬í•˜ëŠ” ë‹¨ê³„ì˜€ë‹¤. ë‚´ ìƒê°ì—ëŠ” ìµœì¢…ì ìœ¼ë¡œëŠ” ëª¨ë“ˆ ê°ê°ì´ MSAë¡œ ë¶„ë¦¬ë˜ì–´ì•¼ í•˜ëŠ”ë° ì´ë¥¼ í”„ë¡œì íŠ¸ ë‹¨ìœ„ë¡œ ë¶„ë¦¬í•˜ëŠ”ê±´ ë¯¸ì…˜ì—ì„œ ì§„í–‰í•  ìˆ˜ ì—†ìœ¼ë‹ˆ Gradleì˜ ë©€í‹° ëª¨ë“ˆì„ ì´ìš©í•œê²Œ ì•„ë‹Œê°€ ì¶”ì¸¡í•´ë³¸ë‹¤. ğŸ¤”</p>

<p>ì´ë ‡ê²Œ ë ˆê±°ì‹œ ì½”ë“œ ë¦¬íŒ©í„°ë§ ë¯¸ì…˜ì„ 4ë‹¨ê³„ì— ê±¸ì³ ì§„í–‰í•˜ì˜€ë‹¤. ì´ë²ˆ ë¯¸ì…˜ì„ ì§„í–‰í•˜ë©´ì„œ ë„ˆë¬´ ì ì´ ë¶€ì¡±í•´ ì»¤í”¼ë¥¼ í•˜ë£¨ì— 3ì”ì”©ë„ ë§ˆì…¨ë‹¤. ğŸ˜± ê·¸ë§Œí¼ ë‚œì´ë„ë„ ë†’ì•˜ê³  ì‹œê°„ë„ ë¶€ì¡±í•œ ë¯¸ì…˜ì´ì—ˆë‹¤.<br />
ê·¸ë˜ë„ ì´ë²ˆ ë¯¸ì…˜ì„ í†µí•´ ë„ë©”ì¸ì„ ì–´ë–»ê²Œ ì„¤ê³„í•˜ë©´ ì¢‹ì„ì§€, í”„ë¡œê·¸ë˜ë°ì„ í•˜ë©´ì„œ ì˜ì¡´ê´€ê³„ë¥¼ ì–´ë–»ê²Œ ë§ºì–´ì•¼ í•˜ëŠ”ì§€ì— ëŒ€í•´ ë§ì´ ìƒê°í•´ ë³¼ ìˆ˜ ìˆì–´ì„œ ì¢‹ì€ ê²½í—˜ì´ ë˜ì—ˆë‹¤.
<del>ë„ë©”ì¸ ì„¤ê³„ë¥¼ í•´ë³´ë©´ì„œ ê°œì¸ì ìœ¼ë¡œ ëŠë‚€ì ìœ¼ë¡œëŠ” ë„ë©”ì¸ ì„¤ê³„ëŠ” íƒ€ê³ ë‚œ ì„¼ìŠ¤ê°€ ì–´ëŠì •ë„ í•„ìš”í•œê±° ê°™ë‹¤ëŠ” ì ì´ë‹¤ ğŸ˜‚</del></p>

<p>ì´ë²ˆ ë¯¸ì…˜ì—ì„œ ë‚˜ì˜ ë¬¸ì œì ì€ ë„ë©”ì¸ ì„¤ê³„ë¥¼ ì œëŒ€ë¡œ í–ˆëŠ”ì§€, íŒ¨í‚¤ì§€ê°„ ì˜ì¡´ê´€ê³„ë¥¼ ì œëŒ€ë¡œ ë§ºì—ˆëŠ”ì§€ í™•ì‹ ì´ ì•ˆì„ ë‹¤ëŠ” ì ì´ë‹¤. ë­”ê°€ ë” ì¢‹ì€ ë°©ë²•ì´ ë¶„ëª…íˆ ìˆì„ê±° ê°™ì€ë°â€¦ğŸ˜‚<br />
ë‹¤ë¥¸ ë¬¸ì œì ìœ¼ë¡œëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œì—ì„œì˜ ì—°ê´€ê´€ê³„ ë¶„ë¦¬ë¥¼ ì œëŒ€ë¡œ í•˜ì§€ ëª»í•´ ëª¨ë“ˆ ë¶„ë¦¬í•  ë•Œ ì—„ì²­ í˜ë“¤ì—ˆë‹¤ëŠ” ì ì´ë‹¤.</p>

<p>ìœ„ ë¬¸ì œì ì„ ê°œì„ í•˜ê¸° ìœ„í•´ DDDê´€ë ¨ ê¸€ì„ ì½ê³  ê³µë¶€, ì—°ìŠµì„ ë§ì´ í•´ë´ì•¼ í• ê±°ê°™ê³ , í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ì‹œì—ë„ ì˜ì¡´ê´€ê³„ë¥¼ ìƒê°í•´ì•¼í•  ê²ƒ ê°™ë‹¤(TestFixturesë“±ì„ ì´ìš©)</p>

<h2 id="-ì €ì¥ì†Œ">ğŸ’¾ ì €ì¥ì†Œ</h2>
<p><a href="https://github.com/sangjaeoh/jwp-refactoring/tree/step4" target="_blank">ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œ ë§í¬</a></p>]]></content><author><name>Sangjae Oh</name></author><category term="íšŒê³ " /><category term="íšŒê³ " /><category term="êµìœ¡" /><category term="ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸°" /><summary type="html"><![CDATA[2022ë…„ 10ì›” 24ì¼ ~ 2022ë…„ 12ì›” 23ì¼ ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸°ë¥¼ ê²½í—˜í•œ ë‚´ìš© ê¸°ë¡ì…ë‹ˆë‹¤.]]></summary></entry><entry><title type="html">MAC ë‹¨ì¶•í‚¤ ëª¨ìŒ ğŸ’»</title><link href="http://localhost:4000/mac/%EB%8B%A8%EC%B6%95%ED%82%A4/" rel="alternate" type="text/html" title="MAC ë‹¨ì¶•í‚¤ ëª¨ìŒ ğŸ’»" /><published>2023-01-08T00:00:00+09:00</published><updated>2023-01-08T00:00:00+09:00</updated><id>http://localhost:4000/mac/%EB%8B%A8%EC%B6%95%ED%82%A4</id><content type="html" xml:base="http://localhost:4000/mac/%EB%8B%A8%EC%B6%95%ED%82%A4/"><![CDATA[<h2 id="-ì¼ë°˜-ë‹¨ì¶•í‚¤">âŒ¨ ì¼ë°˜ ë‹¨ì¶•í‚¤</h2>
<ul>
  <li>í™”ë©´ ì ê¸ˆ: <strong>Control + Command + Q</strong></li>
  <li>ë³µì œ: <strong>Command + x</strong></li>
  <li>ë‹¤ì‹œì°¾ê¸°: <strong>Command + G</strong></li>
  <li>ìœˆë„ìš° ìµœì†Œí™”: <strong>Command + M</strong></li>
  <li>í”„ë¦°íŠ¸: <strong>Command + P</strong></li>
  <li>ë¶™ì—¬ë„£ê¸°: <strong>Command + V</strong></li>
  <li>ëª¨ë‘ì„ íƒ: <strong>Command + A</strong></li>
  <li>ë³µì‚¬: <strong>Command + C</strong></li>
  <li>ìˆ¨ê¸°ê¸°: <strong>Command + H</strong></li>
  <li>ì„ íƒí•­ëª© ì—´ê¸°: <strong>Command + O</strong></li>
  <li>ë¬¸ì„œ ì €ì¥: <strong>Command + S</strong></li>
  <li>ì´ì „ëª…ë ¹: <strong>Command + Z</strong></li>
  <li>í•­ëª©ì°¾ê¸°: <strong>Command + F</strong></li>
  <li>ìƒˆ íƒ­ ì—´ê¸°: <strong>Command + T</strong></li>
  <li>ì°½ ë‹«ê¸°: <strong>Command + W</strong></li>
  <li>ê°•ì œ ì¢…ë£Œ: <strong>Option + Command + Esc</strong></li>
  <li>Spotlight í‘œì‹œ/ìˆ¨ê¸°ê¸°: <strong>Command + Spacebar</strong></li>
  <li>ì´ëª¨í‹°ì½˜ ë° ê¸°íƒ€ ê¸°í˜¸: <strong>Ctrl + Command + Spacebar</strong></li>
  <li>ì „ì²´í™”ë©´: <strong>Ctrl + Command + F</strong></li>
  <li>ìŠ¤í¬ë¦°ìƒ· ë° í™”ë©´ ê¸°ë¡: <strong>Shift + Command + 5</strong></li>
  <li>ìƒˆí´ë” ìƒì„±: <strong>Shift + Command + N</strong></li>
  <li>í™˜ê²½ì„¤ì • ì—´ê¸°: <strong>Command + ,</strong></li>
  <li>ìµœê·¼ ì‚¬ìš© ì•±ìœ¼ë¡œ ì „í™˜: <strong>Command + Tab</strong></li>
  <li>í›‘ì–´ë³´ê¸°: <strong>Spacebar</strong></li>
</ul>

<h2 id="-finder-ë°-ì‹œìŠ¤í…œ-ë‹¨ì¶•í‚¤">âŒ¨ Finder ë° ì‹œìŠ¤í…œ ë‹¨ì¶•í‚¤</h2>
<ul>
  <li>ì„ íƒ íŒŒì¼ ë³µì œ: <strong>Command + D</strong></li>
  <li>Finder ìœˆë„ìš°ì—ì„œ Spotlight ê²€ìƒ‰ ì‹œì‘: <strong>Command + F</strong></li>
  <li>ì„ íƒ ë””ìŠ¤í¬ ë˜ëŠ” ë³¼ë¥¨ ì¶”ì¶œ: <strong>Command + E</strong></li>
  <li>ì„ íƒ íŒŒì¼ì˜ ì •ë³´ ê°€ì ¸ì˜¤ê¸°: <strong>Command + I</strong></li>
  <li>ê°€ìƒë³¸ì˜ ì›ë³¸ íŒŒì¼ì´ í˜•ì„±: <strong>Command + R</strong></li>
  <li>ì»´í“¨í„° ìœˆë„ìš° ì—´ê¸°: <strong>Shift + Command + C</strong></li>
  <li>ìµœê·¼ ìœˆë„ìš°/íŒŒì¼ í‘œì‹œ: <strong>Shift + Command + F</strong></li>
  <li>í˜„ì¬ macOS ì‚¬ìš©ì ê³„ì • í´ë” ì—´ê¸°: <strong>Shift + Command + H</strong></li>
  <li>ë°ìŠ¤í¬íƒ‘ í´ë” ì—´ê¸°: <strong>Shift + Command + D</strong></li>
  <li>í´ë”ë¡œ ì´ë™ ìœˆë„ìš° ì—´ê¸°: <strong>Shift + Command + G</strong></li>
  <li>iCloud Drive ì—´ê¸°: <strong>Shift + Command + I</strong></li>
  <li>ë„¤íŠ¸ìœ„í¬ ìœˆë„ìš° ì—´ê¸°: <strong>Shift + Command K</strong></li>
  <li>ìƒˆ í´ë” ìƒì„±: <strong>Shift + Command + N</strong></li>
  <li>Finder ë¯¸ë¦¬ë³´ê¸° íŒ¨ë„ í‘œì‹œ/ê°€ë¦¬ê¸°: <strong>Shift + Command + P</strong></li>
  <li>ë‹¤ìš´ë¡œë“œ í´ë” ì—´ê¸°: <strong>Shift + Command + L</strong></li>
  <li>ë¬¸ì„œ í´ë” ì—´ê¸°: <strong>Shift + Command + O</strong></li>
  <li>AirDrop ìœˆë„ìš° ì—´ê¸°: <strong>Shift + Command + R</strong></li>
</ul>

<h2 id="-ì°¸ê³ -ì‚¬ì´íŠ¸">ğŸ” ì°¸ê³  ì‚¬ì´íŠ¸</h2>
<p><a href="https://www.invaiz.com/blog/?q=YToxOntzOjEyOiJrZXl3b3JkX3R5cGUiO3M6MzoiYWxsIjt9&amp;bmode=view&amp;idx=12577409&amp;t=board" target="_blank">invaiz ë¸”ë¡œê·¸</a></p>]]></content><author><name>Sangjae Oh</name></author><category term="Mac" /><category term="Mac" /><category term="ë‹¨ì¶•í‚¤" /><summary type="html"><![CDATA[âŒ¨ ì¼ë°˜ ë‹¨ì¶•í‚¤ í™”ë©´ ì ê¸ˆ: Control + Command + Q ë³µì œ: Command + x ë‹¤ì‹œì°¾ê¸°: Command + G ìœˆë„ìš° ìµœì†Œí™”: Command + M í”„ë¦°íŠ¸: Command + P ë¶™ì—¬ë„£ê¸°: Command + V ëª¨ë‘ì„ íƒ: Command + A ë³µì‚¬: Command + C ìˆ¨ê¸°ê¸°: Command + H ì„ íƒí•­ëª© ì—´ê¸°: Command + O ë¬¸ì„œ ì €ì¥: Command + S ì´ì „ëª…ë ¹: Command + Z í•­ëª©ì°¾ê¸°: Command + F ìƒˆ íƒ­ ì—´ê¸°: Command + T ì°½ ë‹«ê¸°: Command + W ê°•ì œ ì¢…ë£Œ: Option + Command + Esc Spotlight í‘œì‹œ/ìˆ¨ê¸°ê¸°: Command + Spacebar ì´ëª¨í‹°ì½˜ ë° ê¸°íƒ€ ê¸°í˜¸: Ctrl + Command + Spacebar ì „ì²´í™”ë©´: Ctrl + Command + F ìŠ¤í¬ë¦°ìƒ· ë° í™”ë©´ ê¸°ë¡: Shift + Command + 5 ìƒˆí´ë” ìƒì„±: Shift + Command + N í™˜ê²½ì„¤ì • ì—´ê¸°: Command + , ìµœê·¼ ì‚¬ìš© ì•±ìœ¼ë¡œ ì „í™˜: Command + Tab í›‘ì–´ë³´ê¸°: Spacebar]]></summary></entry><entry><title type="html">ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸° - 6ì£¼ì°¨ (ì„œë¹„ìŠ¤ ì§„ë‹¨í•˜ê¸°)</title><link href="http://localhost:4000/%ED%9A%8C%EA%B3%A0/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BA%A0%ED%94%84pro5%EA%B8%B0-6%EC%A3%BC%EC%B0%A8/" rel="alternate" type="text/html" title="ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸° - 6ì£¼ì°¨ (ì„œë¹„ìŠ¤ ì§„ë‹¨í•˜ê¸°)" /><published>2023-01-07T00:00:00+09:00</published><updated>2023-01-07T00:00:00+09:00</updated><id>http://localhost:4000/%ED%9A%8C%EA%B3%A0/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BA%A0%ED%94%84pro5%EA%B8%B0-6%EC%A3%BC%EC%B0%A8</id><content type="html" xml:base="http://localhost:4000/%ED%9A%8C%EA%B3%A0/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BA%A0%ED%94%84pro5%EA%B8%B0-6%EC%A3%BC%EC%B0%A8/"><![CDATA[<p><em>2022ë…„ 10ì›” 24ì¼ ~ 2022ë…„ 12ì›” 23ì¼</em><br />
ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸°ë¥¼ ê²½í—˜í•œ ë‚´ìš© ê¸°ë¡ì…ë‹ˆë‹¤.</p>

<h2 id="ï¸-ë¯¸ì…˜-ì„¤ëª…">ğŸ™‡ğŸ»â€â™‚ï¸ ë¯¸ì…˜ ì„¤ëª…</h2>
<p>ì›¹ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸, ë¶€í•˜ í…ŒìŠ¤íŠ¸ ë° ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ì„ ì§ì ‘ í•´ë³´ëŠ” ë¯¸ì…˜</p>

<h2 id="-í•™ìŠµ-ëª©í‘œ">ğŸ¯ í•™ìŠµ ëª©í‘œ</h2>
<ul>
  <li>ì›¹ ì„±ëŠ¥í…ŒìŠ¤íŠ¸</li>
  <li>ë¶€í•˜í…ŒìŠ¤íŠ¸</li>
  <li>ëª¨ë‹ˆí„°ë§</li>
</ul>

<h2 id="-ê°•ì˜-ë‚´ìš©">ğŸ“– ê°•ì˜ ë‚´ìš©</h2>
<p>ì›¹ ì„±ëŠ¥í…ŒìŠ¤íŠ¸, ë¶€í•˜ í…ŒìŠ¤íŠ¸ ë° ëª¨ë‹ˆí„°ë§ì˜ ì„¤ëª…ê³¼ í•¨ê»˜ PageSpeed, k6, Cloudwatch ë“±ì„ ì´ìš©í•´ ì§ì ‘ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆë„ë¡ ì„¤ëª…</p>

<p><strong>ë¶€í•˜ í…ŒìŠ¤íŠ¸</strong><br />
<em>1. ëª©í‘œ rps êµ¬í•˜ê¸°</em></p>
<ul>
  <li>ìš°ì„  ì˜ˆìƒ 1ì¼ ì‚¬ìš©ì ìˆ˜(DAU)ë¥¼ ì •í•´ë´…ë‹ˆë‹¤.</li>
  <li>í”¼í¬ ì‹œê°„ëŒ€ì˜ ì§‘ì¤‘ë¥ ì„ ì˜ˆìƒí•´ë´…ë‹ˆë‹¤. (ìµœëŒ€ íŠ¸ê°œí”½ / í‰ì†Œ íŠ¸ë˜í”½)</li>
  <li>1ëª…ë‹¹ 1ì¼ í‰ê·  ì ‘ì† í˜¹ì€ ìš”ì²­ìˆ˜ë¥¼ ì˜ˆìƒí•´ë´…ë‹ˆë‹¤.</li>
  <li>ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ Throughputì„ ê³„ì‚°í•©ë‹ˆë‹¤.
    <ul>
      <li>Throughput : 1ì¼ í‰ê·  rps ~ 1ì¼ ìµœëŒ€ rps
        <ul>
          <li>1ì¼ ì‚¬ìš©ì ìˆ˜(DAU) x 1ëª…ë‹¹ 1ì¼ í‰ê·  ì ‘ì† ìˆ˜ = 1ì¼ ì´ ì ‘ì† ìˆ˜</li>
          <li>1ì¼ ì´ ì ‘ì† ìˆ˜ / 86,400 (ì´ˆ/ì¼) = 1ì¼ í‰ê·  rps</li>
          <li>1ì¼ í‰ê·  rps x (ìµœëŒ€ íŠ¸ë˜í”½ / í‰ì†Œ íŠ¸ë˜í”½) = 1ì¼ ìµœëŒ€ rps</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><em>2. VUser êµ¬í•˜ê¸°</em></p>
<ul>
  <li>Request Rate: measured by the number of requests per second (RPS)</li>
  <li>VU: the number of virtual users</li>
  <li>R: the number of requests per VU iteration</li>
  <li>T: a value larger than the time needed to complete a VU iteration
    <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>T = (R * http_req_duration) (+ 1s)
VUser = (ëª©í‘œ rps * T) / R
</code></pre></div>    </div>
  </li>
</ul>

<p><br /></p>

<p><strong>ë¡œê¹… ì£¼ì˜ì </strong></p>
<ul>
  <li>Avoid side effects
    <ul>
      <li>loggingìœ¼ë¡œ ì¸í•´ ì• í”Œë¦¬ì¼€ì´ì…˜ ê¸°ëŠ¥ì˜ ë™ì‘ì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šì•„ì•¼ í•©ë‹ˆë‹¤.</li>
      <li>ì˜ˆë¥¼ ë“¤ì–´ loggingí•˜ëŠ” ì‹œì ì— NullPointerExceptionì´ ë°œìƒí•´ í”„ë¡œê·¸ë¨ì´ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ì§€ ì•ŠëŠ” ìƒí™©ì´ ë°œìƒí•˜ë©´ ì•ˆë©ë‹ˆë‹¤.</li>
    </ul>
  </li>
  <li>Be concise and descriptive
    <ul>
      <li>ê° Loggingì—ëŠ” ë°ì´í„°ì™€ ì„¤ëª…ì´ ëª¨ë‘ í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.</li>
    </ul>
  </li>
  <li>Log method arguments and return values
    <ul>
      <li>ë©”ì†Œë“œì˜ inputê³¼ outputì„ ë¡œê·¸ë¡œ ë‚¨ê¸°ë©´ debuggerë¥¼ ì‚¬ìš©í•´ ë””ë²„ê¹…í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤.</li>
      <li>AOPë¥¼ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
    </ul>
  </li>
  <li>Delete personal information
    <ul>
      <li>ë¡œê·¸ì— ì‚¬ìš©ìì˜ ì „í™”ë²ˆí˜¸, ê³„ì¢Œë²ˆí˜¸, íŒ¨ìŠ¤ì›Œë“œ, ì£¼ì†Œ, ì „í™”ë²ˆí˜¸ì™€ ê°™ì€ ê°œì¸ì •ë³´ë¥¼ ë‚¨ê¸°ì§€ ì•ŠìŠµë‹ˆë‹¤.</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<p><strong>ë¡œê¹… ë ˆë²¨</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">ERROR</code>: ì˜ˆìƒí•˜ì§€ ëª»í•œ ì‹¬ê°í•œ ë¬¸ì œê°€ ë°œìƒí•˜ì—¬ ì¦‰ì‹œ ì¡°ì‚¬í•´ì•¼ í•¨</li>
  <li><code class="language-plaintext highlighter-rouge">WARN</code>: ë¡œì§ìƒ ìœ íš¨ì„± í™•ì¸, ì˜ˆìƒ ê°€ëŠ¥í•œ ë¬¸ì œë¡œ ì¸í•œ ì˜ˆì™¸ì²˜ë¦¬ ë“±ì„ ë‚¨ê¹€, ì„œë¹„ìŠ¤ëŠ” ìš´ì˜ë  ìˆ˜ ìˆì§€ë§Œ, ì£¼ì˜í•´ì•¼ í•¨</li>
  <li><code class="language-plaintext highlighter-rouge">INFO</code>: ìš´ì˜ì— ì°¸ê³ í• ë§Œí•œ ì‚¬í•­ìœ¼ë¡œ, ì¤‘ìš”í•œ ë¹„ì¦ˆë‹ˆìŠ¤ í”„ë¡œì„¸ìŠ¤ê°€ ì™„ë£Œë¨</li>
  <li><code class="language-plaintext highlighter-rouge">DEBUG</code> / <code class="language-plaintext highlighter-rouge">TRACE</code>: ê°œë°œ ë‹¨ê³„ì—ì„œë§Œ ì‚¬ìš©í•˜ê³  ìš´ì˜ ë‹¨ê³„ì—ì„œëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŒ</li>
</ul>

<h2 id="-ë¯¸ì…˜-í›„ê¸°">ğŸ“ ë¯¸ì…˜ í›„ê¸°</h2>
<p>ì´ë²ˆ ë¯¸ì…˜ì—ì„œëŠ” ìƒˆë¡œìš´ ë¶€í•˜í…ŒìŠ¤íŠ¸ ë°©ë²•ê³¼ ì„œë²„, ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê¹…ì„ í•´ë³¼ ìˆ˜ ìˆì–´ì„œ ì¢‹ì•˜ë‹¤.</p>

<p>ê¸°ì¡´ì— ë¶€í•˜í…ŒìŠ¤íŠ¸ í•  ë•ŒëŠ” JMeterë¥¼ ì‚¬ìš©í–ˆì—ˆëŠ”ë°, ì´ë²ˆì— k6ë¼ëŠ” ê²ƒì„ ì²˜ìŒ ì•Œì•˜ê³  ì‹¤ì œë¡œ ì‚¬ìš©í•´ë³´ë‹ˆê¹Œ JMeterë³´ë‹¤ í›¨ì”¬ ì‚¬ìš©í•˜ê¸°ê°€ í¸í–ˆë‹¤.
ë˜ grafanaì™€ ì—°ê³„í•´ì„œ ë°ì´í„°ë¥¼ ì‹œê°í™” í•´ë³´ë‹ˆ JMeterë³´ë‹¤ í›¨ì”¬ ì´ì˜ê²Œ ë‚˜ì™€ì„œ ë”ìš± ë§ˆìŒì— ë“¤ì—ˆë‹¤. ğŸ˜</p>

<p>ë¡œê¹…, ëª¨ë‹ˆí„°ë§ ê°™ì€ ê²½ìš°ëŠ” AWSì—ì„œ Cloudwatchë¥¼ í™œìš©í•´ì„œ ì–´ë–»ê²Œ ec2 access log, metric logë¥¼ ìˆ˜ì§‘í•˜ëŠ”ì§€, ëŒ€ì‹œë³´ë“œì— ì–´ë–»ê²Œ í‘œí˜„í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆì—ˆë‹¤.
ë‹¤ë§Œ ê°œì¸ì ìœ¼ë¡œëŠ” Cloudwatchê°€ ì¢€ ëœ ì´ì˜ê³ , ì•½ê°„ ë¶ˆí¸í•˜ë‹¤? ë¼ëŠ” ëŠë‚Œì´ ìˆì—ˆë‹¤. ğŸ˜…</p>

<p>ì´ë²ˆ ê°•ì˜ë¥¼ í†µí•´ k6ì™€ ë¶€í•˜í…ŒìŠ¤íŠ¸ì˜ ë°©ë²•ì„ ë°°ì› ìœ¼ë‹ˆ, ì•ìœ¼ë¡œ APIë¥¼ ê°œë°œí•  ë•Œë§ˆë‹¤ ê°„ë‹¨í•˜ê²Œ í…ŒìŠ¤íŠ¸ í•´ë³´ë©´ ì¢‹ì„ê²ƒ ê°™ë‹¤. ğŸ‘</p>

<h2 id="-ì €ì¥ì†Œ">ğŸ’¾ ì €ì¥ì†Œ</h2>
<p><a href="https://github.com/sangjaeoh/infra-subway-monitoring/tree/step3" target="_blank">ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œ ë§í¬</a></p>]]></content><author><name>Sangjae Oh</name></author><category term="íšŒê³ " /><category term="íšŒê³ " /><category term="êµìœ¡" /><category term="ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸°" /><summary type="html"><![CDATA[2022ë…„ 10ì›” 24ì¼ ~ 2022ë…„ 12ì›” 23ì¼ ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸°ë¥¼ ê²½í—˜í•œ ë‚´ìš© ê¸°ë¡ì…ë‹ˆë‹¤.]]></summary></entry><entry><title type="html">ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸° - 5ì£¼ì°¨ (ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ ê¸°ë°˜ TDD)</title><link href="http://localhost:4000/%ED%9A%8C%EA%B3%A0/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BA%A0%ED%94%84pro5%EA%B8%B0-5%EC%A3%BC%EC%B0%A8/" rel="alternate" type="text/html" title="ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸° - 5ì£¼ì°¨ (ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ ê¸°ë°˜ TDD)" /><published>2023-01-05T00:00:00+09:00</published><updated>2023-01-05T00:00:00+09:00</updated><id>http://localhost:4000/%ED%9A%8C%EA%B3%A0/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BA%A0%ED%94%84pro5%EA%B8%B0-5%EC%A3%BC%EC%B0%A8</id><content type="html" xml:base="http://localhost:4000/%ED%9A%8C%EA%B3%A0/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BA%A0%ED%94%84pro5%EA%B8%B0-5%EC%A3%BC%EC%B0%A8/"><![CDATA[<p><em>2022ë…„ 10ì›” 24ì¼ ~ 2022ë…„ 12ì›” 23ì¼</em><br />
ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸°ë¥¼ ê²½í—˜í•œ ë‚´ìš© ê¸°ë¡ì…ë‹ˆë‹¤.</p>

<h2 id="ï¸-ë¯¸ì…˜-ì„¤ëª…">ğŸ™‡ğŸ»â€â™‚ï¸ ë¯¸ì…˜ ì„¤ëª…</h2>
<p>ì§€í•˜ì²  ë…¸ì„ ë„ ì„œë¹„ìŠ¤ì„ êµ¬í˜„í•˜ë©´ì„œ ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ ê¸°ë°˜ TDDë¥¼ ì§„í–‰í•˜ëŠ” ë¯¸ì…˜</p>

<h2 id="-í•™ìŠµ-ëª©í‘œ">ğŸ¯ í•™ìŠµ ëª©í‘œ</h2>
<ul>
  <li>ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ ê¸°ë°˜ì˜ TDD ê²½í—˜</li>
  <li>ë¡œê·¸ì¸ ìƒíƒœ ì¸ìˆ˜ í…ŒìŠ¤íŠ¸</li>
</ul>

<h2 id="-ê°•ì˜-ë‚´ìš©">ğŸ“– ê°•ì˜ ë‚´ìš©</h2>
<p>ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ ê¸°ë°˜ìœ¼ë¡œ TDDë¥¼ ì§„í–‰í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•˜ê³ , ë‹¨ìœ„í…ŒìŠ¤íŠ¸ì™€ í†µí•©í…ŒìŠ¤íŠ¸ ì„¤ëª…, ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ ê¸°ë°˜ìœ¼ë¡œ ë¦¬íŒ©í„°ë§ ë°©ë²•, ì¸ì¦ê¸°ë°˜ ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ ë°©ë²•ì„ ì„¤ëª…</p>

<p><strong>ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë€?</strong></p>
<ul>
  <li>ì‘ì€ ì½”ë“œ ì¡°ê°(ë‹¨ìœ„)ì„ ê²€ì¦</li>
  <li>ë¹ ë¥´ê²Œ ìˆ˜í–‰ ê°€ëŠ¥</li>
  <li>ê²©ë¦¬ëœ ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬</li>
</ul>

<p><strong>í†µí•©ê³¼ ê³ ë¦½(Sociable and Solitary)</strong></p>
<ul>
  <li>ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„± ì‹œ ê´€ê³„ë¥¼ ë§ºê³  ìˆëŠ” ëŒ€ìƒ(í˜‘ë ¥ ê°ì²´)ì´ ìˆëŠ” ê²½ìš°ë¥¼ ê³ ë ¤í•´ì•¼ í•¨</li>
  <li>í˜‘ë ¥ ê°ì²´ë¥¼ ì‹¤ì œ ê°ì²´ë¡œ ì‚¬ìš©í•˜ëŠ”ì§€ Mock(ê°€ì§œ) ê°ì²´ë¡œ ì‚¬ìš©í•˜ëŠ”ì§€ì— ë”°ë¼ í…ŒìŠ¤íŠ¸ êµ¬í˜„ì´ ë‹¬ë¼ì§
<img src="/assets/images/posts/sociable_and_solitary.png" alt="sociable_and_solitary" /></li>
</ul>

<p><strong>Test Double</strong></p>
<ul>
  <li>ì‹¤ì œ ê°ì²´ ëŒ€ì‹  ì‚¬ìš©ë˜ëŠ” ëª¨ë“  ì¢…ë¥˜ì˜ ê°ì²´ì— ëŒ€í•œ ì¼ë°˜ ìš©ì–´</li>
  <li>ì¦‰, ì‹¤ì œ (ì˜ˆ : í´ë˜ìŠ¤, ëª¨ë“ˆ ë˜ëŠ” í•¨ìˆ˜)ë¥¼ ê°€ì§œ ë²„ì „ìœ¼ë¡œ ëŒ€ì²´í•œë‹¤ëŠ” ì˜ë¯¸
<img src="/assets/images/posts/test_double.png" alt="test_double" /></li>
  <li>Dummy: ê°ì²´ëŠ” ì „ë‹¬ë˜ì§€ë§Œ, ì‹¤ì œë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. ì¢…ì¢… íŒŒë¼ë¯¸í„° ë¦¬ìŠ¤íŠ¸ë¥¼ ì±„ìš°ê¸° ìœ„í•´ ì‚¬ìš©</li>
  <li>Fake: ë™ì‘ì˜ êµ¬í˜„ì„ ê°€ì§€ê³  ìˆì§€ë§Œ, í”„ë¡œë•ì…˜ì— ì í•©í•˜ì§€ ì•Šì€ ê°„ê²°í•œì„ ì œê³µ</li>
  <li>Stub: í…ŒìŠ¤íŠ¸ ì§„í–‰ ì¤‘ì— í˜¸ì¶œì— ëŒ€í•œ ë¯¸ë¦¬ ì¤€ë¹„ëœ ì‘ë‹µì„ ì œê³µí•˜ê³ , ì¤€ë¹„ëœ ì‘ë‹µ ì´ì™¸(ì¼ë°˜ì ì¸ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ í”„ë¡œê·¸ë˜ë° êµ¬í˜„)ì˜ í•­ëª©ì—ëŠ” ì „í˜€ ì‘ë‹µí•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
  <li>Spy: ì–´ë–»ê²Œ í˜¸ì¶œëëŠ”ì§€ì— ë”°ë¼ íŠ¹ì • ì •ë³´ë¥¼ í‘œí˜„í•˜ëŠ” ìŠ¤íŒŒì´ë„ ìŠ¤í…ì´ë‹¤.</li>
  <li>Mock: ê¸°ëŒ€ëœ í˜¸ì¶œì˜ êµ¬ì²´ì ì¸ í˜•ì‹ì„ ê¸°ëŒ€í•˜ëŠ” ë¯¸ë¦¬ í”„ë¡œê·¸ë˜ë°ëœ ê°ì²´ì´ë‹¤.</li>
</ul>

<p><br /></p>

<p><strong>Stub</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">calculates_grades_average_for_student</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">when</span><span class="o">(</span><span class="n">gradebook</span><span class="o">.</span><span class="na">gradesFor</span><span class="o">(</span><span class="n">student</span><span class="o">)).</span><span class="na">thenReturn</span><span class="o">(</span><span class="n">grades</span><span class="o">(</span><span class="mi">8</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">10</span><span class="o">));</span> <span class="c1">// stubbing</span>

    <span class="kt">double</span> <span class="n">averageGrades</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GradesService</span><span class="o">(</span><span class="n">gradebook</span><span class="o">).</span><span class="na">averageGrades</span><span class="o">(</span><span class="n">student</span><span class="o">);</span>

    <span class="n">assertThat</span><span class="o">(</span><span class="n">averageGrades</span><span class="o">).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="mf">8.0</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<p><strong>Mock</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Window</span> <span class="n">windowMock</span> <span class="o">=</span> <span class="n">mock</span><span class="o">(</span><span class="nc">Window</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="nc">Door</span> <span class="n">doorMock</span> <span class="o">=</span> <span class="n">mock</span><span class="o">(</span><span class="nc">Door</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">enabling_security_locks_windows_and_doors</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">SecurityCentral</span> <span class="n">securityCentral</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SecurityCentral</span><span class="o">(</span><span class="n">windowMock</span><span class="o">,</span> <span class="n">doorMock</span><span class="o">);</span>

    <span class="n">securityCentral</span><span class="o">.</span><span class="na">securityOn</span><span class="o">();</span>

    <span class="n">verify</span><span class="o">(</span><span class="n">doorMock</span><span class="o">).</span><span class="na">close</span><span class="o">();</span>
    <span class="n">verify</span><span class="o">(</span><span class="n">windowMock</span><span class="o">).</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<p><strong>í†µí•© vs ê³ ë¦½</strong></p>
<ul>
  <li>í˜‘ë ¥ ê°ì²´ë¥¼ ì‹¤ì œ ê°ì²´ë¡œ? ê°€ì§œ ê°ì²´ë¡œ?
    <ul>
      <li>ì‹¤ì œ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ë©´ í˜‘ë ¥ ê°ì²´ì˜ í–‰ìœ„ë¥¼ í˜‘ë ¥ ê°ì²´ ìŠ¤ìŠ¤ë¡œê°€ ì •ì˜</li>
      <li>ê°€ì§œ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ë©´ í˜‘ë ¥ ê°ì²´ì˜ í–‰ìœ„ë¥¼ í…ŒìŠ¤íŠ¸ê°€ ì •ì˜</li>
    </ul>
  </li>
  <li>ê°€ì§œ ê°ì²´(í…ŒìŠ¤íŠ¸ ë”ë¸”)ë¥¼ ì‚¬ìš©í•  ê²½ìš°
    <ul>
      <li>í…ŒìŠ¤íŠ¸ ëŒ€ìƒì„ ê²€ì¦í•  ë•Œ ì™¸ë¶€ ìš”ì¸(í˜‘ë ¥ ê°ì²´)ìœ¼ë¡œ ë¶€í„° ì² ì €íˆ ê²©ë¦¬</li>
      <li>í•˜ì§€ë§Œ í…ŒìŠ¤íŠ¸ê°€ í˜‘ë ¥ ê°ì²´ì˜ ìƒì„¸ êµ¬í˜„ì„ ì•Œì•„ì•¼ í•¨</li>
    </ul>
  </li>
  <li>ì‹¤ì œ ê°ì²´ë¥¼ ì‚¬ìš©í•  ê²½ìš°
    <ul>
      <li>ì‹¤ì œ ê°ì²´ë¥¼ ì‚¬ìš© í•  ê²½ìš° í˜‘ë ¥ ê°ì²´ì˜ ìƒì„¸ êµ¬í˜„ì— ëŒ€í•´ì„œ ì•Œ í•„ìš”ê°€ ì—†ìŒ</li>
      <li>í•˜ì§€ë§Œ í˜‘ë ¥ ê°ì²´ì˜ ì •ìƒ ë™ì‘ ì—¬ë¶€ì— ì˜í–¥ì„ ë°›ìŒ</li>
    </ul>
  </li>
  <li>í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•  ë•Œ
    <ul>
      <li>ê°€ì§œ ê°ì²´ë¥¼ í™œìš©í•˜ë©´ ì‹¤ì œ ê°ì²´ë¥¼ ì‚¬ìš©í•  ë•Œ ë³´ë‹¤ ì¡°ê¸ˆ ë” í¸í•˜ê²Œ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŒ</li>
      <li>í•˜ì§€ë§Œ ìƒì„¸ êµ¬í˜„ì— ì˜ì¡´í•˜ëŠ” í…ŒìŠ¤íŠ¸ê°€ ë  ìˆ˜ ìˆìŒ</li>
    </ul>
  </li>
  <li>ì¶”ì²œí•˜ëŠ” ë°©ë²•
    <ul>
      <li>TDDë¥¼ ì—°ìŠµí•  ë•ŒëŠ” ê°€ê¸‰ì ì´ë©´ ì‹¤ì œ ê°ì²´ë¥¼ í™œìš©í•˜ëŠ” ê²ƒì„ ìš°ì„ ìœ¼ë¡œ ì§„í–‰</li>
      <li>í…ŒìŠ¤íŠ¸ ì‘ì„±ì´ ì–´ë µê±°ë‚˜ íë¦„ì´ ì˜ ì´ì–´ì§€ì§€ ì•ŠëŠ”ë‹¤ë©´ í…ŒìŠ¤íŠ¸ ë”ë¸”ì„ í™œìš©í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ì ‘ê·¼í•˜ì‹œëŠ” ê²ƒì„ ì¶”ì²œ</li>
    </ul>
  </li>
</ul>

<h2 id="-ë¯¸ì…˜-í›„ê¸°">ğŸ“ ë¯¸ì…˜ í›„ê¸°</h2>
<p>ë¯¸ì…˜ì´ ì§„í–‰ë ìˆ˜ë¡ ì ì  ì–´ë ¤ì›Œì¡Œê³ , ì‹œê°„ì´ ë¶€ì¡±í•´ì§€ê¸° ì‹œì‘í–ˆë‹¤. í‰ì†Œì— ì˜ ë§ˆì‹œì§€ ì•Šë˜ ì»¤í”¼ë¥¼ ë¯¸ì…˜ì„ ì§„í–‰í•˜ëŠ” ë™ì•ˆ ë§¤ì¼ ë§ˆì‹œê²Œ ë˜ì—ˆë‹¤.</p>

<p>ì´ë²ˆ ë¯¸ì…˜ì€ ë¦¬íŒ©í„°ë§, ê²½ë¡œ ì¡°íšŒ ê¸°ëŠ¥, ì¸ì¦ì„ í†µí•œ ê¸°ëŠ¥, ìš”ê¸ˆ ì¡°íšŒ ë“±ì„ êµ¬í˜„í•˜ë©´ì„œ ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ì™€ TDDë¥¼ ì‹¬í™”í•˜ëŠ” ê³¼ì •ì´ì—ˆë‹¤.</p>

<p>ì´ë²ˆ ë¯¸ì…˜ ê°™ì€ ê²½ìš° ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ ë§Œë“¤ê³ , ë„ë©”ì¸ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ í•˜ê³ , ì„œë¹„ìŠ¤ í†µí•© í…ŒìŠ¤íŠ¸ë¥¼ í•˜ëŠ” ì‹ìœ¼ë¡œ Outside Inê³¼ Inside Out ë°©ì‹ì˜ í…ŒìŠ¤íŠ¸ë¥¼ ì„ì–´ê°€ë©´ì„œ ì§„í–‰í•˜ì˜€ë‹¤. ì´ë ‡ê²Œ ì§„í–‰ì„ í•˜ë‹ˆ ìš”êµ¬ì‚¬í•­ê³¼ ê¸°ëŠ¥ ì´í•´ì— ë„ì›€ì´ ë˜ì—ˆê³ , ë³µì¡í•œ ì„¤ê³„ë¥¼ í•œë²ˆì— ë§Œë“¤ë ¤ê³  í•˜ì§€ì•Šê³  ìª¼ê°œì„œ ìƒê°í•˜ê²Œ ë˜ì–´ ê¸°ëŠ¥ êµ¬í˜„ì— ë„ì›€ì´ ë˜ì—ˆë‹¤.</p>

<p>í•˜ì§€ë§Œ ì²˜ìŒë¶€í„° ì™„ë²½í•  ìˆ˜ëŠ” ì—†ì—ˆê³  ë©”ì„œë“œëª…, ë¹Œë”íŒ¨í„´ ì ìš©, Optional í™œìš©, ì¸í„°í˜ì´ìŠ¤ í™œìš© ë“± í”¼ë“œë°± ë°›ì€ ê²ƒë“¤ì´ ë§ì•˜ë‹¤. ê¸°ëŠ¥ êµ¬í˜„í•˜ë´ í”¼ë“œë°± ë°˜ì˜í•˜ë´â€¦ ì •ë§ ì‹œê°„ì´ ë„ˆë¬´ ë¶€ì¡±í–ˆë‹¤. ğŸ˜­</p>

<p>ì´ë²ˆ ë¯¸ì…˜ì„ í•˜ë©´ì„œ ì¸ìˆ˜ í…ŒìŠ¤íŠ¸, ë‹¨ìœ„ í…ŒìŠ¤íŠ¸, í†µí•© í…ŒìŠ¤íŠ¸ì— ì¢€ ë” ìµìˆ™í•´ì§ˆ ìˆ˜ ìˆì—ˆê³ , í”„ë¡œê·¸ë˜ë°ì— ëŒ€í•œ í”¼ë“œë°±ìœ¼ë¡œ ì‹¤ë ¥ í–¥ìƒì— ë„ì›€ì´ ë˜ì—ˆë‹¤.</p>

<p>ë’¤ë¡œ ê°ˆìˆ˜ë¡ ë¯¸ì…˜ ë‚œì´ë„ê°€ ë†’ì•„ì§€ë©´ì„œ, ë¯¸ì…˜ í•œ ë‹¨ê³„ í•œ ë‹¨ê³„ Merge ë  ë•Œë§ˆë‹¤ ì •ë§ ê°ê²©(?)ìŠ¤ëŸ¬ì› ë‹¤â€¦ ğŸ˜­</p>

<p>ì´ë²ˆ ë¯¸ì…˜ì—ì„œì˜ ë‚˜ì˜ ë¬¸ì œì ì€ í”¼ë“œë°±ì˜ ë‚´ìš©ì—ì„œ ì•Œ ìˆ˜ ìˆë“¯ì´ í”„ë¡œê·¸ë˜ë° ì‹¤ë ¥ ë¶€ì¡±ì´ì—ˆë‹¤â€¦ ğŸ˜­<br />
ì±…ë§Œ ìŒ“ì—¬ê°„ë‹¤â€¦ ğŸ“–ğŸ“–ğŸ“–</p>

<h2 id="-ì €ì¥ì†Œ">ğŸ’¾ ì €ì¥ì†Œ</h2>
<p><a href="https://github.com/sangjaeoh/atdd-subway-service/tree/step4" target="_blank">ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œ ë§í¬</a></p>]]></content><author><name>Sangjae Oh</name></author><category term="íšŒê³ " /><category term="íšŒê³ " /><category term="êµìœ¡" /><category term="ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸°" /><summary type="html"><![CDATA[2022ë…„ 10ì›” 24ì¼ ~ 2022ë…„ 12ì›” 23ì¼ ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸°ë¥¼ ê²½í—˜í•œ ë‚´ìš© ê¸°ë¡ì…ë‹ˆë‹¤.]]></summary></entry><entry><title type="html">ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸° - 3ì£¼ì°¨ (ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ ì£¼ë„ ê°œë°œ - ATDD)</title><link href="http://localhost:4000/%ED%9A%8C%EA%B3%A0/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BA%A0%ED%94%84pro5%EA%B8%B0-3%EC%A3%BC%EC%B0%A8/" rel="alternate" type="text/html" title="ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸° - 3ì£¼ì°¨ (ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ ì£¼ë„ ê°œë°œ - ATDD)" /><published>2023-01-04T00:00:00+09:00</published><updated>2023-01-04T00:00:00+09:00</updated><id>http://localhost:4000/%ED%9A%8C%EA%B3%A0/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BA%A0%ED%94%84pro5%EA%B8%B0-3%EC%A3%BC%EC%B0%A8</id><content type="html" xml:base="http://localhost:4000/%ED%9A%8C%EA%B3%A0/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BA%A0%ED%94%84pro5%EA%B8%B0-3%EC%A3%BC%EC%B0%A8/"><![CDATA[<p><em>2022ë…„ 10ì›” 24ì¼ ~ 2022ë…„ 12ì›” 23ì¼</em><br />
ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸°ë¥¼ ê²½í—˜í•œ ë‚´ìš© ê¸°ë¡ì…ë‹ˆë‹¤.</p>

<h2 id="ï¸-ë¯¸ì…˜-ì„¤ëª…">ğŸ™‡ğŸ»â€â™‚ï¸ ë¯¸ì…˜ ì„¤ëª…</h2>
<p>ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ ë§Œë“¤ê¸° ê²½í—˜ì„ ìœ„í•´ ì§€í•˜ì²  ë…¸ì„ ë„ ê´€ë¦¬ ì–´ë“œë¯¼ ì„œë¹„ìŠ¤ êµ¬í˜„ì„ ì œê³µëœ ì¸ìˆ˜ ì¡°ê±´ ê¸°ë°˜ìœ¼ë¡œ, ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ ì£¼ë„ ê°œë°œì„ ì§„í–‰í•˜ëŠ” ë¯¸ì…˜</p>

<h2 id="-í•™ìŠµ-ëª©í‘œ">ğŸ¯ í•™ìŠµ ëª©í‘œ</h2>
<ul>
  <li>ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ ì£¼ë„ ê°œë°œ ë°©ë²•ìœ¼ë¡œ ê°œë°œí•˜ëŠ” ê²½í—˜</li>
</ul>

<h2 id="-ê°•ì˜-ë‚´ìš©">ğŸ“– ê°•ì˜ ë‚´ìš©</h2>
<p>ATDDê°€ ë¬´ì—‡ì¸ì§€ ì„¤ëª…í•˜ê³ , ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ëŠ” ë°©ë²•, ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©ë˜ëŠ” ë„êµ¬ë¥¼ ì„¤ëª…</p>

<p><strong>ATDDë€?</strong><br />
ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ + TDD<br />
<img src="/assets/images/posts/atdd.png" alt="atdd" /></p>

<p><strong>ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ë€(Acceptance Test)?</strong></p>
<ul>
  <li>ì‚¬ìš©ì ìŠ¤í† ë¦¬ë¥¼ ê²€ì¦í•˜ëŠ” ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</li>
  <li>ì‚¬ìš©ì ìŠ¤í† ë¦¬ë¡œ í…ŒìŠ¤íŠ¸í•  ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‘ì„±</li>
  <li>ëª…ì„¸ë‚˜ ê³„ì•½ì˜ ìš”êµ¬ ì‚¬í•­ì´ ì¶©ì¡±ë˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ìˆ˜í–‰ë˜ëŠ” í…ŒìŠ¤íŠ¸</li>
</ul>

<p><strong>í…ŒìŠ¤íŠ¸ì˜ ì¢…ë¥˜</strong></p>
<ul>
  <li>ë‹¨ìœ„ í…ŒìŠ¤íŠ¸</li>
  <li>í†µí•© í…ŒìŠ¤íŠ¸</li>
  <li>E2E í…ŒìŠ¤íŠ¸</li>
</ul>

<p><strong>í…ŒìŠ¤íŠ¸ê°€ ê²€ì¦í•˜ëŠ” ëŒ€ìƒ</strong></p>
<ul>
  <li>ë‹¨ìœ„ í…ŒìŠ¤íŠ¸: êµ¬í˜„í•œ ë¶€ë¶„, ë‹¨ìœ„ë¥¼ ê²€ì¦</li>
  <li>í†µí•© í…ŒìŠ¤íŠ¸: ê° ë‹¨ìœ„ë“¤ì´ ìœ ê¸°ì ìœ¼ë¡œ ì˜ ë™ì‘í•˜ëŠ”ì§€ ê²€ì¦</li>
  <li>ì¸ìˆ˜ í…ŒìŠ¤íŠ¸: ìš”êµ¬ì‚¬í•­ì„ ë§Œì¡±í•˜ëŠ”ì§€ë¥¼ ê²€ì¦</li>
</ul>

<p>ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ëŠ” E2Eì— í•´ë‹¹</p>

<p><strong>webEnvironment</strong><br />
<code class="language-plaintext highlighter-rouge">@SpringBootTest</code>ì˜ <code class="language-plaintext highlighter-rouge">webEnvironment</code> ì†ì„±ì„ ì‚¬ìš©í•˜ì—¬ í…ŒìŠ¤íŠ¸ ì„œë²„ì˜ ì‹¤í–‰ ë°©ë²•ì„ ì„¤ì •</p>
<ul>
  <li>MOCK: Mockingëœ ì›¹ í™˜ê²½ì„ ì œê³µ, MockMvcë¥¼ ì‚¬ìš©í•œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆìŒ</li>
  <li>RANDOM_PORT: ì‹¤ì œ ì›¹ í™˜ê²½ì„ êµ¬ì„±</li>
  <li>DEFINED_PORT: ì‹¤ì œ ì›¹ í™˜ê²½ì„ êµ¬ì„±, ì§€ì •í•œ í¬íŠ¸ë¥¼ listen</li>
  <li>NONE: ì•„ë¬´ëŸ° ì›¹ í™˜ê²½ì„ êµ¬ì„±í•˜ì§€ ì•ŠìŒ</li>
</ul>

<p><strong>MockMvc vs WebTestClient vs RestAssured</strong></p>
<ul>
  <li>MockMvc<br />
<code class="language-plaintext highlighter-rouge">@SpringBootTest</code>ì˜ <code class="language-plaintext highlighter-rouge">webEnvironment.MOCK</code>ê³¼ í•¨ê»˜ ì‚¬ìš© ê°€ëŠ¥í•˜ë©° <code class="language-plaintext highlighter-rouge">mocking</code> ëœ <code class="language-plaintext highlighter-rouge">web environment</code> í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸</li>
  <li>WebTestClient<br />
<code class="language-plaintext highlighter-rouge">@SpringBootTest</code>ì˜ <code class="language-plaintext highlighter-rouge">webEnvironment.RANDOM_PORT</code> ë‚˜ <code class="language-plaintext highlighter-rouge">DEFINED_PORT</code>ì™€ í•¨ê»˜ ì‚¬ìš©, <code class="language-plaintext highlighter-rouge">Netty</code>ë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©</li>
  <li>RestAssured<br />
ì‹¤ì œ <code class="language-plaintext highlighter-rouge">web environment(Apache Tomcat)</code>ì„ ì‚¬ìš©í•˜ì—¬ í…ŒìŠ¤íŠ¸</li>
</ul>

<p><strong>JsonPath</strong></p>
<ul>
  <li>Json ë¬¸ì„œë¥¼ ì½ì–´ì˜¤ëŠ” DSL</li>
  <li>JsonPathë¥¼ ì‚¬ìš©í•˜ë©´ Response Dto ê°ì²´ë¡œ ë°›ì„ í•„ìš” ì—†ì´ í•„ìš”í•œ ê°’ë§Œ ì¶”ì¶œí•˜ì—¬ ê²€ì¦ì— ì‚¬ìš©í•  ìˆ˜ ìˆìŒ</li>
</ul>

<p><strong>ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ ì˜ˆì‹œ</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
* Given ì§€í•˜ì²  ë…¸ì„ ì„ ìƒì„±í•˜ê³ 
* When ìƒì„±í•œ ì§€í•˜ì²  ë…¸ì„ ì„ ì¡°íšŒí•˜ë©´
* Then ìƒì„±í•œ ì§€í•˜ì²  ë…¸ì„ ì˜ ì •ë³´ë¥¼ ì‘ë‹µë°›ì„ ìˆ˜ ìˆë‹¤.
*/</span>
<span class="nd">@Test</span>
<span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"ì§€í•˜ì²  ë…¸ì„  ì¡°íšŒ"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">retrieveLine</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// given</span>
    <span class="n">ì§€í•˜ì² ì—­ë“¤_ìƒì„±</span><span class="o">(</span><span class="s">"ì ì‹¤ì—­"</span><span class="o">,</span> <span class="s">"ë¬¸ì •ì—­"</span><span class="o">);</span>
    <span class="nc">Long</span> <span class="n">id</span> <span class="o">=</span> <span class="n">ì§€í•˜ì² ë…¸ì„ _ìƒì„±</span><span class="o">(</span><span class="s">"8í˜¸ì„ "</span><span class="o">,</span> <span class="s">"ë¶„í™ìƒ‰"</span><span class="o">,</span> <span class="mi">1L</span><span class="o">,</span> <span class="mi">2L</span><span class="o">,</span> <span class="mi">10</span><span class="o">).</span><span class="na">jsonPath</span><span class="o">().</span><span class="na">getLong</span><span class="o">(</span><span class="s">"id"</span><span class="o">);</span>

    <span class="c1">// when</span>
    <span class="nc">ExtractableResponse</span><span class="o">&lt;</span><span class="nc">Response</span><span class="o">&gt;</span> <span class="n">response</span> <span class="o">=</span> <span class="n">ì§€í•˜ì² ë…¸ì„ _ì¡°íšŒ</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>

    <span class="c1">// then</span>
    <span class="nc">JsonPath</span> <span class="n">jsonPath</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">jsonPath</span><span class="o">();</span>
    <span class="n">assertThat</span><span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">statusCode</span><span class="o">()).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">.</span><span class="na">value</span><span class="o">());</span>
    <span class="n">assertThat</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">.</span><span class="na">getLong</span><span class="o">(</span><span class="s">"id"</span><span class="o">)).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="nc">ExtractableResponse</span><span class="o">&lt;</span><span class="nc">Response</span><span class="o">&gt;</span> <span class="n">ì§€í•˜ì² ë…¸ì„ _ìƒì„±</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">String</span> <span class="n">color</span><span class="o">,</span> <span class="nc">Long</span> <span class="n">upStationId</span><span class="o">,</span> <span class="nc">Long</span> <span class="n">downStationId</span><span class="o">,</span> <span class="nc">Integer</span> <span class="n">distance</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
    <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="n">name</span><span class="o">);</span>
    <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"color"</span><span class="o">,</span> <span class="n">color</span><span class="o">);</span>
    <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"upStationId"</span><span class="o">,</span> <span class="n">upStationId</span><span class="o">);</span>
    <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"downStationId"</span><span class="o">,</span> <span class="n">downStationId</span><span class="o">);</span>
    <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"distance"</span><span class="o">,</span> <span class="n">distance</span><span class="o">);</span>

    <span class="k">return</span> <span class="nc">RestAssured</span><span class="o">.</span><span class="na">given</span><span class="o">().</span><span class="na">log</span><span class="o">().</span><span class="na">all</span><span class="o">()</span>
            <span class="o">.</span><span class="na">body</span><span class="o">(</span><span class="n">params</span><span class="o">)</span>
            <span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON_VALUE</span><span class="o">)</span>
            <span class="o">.</span><span class="na">when</span><span class="o">().</span><span class="na">post</span><span class="o">(</span><span class="s">"/lines"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">then</span><span class="o">().</span><span class="na">log</span><span class="o">().</span><span class="na">all</span><span class="o">()</span>
            <span class="o">.</span><span class="na">extract</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="nc">ExtractableResponse</span><span class="o">&lt;</span><span class="nc">Response</span><span class="o">&gt;</span> <span class="n">ì§€í•˜ì² ë…¸ì„ _ì¡°íšŒ</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">RestAssured</span>
            <span class="o">.</span><span class="na">given</span><span class="o">().</span><span class="na">log</span><span class="o">().</span><span class="na">all</span><span class="o">()</span>
            <span class="o">.</span><span class="na">when</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">"/lines/{id}"</span><span class="o">,</span> <span class="n">id</span><span class="o">)</span>
            <span class="o">.</span><span class="na">then</span><span class="o">().</span><span class="na">log</span><span class="o">().</span><span class="na">all</span><span class="o">()</span>
            <span class="o">.</span><span class="na">extract</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="-ë¯¸ì…˜-í›„ê¸°">ğŸ“ ë¯¸ì…˜ í›„ê¸°</h2>
<p>ì´ë²ˆ ë¯¸ì…˜ì—ì„œ ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ë¼ëŠ” ê²ƒì„ ì²˜ìŒ ì ‘í•˜ì˜€ë‹¤. ì²˜ìŒ ì„¤ëª…ì„ ë“¤ì—ˆì„ë•Œ ê°œë… ì¡ê¸°ê°€ ì•½ê°„ì€ ì–´ë ¤ì› ì§€ë§Œ ì‹¤ì œ ì˜ˆì œ ì½”ë“œë¥¼ ë³´ê³  ë¯¸ì…˜ì„ ì§„í–‰í•´ë³´ë‹ˆ, TDDë¥¼ ì²˜ìŒ ì ‘í–ˆì„ ë•Œë³´ë‹¤ í›¨ì”¬ ìˆ˜ì›”í•˜ê²Œ í•  ìˆ˜ ìˆì—ˆë‹¤. ì•„ë§ˆ ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ì˜ ëª©ì ìì²´ê°€ ì‚¬ìš©ìì˜ ìŠ¤í† ë¦¬ë¥¼ ê²€ì¦í•˜ëŠ” í…ŒìŠ¤íŠ¸ë¼ì„œ ì§ê´€ì ìœ¼ë¡œ êµ¬ìƒí•˜ê¸° ì¢‹ì•„ì„œ ê·¸ëŸ°ê²ƒ ê°™ë‹¤.</p>

<p>ê·¸ì™€ëŠ” ë³„ê°œë¡œ ì´ë²ˆ ë¯¸ì…˜ì´ 1ì£¼ì°¨, 2ì£¼ì°¨ ëŒ€ë¹„ í™•ì‹¤íˆ ì–´ë ¤ì› ë‹¤.</p>

<p><strong>1ë‹¨ê³„ ì¸ìˆ˜í…ŒìŠ¤íŠ¸ ì‘ì„±</strong>, <strong>2ë‹¨ê³„ ì§€í•˜ì²  ë…¸ì„  ê¸°ëŠ¥</strong> êµ¬í˜„ì€ ë‹¨ìˆœ CURDë¡œ í¬ê²Œ ì–´ë µì§€ ì•Šê²Œ êµ¬í˜„í•  ìˆ˜ ìˆì—ˆì§€ë§Œ <strong>3ë‹¨ê³„ êµ¬ê°„ ì¶”ê°€ê¸°ëŠ¥</strong>, <strong>4ë‹¨ê³„ êµ¬ê°„ ì œê±° ê¸°ëŠ¥</strong>ì€ ì •ì±…ì´ ë§ì•„ ì—¬ëŸ¬ê°€ì§€ ìƒê°í•  ê²ƒë“¤ì´ ë§ì•˜ë‹¤.<br />
ë¯¸ì…˜ì„ ì§„í–‰í•˜ë©´ì„œ ë¶€ì¡±í•œ JPA ì§€ì‹ì— ëŒ€í•´ì„œëŠ” <strong>ìë°” ORM í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë°</strong> ì±…ì„ ì‚´í´ë³´ë©° ë¯¸ì…˜ì„ ì§„í–‰í•˜ì˜€ê³ , ë¦¬ë·°ì–´ë‹˜ì˜ í”¼ë“œë°±ë„ ë§ì€ ë„ì›€ì´ ë˜ì—ˆë‹¤.</p>

<p>ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì— ë”í•˜ì—¬ ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°œë°œ, ë¦¬íŒ©í„°ë§ì„ ì§„í–‰í•´ë³´ë‹ˆ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë§Œìœ¼ë¡œ ê¸°ëŠ¥ ê°œë°œí–ˆì„ ë•Œë³´ë‹¤ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì´í•´í•˜ëŠ”ë° ë§ì€ ë„ì›€ì´ ë˜ì—ˆê³ , í”„ë¡œê·¸ë˜ë° í•˜ê¸°ë„ í›¨ì”¬ ìˆ˜ì›”í•˜ì˜€ë‹¤.</p>

<p>ì´ë²ˆ ë¯¸ì…˜ì—ì„œ ë‚˜ì˜ ë¬¸ì œì ì€ ì—¬ì „íˆ ì„œë¹„ìŠ¤ì—ì„œ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ë˜ ë²„ë¦‡ì´ ìˆì–´ì„œ ê·¸ëŸ°ì§€, ë„ë©”ì¸ì— ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ë ¤ë‹¤ ë³´ë‹ˆ ì–´ë–»ê²Œ í•´ì•¼í• ì§€ ìƒê°ì´ ì•ˆë‚˜ ë§‰íˆëŠ” ë¶€ë¶„ì´ ìˆì—ˆê³ , ë©”ì†Œë“œëª…ìœ¼ë¡œ ë¡œì§ì˜ ë™ì‘ì˜ë¯¸ë¥¼ ëª…í™•íˆ í•˜ëŠ” ë¶€ë¶„ì´ ë¶€ì¡±í•˜ì˜€ë‹¤.</p>

<p>ì´ë¥¼ ê°œì„ í•˜ê¸° ìœ„í•´ì„œ ê°ì²´ ì§€í–¥ ì„¤ê³„ì— ëŒ€í•´ ë” ê³µë¶€, ì—°ìŠµì„ í•˜ê³  ë©”ì†Œë“œ, ë³€ìˆ˜ì˜ ì˜ë¯¸ë¥¼ ë°”ë¡œì•Œ ìˆ˜ ìˆë„ë¡ ì¶•ì•½í•˜ì§€ ì•Šê³  ìì„¸íˆ ì„¤ëª…í•˜ëŠ” ì´ë¦„ì„ ì§“ëŠ” ë…¸ë ¥ì„ í•´ì•¼í•  ê²ƒ ê°™ë‹¤. ğŸ˜…ğŸ˜‚</p>

<h2 id="-ì €ì¥ì†Œ">ğŸ’¾ ì €ì¥ì†Œ</h2>
<p><a href="https://github.com/sangjaeoh/atdd-subway-admin/tree/step4" target="_blank">ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œ ë§í¬</a></p>]]></content><author><name>Sangjae Oh</name></author><category term="íšŒê³ " /><category term="íšŒê³ " /><category term="êµìœ¡" /><category term="ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸°" /><summary type="html"><![CDATA[2022ë…„ 10ì›” 24ì¼ ~ 2022ë…„ 12ì›” 23ì¼ ìš°ì•„í•œí…Œí¬ìº í”„ Pro 5ê¸°ë¥¼ ê²½í—˜í•œ ë‚´ìš© ê¸°ë¡ì…ë‹ˆë‹¤.]]></summary></entry></feed>