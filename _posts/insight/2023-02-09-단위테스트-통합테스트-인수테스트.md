---
layout: single
title: "ë‹¨ìœ„ í…ŒìŠ¤íŠ¸, í†µí•© í…ŒìŠ¤íŠ¸, ì¸ìˆ˜ í…ŒìŠ¤íŠ¸"
categories: [Insight]
tag: [Insight, Test]
author_profile: true
toc: true
toc_sticky: true
---

ë‹¨ìœ„ í…ŒìŠ¤íŠ¸, í†µí•© í…ŒìŠ¤íŠ¸, ì¸ìˆ˜  í…ŒìŠ¤íŠ¸ì— ëŒ€í•´ ì„¤ëª…í•©ë‹ˆë‹¤.

<br/>

# ğŸ¤” ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë€?
- Unit Testë¼ê³  í•œë‹¤.
- ê°œë°œì ê´€ì ì—ì„œ í…ŒìŠ¤íŠ¸í•œë‹¤.
- êµ¬í˜„í•œ ë¶€ë¶„, ë‹¨ìœ„ë¥¼ ê²€ì¦í•œë‹¤.
- ë‹¨ìœ„ ê¸°ëŠ¥ì„ ì¤‘ì‹¬ìœ¼ë¡œ ë‹¤ë¥¸ ì™¸ë¶€ ì˜í–¥ì„ ë°°ì œí•˜ê³  í…ŒìŠ¤íŠ¸ í•˜ëŠ” ê²ƒì´ ëª©ì ì´ë‹¤.
- í˜‘ë ¥ ê°ì²´ê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì—ëŠ” í˜‘ë ¥ ê°ì²´ê°€ ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ì‘ë‹µí•˜ë„ë¡ ëª¨í‚¹í•œë‹¤.  
<br/>

**ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ë²”ìœ„**  
- ë‹¨ìœ„ì˜ í¬ê¸°ë¥¼ ì •í™•íˆ ì œì‹œí•˜ê¸°ëŠ” ì–´ë µë‹¤.
- ì¼ë°˜ì ìœ¼ë¡œ íŠ¹ì •í•œ ì±…ì„ì„ ìˆ˜í–‰í•˜ë©´ì„œ, ê³ ë¦½ë  ìˆ˜ ìˆëŠ” ìµœì†Œ ë‹¨ìœ„  
<br/>

**ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì˜ˆ** 
```java
class UnitTest {

    @DisplayName("ì´ë¦„ì„ ë°›ì•„ ìë™ì°¨ ìƒì„±")
    @Test
    public void createCar() {
        // given
        String name = "Boong-Boong";

        // when
        Car car = new Car(name);

        // then
        assertThat(car).isNotNull();
    }

    @DisplayName("ìˆ«ì 4ë¥¼ ë°›ìœ¼ë©´ ìë™ì°¨ê°€ 1 ì „ì§„í•œë‹¤.")
    @Test
    public void moveCar() {
        // given
        Car car = new Car("Boong-Boong");

        // when
        car.move(4);

        // then
        assertThat(car.getPosition()).isEqualTo(1);
    }
}
```
<br/>

**í˜‘ë ¥ ê°ì²´ì˜ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì˜ˆ**
```java
@ExtendWith(MockitoExtension.class)
class ServiceTest {

    @Mock
    private CarRepository carRepository;

    @InjectMocks
    private CarService carService;

    @DisplayName("ì´ë¦„ì„ ë°›ì•„ ìë™ì°¨ë¥¼ ì €ì¥í•œë‹¤.")
    @Test
    public void save(){
        // given
        final String NAME = "Boong-Boong";
        when(carRepository.save(any())).thenReturn(Optional.of(new Car(NAME)));
        
        // when
        CarResponse carResponse = carService.save(NAME);

        // then
        assertThat(carResponse.getName()).isEqualTo(NAME);
    }
}
```
```java
@WebMvcTest(CarController.class)
public class CarControllerTest {

    private static final String API_BASE_PATH = "/api/cars";

    @Autowired
    private MockMvc mockMvc;

    @MockBean
    private CarService carService;

    @Autowired
    private ObjectMapper objectMapper;

    @DisplayName("ìë™ì°¨ë¥¼ ìƒì„±í•œë‹¤.")
    @Test
    public void createCar() throws Exception {
        //given
        CarRequest carRequest = new carRequest("Boong-Boong");
        CarResponse carResponse = new CarResponse(1L, carRequest.getName());
        given(carService.save(any())).willReturn(carResponse);

        //when, then
        mockMvc.perform(post(API_BASE_PATH)
                .content(objectMapper.writeValueAsString(carRequest))
                .contentType(MediaType.APPLICATION_JSON))
                .andExpect(status().isCreated())
                .andExpect(jsonPath("$.id").value(carResponse.getId()));
    }
}
```
<br/>
<br/>
<br/>



# ğŸ¤” í†µí•© í…ŒìŠ¤íŠ¸ë€?
- Integration Testë¼ê³  í•œë‹¤.
- ê°œë°œì ê´€ì ì—ì„œ í…ŒìŠ¤íŠ¸í•œë‹¤.
- ì—¬ëŸ¬ ê¸°ëŠ¥ì„ ì¡°í•©í•˜ì—¬ ì „ì²´ ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ì´ ì œëŒ€ë¡œ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.
- ë‹¨ìœ„ ê¸°ëŠ¥ ê°„ì˜ ì˜ì¡´ì„±ì„ í¬í•¨í•˜ì—¬ í…ŒìŠ¤íŠ¸í•œë‹¤.
- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì™€ ë‹¬ë¦¬ ê°œë°œìê°€ ë³€ê²½í•  ìˆ˜ ì—†ëŠ” ë¶€ë¶„(ì˜ˆ: ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬)ê¹Œì§€ ë¬¶ì–´ ê²€ì¦í•  ë•Œ ì‚¬ìš©í•œë‹¤.  
<br/>


**í†µí•© í…ŒìŠ¤íŠ¸ ì˜ˆ** 
```java
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.MOCK)
class CarServiceTest {

    @Autowired
    private CarService carService;

    @DisplayName("ì´ë¦„ì„ ë°›ì•„ ìë™ì°¨ë¥¼ ì €ì¥í•œë‹¤.")
    @Test
    public void save(){
        // given
        final String NAME = "Boong-Boong";
        
        // when
        CarResponse car = carService.save(NAME);

        // then
        assertThat(car.getName()).isEqualTo(NAME);
    }
}
```
<br/>
<br/>
<br/>




# ğŸ¤” ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ë€?
- Acceptance Testë¼ê³  í•œë‹¤.
- ì‚¬ìš©ì ê´€ì ì—ì„œ í…ŒìŠ¤íŠ¸í•œë‹¤.
- ì‚¬ìš©ì ìŠ¤í† ë¦¬(ì‹œë‚˜ë¦¬ì˜¤)ì— ë§ì¶° ìˆ˜í–‰í•˜ëŠ” í…ŒìŠ¤íŠ¸ì´ë‹¤.
- ìš”êµ¬ì‚¬í•­ì„ ë§Œì¡±í•˜ëŠ”ì§€ë¥¼ ê²€ì¦í•œë‹¤.
- ë‹¤ë¥¸ ì˜ì‚¬ì†Œí†µì§‘ë‹¨ìœ¼ë¡œë¶€í„° ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ë°›ì•„(ì¸ìˆ˜) ê°œë°œí•œë‹¤ëŠ” ì˜ë¯¸ë¥¼ ê°€ì§€ê³  ìˆë‹¤.  
<br/>


**ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ ì˜ˆ: MockMvc**  
{% capture notice %}
- ì‹¤ì œë¡œ ì„œë²„ë¥¼ êµ¬ë™í•˜ì§„ ì•Šê³  ëª¨í‚¹í•œ Spring MVC í™˜ê²½ì„ êµ¬í˜„
- MVC ì„œë²„ì™€ ìš”ì²­ì„ ë‚ ë¦¬ëŠ” ê³³ì˜ ìŠ¤ë ˆë“œê°€ ë¶„ë¦¬ë˜ë¯€ë¡œ `@Transaction`ì„ ì„ ì–¸í•˜ì—¬ë„ `Rollback`ë˜ì§€ ì•ŠìŒ.
  - ë°ì´í„°ë¥¼ ì§ì ‘ ì‚­ì œí•´ì•¼í•¨
{% endcapture %}
<div class="notice--info">{{ notice | markdownify }}</div>

```java
@SpringBootTest
@AutoConfigureMockMvc
public class CarControllerMockTest {

    private static final String API_BASE_PATH = "/api/cars";

    @Autowired
    private MockMvc mockMvc;

    @Autowired
    private ObjectMapper objectMapper;

    @DisplayName("ìë™ì°¨ë¥¼ ìƒì„±í•œë‹¤.")
    @Test
    public void createCar() throws Exception {
        //given
        CarRequest carRequest = new carRequest("Boong-Boong");
        CarResponse carResponse = new CarResponse(1L, carRequest.getName());

        //when, then
        mockMvc.perform(post(API_BASE_PATH)
                .content(objectMapper.writeValueAsString(carRequest))
                .contentType(MediaType.APPLICATION_JSON))
                .andExpect(status().isCreated())
                .andExpect(jsonPath("$.id").value(carResponse.getId()));
    }
}
```
<br/>

**ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ ì˜ˆ: RestAssured**
{% capture notice %}
- ì‹¤ì œ ì„œë²„ë¥¼ êµ¬ë™í•˜ì—¬ ì‹¤ì œì™€ ë™ì¼í•œ í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ì§€ì›
- MockMvcì™€ ë§ˆì°¬ê°€ì§€ë¡œ MVC ì„œë²„ì™€ ìš”ì²­ì„ ë‚ ë¦¬ëŠ” ê³³ì˜ ìŠ¤ë ˆë“œê°€ ë¶„ë¦¬ë˜ë¯€ë¡œ `@Transaction`ì„ ì„ ì–¸í•˜ì—¬ë„ `Rollback`ë˜ì§€ ì•ŠìŒ.
  - ë°ì´í„°ë¥¼ ì§ì ‘ ì‚­ì œí•´ì•¼í•¨
{% endcapture %}
<div class="notice--info">{{ notice | markdownify }}</div>

```java
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
public class AcceptanceTest {

    @LocalServerPort
    int port;

    @Autowired
    private DatabaseCleanup databaseCleanup; // ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë“±ë¡ëœ ì—”í‹°í‹°ë¥¼ í…Œì´ë¸”ì„ ë¹„ì›Œì£¼ëŠ” í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ (ì„ì˜ë¡œ ë§Œë“  í´ë ˆìŠ¤)

    @BeforeEach // ë§¤ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì „ì—
    public void setUp() {
        RestAssured.port = port;
        databaseCleanup.execute();  // í…Œì´ë¸”ì„ ë¹„ì›Œì¤€ë‹¤.
    }
}
```
```java
public class CarAcceptanceTest extends AcceptanceTest{

    private static final String API_BASE_PATH = "/api/cars";

    @DisplayName("ìë™ì°¨ë¥¼ ìƒì„±í•œë‹¤.")
    @Test
    public void createCar(){
        //give
        CarRequest ìë™ì°¨ = new carRequest("Boong-Boong");

        //when
        ExtractableResponse<Response> ìë™ì°¨_ìƒì„±_ê²°ê³¼ = ìë™ì°¨_ìƒì„±_ìš”ì²­(ìë™ì°¨);

        //then
        ìë™ì°¨_ìƒì„±_ì™„ë£Œë¨(ìë™ì°¨_ìƒì„±_ê²°ê³¼);
    }

    public ExtractableResponse<Response> ìë™ì°¨_ìƒì„±_ìš”ì²­(CarRequest request) {
        return RestAssured
            .given().log().all()
            .contentType(MediaType.APPLICATION_JSON_VALUE)
            .body(request)
            .when().post(API_BASE_PATH)
            .then().log().all()
            .extract();
    }

    public static void ìë™ì°¨_ìƒì„±_ì™„ë£Œë¨(ExtractableResponse<Response> response) {
        assertThat(response.statusCode()).isEqualTo(HttpStatus.OK.value());
    }
}
```





<br/>
<br/>
<br/>

# ğŸ™‡ğŸ»â€â™‚ï¸ ì°¸ê³ ì‚¬ì´íŠ¸
- [https://jerry92k.tistory.com/](https://jerry92k.tistory.com/m/77){:target="_blank"}
- [https://tecoble.techcourse.co.kr](https://tecoble.techcourse.co.kr/post/2021-05-25-unit-test-vs-integration-test-vs-acceptance-test/){:target="_blank"}